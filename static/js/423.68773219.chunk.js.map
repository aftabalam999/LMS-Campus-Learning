{"version":3,"file":"static/js/423.68773219.chunk.js","mappings":"0MAoBOA,eAAeC,EAAcC,EAAYC,GAE9C,GAAID,EAAKE,KAAOD,EAAKE,WACnB,OAAO,EAIT,GAAIH,EAAKI,SAAyB,UAAdJ,EAAKK,KAEvB,OADAC,QAAQC,IAAI,oDACL,EAIT,GAAkB,uBAAdP,EAAKK,MAAiCL,EAAKQ,OAAQ,CACrD,MAAMC,QAAgBC,EAAAA,YAAYC,YAAYV,EAAKE,YAC7CS,IAAkBH,GAAWA,EAAQD,SAAWR,EAAKQ,OAM3D,OALAF,QAAQC,IAAI,yCAAgC,CAC1CM,WAAYb,EAAKQ,OACjBM,cAAsB,OAAPL,QAAO,IAAPA,OAAO,EAAPA,EAASD,OACxBI,kBAEKA,CACT,CAGA,GAAIZ,EAAKe,eAA+B,iBAAdf,EAAKK,MAAyC,WAAdL,EAAKK,KAAmB,CAChF,MAAMW,QAAwBN,EAAAA,YAAYO,mBAAmBjB,EAAKE,IAC5DU,EAAgBI,EAAgBE,SAASjB,EAAKE,YAQpD,OAPAG,QAAQC,IAAI,iEAAyC,CACnDY,SAAUnB,EAAKE,GACfkB,WAAYpB,EAAKqB,KACjBC,cAAerB,EAAKE,WACpBa,kBACAJ,kBAEKA,CACT,CAGA,OAAO,CACT,CAQOd,eAAeyB,EAAoBvB,EAAYwB,GAEpD,GAAIxB,EAAKE,KAAOsB,EAAWrB,WACzB,OAAO,EAIT,GAAIH,EAAKI,SAAyB,UAAdJ,EAAKK,KAEvB,OADAC,QAAQC,IAAI,0DACL,EAIT,GAAkB,uBAAdP,EAAKK,MAAiCL,EAAKQ,OAAQ,CACrD,MAAMC,QAAgBC,EAAAA,YAAYC,YAAYa,EAAWrB,YACnDS,IAAkBH,GAAWA,EAAQD,SAAWR,EAAKQ,OAM3D,OALAF,QAAQC,IAAI,sDAA6C,CACvDM,WAAYb,EAAKQ,OACjBM,cAAsB,OAAPL,QAAO,IAAPA,OAAO,EAAPA,EAASD,OACxBI,kBAEKA,CACT,CAGA,GAAIZ,EAAKe,eAA+B,iBAAdf,EAAKK,MAAyC,WAAdL,EAAKK,KAAmB,CAChF,MAAMW,QAAwBN,EAAAA,YAAYO,mBAAmBjB,EAAKE,IAC5DU,EAAgBI,EAAgBE,SAASM,EAAWrB,YAQ1D,OAPAG,QAAQC,IAAI,uEAA+C,CACzDY,SAAUnB,EAAKE,GACfkB,WAAYpB,EAAKqB,KACjBI,oBAAqBD,EAAWrB,WAChCa,kBACAJ,kBAEKA,CACT,CAGA,OAAO,CACT,C","sources":["services/permissions.ts"],"sourcesContent":["import { User, DailyGoal, DailyReflection, MentorChangeRequest } from '../types';\nimport { UserService } from './firestore';\n\n/**\n * Centralized permission checks for role-based access control\n * \n * Role hierarchy:\n * - Admin: Full access to all resources\n * - Academic Associate: Campus-wide access (all students on their campus)\n * - Super Mentor: Assigned mentees only\n * - Mentor: Assigned mentees only (regular mentor)\n * - Student: Own resources only\n */\n\n/**\n * Check if a user can review (approve/comment on) a specific goal\n * @param user The user attempting to review\n * @param goal The goal being reviewed\n * @returns true if user has permission, false otherwise\n */\nexport async function canReviewGoal(user: User, goal: DailyGoal): Promise<boolean> {\n  // Prevent self-review\n  if (user.id === goal.student_id) {\n    return false;\n  }\n\n  // Admin can review anything\n  if (user.isAdmin || user.role === 'admin') {\n    console.log('‚úÖ Admin permission granted for goal review');\n    return true;\n  }\n\n  // Academic Associate can review goals from their entire campus\n  if (user.role === 'academic_associate' && user.campus) {\n    const student = await UserService.getUserById(goal.student_id);\n    const hasPermission = !!student && student.campus === user.campus;\n    console.log('üè´ Academic Associate check:', {\n      userCampus: user.campus,\n      studentCampus: student?.campus,\n      hasPermission\n    });\n    return hasPermission;\n  }\n\n  // Super Mentor / Mentor can review goals from their assigned mentees\n  if (user.isSuperMentor || user.role === 'super_mentor' || user.role === 'mentor') {\n    const assignedMentees = await UserService.getAssignedMentees(user.id);\n    const hasPermission = assignedMentees.includes(goal.student_id);\n    console.log('üë®‚Äçüè´ Mentor permission check (goal):', {\n      mentorId: user.id,\n      mentorName: user.name,\n      goalStudentId: goal.student_id,\n      assignedMentees,\n      hasPermission\n    });\n    return hasPermission;\n  }\n\n  // Students and users without elevated roles cannot review\n  return false;\n}\n\n/**\n * Check if a user can review (approve/comment on) a specific reflection\n * @param user The user attempting to review\n * @param reflection The reflection being reviewed\n * @returns true if user has permission, false otherwise\n */\nexport async function canReviewReflection(user: User, reflection: DailyReflection): Promise<boolean> {\n  // Prevent self-review\n  if (user.id === reflection.student_id) {\n    return false;\n  }\n\n  // Admin can review anything\n  if (user.isAdmin || user.role === 'admin') {\n    console.log('‚úÖ Admin permission granted for reflection review');\n    return true;\n  }\n\n  // Academic Associate can review reflections from their entire campus\n  if (user.role === 'academic_associate' && user.campus) {\n    const student = await UserService.getUserById(reflection.student_id);\n    const hasPermission = !!student && student.campus === user.campus;\n    console.log('üè´ Academic Associate check (reflection):', {\n      userCampus: user.campus,\n      studentCampus: student?.campus,\n      hasPermission\n    });\n    return hasPermission;\n  }\n\n  // Super Mentor / Mentor can review reflections from their assigned mentees\n  if (user.isSuperMentor || user.role === 'super_mentor' || user.role === 'mentor') {\n    const assignedMentees = await UserService.getAssignedMentees(user.id);\n    const hasPermission = assignedMentees.includes(reflection.student_id);\n    console.log('üë®‚Äçüè´ Mentor permission check (reflection):', {\n      mentorId: user.id,\n      mentorName: user.name,\n      reflectionStudentId: reflection.student_id,\n      assignedMentees,\n      hasPermission\n    });\n    return hasPermission;\n  }\n\n  // Students and users without elevated roles cannot review\n  return false;\n}\n\n/**\n * Check if a user can approve/reject a mentor change request\n * @param user The user attempting to approve/reject\n * @param request The mentor change request\n * @returns true if user has permission, false otherwise\n */\nexport async function canApproveMentorChange(user: User, request: MentorChangeRequest): Promise<boolean> {\n  // Admin can approve anything\n  if (user.isAdmin) {\n    return true;\n  }\n\n  // Super Mentor can approve requests for their assigned mentees\n  if (user.isSuperMentor || user.role === 'super_mentor') {\n    const assignedMentees = await UserService.getAssignedMentees(user.id);\n    return assignedMentees.includes(request.student_id);\n  }\n\n  // Academic Associate can approve requests for their entire campus\n  if (user.role === 'academic_associate' && user.campus) {\n    const student = await UserService.getUserById(request.student_id);\n    return !!student && student.campus === user.campus;\n  }\n\n  return false;\n}\n\n/**\n * Get user role for display/logging purposes\n * @param user The user\n * @returns Normalized role string\n */\nexport function getUserRole(user: User): string {\n  if (user.isAdmin) return 'admin';\n  if (user.role === 'academic_associate') return 'academic_associate';\n  if (user.isSuperMentor || user.role === 'super_mentor') return 'super_mentor';\n  if (user.role === 'mentor') return 'mentor';\n  return 'student';\n}\n"],"names":["async","canReviewGoal","user","goal","id","student_id","isAdmin","role","console","log","campus","student","UserService","getUserById","hasPermission","userCampus","studentCampus","isSuperMentor","assignedMentees","getAssignedMentees","includes","mentorId","mentorName","name","goalStudentId","canReviewReflection","reflection","reflectionStudentId"],"ignoreList":[],"sourceRoot":""}