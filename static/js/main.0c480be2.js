/*! For license information please see main.0c480be2.js.LICENSE.txt */
(()=>{var e={356:(e,t,n)=>{e.exports=n(9645).last},579:(e,t,n)=>{"use strict";e.exports=n(2799)},763:(e,t,n)=>{"use strict";n.r(t),n.d(t,{phase3Topics:()=>r});const r=[{name:"Project Introduction: Interactive Quiz Master",order:1,maxTime:null,keyConcepts:["Overview"],description:"Learn how JavaScript brings websites to life. Understand the goal of making an interactive quiz application using existing HTML & CSS.",deliverable:"No video \u2013 intro only",video:null},{name:"Starting the Quiz (Start Page / quiz.html)",order:2,maxTime:null,keyConcepts:["Variables","Functions","DOM Manipulation","Events"],description:'Implement "Start Quiz" button functionality to reveal the first question or navigate to quiz.html. Learn DOM basics and event handling.',deliverable:"1 Video: Show Start Page + explain variables, functions, events, DOM Manipulation.",video:1},{name:"Storing Quiz Questions & Answers",order:3,maxTime:null,keyConcepts:["Arrays","Objects"],description:"Create an array of question objects holding text, options, and correct answers. Practice storing structured data.",deliverable:"1 Video: Show array/object structure + explain data organization.",video:1},{name:"Displaying Questions & Options (quiz.html)",order:4,maxTime:null,keyConcepts:["Loops","Strings","Functions","DOM Manipulation"],description:"Use loops to iterate through questions and display them dynamically. Build HTML content using strings.",deliverable:"1 Video: Show questions & options appearing dynamically + explanation of loops, strings, DOM usage.",video:1},{name:"Handling User Answers & Navigation (quiz.html)",order:5,maxTime:null,keyConcepts:["Variables","Operators","Conditional Statements","Functions","DOM","Events"],description:"Detect user answers, compare with correct answers, update score, and move to the next question or results page.",deliverable:"1 Video: Show answer handling and navigation + explanation of events, conditionals, and score tracking.",video:1},{name:"Calculating & Displaying Results (results.html)",order:6,maxTime:null,keyConcepts:["Variables","Strings","DOM","Functions","URL Parameters (optional)"],description:"Calculate final score and display a result message dynamically. Optionally, pass data between pages.",deliverable:"1 Video: Show results display + explanation of score calculation and DOM usage.",video:1},{name:"Restarting the Quiz (Optional, results.html or quiz.html)",order:7,maxTime:null,keyConcepts:["Functions","Variables","DOM","Events"],description:'Implement a "Restart Quiz" feature to reset variables and page state.',deliverable:"1 Video: Show reset functionality + explanation of functions, events, and state reset.",video:1},{name:"Mini Projects: Practice JS Concepts",order:8,maxTime:null,keyConcepts:["Variables","Arrays","Objects","Functions","DOM","Events","Operators","Strings"],description:"Build focused practice projects: To-Do List, Tip Calculator, Quote Generator. Solidify JS fundamentals before or alongside the main project.",deliverable:"1 Video per mini-project: Show working demo + explain concepts applied.",video:3},{name:"Project Wrap-Up & Reflection",order:9,maxTime:null,keyConcepts:["Review All Learned Concepts"],description:"Review JavaScript fundamentals applied in the project: Variables, Data Types, Operators, Strings, Loops, Arrays, Objects, Functions, DOM, Events, Conditional Statements.",deliverable:"1 Video: Reflect on learning + demonstrate final working quiz.",video:1}]},870:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObject=function(e){return null!==e&&("object"===typeof e||"function"===typeof e)}},1203:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8420);t.isArrayLike=function(e){return null!=e&&"function"!==typeof e&&r.isLength(e.length)}},1267:(e,t,n)=>{"use strict";n.r(t),n.d(t,{achievementLevels:()=>l,detailedTopics:()=>a,getTopicDetails:()=>o,goalTemplates:()=>i,initialPhases:()=>r,initialTopics:()=>s});const r=[{name:"Super mentor Phase",order:9,isSenior:!0},{name:"Induction: Life Skills & Learning",order:0},{name:"Phase 0: Foundation",order:1},{name:"Phase 1: Student Profile & Course Portal (HTML Only)",order:2},{name:"Phase 2: Styling & Responsive Design",order:3},{name:"Phase 3: Interactive Quiz Master",order:4},{name:"Phase 4: AI-Powered Content Generator",order:5},{name:"Phase 5: Ask Gemini Web App",order:6},{name:"Phase 6: Student Feedback Manager",order:7},{name:"Phase 7: CollabSphere",order:8},{name:"Self Learning Space",order:10}],a={"Super mentor Phase":[{name:"Module 4",order:1,maxTime:120,keyTags:["Advanced Concepts"],deliverable:"Complete Module 4 assignments",icon:"\u2b50",technologies:["Mentor Guidance"],description:"Advanced learning and mentorship activities for Module 4."},{name:"Module 5",order:2,maxTime:120,keyTags:["Advanced Concepts"],deliverable:"Complete Module 5 assignments",icon:"\u2b50",technologies:["Mentor Guidance"],description:"Advanced learning and mentorship activities for Module 5."},{name:"Module 6",order:3,maxTime:120,keyTags:["Advanced Concepts"],deliverable:"Complete Module 6 assignments",icon:"\u2b50",technologies:["Mentor Guidance"],description:"Advanced learning and mentorship activities for Module 6."},{name:"React Bootcamp",order:4,maxTime:180,keyTags:["React","Bootcamp"],deliverable:"Complete React Bootcamp project",icon:"\u269b\ufe0f",technologies:["React","Mentor Guidance"],description:"Intensive React bootcamp for advanced students."}],"Induction: Life Skills & Learning":[{name:"LS0: Pre-Check \u2013 Tools Setup",order:1,maxTime:120,keyTags:["Digital Tools","Setup","Prerequisites","Technology"],deliverable:"Confirm installation & explore tool usage",icon:"\ud83d\udee0\ufe0f",technologies:["Haal-Chaal","Google Translate","AudioPen","ChatGPT","Gemini AI","Google Docs"],description:"**Quest 0: Pre-Check \u2013 Tools Setup**\n\n**Purpose:** Ensure students have basic digital tools for learning & exploration.\n\n**Key Activities:**\n\u2022 Install Haal-Chaal app for campus communication\n\u2022 Set up Google Translate for language support\n\u2022 Install AudioPen for voice-to-text notes\n\u2022 Set up ChatGPT account and explore basic usage\n\u2022 Install Gemini AI and test voice features\n\u2022 Set up Google Docs for collaborative writing\n\n**Deliverable:** Confirm installation & explore tool usage for all 6 tools\n\n**Learning Focus:**\nPrepare students with essential digital tools that will support their entire learning journey at NavGurukul."},{name:"LS1: Ye NavGurukul Kya Hai? (Intro to NG)",order:2,maxTime:180,keyTags:["NavGurukul","Mission","Values","Learning Philosophy","Community"],deliverable:'5-min video explaining "What is NavGurukul" + short reflection doc',icon:"\ud83c\udfeb",technologies:["Video Creation","Research","Reflection"],description:"**Quest 1: Ye NavGurukul Kya Hai? (Intro to NG)**\n\n**Purpose:** Understand NavGurukul's mission, values, and learning philosophy.\n\n**Key Activities:**\n\u2022 Explore NavGurukul website thoroughly\n\u2022 Watch alumni success stories and testimonials\n\u2022 Reflect on NavGurukul's impact on students' lives\n\u2022 Understand the unique learning approach\n\u2022 Connect with the mission and vision\n\n**Deliverable:** Create a 5-minute video explaining \"What is NavGurukul\" + write a short reflection document\n\n**Learning Focus:**\nDeep understanding of NavGurukul's educational philosophy and how it differs from traditional education systems."},{name:"LS2: English Speaking Culture \u2013 B2 in 2 Months",order:3,maxTime:1440,keyTags:["English Speaking","Culture","Communication","LSRW","Daily Practice"],deliverable:"Multiple sub-quests (2.1\u20132.7) \u2014 uploads, videos, reflections",icon:"\ud83d\udde3\ufe0f",technologies:["Human Library","Karaoke","AI Tools","Voice Recording"],description:"**Quest 2: English Speaking Culture \u2013 B2 in 2 Months**\n\n**Purpose:** Build daily English-speaking habits & campus culture.\n\n**Key Activities:**\n\u2022 Human Library sessions for conversational practice\n\u2022 Karaoke sessions for confidence building\n\u2022 Drama skits and flash mobs for expression\n\u2022 AI correction tools for improvement\n\u2022 Focus on LSRW (Listening, Speaking, Reading, Writing)\n\n**Sub-Quests Overview:**\nThis quest contains 7 sub-activities (2.1-2.7) designed to create an immersive English learning environment.\n\n**Learning Focus:**\nTransform English from a subject to a living, breathing part of daily campus culture."},{name:"LS2.1: Story Reading & Retelling",order:4,maxTime:180,keyTags:["Reading Comprehension","Narration","Storytelling","English Practice"],deliverable:"Write doc on story, favorite character, alternate ending",icon:"\ud83d\udcda",technologies:["Reading","Writing","Storytelling"],description:"**Quest 2.1: Story Reading & Retelling**\n\n**Purpose:** Develop comprehension and narration skills.\n\n**Key Activities:**\n\u2022 Read a short story from campus library\n\u2022 Narrate the story in English to peers\n\u2022 Share personal reflections and insights\n\u2022 Discuss themes and characters\n\n**Deliverable:** Write a document covering the story summary, favorite character analysis, and create an alternate ending\n\n**Learning Focus:**\nBuilding reading comprehension while developing confident English narration abilities."},{name:"LS2.2: English Only Day",order:5,maxTime:480,keyTags:["Immersive Practice","English Only","Communication Challenge"],deliverable:"Share fun moments from English-only day with LSA",icon:"\ud83c\udf05",technologies:["Voice Translate","Conversation Practice"],description:"**Quest 2.2: English Only Day**\n\n**Purpose:** Encourage immersive English practice.\n\n**Key Activities:**\n\u2022 Commit to speaking only English for an entire day\n\u2022 Use voice translate when stuck on words\n\u2022 Document funny and challenging moments\n\u2022 Help peers maintain English-only communication\n\n**Deliverable:** Share fun moments and learnings from English-only day with LSA (Life Skills Assistant)\n\n**Learning Focus:**\nExperience immersive language learning and build confidence through real-world English usage."},{name:"LS2.3: Self-Introduction Video",order:6,maxTime:120,keyTags:["Self Expression","Video Creation","Confidence Building","Personal Branding"],deliverable:"Upload video and share feedback from LSA",icon:"\ud83c\udfac",technologies:["Video Recording","Self Presentation"],description:"**Quest 2.3: Self-Introduction Video**\n\n**Purpose:** Build confidence in self-expression.\n\n**Key Activities:**\n\u2022 Watch introduction videos for inspiration\n\u2022 Prepare personal introduction script\n\u2022 Record engaging self-introduction video\n\u2022 Practice speaking clearly and confidently\n\n**Deliverable:** Upload introduction video and share feedback received from LSA\n\n**Learning Focus:**\nDevelop confident self-expression and video communication skills."},{name:"LS2.4: Friends Series Roleplay",order:7,maxTime:240,keyTags:["Roleplay","Tone Practice","Emotional Expression","Entertainment Learning"],deliverable:"Upload video + write reflections on favorite episode/character",icon:"\ud83c\udfad",technologies:["Video Recording","Acting","Script Analysis"],description:"**Quest 2.4: Friends Series Roleplay**\n\n**Purpose:** Practice tone, emotion & conversational English.\n\n**Key Activities:**\n\u2022 Watch a season of Friends TV series\n\u2022 Choose a 15-minute scene to recreate\n\u2022 Practice emotional expressions and timing\n\u2022 Act out the scene and record it\n\n**Deliverable:** Upload roleplay video + write reflections on favorite episode and character\n\n**Learning Focus:**\nLearn natural English conversation patterns, emotional expression, and cultural context through entertainment."},{name:"LS2.5: Harry Potter Dubbing Challenge",order:8,maxTime:180,keyTags:["Dubbing","Pronunciation","Voice Acting","Timing"],deliverable:"Upload dubbed video + short presentation on process",icon:"\u26a1",technologies:["Voice Recording","Video Editing","Dubbing"],description:"**Quest 2.5: Harry Potter Dubbing Challenge**\n\n**Purpose:** Improve pronunciation & emotional fluency.\n\n**Key Activities:**\n\u2022 Select a 3-5 minute scene from Harry Potter\n\u2022 Practice matching voice timing and emotion\n\u2022 Focus on clear pronunciation and expression\n\u2022 Record dubbed version with proper timing\n\n**Deliverable:** Upload dubbed video + create short presentation explaining the dubbing process\n\n**Learning Focus:**\nMaster pronunciation, timing, and emotional expression through creative voice work."},{name:"LS2.6: 10-Day AI English Practice",order:9,maxTime:600,keyTags:["AI Practice","Daily Habit","Conversation","Feedback Loop"],deliverable:"Upload AI feedback + share chat with LSA",icon:"\ud83e\udd16",technologies:["ChatGPT","Gemini","AI Conversation"],description:"**Quest 2.6: 10-Day AI English Practice**\n\n**Purpose:** Build daily English habit using AI chat tools.\n\n**Key Activities:**\n\u2022 Chat with AI for 10 minutes daily for 10 consecutive days\n\u2022 Discuss different topics each day\n\u2022 Ask AI for feedback on language improvement\n\u2022 Track progress and areas of improvement\n\n**Deliverable:** Upload AI feedback from Day 10 + share interesting chat conversations with LSA\n\n**Learning Focus:**\nEstablish consistent English practice routine with AI assistance and personalized feedback."},{name:"LS2.7: Read an English Book",order:10,maxTime:360,keyTags:["Reading Comprehension","Book Analysis","Peer Teaching"],deliverable:"Upload short written summary & reflection",icon:"\ud83d\udcd6",technologies:["Reading","Analysis","Peer Discussion"],description:"**Quest 2.7: Read an English Book**\n\n**Purpose:** Strengthen reading comprehension & expression.\n\n**Key Activities:**\n\u2022 Pick an interesting book from campus library\n\u2022 Finish reading the book in 3-5 days\n\u2022 Understand the story, themes, and characters\n\u2022 Explain the story to a peer in English\n\n**Deliverable:** Upload short written summary and personal reflection on the book\n\n**Learning Focus:**\nDevelop sustained reading habits and ability to comprehend and communicate complex narratives."},{name:"LS3: Morning Exercise \u2013 Break the Loop!",order:11,maxTime:240,keyTags:["Physical Fitness","Energy Building","Consistency","Health"],deliverable:'Article on "My experience of morning exercise" (with ChatGPT)',icon:"\ud83c\udfc3\u200d\u2642\ufe0f",technologies:["Physical Training","ChatGPT","Health Tracking"],description:'**Quest 3: Morning Exercise \u2013 Break the Loop!**\n\n**Purpose:** Build energy & consistency through fitness.\n\n**Key Activities:**\n\u2022 Explore self-defence techniques and training\n\u2022 Interview peers about their exercise experiences\n\u2022 Watch fitness and health-related videos\n\u2022 Join morning exercise sessions regularly\n\n**Deliverable:** Write an article on "My experience of morning exercise" using ChatGPT assistance\n\n**Learning Focus:**\nEstablish healthy physical habits that boost energy and create positive daily momentum.'},{name:"LS4: Reward System \u2013 Mehnat Ka Medal",order:12,maxTime:180,keyTags:["Recognition","Input Tracking","Effort Appreciation","Motivation"],deliverable:"1-min reflection video + points tracking sheet",icon:"\ud83c\udfc5",technologies:["Point Tracking","Video Reflection"],description:"**Quest 4: Reward System \u2013 Mehnat Ka Medal**\n\n**Purpose:** Understand recognition through inputs & efforts.\n\n**Key Activities:**\n\u2022 Read and understand the Reward System documentation\n\u2022 Observe how peers earn recognition and points\n\u2022 Track your own input activities and efforts\n\u2022 Reflect on the importance of consistent effort\n\n**Deliverable:** Create 1-minute reflection video + maintain detailed points tracking sheet\n\n**Learning Focus:**\nLearn that success comes from consistent input and effort, not just output and results."},{name:"LS5: Apna Ghar, Apni Pehchaan (House System)",order:13,maxTime:180,keyTags:["House System","Belonging","Team Spirit","Identity"],deliverable:"Upload reflection doc + English chant video",icon:"\ud83c\udfe0",technologies:["Community Building","Creative Expression"],description:"**Quest 5: Apna Ghar, Apni Pehchaan (House System)**\n\n**Purpose:** Learn about the House structure & belonging.\n\n**Key Activities:**\n\u2022 Talk to 3 different house members about their experiences\n\u2022 Choose your house based on values and connection\n\u2022 Create an original house chant or song\n\u2022 Read house documentation and understand traditions\n\n**Deliverable:** Upload reflection document + create English chant video for your house\n\n**Learning Focus:**\nDevelop sense of belonging and team identity within the larger NavGurukul community."},{name:"LS6: GBU \u2013 Good, Bad, Ugly Reflection",order:14,maxTime:240,keyTags:["Self Reflection","Honest Assessment","Growth Mindset","Learning"],deliverable:"GBU table + overall video reflection",icon:"\ud83e\ude9e",technologies:["Reflection Tools","Video Creation"],description:"**Quest 6: GBU \u2013 Good, Bad, Ugly Reflection**\n\n**Purpose:** Build self-awareness through honest reflection.\n\n**Key Activities:**\n\u2022 Reflect on each completed activity (Intro, English, Rewards, Exercise, House, etc.)\n\u2022 Identify Good aspects (what worked well)\n\u2022 Acknowledge Bad aspects (what could be improved)\n\u2022 Face Ugly aspects (honest self-criticism and areas for growth)\n\n**Deliverable:** Create comprehensive GBU table + record overall video reflection\n\n**Learning Focus:**\nDevelop honest self-assessment skills and growth mindset through structured reflection."},{name:"LS7: Council Hunt \u2013 Etiocracy",order:15,maxTime:180,keyTags:["Student Governance","Etiocracy","Decision Making","Leadership"],deliverable:'Google Doc summary + reflection "What I understood about Etiocracy"',icon:"\ud83c\udfdb\ufe0f",technologies:["Interview Skills","AI Writing","Research"],description:'**Quest 7: Council Hunt \u2013 Etiocracy**\n\n**Purpose:** Understand student governance & decision-making.\n\n**Key Activities:**\n\u2022 Interview 2 or more council members about their roles\n\u2022 Record Q&A sessions about student governance\n\u2022 Write comprehensive summary using AI assistance\n\u2022 Understand the concept and practice of Etiocracy\n\n**Deliverable:** Create Google Doc summary + reflection "What I understood about Etiocracy"\n\n**Learning Focus:**\nLearn about democratic decision-making, student leadership, and collaborative governance systems.'},{name:"LS8: Mini AI Challenge \u2013 Create App with PartyRock",order:16,maxTime:240,keyTags:["AI Tools","App Creation","Creative Problem Solving","Technology"],deliverable:"Published app link + presentation/demo shared with LSA",icon:"\ud83c\udf89",technologies:["PartyRock","App Development","AI Tools"],description:"**Quest 8: Mini AI Challenge \u2013 Create App with PartyRock**\n\n**Purpose:** Introduce creative use of AI for problem-solving.\n\n**Key Activities:**\n\u2022 Explore PartyRock platform and its capabilities\n\u2022 Brainstorm app ideas (quotes, jokes, games, utilities)\n\u2022 Create and publish a simple but functional app\n\u2022 Test and refine the app based on feedback\n\n**Deliverable:** Share published app link + create presentation/demo to share with LSA\n\n**Learning Focus:**\nExperience the power of AI-assisted creativity and learn to build functional applications."},{name:"LSB1: Vipassana \u2013 Inner Reflection & Calmness (Bonus)",order:17,maxTime:300,keyTags:["Vipassana","Mindfulness","Inner Peace","Meditation","Bonus Quest"],deliverable:"Reflection note / verbal sharing session",icon:"\ud83e\uddd8",technologies:["Meditation","Mindfulness Practice"],description:"**Bonus Quest: Vipassana \u2013 Inner Reflection & Calmness**\n\n**Purpose:** Experience mindfulness and emotional balance.\n\n**Key Activities:**\n\u2022 Attend structured Vipassana meditation session\n\u2022 Practice silence and inner observation\n\u2022 Reflect on the experience of stillness\n\u2022 Learn mindfulness techniques for daily life\n\n**Deliverable:** Write reflection note or participate in verbal sharing session about the experience\n\n**Learning Focus:**\nDevelop inner calm, emotional balance, and mindfulness practices for mental well-being."},{name:"LSB2: Payforward \u2013 Giving Back to Community (Bonus)",order:18,maxTime:360,keyTags:["Community Service","Giving Back","Gratitude","Social Impact","Bonus Quest"],deliverable:"Short write-up/video on your Payforward experience",icon:"\ud83c\udf81",technologies:["Community Engagement","Social Impact"],description:"**Bonus Quest: Payforward \u2013 Giving Back to Community**\n\n**Purpose:** Encourage contribution and gratitude.\n\n**Key Activities:**\n\u2022 Support peers or juniors using skills you've learned\n\u2022 Share knowledge and experiences generously\n\u2022 Help others navigate challenges you've overcome\n\u2022 Create positive impact in the community\n\n**Deliverable:** Create short write-up or video documenting your Payforward experience\n\n**Learning Focus:**\nDevelop gratitude, generosity, and understanding of how giving back strengthens the entire community."},{name:"LE1: Learning How to Learn",order:18,maxTime:360,keyTags:["Learning Methodology","Metacognition","Practice","Reflection","Experiential Learning"],deliverable:"Complete origami activity, laptop exploration, and self-learning challenges",icon:"\ud83e\udde0",technologies:["Visual Learning","Hands-on Practice","Self-Learning"],description:"**Quest 1: Learning How to Learn**\n\n**Step 1: Visual Learning**\n\u2022 Learning through seeing instead of only instructions\n\u2022 Group activity: Follow facilitator guide for origami\n\u2022 Realize how visual demonstration + practice improves understanding\n\n**Step 2: Laptop Hackathon**\n\u2022 Learning by doing yourself (Mohit cleaning laptop story)\n\u2022 Identify laptop parts, make short fun video explaining them\n\u2022 Learn technical skills + gain confidence through hands-on experience\n\n**Step 3: Self-Learning Challenge**\n\u2022 Learning like a child \u2013 discover through exploration\n\u2022 Use Khan Academy or similar platform\n\u2022 Pick any topic you're curious about and learn for 2 hours\n\u2022 Reflect: What made it interesting? What was difficult?\n\n**Learning Objectives:**\n\u2022 Understand different learning styles and methods\n\u2022 Experience visual, hands-on, and self-directed learning\n\u2022 Develop confidence in exploration and discovery\n\u2022 Build metacognitive awareness of your learning process"},{name:"LE2: Research & Information Literacy",order:19,maxTime:300,keyTags:["Research Skills","Information Literacy","Critical Evaluation","Source Analysis"],deliverable:"Complete research project with credible sources and analysis",icon:"\ud83d\udd0d",technologies:["Google Scholar","Research Databases","Fact-Checking Tools"],description:"Learn essential research skills and how to evaluate information credibility in the digital age.\n\n**Learning Objectives:**\n\u2022 Master effective search strategies\n\u2022 Learn to evaluate source credibility\n\u2022 Practice information synthesis\n\u2022 Develop critical thinking about information\n\u2022 Build academic research foundations"},{name:"LE3: Critical Thinking & Problem Solving",order:20,maxTime:240,keyTags:["Critical Thinking","Problem Solving","Logic","Analysis","Decision Making"],deliverable:"Solve complex problems using structured thinking frameworks",icon:"\ud83e\udde9",technologies:["Problem Solving Frameworks","Logic Tools"],description:"Develop critical thinking skills and systematic approaches to problem-solving.\n\n**Learning Objectives:**\n\u2022 Learn structured problem-solving methods\n\u2022 Practice logical reasoning and analysis\n\u2022 Develop decision-making frameworks\n\u2022 Build critical evaluation skills\n\u2022 Master systematic thinking approaches"},{name:"LE4: Digital Literacy & Basic Computing",order:21,maxTime:300,keyTags:["Digital Literacy","Computing Basics","File Management","Internet Safety"],deliverable:"Demonstrate proficiency in digital tools and computing basics",icon:"\ud83d\udcbe",technologies:["Operating Systems","File Management","Internet Browsers","Security Tools"],description:"Build foundational digital literacy skills and understanding of basic computing concepts.\n\n**Learning Objectives:**\n\u2022 Master file management and organization\n\u2022 Understand operating system basics\n\u2022 Learn internet safety and security\n\u2022 Develop keyboard and navigation skills\n\u2022 Build confidence with digital tools"},{name:"LE5: Introduction to Programming Concepts",order:22,maxTime:360,keyTags:["Programming Basics","Logic","Algorithms","Computational Thinking"],deliverable:"Create simple programs demonstrating basic programming concepts",icon:"\ud83d\udc68\u200d\ud83d\udcbb",technologies:["Scratch","Block Programming","Basic Coding"],description:"Introduction to programming logic and computational thinking through visual and interactive tools.\n\n**Learning Objectives:**\n\u2022 Understand programming logic and flow\n\u2022 Learn algorithmic thinking\n\u2022 Practice problem decomposition\n\u2022 Build computational problem-solving skills\n\u2022 Gain confidence in logical thinking"},{name:"LE6: Web Technologies Overview",order:23,maxTime:300,keyTags:["Web Technologies","HTML","CSS","Internet Basics","Web Development"],deliverable:"Create simple web page demonstrating understanding of web technologies",icon:"\ud83c\udf10",technologies:["HTML","CSS","Web Browsers","Developer Tools"],description:"Explore how websites work and get hands-on experience with basic web technologies.\n\n**Learning Objectives:**\n\u2022 Understand how the internet and websites work\n\u2022 Learn HTML structure and CSS styling basics\n\u2022 Explore web development tools\n\u2022 Create your first web page\n\u2022 Build foundation for web development"},{name:"LE7: Creative Technology Projects",order:24,maxTime:360,keyTags:["Creative Technology","Digital Art","Multimedia","Innovation","Design"],deliverable:"Complete creative technology project combining multiple skills",icon:"\ud83c\udfa8",technologies:["Design Tools","Multimedia Software","Creative Platforms"],description:"Combine technology skills with creativity to build innovative and artistic projects.\n\n**Learning Objectives:**\n\u2022 Integrate technical and creative skills\n\u2022 Learn design thinking principles\n\u2022 Practice innovation and creativity\n\u2022 Build multimedia projects\n\u2022 Develop artistic expression through technology"},{name:"LE8: Portfolio Development & Presentation",order:25,maxTime:300,keyTags:["Portfolio","Presentation","Documentation","Reflection","Showcase"],deliverable:"Create comprehensive learning portfolio and present achievements",icon:"\ud83d\udcc1",technologies:["Portfolio Platforms","Presentation Tools","Documentation"],description:"Create a comprehensive portfolio showcasing your learning journey and present your achievements to the community.\n\n**Learning Objectives:**\n\u2022 Document and reflect on learning journey\n\u2022 Create professional portfolio presentation\n\u2022 Practice public presentation skills\n\u2022 Showcase projects and achievements\n\u2022 Prepare for next phase transition"}],"Phase 0: Foundation":[{name:"Mathematics Fundamentals",order:1,maxTime:600,keyTags:["BODMAS","Algebra","Exponents","Number Theory","Mathematical Operations"],deliverable:"Complete Khan Academy Math Module and pass Module 0 Assessment",icon:"\ud83d\udd22",technologies:["Mathematics","Problem Solving","Khan Academy"],description:"1-week intensive math primer to strengthen foundation for programming logic.\n\n**Topics Covered:**\n\u2022 BODMAS & Order of Operations - Learn the fundamental rules for evaluating mathematical expressions\n\u2022 Number Types & Properties - Understanding even/odd, prime, composite, and natural numbers\n\u2022 Division & Number Operations - Master long division, HCF (Highest Common Factor), and LCM (Lowest Common Multiple)\n\u2022 Basic Algebra - Introduction to variables, equations, and algebraic expressions\n\u2022 Basic Exponents - Understanding powers and exponential notation\n\n**Key Learning Outcomes:**\n- Apply BODMAS rules to solve complex expressions\n- Classify and work with different number types\n- Perform division operations and find HCF/LCM\n- Work with variables and solve simple equations\n- Understand and calculate exponents\n\n**Assessment:** Complete all Khan Academy exercises and pass the Module 0 test to demonstrate mastery of mathematical fundamentals essential for programming."},{name:"Number Systems & Binary Logic",order:2,maxTime:960,keyTags:["Binary","Decimal","Number Systems","Base Conversion","Computer Fundamentals"],deliverable:"Complete number systems exercises and participate in facilitation session",icon:"\ud83d\udcbb",technologies:["Binary Systems","Computer Science","Number Theory"],description:"2-week deep dive into number systems - the language computers speak.\n\n**Topics Covered:**\n\u2022 Introduction to Number Systems - Understanding different base systems (binary, decimal, octal, hexadecimal)\n\u2022 Binary Numbers & Representation - How computers represent data using only 0s and 1s\n\u2022 Base Conversions - Converting between decimal, binary, octal, and hexadecimal systems\n\u2022 Adding Numbers in Different Bases - Arithmetic operations in binary and other bases\n\u2022 Fun Facilitation Session - Interactive mentor-led activities to solidify concepts\n\n**Key Learning Outcomes:**\n- Understand how computers process and store information\n- Convert numbers between different base systems (binary \u2194 decimal \u2194 hex)\n- Perform binary arithmetic operations\n- Grasp the relationship between bits, bytes, and computer memory\n- Apply number system concepts to real-world computing scenarios\n\n**Activities:** Daily exercises, base conversion practice, binary addition problems, and interactive mentor session with group discussions and reflections on Moodle."},{name:"Problem Solving & Flowcharts",order:3,maxTime:1680,keyTags:["Flowcharts","Problem Solving","Algorithms","Logic","Computational Thinking"],deliverable:"Create flowcharts for complex problems and pass Module 2 Assessment",icon:"\ud83d\udcca",technologies:["Flowcharts","Algorithmic Thinking","Visual Programming"],description:"5-week intensive program to master systematic problem-solving using flowcharts.\n\n**Topics Covered:**\n\u2022 Introduction to Problem Solving - Breaking down complex problems into manageable steps\n\u2022 Variables & Data - Understanding data storage and manipulation concepts\n\u2022 Loops & Repetition - Representing iterative processes visually\n\u2022 Mathematical Logic - Boolean logic and conditional decision-making\n\u2022 Flowchart Design Basics - Mastering flowchart symbols and conventions\n\u2022 Advanced Flowchart Design - Complex problems with nested logic and multiple paths\n\u2022 Problem-Solving Practice - Daily practice with real-world challenges\n\u2022 Module 2 Review & Assessment - Comprehensive test of all concepts\n\n**Key Learning Outcomes:**\n- Analyze problems systematically and identify solution steps\n- Design clear flowcharts using standard notation and symbols\n- Represent variables, loops, and conditions visually\n- Apply boolean logic to decision-making processes\n- Create flowcharts for complex, multi-step problems\n- Translate real-world problems into algorithmic solutions\n\n**Activities:** Daily practice sessions, individual gap analysis with facilitators, mentor-guided problem-solving workshops, and comprehensive final assessment demonstrating mastery of computational thinking and flowchart design."}],"Phase 1: Student Profile & Course Portal (HTML Only)":[{name:"\ud83c\udfe0 Home Page",order:1,maxTime:90,keyTags:["<header>","<nav>","<footer>","<main>","<ul>","<li>","<a>"],deliverable:"Project Video 1 (Page Walkthrough)",icon:"\ud83c\udfe0",technologies:["HTML5 Semantics","Tables","Forms"],description:"Create the main landing page. Focus is on mastering fundamental page structure and implementing basic site navigation using the new semantic tags and the anchor tag (<a>) for linking."},{name:"\ud83d\udc64 Profile Page",order:2,maxTime:75,keyTags:["<img> (with src, alt)","<ol>","<br>","<hr>"],deliverable:"Project Video 2 (Page Walkthrough)",icon:"\ud83d\udc64",technologies:["HTML5 Semantics","Tables","Forms"],description:'Build a simple "About Me" page. Focus on embedding images, using ordered (<ol>) and unordered (<ul>) lists, and using structural tags like <hr> for visual separation.'},{name:"\ud83d\udcda Courses Page",order:3,maxTime:75,keyTags:["Relative Paths in <a> tags"],deliverable:"Project Video 3 (Page Walkthrough)",icon:"\ud83d\udcda",technologies:["HTML5 Semantics","Tables","Forms"],description:"List courses and their descriptions. Focus on creating a clear content hierarchy using heading tags and correctly using relative paths in <a> tags to link to other pages within the project structure."},{name:"\ud83d\udcdd Feedback Page",order:4,maxTime:90,keyTags:["<form>","<label>","<input> (types: email, radio, checkbox)","<textarea>","<select>","<button>"],deliverable:"Project Video 4 (Page Walkthrough)",icon:"\ud83d\udcdd",technologies:["HTML5 Semantics","Tables","Forms"],description:"Construct a fully-featured input form. Focus is on the proper structure of a form, labeling inputs (<label>), and utilizing a wide range of input types for data collection."},{name:"\ud83d\udcca Grades Table Page",order:5,maxTime:60,keyTags:["<table>","<caption>","<thead>","<tbody>","<tfoot>","<tr>","<th>","<td>"],deliverable:"Project Video 5 (Page Walkthrough)",icon:"\ud83d\udcca",technologies:["HTML5 Semantics","Tables","Forms"],description:"Display tabular data (grades). Focus is entirely on table structure: organizing data into rows and cells, defining columns with headers, and structuring the table body and footer semantically."},{name:"\ud83d\udcde Contact Us Page",order:6,maxTime:45,keyTags:["mailto: in <a>","tel: in <a>","<address>"],deliverable:"Project Video 6 (Page Walkthrough)",icon:"\ud83d\udcde",technologies:["HTML5 Semantics","Tables","Forms"],description:"Provide contact information. Focus on creating actionable links that open an email client (mailto:) or initiate a phone call (tel:), and using the semantic <address> tag."},{name:"Conceptual Review",order:7,maxTime:0,keyTags:["Focus on Semantics and Navigation"],deliverable:"Concept Video 7 (Linking It All Together)",icon:"\ud83d\udd17",technologies:["HTML5 Semantics","Tables","Forms"],description:"Review and finalize consistent navigation across all six pages. Ensure all links function correctly and the overall HTML structure is clean and semantically correct."}],"Phase 2: Styling & Responsive Design":[{name:"Global Stylesheet",order:1,maxTime:0,keyTags:["N/A (Focus is on CSS)"],deliverable:"CSS Foundation",icon:"\ud83c\udfa8",technologies:["CSS Fundamentals","Selectors","Box Model","Flexbox","Media Queries"],description:"Establish the foundation: Resetting default browser styles, setting base typography, styling structural elements (<header>, <nav>), and using pseudo-classes for link interaction."},{name:"Page-by-Page Styling",order:2,maxTime:0,keyTags:["N/A (Focus is on CSS)"],deliverable:"CSS Content Styling",icon:"\ud83d\udd8c\ufe0f",technologies:["CSS Fundamentals","Selectors","Box Model","Flexbox","Media Queries"],description:"Apply styles to specific content: using Flexbox for course cards, structuring forms for usability, styling tables with tr:nth-child for readability, and mastering the CSS Box Model for spacing."},{name:"Making It Responsive",order:3,maxTime:0,keyTags:["N/A (Focus is on CSS)"],deliverable:"Responsive Design",icon:"\ud83d\udcf1",technologies:["CSS Fundamentals","Selectors","Box Model","Flexbox","Media Queries"],description:"Introduce the basics of Responsive Web Design (RWD). Define breakpoints using Media Queries to adjust styles (e.g., stacking navigation links) for mobile and tablet screens."}],"Phase 3: Interactive Quiz Master":[{name:"Project Introduction: Interactive Quiz Master",order:1,maxTime:30,keyTags:["JavaScript Overview"],deliverable:"No video \u2013 intro only",icon:"\ud83c\udfaf",technologies:["JavaScript Fundamentals"],description:"Learn how JavaScript brings websites to life. Understand the goal of making an interactive quiz application using existing HTML & CSS."},{name:"Starting the Quiz (Start Page / quiz.html)",order:2,maxTime:60,keyTags:["Variables","Functions","DOM Manipulation","Events"],deliverable:"1 Video: Show Start Page + explain variables, functions, events, DOM Manipulation.",icon:"\u25b6\ufe0f",technologies:["JavaScript","DOM API","Event Handling"],description:'Implement "Start Quiz" button functionality to reveal the first question or navigate to quiz.html. Learn DOM basics and event handling.'},{name:"Storing Quiz Questions & Answers",order:3,maxTime:45,keyTags:["Arrays","Objects"],deliverable:"1 Video: Show array/object structure + explain data organization.",icon:"\ud83d\udccb",technologies:["JavaScript Arrays","JavaScript Objects"],description:"Create an array of question objects holding text, options, and correct answers. Practice storing structured data."},{name:"Displaying Questions & Options (quiz.html)",order:4,maxTime:60,keyTags:["Loops","Strings","Functions","DOM Manipulation"],deliverable:"1 Video: Show questions & options appearing dynamically + explanation of loops, strings, DOM usage.",icon:"\u2753",technologies:["JavaScript Loops","String Manipulation","DOM API"],description:"Use loops to iterate through questions and display them dynamically. Build HTML content using strings."},{name:"Handling User Answers & Navigation (quiz.html)",order:5,maxTime:75,keyTags:["Variables","Operators","Conditional Statements","Functions","DOM","Events"],deliverable:"1 Video: Show answer handling and navigation + explanation of events, conditionals, and score tracking.",icon:"\u2705",technologies:["JavaScript Conditionals","Event Handling","DOM Manipulation"],description:"Detect user answers, compare with correct answers, update score, and move to the next question or results page."},{name:"Calculating & Displaying Results (results.html)",order:6,maxTime:45,keyTags:["Variables","Strings","DOM","Functions","URL Parameters"],deliverable:"1 Video: Show results display + explanation of score calculation and DOM usage.",icon:"\ud83d\udcca",technologies:["JavaScript Variables","DOM API","URL Parameters"],description:"Calculate final score and display a result message dynamically. Optionally, pass data between pages."},{name:"Restarting the Quiz (Optional, results.html or quiz.html)",order:7,maxTime:30,keyTags:["Functions","Variables","DOM","Events"],deliverable:"1 Video: Show reset functionality + explanation of functions, events, and state reset.",icon:"\ud83d\udd04",technologies:["JavaScript Functions","Event Handling","State Management"],description:'Implement a "Restart Quiz" feature to reset variables and page state.'},{name:"Mini Projects: Practice JS Concepts",order:8,maxTime:120,keyTags:["Variables","Arrays","Objects","Functions","DOM","Events","Operators","Strings"],deliverable:"1 Video per mini-project: Show working demo + explain concepts applied.",icon:"\ud83d\udee0\ufe0f",technologies:["JavaScript Fundamentals","DOM API","Event Handling"],description:"Build focused practice projects: To-Do List, Tip Calculator, Quote Generator. Solidify JS fundamentals before or alongside the main project."},{name:"Project Wrap-Up & Reflection",order:9,maxTime:30,keyTags:["JavaScript Review"],deliverable:"1 Video: Reflect on learning + demonstrate final working quiz.",icon:"\ud83c\udf89",technologies:["JavaScript Fundamentals"],description:"Review JavaScript fundamentals applied in the project: Variables, Data Types, Operators, Strings, Loops, Arrays, Objects, Functions, DOM, Events, Conditional Statements."}],"Phase 4: AI-Powered Content Generator":[{name:"Project Introduction: AI-Powered Content Generator",order:1,maxTime:30,keyTags:["ES6+ Overview","Gemini API"],deliverable:"No video \u2013 intro only",icon:"\ud83e\udd16",technologies:["JavaScript ES6+","Gemini API"],description:"Understand the goal: use modern JS (ES6+) and Gemini API to build interactive AI-powered web features."},{name:"Ask Me Anything Feature",order:2,maxTime:75,keyTags:["let/const","Arrow Functions","Template Literals","fetch()","Promises"],deliverable:"1 Video: Demonstrate feature + explain ES6 concepts + Gemini API call.",icon:"\u2753",technologies:["JavaScript ES6+","Fetch API","Gemini API"],description:"Build a feature where users type a question and Gemini returns an answer dynamically. Learn event handling, template literals for API queries, and fetch() for asynchronous calls."},{name:"Quick Summarizer Feature",order:3,maxTime:60,keyTags:["let/const","Arrow Functions","Template Literals","fetch()","Promises","Destructuring"],deliverable:"1 Video: Show summarizer + ES6 features + API integration.",icon:"\ud83d\udcdd",technologies:["JavaScript ES6+","Destructuring","Gemini API"],description:"Users paste text and receive a concise summary via Gemini. Learn destructuring to extract data from API responses and handle asynchronous results."},{name:"Idea Spark Feature",order:4,maxTime:60,keyTags:["let/const","Arrow Functions","Template Literals","fetch()","Promises","Array Methods"],deliverable:"1 Video: Demo feature + explain applied JS/ES6 concepts and API usage.",icon:"\ud83d\udca1",technologies:["JavaScript ES6+","Array Methods","Gemini API"],description:"Users request creative ideas (blog topics, stories) from Gemini. Apply array methods to process multiple suggestions if needed."},{name:"Definition Finder Feature",order:5,maxTime:45,keyTags:["let/const","Arrow Functions","Template Literals","fetch()","Promises"],deliverable:"1 Video: Demo feature + explain ES6/API usage.",icon:"\ud83d\udcda",technologies:["JavaScript ES6+","Fetch API","Gemini API"],description:"Users input terms, and Gemini provides definitions. Practice API request construction, fetch() handling, and DOM manipulation."},{name:"Mini Projects / Warm-up Exercises",order:6,maxTime:120,keyTags:["let/const","Arrow Functions","Template Literals","Destructuring","fetch()","Promises"],deliverable:"1 Video per mini-project: Show working demo + explain JS concepts & API integration.",icon:"\ud83d\udee0\ufe0f",technologies:["JavaScript ES6+","Gemini API","DOM Manipulation"],description:"AI Joke Generator, Gemini-Powered Quiz Helper, Daily Positive Affirmation Fetcher. Focused practice on ES6 features + API calls."},{name:"Project Wrap-Up & Reflection",order:7,maxTime:30,keyTags:["ES6+ Review","Gemini API Review"],deliverable:"1 Video: Demonstrate final AI content generator + reflect on learning outcomes.",icon:"\ud83c\udf89",technologies:["JavaScript ES6+","Gemini API"],description:"Review ES6 fundamentals (let/const, arrow functions, template literals, destructuring, spread/rest, array methods) and Gemini API integration. Reflect on building a functional, AI-powered web app."}],"Phase 5: Ask Gemini Web App":[{name:"Project Introduction: Ask Gemini Web App",order:1,maxTime:30,keyTags:["Full-Stack Overview","Node.js","Express"],deliverable:"No video \u2013 intro only",icon:"\ud83c\udf10",technologies:["Node.js","Express.js","Gemini API"],description:"Understand full-stack development: frontend communicates with backend server built in Node.js & Express, which integrates with Gemini API."},{name:"Express App Setup & Structure",order:2,maxTime:45,keyTags:["Node.js runtime","express()","Project folder structure"],deliverable:"1 Video: Show setup, folder structure, app.listen(), basic server code.",icon:"\u2699\ufe0f",technologies:["Node.js","Express.js","npm"],description:"Initialize Express server, install dependencies, organize project folders (server code, frontend files)."},{name:"Backend Routes & Request Handling",order:3,maxTime:60,keyTags:["Express routes (app.get(), app.post())","express.json()"],deliverable:"1 Video: Demonstrate routes handling user inputs.",icon:"\ud83d\udee4\ufe0f",technologies:["Express.js Routes","JSON Parsing"],description:"Handle frontend requests via GET/POST. Parse incoming request data (JSON), structure server responses."},{name:"Gemini API Integration on Backend",order:4,maxTime:75,keyTags:["fetch() / axios","Promises","async/await","environment variables (.env, dotenv)"],deliverable:"1 Video: Show API integration + explain API key security + backend response processing.",icon:"\ud83d\udd17",technologies:["Gemini API","Environment Variables","Async/Await"],description:"Securely communicate with Gemini API from server. Handle asynchronous responses, parse JSON, return data to frontend."},{name:"Frontend-Backend Interaction Demo",order:5,maxTime:60,keyTags:["DOM manipulation","fetch() (frontend)","Event handling"],deliverable:"1 Video: Demo full app flow (frontend \u2192 backend \u2192 Gemini \u2192 frontend).",icon:"\ud83d\udd04",technologies:["Fetch API","DOM Manipulation","Event Handling"],description:"Send user input to backend, receive AI-generated content, update frontend dynamically. Demonstrate full-stack communication."},{name:"Mini Projects / Practice Exercises",order:6,maxTime:120,keyTags:["Node.js","Express routes","fetch()/axios","JSON responses"],deliverable:"1 Video per mini-project: Demo working backend + explain code and API usage.",icon:"\ud83d\udee0\ufe0f",technologies:["Node.js","Express.js","Gemini API"],description:"Practice building small backend APIs: AI Fun Facts, AI Daily Journal Prompter, AI Helper Bot with multiple endpoints. Apply async JS and Gemini API integration."},{name:"Project Wrap-Up & Reflection",order:7,maxTime:30,keyTags:["Full-Stack Review","Node.js Review"],deliverable:'1 Video: Demonstrate final full-stack "Ask Gemini" app + reflect on learning outcomes.',icon:"\ud83c\udf89",technologies:["Node.js","Express.js","Gemini API"],description:"Review Node.js, Express.js, backend routing, API integration, async operations, full-stack flow. Reflect on building a functional backend app with AI."}],"Phase 6: Student Feedback Manager":[{name:"Project Introduction: Student Feedback Manager",order:1,maxTime:30,keyTags:["Database Overview","MongoDB","Mongoose"],deliverable:"No video \u2013 intro only",icon:"\ud83d\udcac",technologies:["MongoDB","Mongoose","Node.js"],description:"Understand databases, NoSQL concepts, MongoDB for data storage, Mongoose for schema and model management."},{name:"MongoDB Setup & Connection",order:2,maxTime:45,keyTags:["mongoose.connect()",".env (dotenv)"],deliverable:"1 Video: Show database connection, explain .env usage, demonstrate successful connection.",icon:"\ud83d\udd0c",technologies:["MongoDB","Mongoose","Environment Variables"],description:"Connect Node.js/Express app to MongoDB (local or Atlas). Keep connection string secure with environment variables."},{name:"Define Schema & Model",order:3,maxTime:60,keyTags:["mongoose.Schema()","mongoose.model()"],deliverable:"1 Video: Explain schema, model, and why schemas structure data.",icon:"\ud83d\udccb",technologies:["Mongoose Schema","Mongoose Model"],description:"Create a Mongoose schema for feedback (name, rating, comments). Build a model to interact with the database."},{name:"Storing New Feedback (Create)",order:4,maxTime:75,keyTags:["new Model()","instance.save()","express.json()"],deliverable:"1 Video: Submit feedback via form \u2192 save to database \u2192 confirm stored data (MongoDB Compass or shell).",icon:"\ud83d\udcbe",technologies:["Mongoose CRUD","Express.js","JSON Parsing"],description:"Receive POST requests from frontend form, create a new document, save feedback to MongoDB."},{name:"Retrieving & Displaying Feedback (Read)",order:5,maxTime:60,keyTags:["Model.find()","async/await","Express GET route"],deliverable:"1 Video: Fetch feedback \u2192 render on frontend \u2192 explain full data flow.",icon:"\ud83d\udcd6",technologies:["Mongoose Queries","Async/Await","Express Routes"],description:'Create route to fetch all feedback, send JSON to frontend, dynamically display feedback on "All Feedback" page.'},{name:"Mini Projects / Practice Exercises",order:6,maxTime:120,keyTags:["CRUD basics (Create & Read focus)","Express routes","Mongoose models"],deliverable:"1 Video per mini-project: Demo backend functionality, explain schema, routes, and database interactions.",icon:"\ud83d\udee0\ufe0f",technologies:["MongoDB","Mongoose","Express.js"],description:"Build small apps to practice database integration: contact form collector, student progress tracker, quick notes saver. Use POST to store and GET to retrieve data."},{name:"Project Wrap-Up & Reflection",order:7,maxTime:30,keyTags:["MongoDB Review","Mongoose Review","Full-Stack Data Flow"],deliverable:"1 Video: Showcase final app, explain end-to-end data flow (frontend \u2192 backend \u2192 database \u2192 frontend).",icon:"\ud83c\udf89",technologies:["MongoDB","Mongoose","Full-Stack Development"],description:"Consolidate knowledge: connect frontend, backend, database; secure connection; handle user data persistently."}],"Phase 7: CollabSphere":[{name:"Project Introduction: CollabSphere",order:1,maxTime:30,keyTags:["Full-Stack Overview","AI Integration","SaaS Application"],deliverable:"No video \u2013 intro only",icon:"\ud83c\udf0d",technologies:["Full-Stack Development","AI Integration","MongoDB"],description:"Understand project scope: full-stack development, AI-powered collaboration, portfolio-ready SaaS application."},{name:"User Authentication System",order:2,maxTime:90,keyTags:["bcrypt.js (password hashing)","JWT (auth)","Express routes","MongoDB"],deliverable:"Video 1: Registration & Login demo, explain auth flow and JWT handling",icon:"\ud83d\udd10",technologies:["JWT Authentication","bcrypt.js","MongoDB"],description:"Secure user registration, login, JWT-protected routes, store users in MongoDB."},{name:"Project Creation & Collaboration",order:3,maxTime:75,keyTags:["Express routes","MongoDB relations","Mongoose models"],deliverable:"Video 2: Create project, add members, demo dashboard",icon:"\ud83d\udc65",technologies:["Express.js","MongoDB Relations","Mongoose"],description:"Create projects, invite users as members, display user dashboard."},{name:"Markdown Notes Management",order:4,maxTime:90,keyTags:["SimpleMDE editor","CRUD operations","MongoDB"],deliverable:"Video 3: CRUD notes demo, save to DB, frontend interaction",icon:"\ud83d\udcdd",technologies:["SimpleMDE","CRUD Operations","MongoDB"],description:"Create, edit, save notes; basic collaboration logic."},{name:"Gemini AI Integration with Notes",order:5,maxTime:75,keyTags:["Gemini API","Express backend routes","fetch/axios"],deliverable:"Video 4: Gemini explain & suggestion demo, show backend API routes",icon:"\ud83e\udd16",technologies:["Gemini API","Express.js","Fetch API"],description:"Buttons to explain notes or suggest improvements via Gemini; backend handles API calls securely."},{name:"File Upload & Preview",order:6,maxTime:90,keyTags:["Multer (or Cloudinary)","file handling","MongoDB references"],deliverable:"Video 5: Upload demo, preview, Gemini code explanation",icon:"\ud83d\udcc1",technologies:["Multer","File Handling","MongoDB"],description:"Upload project files, basic preview, Gemini code explanation for supported files."},{name:"Contribution Analytics",order:7,maxTime:60,keyTags:["Express GET routes","MongoDB queries","data aggregation"],deliverable:"Video 6: Analytics demo, basic dashboard summary",icon:"\ud83d\udcca",technologies:["Express Routes","MongoDB Queries","Data Aggregation"],description:"Track user activity: notes created, files uploaded, project contributions."},{name:"Public Shareable Project Page & README Generation",order:8,maxTime:75,keyTags:["Public routes","Gemini API","Markdown generation"],deliverable:"Video 7: Public project page demo, README generation using Gemini",icon:"\ud83d\udcc4",technologies:["Gemini API","Markdown Generation","Public Routes"],description:"Generate project README via Gemini, make project or README publicly viewable."},{name:"Mini Projects / Practice Exercises",order:9,maxTime:150,keyTags:["Authentication","Collaborative Notes","README Generation"],deliverable:"Optional videos for practice, helps prep final project",icon:"\ud83d\udee0\ufe0f",technologies:["Full-Stack Development","AI Integration"],description:"1) Authentication system, 2) Collaborative Markdown notes, 3) Gemini-powered README generator."},{name:"Project Wrap-Up & Reflection",order:10,maxTime:45,keyTags:["Full-Stack Flow","Security","AI Enhancement"],deliverable:"Optional reflection video summarizing full app",icon:"\ud83c\udf89",technologies:["Full-Stack Development","AI Integration","Deployment"],description:"Consolidate all features, demonstrate end-to-end functionality, deployment readiness."}],"Self Learning Space":[{name:"Exam Preparation",order:1,maxTime:480,keyTags:["Self-Study","Exam Prep","Knowledge Assessment","Study Skills"],deliverable:"Personal study plan and exam preparation goals",icon:"\ud83d\udcda",technologies:["Study Materials","Practice Tests","Self-Reflection"],description:"Dedicated space for exam preparation and knowledge assessment.\nFocus on building study habits, taking practice exams, and tracking your learning progress.\n\n**Learning Objectives:**\n\u2022 Develop effective study strategies\n\u2022 Practice exam-taking skills\n\u2022 Track personal learning progress\n\u2022 Build confidence through preparation"},{name:"Job Preparation",order:2,maxTime:480,keyTags:["Career Development","Job Search","Resume Building","Interview Skills"],deliverable:"Job application materials and career development plan",icon:"\ud83d\udcbc",technologies:["Resume Writing","LinkedIn","Interview Practice","Networking"],description:"Prepare for job opportunities and career advancement.\nBuild your professional profile, practice interviews, and develop job search strategies.\n\n**Learning Objectives:**\n\u2022 Create compelling resumes and portfolios\n\u2022 Practice interview techniques\n\u2022 Learn job search strategies\n\u2022 Build professional networking skills"},{name:"Internship Tasks",order:3,maxTime:480,keyTags:["Internship","Professional Development","Work Experience","Career Growth"],deliverable:"Internship task completion and professional development goals",icon:"\ud83d\udcbb",technologies:["Project Management","Professional Communication","Task Execution","Time Management"],description:"Complete internship tasks and develop professional work experience.\nFocus on real-world application of skills, professional communication, and career development.\n\n**Learning Objectives:**\n\u2022 Execute assigned internship tasks effectively\n\u2022 Develop professional communication skills\n\u2022 Apply learned technical skills in real projects\n\u2022 Build work experience and professional portfolio"}]},s={"Phase 1: Student Profile & Course Portal (HTML Only)":a["Phase 1: Student Profile & Course Portal (HTML Only)"].map(e=>({name:e.name,order:e.order})),"Phase 2: Styling & Responsive Design":a["Phase 2: Styling & Responsive Design"].map(e=>({name:e.name,order:e.order}))},i={"\ud83c\udfe0 Home Page":["Create HTML structure using <header>, <nav>, <main>, and <footer> tags","Build a navigation menu with <ul>, <li>, and <a> elements","Structure content with semantic HTML and proper heading hierarchy","Complete the home page layout within 90 minutes and record walkthrough video"],"\ud83d\udc64 Profile Page":["Add profile image using <img> tag with proper alt attributes","Create profile information using <h2>/<h3> headings and lists","Organize personal details with <ul>/<ol> and <li> elements","Complete profile page within 75 minutes and record walkthrough video"],"\ud83d\udcda Courses Page":["Structure course listings using <h2>/<h3> headings","Add course descriptions with <p> elements and proper content hierarchy","Create course links using <a> tags for navigation","Complete courses page within 75 minutes and record walkthrough video"],"\ud83d\udcdd Feedback Page":["Build feedback form using <form>, <label>, and various <input> types","Add text area for comments using <textarea> element","Include dropdown selections with <select> and submit with <button>","Complete feedback form within 90 minutes and record walkthrough video"],"\ud83d\udcca Grades Table Page":["Create grades table using <table>, <thead>, and <tbody> structure","Add table caption with <caption> and organize data with <tr>, <th>, <td>","Structure tabular data properly for accessibility and readability","Complete grades table within 60 minutes and record walkthrough video"],"\ud83d\udcde Contact Us Page":["Add contact information using <p> and <h2>/<h3> elements","Create clickable email links using <a> with mailto: protocol","Add phone links using <a> with tel: protocol for mobile compatibility","Complete contact page within 45 minutes and record walkthrough video"],"\ud83d\udd17 Conceptual Review":["Demonstrate understanding of HTML document structure and semantic elements","Show how all pages link together using proper navigation","Explain the relationship between different HTML elements used","Record concept video explaining the complete project structure"],"React.js Fundamentals":["Build a todo list application with React components","Implement state management for a shopping cart feature","Create reusable components with proper prop handling"],"Node.js & Backend Development":["Set up Express server with basic routing","Implement CRUD operations for a REST API","Integrate authentication middleware for secure endpoints"],"Project Planning & Architecture":["Design system architecture for full-stack application","Create user stories and technical specifications","Set up project structure with proper folder organization"]},o=(e,t)=>{const n=a[e];return n&&n.find(e=>e.name===t)||null},l={beginner:{range:[0,40],label:"Getting Started",color:"red",description:"Learning the basics and building foundation"},developing:{range:[41,70],label:"Developing",color:"yellow",description:"Understanding concepts and applying knowledge"},proficient:{range:[71,85],label:"Proficient",color:"blue",description:"Comfortable with concepts and solving problems"},advanced:{range:[86,100],label:"Advanced",color:"green",description:"Mastering concepts and teaching others"}}},1293:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4830);t.debounce=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"!==typeof n&&(n={});const{leading:a=!1,trailing:s=!0,maxWait:i}=n,o=Array(2);let l;a&&(o[0]="leading"),s&&(o[1]="trailing");let c=null;const d=r.debounce(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];l=e.apply(this,n),c=null},t,{edges:o}),u=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null!=i&&(null===c&&(c=Date.now()),Date.now()-c>=i)?(l=e.apply(this,n),c=Date.now(),d.cancel(),d.schedule(),l):(d.apply(this,n),l)};return u.cancel=d.cancel,u.flush=()=>(d.flush(),l),u}},1444:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toPath=function(e){const t=[],n=e.length;if(0===n)return t;let r=0,a="",s="",i=!1;for(46===e.charCodeAt(0)&&(t.push(""),r++);r<n;){const o=e[r];s?"\\"===o&&r+1<n?(r++,a+=e[r]):o===s?s="":a+=o:i?'"'===o||"'"===o?s=o:"]"===o?(i=!1,t.push(a),a=""):a+=o:"["===o?(i=!0,a&&(t.push(a),a="")):"."===o?a&&(t.push(a),a=""):a+=o,r++}return a&&t.push(a),t}},1497:(e,t,n)=>{"use strict";var r=n(3218);function a(){}function s(){}s.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,s,i){if(i!==r){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:a};return n.PropTypes=n,n}},1547:(e,t,n)=>{"use strict";n.d(t,{j2:()=>y,db:()=>x});var r=n(9232);(0,r.KO)("firebase","12.6.0","app");var a=n(4144),s=n(6667),i=n(1776),o=n(9606);const l="functions";i.g;class c{constructor(e,t,n,a){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,(0,r.xZ)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(e=>this.auth=e,()=>{}),this.messaging||n.get().then(e=>this.messaging=e,()=>{}),this.appCheck||null===a||void 0===a||a.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null===e||void 0===e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const d="us-central1";class u{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:d,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){return fetch(...arguments)};this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new c(e,t,n,r),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{const e=new URL(a);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=d}catch(i){this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){const n=this.emulatorOrigin;return"".concat(n,"/").concat(t,"/").concat(this.region,"/").concat(e)}return null!==this.customDomain?"".concat(this.customDomain,"/").concat(e):"https://".concat(this.region,"-").concat(t,".cloudfunctions.net/").concat(e)}}const h="@firebase/functions",m="0.13.1";var p;(0,r.om)(new o.uA(l,(e,t)=>{let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal"),s=e.getProvider("messaging-internal"),i=e.getProvider("app-check-internal");return new u(r,a,s,i,n)},"PUBLIC").setMultipleInstances(!0)),(0,r.KO)(h,m,p),(0,r.KO)(h,m,"esm2020");const f={apiKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_API_KEY||"",authDomain:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_AUTH_DOMAIN||"",projectId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_PROJECT_ID||"",storageBucket:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_STORAGE_BUCKET||"",messagingSenderId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_MESSAGING_SENDER_ID||"",appId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_APP_ID||"",measurementId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_MEASUREMENT_ID||"",databaseURL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FIREBASE_DATABASE_URL||""};if(!f.apiKey)throw new Error("REACT_APP_FIREBASE_API_KEY is required. Please check your .env file.");const g=(0,r.Wp)(f),y=(0,a.xI)(g),x=(0,s.aU)(g);!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;const n=(0,r.j6)((0,i.Ku)(e),l).getImmediate({identifier:t}),a=(0,i.yU)("functions");a&&function(e,t,n){!function(e,t,n){const r=(0,i.zJ)(t);e.emulatorOrigin="http".concat(r?"s":"","://").concat(t,":").concat(n),r&&((0,i.gE)(e.emulatorOrigin+"/backends"),(0,i.P1)("Functions",!0))}((0,i.Ku)(e),t,n)}(n,...a)}(g)},1776:(e,t,n)=>{"use strict";n.d(t,{cY:()=>f,FA:()=>I,g:()=>P,u:()=>l,Uj:()=>o,Fy:()=>x,tD:()=>q,bD:()=>L,hp:()=>z,T9:()=>m,Tj:()=>u,yU:()=>h,XA:()=>p,mS:()=>c,Ku:()=>W,ZQ:()=>j,sr:()=>k,zJ:()=>g,c1:()=>S,Im:()=>M,lT:()=>A,zW:()=>T,jZ:()=>N,lV:()=>E,nr:()=>C,Ov:()=>D,gE:()=>y,Am:()=>U,I9:()=>B,P1:()=>w,eX:()=>O});var r=n(9379);const a=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<e.length;a+=3){const t=e[a],s=a+1<e.length,i=s?e[a+1]:0,o=a+2<e.length,l=o?e[a+2]:0,c=t>>2,d=(3&t)<<4|i>>4;let u=(15&i)<<2|l>>6,h=63&l;o||(h=64,s||(u=64)),r.push(n[c],n[d],n[u],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){const s=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&s)}else if(a>239&&a<365){const s=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],i=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&s)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<e.length;){const t=n[e.charAt(a++)],s=a<e.length?n[e.charAt(a)]:0;++a;const o=a<e.length?n[e.charAt(a)]:64;++a;const l=a<e.length?n[e.charAt(a)]:64;if(++a,null==t||null==s||null==o||null==l)throw new i;const c=t<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==l){const e=o<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(e){return function(e){const t=a(e);return s.encodeByteArray(t,!0)}(e).replace(/\./g,"")},l=function(e){try{return s.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const d=()=>{try{return c().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&l(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},u=e=>{var t;return null===(t=d())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]},h=e=>{const t=u(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},m=()=>{var e;return null===(e=d())||void 0===e?void 0:e.config},p=e=>{var t;return null===(t=d())||void 0===t?void 0:t["_".concat(e)]};class f{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function g(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function y(e){return(await fetch(e,{credentials:"include"})).ok}function x(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",a=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=(0,r.A)({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(i)),""].join(".")}const v={};let b=!1;function w(e,t){if("undefined"===typeof window||"undefined"===typeof document||!g(window.location.host)||v[e]===t||v[e]||b)return;function n(e){return"__firebase__banner__".concat(e)}v[e]=t;const r="__firebase__banner",a=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(v))v[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{b=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function i(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),i=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),d=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(d,c),t.append(d,i,l,n),document.body.appendChild(t)}a?(i.innerText="Preview backend disconnected.",d.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(d.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',i.innerText="Preview backend running in this workspace."),i.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()}function j(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function N(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(j())}function _(){var e;const t=null===(e=d())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function S(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function k(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function E(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function A(){const e=j();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function C(){return!_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function D(){return!_()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function T(){try{return"object"===typeof indexedDB}catch(e){return!1}}function O(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}class P extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,P.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,I.prototype.create)}}class I{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],a=r?function(e,t){return e.replace(R,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",s="".concat(this.serviceName,": ").concat(a," (").concat(n,").");return new P(n,s,t)}}const R=/\{\$([^}]+)}/g;function M(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function L(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const a of n){if(!r.includes(a))return!1;const n=e[a],s=t[a];if(F(n)&&F(s)){if(!L(n,s))return!1}else if(n!==s)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function F(e){return null!==e&&"object"===typeof e}function U(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function B(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function z(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function q(e,t){const n=new V(e,t);return n.subscribe.bind(n)}class V{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=H),void 0===r.error&&(r.error=H),void 0===r.complete&&(r.complete=H);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function H(){}function W(e){return e&&e._delegate?e._delegate:e}},2086:(e,t,n)=>{"use strict";e.exports=n(5082)},2104:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(1203),a=n(9921);t.isArrayLikeObject=function(e){return a.isObjectLike(e)&&r.isArrayLike(e)}},2132:(e,t,n)=>{"use strict";var r=n(2897).default;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const a=n(8268),s=n(870),i=n(4803),o=n(9972);function l(e,t,n,a){if(t===e)return!0;switch(typeof t){case"object":return function(e,t,n,r){if(null==t)return!0;if(Array.isArray(t))return c(e,t,n,r);if(t instanceof Map)return function(e,t,n,r){if(0===t.size)return!0;if(!(e instanceof Map))return!1;for(const[a,s]of t.entries()){if(!1===n(e.get(a),s,a,e,t,r))return!1}return!0}(e,t,n,r);if(t instanceof Set)return d(e,t,n,r);const a=Object.keys(t);if(null==e)return 0===a.length;if(0===a.length)return!0;if(r&&r.has(t))return r.get(t)===e;r&&r.set(t,e);try{for(let s=0;s<a.length;s++){const o=a[s];if(!i.isPrimitive(e)&&!(o in e))return!1;if(void 0===t[o]&&void 0!==e[o])return!1;if(null===t[o]&&null!==e[o])return!1;if(!n(e[o],t[o],o,e,t,r))return!1}return!0}finally{r&&r.delete(t)}}(e,t,n,a);case"function":return Object.keys(t).length>0?l(e,r({},t),n,a):o.eq(e,t);default:return s.isObject(e)?"string"!==typeof t||""===t:o.eq(e,t)}}function c(e,t,n,r){if(0===t.length)return!0;if(!Array.isArray(e))return!1;const a=new Set;for(let s=0;s<t.length;s++){const i=t[s];let o=!1;for(let l=0;l<e.length;l++){if(a.has(l))continue;let c=!1;if(n(e[l],i,s,e,t,r)&&(c=!0),c){a.add(l),o=!0;break}}if(!o)return!1}return!0}function d(e,t,n,r){return 0===t.size||e instanceof Set&&c([...e],[...t],n,r)}t.isMatchWith=function(e,t,n){return"function"!==typeof n?a.isMatch(e,t):l(e,t,function e(t,r,a,s,i,o){const c=n(t,r,a,s,i,o);return void 0!==c?Boolean(c):l(t,r,e,o)},new Map)},t.isSetMatch=d},2204:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5316),a=n(7312),s=n(3799);t.sortBy=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const o=n.length;return o>1&&s.isIterateeCall(e,n[0],n[1])?n=[]:o>2&&s.isIterateeCall(n[0],n[1],n[2])&&(n=[n[0]]),r.orderBy(e,a.flatten(n),["asc"])}},2330:(e,t,n)=>{"use strict";var r=n(5043);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=r.useState,i=r.useEffect,o=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(r){return!0}}var d="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=s({inst:{value:n,getSnapshot:t}}),a=r[0].inst,d=r[1];return o(function(){a.value=n,a.getSnapshot=t,c(a)&&d({inst:a})},[e,n,t]),i(function(){return c(a)&&d({inst:a}),e(function(){c(a)&&d({inst:a})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:d},2489:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isDeepKey=function(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}},2682:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isPlainObject=function(e){if("object"!==typeof e)return!1;if(null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){var t;const n=e[Symbol.toStringTag];if(null==n)return!1;return!!(null!==(t=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))&&void 0!==t&&t.writable)&&e.toString()==="[object ".concat(n,"]")}let n=e;for(;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}},2715:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9599),a=n(7330),s=n(3808),i=n(8845);t.iteratee=function(e){if(null==e)return r.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&2===e.length?i.matchesProperty(e[0],e[1]):s.matches(e);case"string":case"symbol":case"number":return a.property(e)}}},2777:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isSymbol=function(e){return"symbol"===typeof e||e instanceof Symbol}},2799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(e,t,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),"key"in t)for(var s in r={},t)"key"!==s&&(r[s]=t[s]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:a,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=a,t.jsxs=a},2897:(e,t,n)=>{var r=n(3693);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},2965:(e,t,n)=>{"use strict";n.d(t,{$b:()=>a,Vy:()=>c});const r=[];var a;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(a||(a={}));const s={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},i=a.INFO,o={[a.DEBUG]:"log",[a.VERBOSE]:"log",[a.INFO]:"info",[a.WARN]:"warn",[a.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=o[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,s=new Array(a>2?a-2:0),i=2;i<a;i++)s[i-2]=arguments[i];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class c{constructor(e){this.name=e,this._logLevel=i,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in a))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.DEBUG,...t),this._logHandler(this,a.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.VERBOSE,...t),this._logHandler(this,a.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.INFO,...t),this._logHandler(this,a.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.WARN,...t),this._logHandler(this,a.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,a.ERROR,...t),this._logHandler(this,a.ERROR,...t)}}},2970:(e,t,n)=>{"use strict";n.d(t,{B:()=>d,I:()=>c,UserService:()=>u});var r=n(9379),a=n(6667),s=n(1547),i=n(9390);const o={totalReads:0,ops:[],log(e){this.totalReads+=e.count,this.ops.push(e)},summary(){const e={};for(const t of this.ops)e[t.collection]=(e[t.collection]||0)+t.count;console.log("\ud83d\udcca Firestore Read Summary:",{totalReads:this.totalReads,byCollection:e})},reset(){this.totalReads=0,this.ops=[]}};function l(e){if(null===e||"object"!==typeof e)return e;if(e instanceof a.Timestamp)return e.toDate();if(Array.isArray(e))return e.map(l);const t={};for(const[n,r]of Object.entries(e))t[n]=l(r);return t}const c={USERS:"users",PHASES:"phases",TOPICS:"topics",DAILY_GOALS:"daily_goals",DAILY_REFLECTIONS:"daily_reflections",PAIR_PROGRAMMING_REQUESTS:"pair_programming_requests",PAIR_PROGRAMMING_SESSIONS:"pair_programming_sessions",PAIR_PROGRAMMING_GOALS:"pair_programming_goals",MENTOR_FEEDBACK:"mentor_feedback",MENTEE_FEEDBACK:"mentee_feedback",SESSION_COMPLETIONS:"session_completions",LEAVE_REQUESTS:"leave_requests",LEAVE_IMPACTS:"leave_impacts",NOTIFICATIONS:"notifications",REMINDER_SETTINGS:"reminder_settings",ATTENDANCE:"attendance",MENTOR_NOTES:"mentor_notes",STUDENT_PROGRESS:"student_progress",MENTEE_REVIEWS:"mentee_reviews",MENTOR_REVIEWS:"mentor_reviews",MENTEE_REVIEW_CATEGORIES:"mentee_review_categories",MENTOR_AVAILABILITY:"mentor_availability",CAMPUS_SCHEDULES:"campus_schedules",HOUSE_STATS:"house_stats",PHASE_APPROVALS:"phase_approvals",CAMPUS_WEBHOOKS:"campus_webhooks",WEBHOOK_CHANGE_NOTIFICATIONS:"webhook_change_notifications"};class d{static async getWhereCompound(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"desc";const c=performance.now();try{let d=t.map(e=>(0,a._M)(e.field,e.operator,e.value));n&&d.push((0,a.orderBy)(n,i));const u=(0,a.query)((0,a.collection)(s.db,e),...d),h=await(0,a.getDocs)(u);return o.log({type:"getDocs",collection:e,count:h.size,ms:performance.now()-c}),h.docs.map(e=>(0,r.A)({id:e.id},l(e.data())))}catch(d){throw console.error("Error in compound query for ".concat(e,":"),d),d}}static async create(e,t){try{return(await(0,a.gS)((0,a.collection)(s.db,e),(0,r.A)((0,r.A)({},t),{},{created_at:a.Timestamp.now(),updated_at:a.Timestamp.now()}))).id}catch(n){throw console.error("Error creating document in ".concat(e,":"),n),n}}static async createWithId(e,t,n){try{const i=(0,a.H9)(s.db,e,t);await(0,a.BN)(i,(0,r.A)((0,r.A)({},n),{},{created_at:a.Timestamp.now(),updated_at:a.Timestamp.now()}))}catch(i){throw console.error("Error creating document with ID in ".concat(e,":"),i),i}}static async getById(e,t){const n=performance.now();try{const i=(0,a.H9)(s.db,e,t),c=await(0,a.x7)(i);return o.log({type:"getDoc",collection:e,count:1,ms:performance.now()-n}),c.exists()?(0,r.A)({id:c.id},l(c.data())):null}catch(i){throw console.error("Error getting document from ".concat(e,":"),i),i}}static async getAll(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"desc",i=arguments.length>3?arguments[3]:void 0;const c=performance.now();try{let d=(0,a.collection)(s.db,e),u=[];t&&u.push((0,a.orderBy)(t,n)),i&&u.push((0,a.limit)(i));const h=u.length>0?(0,a.query)(d,...u):d,m=await(0,a.getDocs)(h);return o.log({type:"getDocs",collection:e,count:m.size,ms:performance.now()-c}),m.docs.map(e=>(0,r.A)({id:e.id},l(e.data())))}catch(d){throw console.error("Error getting documents from ".concat(e,":"),d),d}}static async getWhere(e,t,n,i,c){let d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"desc";const u=performance.now();try{let h=[(0,a._M)(t,n,i)];c&&h.push((0,a.orderBy)(c,d));const m=(0,a.query)((0,a.collection)(s.db,e),...h),p=await(0,a.getDocs)(m);return o.log({type:"getDocs",collection:e,count:p.size,ms:performance.now()-u}),p.docs.map(e=>(0,r.A)({id:e.id},l(e.data())))}catch(h){throw console.error("Error querying documents from ".concat(e,":"),h),h}}static async update(e,t,n){try{const i=(0,a.H9)(s.db,e,t);await(0,a.mZ)(i,(0,r.A)((0,r.A)({},n),{},{updated_at:a.Timestamp.now()}))}catch(i){throw console.error("Error updating document in ".concat(e,":"),i),i}}static async delete(e,t){try{const n=(0,a.H9)(s.db,e,t);await(0,a.kd)(n)}catch(n){throw console.error("Error deleting document from ".concat(e,":"),n),n}}static subscribeToDocument(e,t,n){const i=(0,a.H9)(s.db,e,t);return(0,a.aQ)(i,e=>{e.exists()?n((0,r.A)({id:e.id},e.data())):n(null)})}static subscribeToCollection(e,t,n,i,o){let l=(0,a.collection)(s.db,e);return n&&i&&o&&(l=(0,a.query)((0,a.collection)(s.db,e),(0,a._M)(n,i,o))),(0,a.aQ)(l,e=>{const n=e.docs.map(e=>(0,r.A)({id:e.id},e.data()));t(n)})}static async updateWhere(e,t,n){try{const r=(await this.getWhereCompound(e,t)).map(t=>this.update(e,t.id,n));await Promise.all(r)}catch(r){throw console.error("Error updating documents in ".concat(e,":"),r),r}}static async deleteWhere(e,t){try{const n=(await this.getWhereCompound(e,t)).map(t=>(0,a.kd)(t(s.db,e,t.id)));await Promise.all(n)}catch(n){throw console.error("Error deleting documents from ".concat(e,":"),n),n}}}class u extends d{static async createUser(e){const t=await this.create(c.USERS,e);return i.queryCache.invalidatePattern("users"),t}static async createUserWithId(e,t){await this.createWithId(c.USERS,e,t),i.queryCache.invalidatePattern("users")}static async getUserById(e){return i.queryCache.get("users:id:".concat(e),async()=>this.getById(c.USERS,e),3e5)}static async getUserByEmail(e){const t=await this.getWhere(c.USERS,"email","==",e);return t.length>0?t[0]:null}static async getAdminUsers(){const e=(0,a.collection)(s.db,"users"),t=(0,a.query)(e,(0,a._M)("isAdmin","==",!0)),n=await(0,a.getDocs)(t),i=[];return n.forEach(e=>{i.push(l((0,r.A)({id:e.id},e.data())))}),i}static async getStudentsByMentor(e){return i.queryCache.get("users:mentor:".concat(e),async()=>{const t=(0,a.query)((0,a.collection)(s.db,c.USERS),(0,a._M)("mentor_id","==",e));return(await(0,a.getDocs)(t)).docs.map(e=>(0,r.A)({id:e.id},l(e.data())))},3e5)}static async getStudentsByStudentMentor(e){return this.getStudentsByMentor(e)}static async getStudentsWithoutMentor(){return this.getWhere(c.USERS,"mentor_id","==",null)}static async updateUser(e,t){console.log("[UserService.updateUser] Updating user ".concat(e," with data:"),t),await this.update(c.USERS,e,t),console.log("[UserService.updateUser] Update successful for user ".concat(e)),i.queryCache.invalidatePattern("users"),i.queryCache.invalidate("users:id:".concat(e))}static async assignMentorToStudent(e,t){return this.updateUser(e,{mentor_id:t})}static async getAssignedMentees(e){try{return(await this.getWhere(c.USERS,"mentor_id","==",e)).map(e=>e.id)}catch(t){throw console.error("Error fetching assigned mentees:",t),t}}static async getUsersByHouse(e){try{return await i.queryCache.get("users:house:".concat(e),async()=>this.getWhere(c.USERS,"house","==",e),3e5)}catch(t){throw console.error("Error fetching users by house:",t),t}}static async getUsersByCampus(e){try{return await i.queryCache.get("users:campus:".concat(e),async()=>this.getWhere(c.USERS,"campus","==",e),3e5)}catch(t){throw console.error("Error fetching users by campus:",t),t}}static async getMentorAvailability(e){try{return await this.getWhere(c.MENTOR_AVAILABILITY,"mentor_id","==",e)}catch(t){throw console.error("Error fetching mentor availability:",t),t}}static async saveMentorAvailability(e){try{const t=await this.getWhereCompound(c.MENTOR_AVAILABILITY,[{field:"mentor_id",operator:"==",value:e.mentor_id},{field:"day_of_week",operator:"==",value:e.day_of_week},{field:"start_time",operator:"==",value:e.start_time}]);return t.length>0?(await this.update(c.MENTOR_AVAILABILITY,t[0].id,(0,r.A)((0,r.A)({},e),{},{updated_at:new Date})),t[0].id):await this.create(c.MENTOR_AVAILABILITY,e)}catch(t){throw console.error("Error saving mentor availability:",t),t}}static async saveBulkMentorAvailability(e){try{const t=e.map(e=>this.saveMentorAvailability(e));await Promise.all(t)}catch(t){throw console.error("Error saving bulk mentor availability:",t),t}}static async deleteMentorAvailability(e,t,n){try{const r=await this.getWhereCompound(c.MENTOR_AVAILABILITY,[{field:"mentor_id",operator:"==",value:e},{field:"day_of_week",operator:"==",value:t},{field:"start_time",operator:"==",value:n}]);r.length>0&&await this.delete(c.MENTOR_AVAILABILITY,r[0].id)}catch(r){throw console.error("Error deleting mentor availability:",r),r}}}},3215:(e,t,n)=>{"use strict";n.r(t),n.d(t,{phase7Topics:()=>r});const r=[{name:"Project Introduction: CollabSphere",order:1,maxTime:null,keyConcepts:["Overview of full-stack + AI integration"],description:"Understand project scope: full-stack development, AI-powered collaboration, portfolio-ready SaaS application.",deliverable:"No video \u2013 intro only",video:null},{name:"User Authentication System",order:2,maxTime:null,keyConcepts:["bcrypt.js (password hashing)","JWT (auth)","Express routes","MongoDB"],description:"Secure user registration, login, JWT-protected routes, store users in MongoDB.",deliverable:"Video 1: Registration & Login demo, explain auth flow and JWT handling",video:1},{name:"Project Creation & Collaboration",order:3,maxTime:null,keyConcepts:["Express routes","MongoDB relations","Mongoose models"],description:"Create projects, invite users as members, display user dashboard.",deliverable:"Video 2: Create project, add members, demo dashboard",video:1},{name:"Markdown Notes Management",order:4,maxTime:null,keyConcepts:["SimpleMDE editor","CRUD operations","MongoDB"],description:"Create, edit, save notes; basic collaboration logic.",deliverable:"Video 3: CRUD notes demo, save to DB, frontend interaction",video:1},{name:"Gemini AI Integration with Notes",order:5,maxTime:null,keyConcepts:["Gemini API","Express backend routes","fetch/axios"],description:"Buttons to explain notes or suggest improvements via Gemini; backend handles API calls securely.",deliverable:"Video 4: Gemini explain & suggestion demo, show backend API routes",video:1},{name:"File Upload & Preview",order:6,maxTime:null,keyConcepts:["Multer (or Cloudinary)","file handling","MongoDB references"],description:"Upload project files, basic preview, Gemini code explanation for supported files.",deliverable:"Video 5: Upload demo, preview, Gemini code explanation",video:1},{name:"Contribution Analytics",order:7,maxTime:null,keyConcepts:["Express GET routes","MongoDB queries","data aggregation"],description:"Track user activity: notes created, files uploaded, project contributions.",deliverable:"Video 6: Analytics demo, basic dashboard summary",video:1},{name:"Public Shareable Project Page & README Generation",order:8,maxTime:null,keyConcepts:["Public routes","Gemini API","Markdown generation"],description:"Generate project README via Gemini, make project or README publicly viewable.",deliverable:"Video 7: Public project page demo, README generation using Gemini",video:1},{name:"Mini Projects / Practice Exercises",order:9,maxTime:null,keyConcepts:["Isolated practice for features"],description:"1) Authentication system, 2) Collaborative Markdown notes, 3) Gemini-powered README generator.",deliverable:"Optional videos for practice, helps prep final project",video:3},{name:"Project Wrap-Up & Reflection",order:10,maxTime:null,keyConcepts:["Full-stack flow","secure integration","AI enhancement"],description:"Consolidate all features, demonstrate end-to-end functionality, deployment readiness.",deliverable:"Optional reflection video summarizing full app",video:1}]},3216:(e,t,n)=>{"use strict";n.r(t),n.d(t,{phase6Topics:()=>r});const r=[{name:"Project Introduction: Student Feedback Manager",order:1,maxTime:null,keyConcepts:["Overview"],description:"Understand databases, NoSQL concepts, MongoDB for data storage, Mongoose for schema and model management.",deliverable:"No video \u2013 intro only",video:null},{name:"MongoDB Setup & Connection",order:2,maxTime:null,keyConcepts:["mongoose.connect()",".env (dotenv)"],description:"Connect Node.js/Express app to MongoDB (local or Atlas). Keep connection string secure with environment variables.",deliverable:"1 Video: Show database connection, explain .env usage, demonstrate successful connection.",video:1},{name:"Define Schema & Model",order:3,maxTime:null,keyConcepts:["mongoose.Schema()","mongoose.model()"],description:"Create a Mongoose schema for feedback (name, rating, comments). Build a model to interact with the database.",deliverable:"1 Video: Explain schema, model, and why schemas structure data.",video:1},{name:"Storing New Feedback (Create)",order:4,maxTime:null,keyConcepts:["new Model()","instance.save()","express.json()"],description:"Receive POST requests from frontend form, create a new document, save feedback to MongoDB.",deliverable:"1 Video: Submit feedback via form \u2192 save to database \u2192 confirm stored data (MongoDB Compass or shell).",video:1},{name:"Retrieving & Displaying Feedback (Read)",order:5,maxTime:null,keyConcepts:["Model.find()","async/await","Express GET route"],description:"Create route to fetch all feedback, send JSON to frontend, dynamically display feedback on \u201cAll Feedback\u201d page.",deliverable:"1 Video: Fetch feedback \u2192 render on frontend \u2192 explain full data flow.",video:1},{name:"Mini Projects / Practice Exercises",order:6,maxTime:null,keyConcepts:["CRUD basics (Create & Read focus)","Express routes","Mongoose models"],description:"Build small apps to practice database integration: contact form collector, student progress tracker, quick notes saver. Use POST to store and GET to retrieve data.",deliverable:"1 Video per mini-project: Demo backend functionality, explain schema, routes, and database interactions.",video:3},{name:"Project Wrap-Up & Reflection",order:7,maxTime:null,keyConcepts:["Review MongoDB + Mongoose","full-stack data flow"],description:"Consolidate knowledge: connect frontend, backend, database; secure connection; handle user data persistently.",deliverable:"1 Video: Showcase final app, explain end-to-end data flow (frontend \u2192 backend \u2192 database \u2192 frontend).",video:1}]},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3272:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toKey=function(e){var t;return"string"===typeof e||"symbol"===typeof e?e:Object.is(null===e||void 0===e||null===(t=e.valueOf)||void 0===t?void 0:t.call(e),-0)?"-0":String(e)}},3693:(e,t,n)=>{var r=n(7736);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3757:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isTypedArray=function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}},3799:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4704),a=n(1203),s=n(870),i=n(9972);t.isIterateeCall=function(e,t,n){return!!s.isObject(n)&&(!!("number"===typeof t&&a.isArrayLike(n)&&r.isIndex(t)&&t<n.length||"string"===typeof t&&t in n)&&i.eq(n[t],e))}},3808:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8268),a=n(5261);t.matches=function(e){return e=a.cloneDeep(e),t=>r.isMatch(t,e)}},3821:(e,t,n)=>{e.exports=n(2204).sortBy},3986:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}n.d(t,{A:()=>r})},4144:(e,t,n)=>{"use strict";n.d(t,{HF:()=>et,xI:()=>Rn,hg:()=>dt,df:()=>Yt,CI:()=>ut});var r=n(3986),a=n(9379),s=n(9232),i=n(1776),o=n(2965),l=n(9606);const c=["providerId"],d=["uid","auth","stsTokenManager"],u=["providerId","signInMethod"];function h(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const m=h,p=new i.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),f=new o.Vy("@firebase/auth");function g(e){if(f.logLevel<=o.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];f.error("Auth (".concat(s.MF,"): ").concat(e),...n)}}function y(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw j(e,...n)}function x(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return j(e,...n)}function v(e,t,n){const r=(0,a.A)((0,a.A)({},m()),{},{[t]:n});return new i.FA("auth","Firebase",r).create(t,{appName:e.name})}function b(e){return v(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function w(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&y(e,"argument-error"),v(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function j(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return p.create(e,...n)}function N(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw j(t,...r)}}function _(e){const t="INTERNAL ASSERTION FAILED: "+e;throw g(t),new Error(t)}function S(e,t){e||_(t)}function k(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function E(){return"http:"===A()||"https:"===A()}function A(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class C{constructor(e,t){this.shortDelay=e,this.longDelay=t,S(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,i.jZ)()||(0,i.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(E()||(0,i.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function D(e,t){S(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class T{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void _("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void _("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void _("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const O={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},P=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],I=new C(3e4,6e4);function R(e,t){return e.tenantId&&!t.tenantId?(0,a.A)((0,a.A)({},t),{},{tenantId:e.tenantId}):t}async function M(e,t,n,r){return L(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let s={},o={};r&&("GET"===t?o=r:s={body:JSON.stringify(r)});const l=(0,i.Am)((0,a.A)({key:e.config.apiKey},o)).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const d=(0,a.A)({method:t,headers:c},s);return(0,i.c1)()||(d.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,i.zJ)(e.emulatorConfig.host)&&(d.credentials="include"),T.fetch()(await U(e,e.config.apiHost,n,l),d)})}async function L(e,t,n){e._canInitEmulator=!1;const r=(0,a.A)((0,a.A)({},O),t);try{const t=new z(e),a=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw q(e,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const t=a.ok?s.errorMessage:s.error.message,[n,i]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw q(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw q(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw q(e,"user-disabled",s);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw v(e,o,i);y(e,o)}}catch(s){if(s instanceof i.g)throw s;y(e,"network-request-failed",{message:String(s)})}}async function F(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await M(e,t,n,r,a);return"mfaPendingCredential"in s&&y(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function U(e,t,n,r){const a="".concat(t).concat(n,"?").concat(r),s=e,i=s.config.emulator?D(e.config,a):"".concat(e.config.apiScheme,"://").concat(a);if(P.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(i).toString()}return i}function B(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class z{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(x(this.auth,"network-request-failed")),I.get())})}}function q(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=x(e,t,r);return a.customData._tokenResponse=n,a}function V(e){return void 0!==e&&void 0!==e.enterprise}class H{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return B(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function W(e,t){return M(e,"GET","/v2/recaptchaConfig",R(e,t))}async function G(e,t){return M(e,"POST","/v1/accounts:lookup",t)}function K(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Q(e){return 1e3*Number(e)}function Y(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return g("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,i.u)(n);return e?JSON.parse(e):(g("Failed to decode base64 JWT payload"),null)}catch(a){return g("Caught error parsing JWT payload as JSON",null===a||void 0===a?void 0:a.toString()),null}}function $(e){const t=Y(e);return N(t,"internal-error"),N("undefined"!==typeof t.exp,"internal-error"),N("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function J(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof i.g&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class X{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{var t;this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Z{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=K(this.lastLoginAt),this.creationTime=K(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ee(e){var t;const n=e.auth,r=await e.getIdToken(),a=await J(e,G(n,{idToken:r}));N(null===a||void 0===a?void 0:a.users.length,n,"internal-error");const s=a.users[0];e._notifyReloadListener(s);const i=null!==(t=s.providerUserInfo)&&void 0!==t&&t.length?te(s.providerUserInfo):[],o=(l=e.providerData,c=i,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const d=e.isAnonymous,u=!(e.email&&s.passwordHash)&&!(null!==o&&void 0!==o&&o.length),h=!!d&&u,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Z(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,m)}function te(e){return e.map(e=>{let{providerId:t}=e,n=(0,r.A)(e,c);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class ne{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){N(e.idToken,"internal-error"),N("undefined"!==typeof e.idToken,"internal-error"),N("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):$(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){N(0!==e.length,"internal-error");const t=$(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(N(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:a}=await async function(e,t){const n=await L(e,{},async()=>{const n=(0,i.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:a}=e.config,s=await U(e,r,"/v1/token","key=".concat(a)),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return e.emulatorConfig&&(0,i.zJ)(e.emulatorConfig.host)&&(l.credentials="include"),T.fetch()(s,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:a}=t,s=new ne;return n&&(N("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(N("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),a&&(N("number"===typeof a,"internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ne,this.toJSON())}_performRefresh(){return _("not implemented")}}function re(e,t){N("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class ae{constructor(e){let{uid:t,auth:n,stsTokenManager:a}=e,s=(0,r.A)(e,d);this.providerId="firebase",this.proactiveRefresh=new X(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Z(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await J(this,this.stsTokenManager.getToken(this.auth,e));return N(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,i.Ku)(e),r=await n.getIdToken(t),a=Y(r);N(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const s="object"===typeof a.firebase?a.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:a,token:r,authTime:K(Q(a.auth_time)),issuedAtTime:K(Q(a.iat)),expirationTime:K(Q(a.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,i.Ku)(e);await ee(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(N(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>(0,a.A)({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ae((0,a.A)((0,a.A)({},this),{},{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){N(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ee(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,s.xZ)(this.auth.app))return Promise.reject(b(this.auth));const e=await this.getIdToken();return await J(this,async function(e,t){return M(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return(0,a.A)((0,a.A)({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>(0,a.A)({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{},{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,i,o,l,c,d;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,m=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,p=null!==(i=t.photoURL)&&void 0!==i?i:void 0,f=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(l=t._redirectEventId)&&void 0!==l?l:void 0,y=null!==(c=t.createdAt)&&void 0!==c?c:void 0,x=null!==(d=t.lastLoginAt)&&void 0!==d?d:void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:j,stsTokenManager:_}=t;N(v&&_,e,"internal-error");const S=ne.fromJSON(this.name,_);N("string"===typeof v,e,"internal-error"),re(u,e.name),re(h,e.name),N("boolean"===typeof b,e,"internal-error"),N("boolean"===typeof w,e,"internal-error"),re(m,e.name),re(p,e.name),re(f,e.name),re(g,e.name),re(y,e.name),re(x,e.name);const k=new ae({uid:v,auth:e,email:h,emailVerified:b,displayName:u,isAnonymous:w,photoURL:p,phoneNumber:m,tenantId:f,stsTokenManager:S,createdAt:y,lastLoginAt:x});return j&&Array.isArray(j)&&(k.providerData=j.map(e=>(0,a.A)({},e))),g&&(k._redirectEventId=g),k}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new ne;r.updateFromServerResponse(t);const a=new ae({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await ee(a),a}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];N(void 0!==r.localId,"internal-error");const a=void 0!==r.providerUserInfo?te(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null!==a&&void 0!==a&&a.length),i=new ne;i.updateFromIdToken(n);const o=new ae({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Z(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null!==a&&void 0!==a&&a.length)};return Object.assign(o,l),o}}const se=new Map;function ie(e){S(e instanceof Function,"Expected a class definition");let t=se.get(e);return t?(S(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,se.set(e,t),t)}class oe{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}oe.type="NONE";const le=oe;function ce(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class de{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:a}=this.auth;this.fullUserKey=ce(this.userKey,r.apiKey,a),this.fullPersistenceKey=ce("persistence",r.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await G(this.auth,{idToken:e}).catch(()=>{});return t?ae._fromGetAccountInfoResponse(this.auth,t,e):null}return ae._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new de(ie(le),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let a=r[0]||ie(le);const s=ce(n,e.config.apiKey,e.name);let i=null;for(const c of t)try{const t=await c._get(s);if(t){let n;if("string"===typeof t){const r=await G(e,{idToken:t}).catch(()=>{});if(!r)break;n=await ae._fromGetAccountInfoResponse(e,r,t)}else n=ae._fromJSON(e,t);c!==a&&(i=n),a=c;break}}catch(l){}const o=r.filter(e=>e._shouldAllowMigration);return a._shouldAllowMigration&&o.length?(a=o[0],i&&await a._set(s,i.toJSON()),await Promise.all(t.map(async e=>{if(e!==a)try{await e._remove(s)}catch(t){}})),new de(a,e,n)):new de(a,e,n)}}function ue(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(fe(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(he(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ye(t))return"Blackberry";if(xe(t))return"Webos";if(me(t))return"Safari";if((t.includes("chrome/")||pe(t))&&!t.includes("edge/"))return"Chrome";if(ge(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function he(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/firefox\//i.test(e)}function me(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/crios\//i.test(e)}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/iemobile/i.test(e)}function ge(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/android/i.test(e)}function ye(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/blackberry/i.test(e)}function xe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/webos/i.test(e)}function ve(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function be(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return ve(e)||ge(e)||xe(e)||ye(e)||/windows phone/i.test(e)||fe(e)}function we(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ue((0,i.ZQ)());break;case"Worker":t="".concat(ue((0,i.ZQ)()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(s.MF,"/").concat(r)}class je{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(a){r(a)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Ne{constructor(e){var t,n,r,a;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(a=e.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,a,s,i;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(a=o.containsUppercaseLetter)||void 0===a||a),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(i=o.containsNonAlphanumericCharacter)||void 0===i||i),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class _e{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ke(this),this.idTokenSubscription=new ke(this),this.beforeStateQueue=new je(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=p,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ie(t)),this._initializationPromise=this.queue(async()=>{var n,r,a;if(!this._deleted&&(this.persistenceManager=await de.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null!==(r=this._popupRedirectResolver)&&void 0!==r&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(a=this.currentUser)||void 0===a?void 0:a.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await G(this,{idToken:e}),n=await ae._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if((0,s.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){var a,i;await this.getOrInitRedirectPersistenceManager();const t=null===(a=this.redirectUser)||void 0===a?void 0:a._redirectEventId,s=null===(i=n)||void 0===i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);t&&t!==s||null===o||void 0===o||!o.user||(n=o.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return N(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ee(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,s.xZ)(this.app))return Promise.reject(b(this));const t=e?(0,i.Ku)(e):null;return t&&N(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&N(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,s.xZ)(this.app)?Promise.reject(b(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,s.xZ)(this.app)?Promise.reject(b(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ie(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return M(e,"GET","/v2/passwordPolicy",R(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Ne(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new i.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return M(e,"POST","/v2/accounts:revokeToken",R(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ie(e)||this._popupRedirectResolver;N(t,this,"argument-error"),this.redirectPersistenceManager=await de.create(this,[ie(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let s=!1;const i=this._isInitialized?Promise.resolve():this._initializationPromise;if(N(i,this,"internal-error"),i.then(()=>{s||a(this.currentUser)}),"function"===typeof t){const a=e.addObserver(t,n,r);return()=>{s=!0,a()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return N(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=we(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if((0,s.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return null!==t&&void 0!==t&&t.error&&function(e){if(f.logLevel<=o.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];f.warn("Auth (".concat(s.MF,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Se(e){return(0,i.Ku)(e)}class ke{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,i.tD)(e=>this.observer=e)}get next(){return N(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ee={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ae(e){return Ee.loadJS(e)}function Ce(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class De{constructor(){this.enterprise=new Te}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Te{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Oe="NO_RECAPTCHA";class Pe{constructor(e){this.type="recaptcha-enterprise",this.auth=Se(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const a=window.grecaptcha;V(a)?a.enterprise.ready(()=>{a.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Oe)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new De).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{W(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new H(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(a=>{if(!t&&V(window.grecaptcha))n(a,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Ee.recaptchaEnterpriseScript;0!==t.length&&(t+=a),Ae(t).then(()=>{n(a,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Ie(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new Pe(e);let o;if(s)o=Oe;else try{o=await i.verify(n)}catch(c){o=await i.verify(n,!0)}const l=(0,a.A)({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in l){const e=l.phoneEnrollmentInfo.phoneNumber,t=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const e=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Re(e,t,n,r,a){if("EMAIL_PASSWORD_PROVIDER"===a){var s;if(null!==(s=e._getRecaptchaConfig())&&void 0!==s&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Ie(e,t,n,"getOobCode"===n);return r(e,a)}return r(e,t).catch(async a=>{if(a.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const a=await Ie(e,t,n,"getOobCode"===n);return r(e,a)}return Promise.reject(a)})}if("PHONE_PROVIDER"===a){var i;if(null!==(i=e._getRecaptchaConfig())&&void 0!==i&&i.isProviderEnabled("PHONE_PROVIDER")){const a=await Ie(e,t,n);return r(e,a).catch(async a=>{var s;if("AUDIT"===(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))&&(a.code==="auth/".concat("missing-recaptcha-token")||a.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const a=await Ie(e,t,n,!1,!0);return r(e,a)}return Promise.reject(a)})}{const a=await Ie(e,t,n,!1,!0);return r(e,a)}}return Promise.reject(a+" provider is not supported.")}async function Me(e){const t=Se(e),n=await W(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new H(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Pe(t).verify()}}function Le(e,t,n){const r=Se(e);N(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const a=!(null===n||void 0===n||!n.disableWarnings),s=Fe(t),{host:o,port:l}=function(e){const t=Fe(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const e=a[1];return{host:e,port:Ue(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Ue(t)}}}(t),c=null===l?"":":".concat(l),d={url:"".concat(s,"//").concat(o).concat(c,"/")},u=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator)return N(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void N((0,i.bD)(d,r.config.emulator)&&(0,i.bD)(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=d,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,(0,i.zJ)(o)?((0,i.gE)("".concat(s,"//").concat(o).concat(c)),(0,i.P1)("Auth",!0)):a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Fe(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ue(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Be{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _("not implemented")}_getIdTokenResponse(e){return _("not implemented")}_linkToIdToken(e,t){return _("not implemented")}_getReauthenticationResolver(e){return _("not implemented")}}async function ze(e,t){return M(e,"POST","/v1/accounts:signUp",t)}async function qe(e,t){return F(e,"POST","/v1/accounts:signInWithPassword",R(e,t))}class Ve extends Be{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Ve(e,t,"password")}static _fromEmailAndCode(e,t){return new Ve(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Re(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",qe,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return F(e,"POST","/v1/accounts:signInWithEmailLink",R(e,t))}(e,{email:this._email,oobCode:this._password});default:y(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Re(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ze,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return F(e,"POST","/v1/accounts:signInWithEmailLink",R(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:y(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function He(e,t){return F(e,"POST","/v1/accounts:signInWithIdp",R(e,t))}class We extends Be{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new We(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):y("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:a}=t,s=(0,r.A)(t,u);if(!n||!a)return null;const i=new We(n,a);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return He(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,He(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,He(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,i.Am)(t)}return e}}async function Ge(e,t){return M(e,"POST","/v1/accounts:sendVerificationCode",R(e,t))}const Ke={USER_NOT_FOUND:"user-not-found"};class Qe extends Be{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Qe({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Qe({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return F(e,"POST","/v1/accounts:signInWithPhoneNumber",R(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await F(e,"POST","/v1/accounts:signInWithPhoneNumber",R(e,t));if(n.temporaryProof)throw q(e,"account-exists-with-different-credential",n);return n}(e,(0,a.A)({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return F(e,"POST","/v1/accounts:signInWithPhoneNumber",R(e,(0,a.A)((0,a.A)({},t),{},{operation:"REAUTH"})),Ke)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}=e;return n||t||r||a?new Qe({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}):null}}class Ye{constructor(e){var t,n,r,a,s,o;const l=(0,i.I9)((0,i.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,d=null!==(n=l.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=l.mode)&&void 0!==r?r:null);N(c&&d&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=d,this.continueUrl=null!==(a=l.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(s=l.lang)&&void 0!==s?s:null,this.tenantId=null!==(o=l.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=(0,i.I9)((0,i.hp)(e)).link,n=t?(0,i.I9)((0,i.hp)(t)).deep_link_id:null,r=(0,i.I9)((0,i.hp)(e)).deep_link_id;return(r?(0,i.I9)((0,i.hp)(r)).link:null)||r||n||t||e}(e);try{return new Ye(t)}catch(n){return null}}}class $e{constructor(){this.providerId=$e.PROVIDER_ID}static credential(e,t){return Ve._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ye.parseLink(t);return N(n,"argument-error"),Ve._fromEmailAndCode(e,n.code,n.tenantId)}}$e.PROVIDER_ID="password",$e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",$e.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Je{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Xe extends Je{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ze extends Xe{constructor(){super("facebook.com")}static credential(e){return We._fromParams({providerId:Ze.PROVIDER_ID,signInMethod:Ze.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ze.credentialFromTaggedObject(e)}static credentialFromError(e){return Ze.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ze.credential(t.oauthAccessToken)}catch(n){return null}}}Ze.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ze.PROVIDER_ID="facebook.com";class et extends Xe{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return We._fromParams({providerId:et.PROVIDER_ID,signInMethod:et.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return et.credentialFromTaggedObject(e)}static credentialFromError(e){return et.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return et.credential(n,r)}catch(a){return null}}}et.GOOGLE_SIGN_IN_METHOD="google.com",et.PROVIDER_ID="google.com";class tt extends Xe{constructor(){super("github.com")}static credential(e){return We._fromParams({providerId:tt.PROVIDER_ID,signInMethod:tt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tt.credentialFromTaggedObject(e)}static credentialFromError(e){return tt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return tt.credential(t.oauthAccessToken)}catch(n){return null}}}tt.GITHUB_SIGN_IN_METHOD="github.com",tt.PROVIDER_ID="github.com";class nt extends Xe{constructor(){super("twitter.com")}static credential(e,t){return We._fromParams({providerId:nt.PROVIDER_ID,signInMethod:nt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return nt.credentialFromTaggedObject(e)}static credentialFromError(e){return nt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return nt.credential(n,r)}catch(a){return null}}}nt.TWITTER_SIGN_IN_METHOD="twitter.com",nt.PROVIDER_ID="twitter.com";class rt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await ae._fromIdTokenResponse(e,n,r),s=at(n);return new rt({user:a,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=at(n);return new rt({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function at(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class st extends i.g{constructor(e,t,n,r){var a;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,st.prototype),this.customData={appName:e.name,tenantId:null!==(a=e.tenantId)&&void 0!==a?a:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new st(e,t,n,r)}}function it(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw st._fromErrorAndOperation(e,n,t,r);throw n})}async function ot(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await J(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return rt._forOperation(e,"link",r)}async function lt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if((0,s.xZ)(r.app))return Promise.reject(b(r));const a="reauthenticate";try{const s=await J(e,it(r,a,t,e),n);N(s.idToken,r,"internal-error");const i=Y(s.idToken);N(i,r,"internal-error");const{sub:o}=i;return N(e.uid===o,r,"user-mismatch"),rt._forOperation(e,a,s)}catch(i){throw(null===i||void 0===i?void 0:i.code)==="auth/".concat("user-not-found")&&y(r,"user-mismatch"),i}}async function ct(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,s.xZ)(e.app))return Promise.reject(b(e));const r="signIn",a=await it(e,r,t),i=await rt._fromIdTokenResponse(e,r,a);return n||await e._updateCurrentUser(i.user),i}function dt(e,t,n,r){return(0,i.Ku)(e).onAuthStateChanged(t,n,r)}function ut(e){return(0,i.Ku)(e).signOut()}function ht(e,t){return M(e,"POST","/v2/accounts/mfaEnrollment:start",R(e,t))}new WeakMap;const mt="__sak";class pt{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(mt,"1"),this.storage.removeItem(mt),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class ft extends pt{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=be(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);(0,i.lT)()&&10===document.documentMode&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ft.type="LOCAL";const gt=ft;function yt(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=RegExp("".concat(r,"=([^;]+)"));return null!==(t=null===(n=document.cookie.match(a))||void 0===n?void 0:n[1])&&void 0!==t?t:null}function xt(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class vt{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=xt(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return yt(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=xt(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=xt(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=yt(n);const a=setInterval(()=>{const e=yt(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(a))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}vt.type="COOKIE";class bt extends pt{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}bt.type="SESSION";const wt=bt;class jt{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new jt(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:a}=t.data,s=this.handlersMap[r];if(null===s||void 0===s||!s.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const i=Array.from(s).map(async e=>e(t.origin,a)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(i);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Nt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}jt.receivers=[];class _t{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,s;return new Promise((i,o)=>{const l=Nt("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),a=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),i(t.data.response);break;default:clearTimeout(c),clearTimeout(a),o(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function St(){return window}function kt(){return"undefined"!==typeof St().WorkerGlobalScope&&"function"===typeof St().importScripts}const Et="firebaseLocalStorageDb",At="firebaseLocalStorage",Ct="fbase_key";class Dt{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Tt(e,t){return e.transaction([At],t?"readwrite":"readonly").objectStore(At)}function Ot(){const e=indexedDB.open(Et,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(At,{keyPath:Ct})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(At)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Et);return new Dt(e).toPromise()}(),t(await Ot()))})})}async function Pt(e,t,n){const r=Tt(e,!0).put({[Ct]:t,value:n});return new Dt(r).toPromise()}function It(e,t){const n=Tt(e,!0).delete(t);return new Dt(n).toPromise()}class Rt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Ot()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return kt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jt._getInstance(kt()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){var e;if(null===(e=navigator)||void 0===e||!e.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new _t(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&null!==(e=n[0])&&void 0!==e&&e.fulfilled&&null!==(t=n[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=navigator)||void 0===e||null===(e=e.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ot();return await Pt(e,mt,"1"),await It(e,mt),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Pt(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Tt(e,!1).get(t),r=await new Dt(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>It(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Tt(e,!1).getAll();return new Dt(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:a}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Rt.type="LOCAL";const Mt=Rt;function Lt(e,t){return M(e,"POST","/v2/accounts/mfaSignIn:start",R(e,t))}Ce("rcb"),new C(3e4,6e4);const Ft="recaptcha";async function Ut(e,t,n){if(!e._getRecaptchaConfig())try{await Me(e)}catch(a){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let a;if(a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){N("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=Re(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Oe){N((null===n||void 0===n?void 0:n.type)===Ft,e,"argument-error");return ht(e,await Bt(e,t,n))}return ht(e,t)},"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{var r;N("signin"===t.type,e,"internal-error");const s=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;N(s,e,"missing-multi-factor-info");const i={mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=Re(e,i,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Oe){N((null===n||void 0===n?void 0:n.type)===Ft,e,"argument-error");return Lt(e,await Bt(e,t,n))}return Lt(e,t)},"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=Re(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Oe){N((null===n||void 0===n?void 0:n.type)===Ft,e,"argument-error");return Ge(e,await Bt(e,t,n))}return Ge(e,t)},"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Bt(e,t,n){N(n.type===Ft,e,"argument-error");const r=await n.verify();N("string"===typeof r,e,"argument-error");const s=(0,a.A)({},t);if("phoneEnrollmentInfo"in s){const e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.captchaResponse,n=s.phoneEnrollmentInfo.clientType,a=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:a}}),s}if("phoneSignInInfo"in s){const e=s.phoneSignInInfo.captchaResponse,t=s.phoneSignInInfo.clientType,n=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),s}return Object.assign(s,{recaptchaToken:r}),s}class zt{constructor(e){this.providerId=zt.PROVIDER_ID,this.auth=Se(e)}verifyPhoneNumber(e,t){return Ut(this.auth,e,(0,i.Ku)(t))}static credential(e,t){return Qe._fromVerification(e,t)}static credentialFromResult(e){const t=e;return zt.credentialFromTaggedObject(t)}static credentialFromError(e){return zt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Qe._fromTokenResponse(n,r):null}}function qt(e,t){return t?ie(t):(N(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}zt.PROVIDER_ID="phone",zt.PHONE_SIGN_IN_METHOD="phone";class Vt extends Be{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return He(e,this._buildIdpRequest())}_linkToIdToken(e,t){return He(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return He(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ht(e){return ct(e.auth,new Vt(e),e.bypassAuthState)}function Wt(e){const{auth:t,user:n}=e;return N(n,t,"internal-error"),lt(n,new Vt(e),e.bypassAuthState)}async function Gt(e){const{auth:t,user:n}=e;return N(n,t,"internal-error"),ot(n,new Vt(e),e.bypassAuthState)}class Kt{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:a,error:s,type:i}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ht;case"linkViaPopup":case"linkViaRedirect":return Gt;case"reauthViaPopup":case"reauthViaRedirect":return Wt;default:y(this.auth,"internal-error")}}resolve(e){S(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){S(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Qt=new C(2e3,1e4);async function Yt(e,t,n){if((0,s.xZ)(e.app))return Promise.reject(x(e,"operation-not-supported-in-this-environment"));const r=Se(e);w(e,t,Je);const a=qt(r,n);return new $t(r,"signInViaPopup",t,a).executeNotNull()}class $t extends Kt{constructor(e,t,n,r,a){super(e,t,r,a),this.provider=n,this.authWindow=null,this.pollId=null,$t.currentPopupAction&&$t.currentPopupAction.cancel(),$t.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return N(e,this.auth,"internal-error"),e}async onExecution(){S(1===this.filter.length,"Popup operations only handle one event");const e=Nt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(x(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(x(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$t.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t;null!==(t=this.authWindow)&&void 0!==t&&null!==(t=t.window)&&void 0!==t&&t.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(x(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Qt.get())};e()}}$t.currentPopupAction=null;const Jt=new Map;class Xt extends Kt{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Jt.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=tn(t),r=en(e);if(!await r._isAvailable())return!1;const a="true"===await r._get(n);return await r._remove(n),a}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Jt.set(this.auth._key(),e)}return this.bypassAuthState||Jt.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Zt(e,t){Jt.set(e._key(),t)}function en(e){return ie(e._redirectPersistence)}function tn(e){return ce("pendingRedirect",e.config.apiKey,e.name)}async function nn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,s.xZ)(e.app))return Promise.reject(b(e));const r=Se(e),a=qt(r,t),i=new Xt(r,a,n),o=await i.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class rn{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sn(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!sn(e)){var n;const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(x(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(an(e))}saveEventToCache(e){this.cachedEventUids.add(an(e)),this.lastProcessedEventTime=Date.now()}}function an(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function sn(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const on=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ln=/^https?/;async function cn(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return M(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(dn(r))return}catch(n){}y(e,"unauthorized-domain")}function dn(e){const t=k(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===r}if(!ln.test(n))return!1;if(on.test(e))return r===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const un=new C(3e4,6e4);function hn(){const e=St().___jsl;if(null!==e&&void 0!==e&&e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function mn(e){return new Promise((t,n)=>{var r,a;function s(){hn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{hn(),n(x(e,"network-request-failed"))},timeout:un.get()})}if(null!==(r=St().gapi)&&void 0!==r&&null!==(r=r.iframes)&&void 0!==r&&r.Iframe)t(gapi.iframes.getContext());else{if(null===(a=St().gapi)||void 0===a||!a.load){const t=Ce("iframefcb");return St()[t]=()=>{gapi.load?s():n(x(e,"network-request-failed"))},Ae("".concat(Ee.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}s()}}).catch(e=>{throw pn=null,e})}let pn=null;const fn=new C(5e3,15e3),gn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xn(e){const t=e.config;N(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?D(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:s.MF},a=yn.get(e.config.apiHost);a&&(r.eid=a);const o=e._getFrameworks();return o.length&&(r.fw=o.join(",")),"".concat(n,"?").concat((0,i.Am)(r).slice(1))}async function vn(e){const t=await function(e){return pn=pn||mn(e),pn}(e),n=St().gapi;return N(n,e,"internal-error"),t.open({where:document.body,url:xn(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gn,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const a=x(e,"network-request-failed"),s=St().setTimeout(()=>{r(a)},fn.get());function i(){St().clearTimeout(s),n(t)}t.ping(i).then(i,()=>{r(a)})}))}const bn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class wn{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function jn(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const d=(0,a.A)((0,a.A)({},bn),{},{width:r.toString(),height:s.toString(),top:o,left:l}),u=(0,i.ZQ)().toLowerCase();n&&(c=pe(u)?"_blank":n),he(u)&&(t=t||"http://localhost",d.scrollbars="yes");const h=Object.entries(d).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return ve(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)())&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(u)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new wn(null);const m=window.open(t||"",c,h);N(m,e,"popup-blocked");try{m.focus()}catch(p){}return new wn(m)}const Nn="__/auth/handler",_n="emulator/auth/handler",Sn=encodeURIComponent("fac");async function kn(e,t,n,r,a,o){N(e.config.authDomain,e,"auth-domain-config-required"),N(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:s.MF,eventId:a};if(t instanceof Je){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,i.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))l[e]=t}if(t instanceof Xe){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const s of Object.keys(c))void 0===c[s]&&delete c[s];const d=await e._getAppCheckToken(),u=d?"#".concat(Sn,"=").concat(encodeURIComponent(d)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Nn);return D(t,_n)}(e),"?").concat((0,i.Am)(c).slice(1)).concat(u)}const En="webStorageSupport";const An=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wt,this._completeRedirectFn=nn,this._overrideRedirectResult=Zt}async _openPopup(e,t,n,r){var a;S(null===(a=this.eventManagers[e._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return jn(e,await kn(e,t,n,k(),r),Nt())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){St().location.href=e}(await kn(e,t,n,k(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(S(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await vn(e),n=new rn(e);return t.register("authEvent",t=>{N(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(En,{type:En},n=>{var r;const a=null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r[En];void 0!==a&&t(!!a),y(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=cn(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return be()||me()||ve()}};var Cn="@firebase/auth",Dn="1.11.1";class Tn{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){N(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const On=(0,i.XA)("authIdTokenMaxAge")||300;let Pn=null;const In=e=>async t=>{const n=t&&await t.getIdTokenResult(),r=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>On)return;const a=null===n||void 0===n?void 0:n.token;Pn!==a&&(Pn=a,await fetch(e,{method:a?"POST":"DELETE",headers:a?{Authorization:"Bearer ".concat(a)}:{}}))};function Rn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.Sx)();const t=(0,s.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,s.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,i.bD)(r,null!==t&&void 0!==t?t:{}))return e;y(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:An,persistence:[Mt,gt,wt]}),r=(0,i.XA)("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=In(e.toString());!function(e,t,n){(0,i.Ku)(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){(0,i.Ku)(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}const a=(0,i.Tj)("auth");return a&&Le(n,"http://".concat(a)),n}var Mn;Ee={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=x("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Mn="Browser",(0,s.om)(new l.uA("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=r.options;N(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:i,authDomain:o,clientPlatform:Mn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:we(Mn)},c=new _e(r,a,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ie);null!==t&&void 0!==t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,s.om)(new l.uA("auth-internal",e=>(e=>new Tn(e))(Se(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,s.KO)(Cn,Dn,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Mn)),(0,s.KO)(Cn,Dn,"esm2020")},4208:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.uniqBy=function(e,t){const n=new Map;for(let r=0;r<e.length;r++){const a=e[r],s=t(a);n.has(s)||n.set(s,a)}return Array.from(n.values())}},4288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,y={};function x(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||f}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||f}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=x.prototype;var w=b.prototype=new v;w.constructor=b,g(w,x.prototype),w.isPureReactComponent=!0;var j=Array.isArray;function N(){}var _={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function k(e,t,r){var a=r.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==a?a:null,props:r}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function D(e,t,a,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,d=!1;if(null===e)d=!0;else switch(o){case"bigint":case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case n:case r:d=!0;break;case h:return D((d=e._init)(e._payload),t,a,s,i)}}if(d)return i=i(e),d=""===s?"."+C(e,0):s,j(i)?(a="",null!=d&&(a=d.replace(A,"$&/")+"/"),D(i,t,a,"",function(e){return e})):null!=i&&(E(i)&&(l=i,c=a+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(A,"$&/")+"/")+d,i=k(l.type,c,l.props)),t.push(i)),1;d=0;var u,m=""===s?".":s+":";if(j(e))for(var f=0;f<e.length;f++)d+=D(s=e[f],t,a,o=m+C(s,f),i);else if("function"===typeof(f=null===(u=e)||"object"!==typeof u?null:"function"===typeof(u=p&&u[p]||u["@@iterator"])?u:null))for(e=f.call(e),f=0;!(s=e.next()).done;)d+=D(s=s.value,t,a,o=m+C(s,f++),i);else if("object"===o){if("function"===typeof e.then)return D(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(N,N):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,a,s,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return d}function T(e,t,n){if(null==e)return e;var r=[],a=0;return D(e,r,"","",function(e){return t.call(n,e,a++)}),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},I={map:T,forEach:function(e,t,n){T(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return T(e,function(){t++}),t},toArray:function(e){return T(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=m,t.Children=I,t.Component=x,t.Fragment=a,t.Profiler=i,t.PureComponent=b,t.StrictMode=s,t.Suspense=d,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return _.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),a=e.key;if(null!=t)for(s in void 0!==t.key&&(a=""+t.key),t)!S.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(r[s]=t[s]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var i=Array(s),o=0;o<s;o++)i[o]=arguments[o+2];r.children=i}return k(e.type,a,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var r,a={},s=null;if(null!=t)for(r in void 0!==t.key&&(s=""+t.key),t)S.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(a[r]=t[r]);var i=arguments.length-2;if(1===i)a.children=n;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];a.children=o}if(e&&e.defaultProps)for(r in i=e.defaultProps)void 0===a[r]&&(a[r]=i[r]);return k(e,s,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=_.T,n={};_.T=n;try{var r=e(),a=_.S;null!==a&&a(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(N,P)}catch(s){P(s)}finally{null!==t&&null!==n.types&&(t.types=n.types),_.T=t}},t.unstable_useCacheRefresh=function(){return _.H.useCacheRefresh()},t.use=function(e){return _.H.use(e)},t.useActionState=function(e,t,n){return _.H.useActionState(e,t,n)},t.useCallback=function(e,t){return _.H.useCallback(e,t)},t.useContext=function(e){return _.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return _.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return _.H.useEffect(e,t)},t.useEffectEvent=function(e){return _.H.useEffectEvent(e)},t.useId=function(){return _.H.useId()},t.useImperativeHandle=function(e,t,n){return _.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return _.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return _.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return _.H.useMemo(e,t)},t.useOptimistic=function(e,t){return _.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return _.H.useReducer(e,t,n)},t.useRef=function(e){return _.H.useRef(e)},t.useState=function(e){return _.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return _.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return _.H.useTransition()},t.version="19.2.0"},4332:(e,t,n)=>{e.exports=n(5053).uniqBy},4391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(7004)},4704:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=/^(?:0|[1-9]\d*)$/;t.isIndex=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return n.test(e)}}},4705:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{A:()=>s})},4803:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isPrimitive=function(e){return null==e||"object"!==typeof e&&"function"!==typeof e}},4830:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.debounce=function(e,t){let n,{signal:r,edges:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=null;const i=null!=a&&a.includes("leading"),o=null==a||a.includes("trailing"),l=()=>{null!==s&&(e.apply(n,s),n=void 0,s=null)};let c=null;const d=()=>{null!=c&&clearTimeout(c),c=setTimeout(()=>{c=null,o&&l(),u()},t)},u=()=>{null!==c&&(clearTimeout(c),c=null),n=void 0,s=null},h=function(){if(null!==r&&void 0!==r&&r.aborted)return;n=this;for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];s=t;const o=null==c;d(),i&&o&&l()};return h.schedule=d,h.cancel=u,h.flush=()=>{l()},null===r||void 0===r||r.addEventListener("abort",u,{once:!0}),h}},4879:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6770);t.toFinite=function(e){if(!e)return 0===e?e:0;if((e=r.toNumber(e))===1/0||e===-1/0){return(e<0?-1:1)*Number.MAX_VALUE}return e===e?e:0}},4974:(e,t,n)=>{"use strict";n.r(t),n.d(t,{phase4Topics:()=>r});const r=[{name:"Project Introduction: AI-Powered Content Generator",order:1,maxTime:null,keyConcepts:["Overview"],description:"Understand the goal: use modern JS (ES6+) and Gemini API to build interactive AI-powered web features.",deliverable:"No video \u2013 intro only",video:null},{name:"Ask Me Anything Feature",order:2,maxTime:null,keyConcepts:["let/const","Arrow Functions","Template Literals","fetch()","Promises"],description:"Build a feature where users type a question and Gemini returns an answer dynamically. Learn event handling, template literals for API queries, and fetch() for asynchronous calls.",deliverable:"1 Video: Demonstrate feature + explain ES6 concepts + Gemini API call.",video:1},{name:"Quick Summarizer Feature",order:3,maxTime:null,keyConcepts:["let/const","Arrow Functions","Template Literals","fetch()","Promises","Destructuring"],description:"Users paste text and receive a concise summary via Gemini. Learn destructuring to extract data from API responses and handle asynchronous results.",deliverable:"1 Video: Show summarizer + ES6 features + API integration.",video:1},{name:"Idea Spark Feature",order:4,maxTime:null,keyConcepts:["let/const","Arrow Functions","Template Literals","fetch()","Promises","Array Methods"],description:"Users request creative ideas (blog topics, stories) from Gemini. Apply array methods to process multiple suggestions if needed.",deliverable:"1 Video: Demo feature + explain applied JS/ES6 concepts and API usage.",video:1},{name:"Definition Finder Feature",order:5,maxTime:null,keyConcepts:["let/const","Arrow Functions","Template Literals","fetch()","Promises"],description:"Users input terms, and Gemini provides definitions. Practice API request construction, fetch() handling, and DOM manipulation.",deliverable:"1 Video: Demo feature + explain ES6/API usage.",video:1},{name:"Mini Projects / Warm-up Exercises",order:6,maxTime:null,keyConcepts:["let/const","Arrow Functions","Template Literals","Destructuring","fetch()","Promises"],description:"AI Joke Generator, Gemini-Powered Quiz Helper, Daily Positive Affirmation Fetcher. Focused practice on ES6 features + API calls.",deliverable:"1 Video per mini-project: Show working demo + explain JS concepts & API integration.",video:3},{name:"Project Wrap-Up & Reflection",order:7,maxTime:null,keyConcepts:["Review All Learned Concepts"],description:"Review ES6 fundamentals (let/const, arrow functions, template literals, destructuring, spread/rest, array methods) and Gemini API integration. Reflect on building a functional, AI-powered web app.",deliverable:"1 Video: Demonstrate final AI content generator + reflect on learning outcomes.",video:1}]},5043:(e,t,n)=>{"use strict";e.exports=n(4288)},5053:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4208),a=n(9599),s=n(2104),i=n(2715);t.uniqBy=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.identity;return s.isArrayLikeObject(e)?r.uniqBy(Array.from(e),i.iteratee(t)):[]}},5082:(e,t)=>{"use strict";var n=60103,r=60106,a=60107,s=60108,i=60114,o=60109,l=60110,c=60112,d=60113,u=60120,h=60115,m=60116,p=60121,f=60122,g=60117,y=60129,x=60131;if("function"===typeof Symbol&&Symbol.for){var v=Symbol.for;n=v("react.element"),r=v("react.portal"),a=v("react.fragment"),s=v("react.strict_mode"),i=v("react.profiler"),o=v("react.provider"),l=v("react.context"),c=v("react.forward_ref"),d=v("react.suspense"),u=v("react.suspense_list"),h=v("react.memo"),m=v("react.lazy"),p=v("react.block"),f=v("react.server.block"),g=v("react.fundamental"),y=v("react.debug_trace_mode"),x=v("react.legacy_hidden")}function b(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case a:case i:case s:case d:case u:return e;default:switch(e=e&&e.$$typeof){case l:case c:case m:case h:case o:return e;default:return t}}case r:return t}}}t.isFragment=function(e){return b(e)===a}},5173:(e,t,n)=>{e.exports=n(1497)()},5261:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6433);t.cloneDeep=function(e){return r.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}},5303:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2489),a=n(4704),s=n(6321),i=n(1444);t.has=function(e,t){let n;if(n=Array.isArray(t)?t:"string"===typeof t&&r.isDeepKey(t)&&null==(null===e||void 0===e?void 0:e[t])?i.toPath(t):[t],0===n.length)return!1;let o=e;for(let r=0;r<n.length;r++){const e=n[r];if(null==o||!Object.hasOwn(o,e)){if(!((Array.isArray(o)||s.isArguments(o))&&a.isIndex(e)&&e<o.length))return!1}o=o[e]}return!0}},5316:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9709),a=n(7043),s=n(1444);t.orderBy=function(e,t,n,i){if(null==e)return[];n=i?void 0:n,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=null==t?[null]:[t]),0===t.length&&(t=[null]),Array.isArray(n)||(n=null==n?[]:[n]),n=n.map(e=>String(e));const o=(e,t)=>{let n=e;for(let r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n},l=t.map(e=>(Array.isArray(e)&&1===e.length&&(e=e[0]),null==e||"function"===typeof e||Array.isArray(e)||a.isKey(e)?e:{key:e,path:s.toPath(e)}));return e.map(e=>({original:e,criteria:l.map(t=>((e,t)=>null==t||null==e?t:"object"===typeof e&&"key"in e?Object.hasOwn(t,e.key)?t[e.key]:o(t,e.path):"function"===typeof e?e(t):Array.isArray(e)?o(t,e):"object"===typeof t?t[e]:t)(t,e))})).slice().sort((e,t)=>{for(let a=0;a<l.length;a++){const s=r.compareValues(e.criteria[a],t.criteria[a],n[a]);if(0!==s)return s}return 0}).map(e=>e.original)}},5414:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(1293);t.throttle=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{leading:a=!0,trailing:s=!0}=n;return r.debounce(e,t,{leading:a,maxWait:t,trailing:s})}},5508:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6433),a=n(7599);t.cloneDeepWith=function(e,t){return r.cloneDeepWith(e,(n,s,i,o)=>{const l=null===t||void 0===t?void 0:t(n,s,i,o);if(void 0!==l)return l;if("object"===typeof e)switch(Object.prototype.toString.call(e)){case a.numberTag:case a.stringTag:case a.booleanTag:{const t=new e.constructor(null===e||void 0===e?void 0:e.valueOf());return r.copyProperties(t,e),t}case a.argumentsTag:{const t={};return r.copyProperties(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}})}},5896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<s(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,i=a>>>1;r<i;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>s(l,n))c<a&&0>s(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>s(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,m=3,p=!1,f=!1,g=!1,y=!1,x="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function j(e){if(g=!1,w(e),!f)if(null!==r(c))f=!0,_||(_=!0,N());else{var t=r(d);null!==t&&O(j,t.startTime-e)}}var N,_=!1,S=-1,k=5,E=-1;function A(){return!!y||!(t.unstable_now()-E<k)}function C(){if(y=!1,_){var e=t.unstable_now();E=e;var n=!0;try{e:{f=!1,g&&(g=!1,v(S),S=-1),p=!0;var s=m;try{t:{for(w(e),h=r(c);null!==h&&!(h.expirationTime>e&&A());){var i=h.callback;if("function"===typeof i){h.callback=null,m=h.priorityLevel;var o=i(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){h.callback=o,w(e),n=!0;break t}h===r(c)&&a(c),w(e)}else a(c);h=r(c)}if(null!==h)n=!0;else{var l=r(d);null!==l&&O(j,l.startTime-e),n=!1}}break e}finally{h=null,m=s,p=!1}n=void 0}}finally{n?N():_=!1}}}if("function"===typeof b)N=function(){b(C)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,T=D.port2;D.port1.onmessage=C,N=function(){T.postMessage(null)}}else N=function(){x(C,0)};function O(e,n){S=x(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},t.unstable_scheduleCallback=function(e,a,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,n(d,e),null===r(c)&&e===r(d)&&(g?(v(S),S=-1):g=!0,O(j,s-i))):(e.sortIndex=o,n(c,e),f||p||(f=!0,_||(_=!0,N()))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}},5990:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getTag=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}},6321:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5990);t.isArguments=function(e){return null!==e&&"object"===typeof e&&"[object Arguments]"===r.getTag(e)}},6392:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.last=function(e){return e[e.length-1]}},6433:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6443),a=n(5990),s=n(7599),i=n(4803),o=n(3757);function l(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const u=null===d||void 0===d?void 0:d(e,t,n,r);if(void 0!==u)return u;if(i.isPrimitive(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){const t=new Array(e.length);r.set(e,t);for(let a=0;a<e.length;a++)t[a]=l(e[a],a,n,r,d);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;r.set(e,t);for(const[a,s]of e)t.set(a,l(s,a,n,r,d));return t}if(e instanceof Set){const t=new Set;r.set(e,t);for(const a of e)t.add(l(a,void 0,n,r,d));return t}if("undefined"!==typeof Buffer&&Buffer.isBuffer(e))return e.subarray();if(o.isTypedArray(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);r.set(e,t);for(let a=0;a<e.length;a++)t[a]=l(e[a],a,n,r,d);return t}if(e instanceof ArrayBuffer||"undefined"!==typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,t),c(t,e,n,r,d),t}if("undefined"!==typeof File&&e instanceof File){const t=new File([e],e.name,{type:e.type});return r.set(e,t),c(t,e,n,r,d),t}if(e instanceof Blob){const t=new Blob([e],{type:e.type});return r.set(e,t),c(t,e,n,r,d),t}if(e instanceof Error){const t=new e.constructor;return r.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,c(t,e,n,r,d),t}if("object"===typeof e&&function(e){switch(a.getTag(e)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return r.set(e,t),c(t,e,n,r,d),t}return e}function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;const i=[...Object.keys(t),...r.getSymbols(t)];for(let r=0;r<i.length;r++){const o=i[r],c=Object.getOwnPropertyDescriptor(e,o);(null==c||c.writable)&&(e[o]=l(t[o],o,n,a,s))}}t.cloneDeepWith=function(e,t){return l(e,void 0,e,new Map,t)},t.cloneDeepWithImpl=l,t.copyProperties=c},6443:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getSymbols=function(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}},6667:(e,t,n)=>{"use strict";n.d(t,{Timestamp:()=>xe,gS:()=>bc,hq:()=>Ac,collection:()=>nl,kd:()=>vc,CL:()=>kc,H9:()=>rl,x7:()=>pc,getDocs:()=>gc,aU:()=>cl,limit:()=>ec,aQ:()=>wc,orderBy:()=>Xl,query:()=>Kl,O5:()=>Ec,BN:()=>yc,startAfter:()=>nc,mZ:()=>xc,_M:()=>Yl,wP:()=>Cc});var r,a,s=n(9379),i=n(9232),o=n(9606),l=n(2965),c=n(1776),d="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},u={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var a=0;a<16;++a)r[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;a<16;++a)r[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];let s,i=e.g[3];s=t+(i^n&(a^i))+r[0]+3614090360&4294967295,s=i+(a^(t=n+(s<<7&4294967295|s>>>25))&(n^a))+r[1]+3905402710&4294967295,i=t+(s<<12&4294967295|s>>>20),s=a+(n^i&(t^n))+r[2]+606105819&4294967295,s=n+(t^(a=i+(s<<17&4294967295|s>>>15))&(i^t))+r[3]+3250441966&4294967295,s=t+(i^(n=a+(s<<22&4294967295|s>>>10))&(a^i))+r[4]+4118548399&4294967295,s=i+(a^(t=n+(s<<7&4294967295|s>>>25))&(n^a))+r[5]+1200080426&4294967295,i=t+(s<<12&4294967295|s>>>20),s=a+(n^i&(t^n))+r[6]+2821735955&4294967295,s=n+(t^(a=i+(s<<17&4294967295|s>>>15))&(i^t))+r[7]+4249261313&4294967295,s=t+(i^(n=a+(s<<22&4294967295|s>>>10))&(a^i))+r[8]+1770035416&4294967295,s=i+(a^(t=n+(s<<7&4294967295|s>>>25))&(n^a))+r[9]+2336552879&4294967295,i=t+(s<<12&4294967295|s>>>20),s=a+(n^i&(t^n))+r[10]+4294925233&4294967295,s=n+(t^(a=i+(s<<17&4294967295|s>>>15))&(i^t))+r[11]+2304563134&4294967295,s=t+(i^(n=a+(s<<22&4294967295|s>>>10))&(a^i))+r[12]+1804603682&4294967295,s=i+(a^(t=n+(s<<7&4294967295|s>>>25))&(n^a))+r[13]+4254626195&4294967295,i=t+(s<<12&4294967295|s>>>20),s=a+(n^i&(t^n))+r[14]+2792965006&4294967295,s=n+(t^(a=i+(s<<17&4294967295|s>>>15))&(i^t))+r[15]+1236535329&4294967295,s=t+(a^i&((n=a+(s<<22&4294967295|s>>>10))^a))+r[1]+4129170786&4294967295,s=i+(n^a&((t=n+(s<<5&4294967295|s>>>27))^n))+r[6]+3225465664&4294967295,i=t+(s<<9&4294967295|s>>>23),s=a+(t^n&(i^t))+r[11]+643717713&4294967295,s=n+(i^t&((a=i+(s<<14&4294967295|s>>>18))^i))+r[0]+3921069994&4294967295,s=t+(a^i&((n=a+(s<<20&4294967295|s>>>12))^a))+r[5]+3593408605&4294967295,s=i+(n^a&((t=n+(s<<5&4294967295|s>>>27))^n))+r[10]+38016083&4294967295,i=t+(s<<9&4294967295|s>>>23),s=a+(t^n&(i^t))+r[15]+3634488961&4294967295,s=n+(i^t&((a=i+(s<<14&4294967295|s>>>18))^i))+r[4]+3889429448&4294967295,s=t+(a^i&((n=a+(s<<20&4294967295|s>>>12))^a))+r[9]+568446438&4294967295,s=i+(n^a&((t=n+(s<<5&4294967295|s>>>27))^n))+r[14]+3275163606&4294967295,i=t+(s<<9&4294967295|s>>>23),s=a+(t^n&(i^t))+r[3]+4107603335&4294967295,s=n+(i^t&((a=i+(s<<14&4294967295|s>>>18))^i))+r[8]+1163531501&4294967295,s=t+(a^i&((n=a+(s<<20&4294967295|s>>>12))^a))+r[13]+2850285829&4294967295,s=i+(n^a&((t=n+(s<<5&4294967295|s>>>27))^n))+r[2]+4243563512&4294967295,i=t+(s<<9&4294967295|s>>>23),s=a+(t^n&(i^t))+r[7]+1735328473&4294967295,s=n+(i^t&((a=i+(s<<14&4294967295|s>>>18))^i))+r[12]+2368359562&4294967295,s=t+((n=a+(s<<20&4294967295|s>>>12))^a^i)+r[5]+4294588738&4294967295,s=i+((t=n+(s<<4&4294967295|s>>>28))^n^a)+r[8]+2272392833&4294967295,i=t+(s<<11&4294967295|s>>>21),s=a+(i^t^n)+r[11]+1839030562&4294967295,s=n+((a=i+(s<<16&4294967295|s>>>16))^i^t)+r[14]+4259657740&4294967295,s=t+((n=a+(s<<23&4294967295|s>>>9))^a^i)+r[1]+2763975236&4294967295,s=i+((t=n+(s<<4&4294967295|s>>>28))^n^a)+r[4]+1272893353&4294967295,i=t+(s<<11&4294967295|s>>>21),s=a+(i^t^n)+r[7]+4139469664&4294967295,s=n+((a=i+(s<<16&4294967295|s>>>16))^i^t)+r[10]+3200236656&4294967295,s=t+((n=a+(s<<23&4294967295|s>>>9))^a^i)+r[13]+681279174&4294967295,s=i+((t=n+(s<<4&4294967295|s>>>28))^n^a)+r[0]+3936430074&4294967295,i=t+(s<<11&4294967295|s>>>21),s=a+(i^t^n)+r[3]+3572445317&4294967295,s=n+((a=i+(s<<16&4294967295|s>>>16))^i^t)+r[6]+76029189&4294967295,s=t+((n=a+(s<<23&4294967295|s>>>9))^a^i)+r[9]+3654602809&4294967295,s=i+((t=n+(s<<4&4294967295|s>>>28))^n^a)+r[12]+3873151461&4294967295,i=t+(s<<11&4294967295|s>>>21),s=a+(i^t^n)+r[15]+530742520&4294967295,s=n+((a=i+(s<<16&4294967295|s>>>16))^i^t)+r[2]+3299628645&4294967295,s=t+(a^((n=a+(s<<23&4294967295|s>>>9))|~i))+r[0]+4096336452&4294967295,s=i+(n^((t=n+(s<<6&4294967295|s>>>26))|~a))+r[7]+1126891415&4294967295,i=t+(s<<10&4294967295|s>>>22),s=a+(t^(i|~n))+r[14]+2878612391&4294967295,s=n+(i^((a=i+(s<<15&4294967295|s>>>17))|~t))+r[5]+4237533241&4294967295,s=t+(a^((n=a+(s<<21&4294967295|s>>>11))|~i))+r[12]+1700485571&4294967295,s=i+(n^((t=n+(s<<6&4294967295|s>>>26))|~a))+r[3]+2399980690&4294967295,i=t+(s<<10&4294967295|s>>>22),s=a+(t^(i|~n))+r[10]+4293915773&4294967295,s=n+(i^((a=i+(s<<15&4294967295|s>>>17))|~t))+r[1]+2240044497&4294967295,s=t+(a^((n=a+(s<<21&4294967295|s>>>11))|~i))+r[8]+1873313359&4294967295,s=i+(n^((t=n+(s<<6&4294967295|s>>>26))|~a))+r[15]+4264355552&4294967295,i=t+(s<<10&4294967295|s>>>22),s=a+(t^(i|~n))+r[6]+2734768916&4294967295,s=n+(i^((a=i+(s<<15&4294967295|s>>>17))|~t))+r[13]+1309151649&4294967295,s=t+(a^((n=a+(s<<21&4294967295|s>>>11))|~i))+r[4]+4149444226&4294967295,s=i+(n^((t=n+(s<<6&4294967295|s>>>26))|~a))+r[11]+3174756917&4294967295,i=t+(s<<10&4294967295|s>>>22),s=a+(t^(i|~n))+r[2]+718787259&4294967295,s=n+(i^((a=i+(s<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+i&4294967295}function s(e,t){this.h=t;const n=[];let r=!0;for(let a=e.length-1;a>=0;a--){const s=0|e[a];r&&s==t||(n[a]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var a=Array(arguments.length-2),s=2;s<arguments.length;s++)a[s-2]=arguments[s];return t.prototype[n].apply(e,a)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,a=this.C;let s=this.h,i=0;for(;i<t;){if(0==s)for(;i<=r;)n(this,e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(a[s++]=e.charCodeAt(i++),s==this.blockSize){n(this,a),s=0;break}}else for(;i<t;)if(a[s++]=e[i++],s==this.blockSize){n(this,a),s=0;break}}this.h=s,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var i={};function o(e){return-128<=e&&e<128?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new s([0|e],e<0?-1:0)}):new s([0|e],e<0?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return c;if(e<0)return f(l(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new s(t,0)}var c=o(0),d=o(1),h=o(16777216);function m(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return-1==e.h}function f(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new s(n,~e.h).add(d)}function g(e,t){return e.add(f(t))}function y(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function x(e,t){this.g=e,this.h=t}function v(e,t){if(m(t))throw Error("division by zero");if(m(e))return new x(c,c);if(p(e))return t=v(f(e),t),new x(f(t.g),f(t.h));if(p(t))return t=v(e,f(t)),new x(f(t.g),t.h);if(e.g.length>30){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var n=d,r=t;r.l(e)<=0;)n=b(n),r=b(r);var a=w(n,1),s=w(r,1);for(r=w(r,2),n=w(n,2);!m(r);){var i=s.add(r);i.l(e)<=0&&(a=a.add(n),s=i),r=w(r,1),n=w(n,1)}return t=g(e,a.j(t)),new x(a,t)}for(a=c;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),i=(s=l(n)).j(t);p(i)||i.l(e)>0;)i=(s=l(n-=r)).j(t);m(s)&&(s=d),a=a.add(s),e=g(e,i)}return new x(a,e)}function b(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new s(n,e.h)}function w(e,t){const n=t>>5;t%=32;const r=e.g.length-n,a=[];for(let s=0;s<r;s++)a[s]=t>0?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new s(a,e.h)}(e=s.prototype).m=function(){if(p(this))return-f(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(m(this))return"0";if(p(this))return"-"+f(this).toString(e);const t=l(Math.pow(e,6));var n=this;let r="";for(;;){const a=v(n,t).g;let s=(((n=g(n,a.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(m(n=a))return s+r;for(;s.length<6;)s="0"+s;r=s+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return p(e=g(this,e))?-1:m(e)?0:1},e.abs=function(){return p(this)?f(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let r=0;for(let a=0;a<=t;a++){let t=r+(65535&this.i(a))+(65535&e.i(a)),s=(t>>>16)+(this.i(a)>>>16)+(e.i(a)>>>16);r=s>>>16,t&=65535,s&=65535,n[a]=s<<16|t}return new s(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(m(this)||m(e))return c;if(p(this))return p(e)?f(this).j(f(e)):f(f(this).j(e));if(p(e))return f(this.j(f(e)));if(this.l(h)<0&&e.l(h)<0)return l(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(let t=0;t<e.g.length;t++){const a=this.i(r)>>>16,s=65535&this.i(r),i=e.i(t)>>>16,o=65535&e.i(t);n[2*r+2*t]+=s*o,y(n,2*r+2*t),n[2*r+2*t+1]+=a*o,y(n,2*r+2*t+1),n[2*r+2*t+1]+=s*i,y(n,2*r+2*t+1),n[2*r+2*t+2]+=a*i,y(n,2*r+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new s(n,0)},e.B=function(e){return v(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new s(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new s(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new s(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,a=u.Md5=t,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return f(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=l(Math.pow(n,8));let a=c;for(let i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i);const e=parseInt(t.substring(i,i+s),n);s<8?(s=l(Math.pow(n,s)),a=a.j(s).add(l(e))):(a=a.j(r),a=a.add(l(e)))}return a},r=u.Integer=s}).apply("undefined"!==typeof d?d:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var h,m,p,f,g,y,x,v,b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},w={};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof b&&b];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var a=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var i=e[s];if(!(i in a))break e;a=a[i]}(r=r(s=a[e=e[e.length-1]]))!=s&&null!=r&&t(a,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var a=a||{},s=this||self;function i(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return(l=o).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var a=Array(arguments.length-2),s=2;s<arguments.length;s++)a[s-2]=arguments[s];return t.prototype[n].apply(e,a)}}var u="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function j(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function _(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let a=0;a<r;a++)e[n+a]=t[a]}else e.push(t)}}function S(e){s.setTimeout(()=>{throw e},0)}function k(){var e=T;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var E=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new A,e=>e.reset());class A{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let C,D=!1,T=new class{constructor(){this.h=this.g=null}add(e,t){const n=E.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},O=()=>{const e=Promise.resolve(void 0);C=()=>{e.then(P)}};function P(){for(var e;e=k();){try{e.h.call(e.g)}catch(n){S(n)}var t=E;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}D=!1}function I(){this.u=this.u,this.C=this.C}function R(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},R.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function L(e){return/^[\s\xa0]*$/.test(e)}function F(e,t){R.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}d(F,R),F.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&F.Z.h.call(this)},F.prototype.h=function(){F.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var U="closure_listenable_"+(1e6*Math.random()|0),B=0;function z(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=a,this.key=++B,this.da=this.fa=!1}function q(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function V(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function H(e){const t={};for(const n in e)t[n]=e[n];return t}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function G(e,t){let n,r;for(let a=1;a<arguments.length;a++){for(n in r=arguments[a],r)e[n]=r[n];for(let t=0;t<W.length;t++)n=W[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function K(e){this.src=e,this.g={},this.h=0}function Q(e,t){const n=t.type;if(n in e.g){var r,a=e.g[n],s=Array.prototype.indexOf.call(a,t,void 0);(r=s>=0)&&Array.prototype.splice.call(a,s,1),r&&(q(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Y(e,t,n,r){for(let a=0;a<e.length;++a){const s=e[a];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return a}return-1}K.prototype.add=function(e,t,n,r,a){const s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);const i=Y(e,t,r,a);return i>-1?(t=e[i],n||(t.fa=!1)):((t=new z(t,this.src,s,!!r,a)).fa=n,e.push(t)),t};var $="closure_lm_"+(1e6*Math.random()|0),J={};function X(e,t,n,r,a){if(r&&r.once)return ee(e,t,n,r,a);if(Array.isArray(t)){for(let s=0;s<t.length;s++)X(e,t[s],n,r,a);return null}return n=le(n),e&&e[U]?e.J(t,n,i(r)?!!r.capture:!!r,a):Z(e,t,n,!1,r,a)}function Z(e,t,n,r,a,s){if(!t)throw Error("Invalid event type");const o=i(a)?!!a.capture:!!a;let l=ie(e);if(l||(e[$]=l=new K(e)),(n=l.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=se;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)M||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(ae(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ee(e,t,n,r,a){if(Array.isArray(t)){for(let s=0;s<t.length;s++)ee(e,t[s],n,r,a);return null}return n=le(n),e&&e[U]?e.K(t,n,i(r)?!!r.capture:!!r,a):Z(e,t,n,!0,r,a)}function ne(e,t,n,r,a){if(Array.isArray(t))for(var s=0;s<t.length;s++)ne(e,t[s],n,r,a);else r=i(r)?!!r.capture:!!r,n=le(n),e&&e[U]?(e=e.i,(s=String(t).toString())in e.g&&((n=Y(t=e.g[s],n,r,a))>-1&&(q(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[s],e.h--)))):e&&(e=ie(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Y(t,n,r,a)),(n=e>-1?t[e]:null)&&re(n))}function re(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[U])Q(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ae(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ie(t))?(Q(n,e),0==n.h&&(n.src=null,t[$]=null)):q(e)}}}function ae(e){return e in J?J[e]:J[e]="on"+e}function se(e,t){if(e.da)e=!0;else{t=new F(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&re(e),e=n.call(r,t)}return e}function ie(e){return(e=e[$])instanceof K?e:null}var oe="__closure_events_fn_"+(1e9*Math.random()>>>0);function le(e){return"function"===typeof e?e:(e[oe]||(e[oe]=function(t){return e.handleEvent(t)}),e[oe])}function ce(){I.call(this),this.i=new K(this),this.M=this,this.G=null}function de(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new R(t,e);else if(t instanceof R)t.target=t.target||e;else{var a=t;G(t=new R(r,e),a)}let s,i;if(a=!0,n)for(i=n.length-1;i>=0;i--)s=t.g=n[i],a=ue(s,r,!0,t)&&a;if(s=t.g=e,a=ue(s,r,!0,t)&&a,a=ue(s,r,!1,t)&&a,n)for(i=0;i<n.length;i++)s=t.g=n[i],a=ue(s,r,!1,t)&&a}function ue(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let a=!0;for(let s=0;s<t.length;++s){const i=t[s];if(i&&!i.da&&i.capture==n){const t=i.listener,n=i.ha||i.src;i.fa&&Q(e.i,i),a=!1!==t.call(n,r)&&a}}return a&&!r.defaultPrevented}function he(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return Number(t)>2147483647?-1:s.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,he(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ce,I),ce.prototype[U]=!0,ce.prototype.removeEventListener=function(e,t,n,r){ne(this,e,t,n,r)},ce.prototype.N=function(){if(ce.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)q(n[e]);delete e.g[t],e.h--}}this.G=null},ce.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ce.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class me extends I{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:he(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pe(e){I.call(this),this.h=e,this.g={}}d(pe,I);var fe=[];function ge(e){V(e.g,function(e,t){this.g.hasOwnProperty(t)&&re(e)},e),e.g={}}pe.prototype.N=function(){pe.Z.N.call(this),ge(this)},pe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=s.JSON.stringify,xe=s.JSON.parse,ve=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function be(){}function we(){}var je={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ne(){R.call(this,"d")}function _e(){R.call(this,"c")}d(Ne,R),d(_e,R);var Se={},ke=null;function Ee(){return ke=ke||new ce}function Ae(e){R.call(this,Se.Ia,e)}function Ce(e){const t=Ee();de(t,new Ae(t))}function De(e,t){R.call(this,Se.STAT_EVENT,e),this.stat=t}function Te(e){const t=Ee();de(t,new De(t,e))}function Oe(e,t){R.call(this,Se.Ja,e),this.size=t}function Pe(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){e()},t)}function Ie(){this.g=!0}function Re(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const s=JSON.parse(t);if(s)for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var n=s[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var a=r[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(let e=1;e<r.length;e++)r[e]=""}}}return ye(s)}catch(s){return t}}(e,n)+(r?" "+r:"")})}Se.Ia="serverreachability",d(Ae,R),Se.STAT_EVENT="statevent",d(De,R),Se.Ja="timingevent",d(Oe,R),Ie.prototype.ua=function(){this.g=!1},Ie.prototype.info=function(){};var Me,Le={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Fe={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Ue(){}function Be(e){return encodeURIComponent(String(e))}function ze(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function qe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new pe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ve}function Ve(){this.i=null,this.g="",this.h=!1}d(Ue,be),Ue.prototype.g=function(){return new XMLHttpRequest},Me=new Ue;var He={},We={};function Ge(e,t,n){e.M=1,e.A=yt(ht(t)),e.u=n,e.R=!0,Ke(e,null)}function Ke(e,t){e.F=Date.now(),$e(e),e.B=ht(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),Tt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Ve,e.g=xn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new me(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var a="readystatechange";Array.isArray(a)||(a&&(fe[0]=a.toString()),a=fe);for(let s=0;s<a.length;s++){const e=X(n,a[s],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?H(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),Ce(),function(e,t,n,r,a,s){e.info(function(){if(e.g)if(s){var i="",o=s.split("&");for(let e=0;e<o.length;e++){var l=o[e].split("=");if(l.length>1){const e=l[0];l=l[1];const t=e.split("_");i=t.length>=2&&"type"==t[1]?i+(e+"=")+l+"&":i+(e+"=redacted&")}}}else i=null;else i=s;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+i})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Qe(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Ye(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?We:(n=Number(t.substring(n,r)),isNaN(n)?He:(r+=1)+n>t.length?We:(t=t.slice(r,r+n),e.C=r+n,t))}function $e(e){e.T=Date.now()+e.H,Je(e,e.H)}function Je(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=Pe(l(e.aa,e),t)}function Xe(e){e.D&&(s.clearTimeout(e.D),e.D=null)}function Ze(e){0==e.j.I||e.K||mn(e.j,e)}function et(e){Xe(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ge(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function tt(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||it(n.h,e)))if(!e.L&&it(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(d){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;hn(n),tn(n)}cn(n),Te(18)}}else n.xa=a[1],0<n.xa-n.K&&a[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=Pe(l(n.Va,n),6e3));st(n.h)<=1&&n.ta&&(n.ta=void 0)}else fn(n,11)}else if((e.L||n.g==e)&&hn(n),!L(t))for(a=n.Ba.g.parse(t),t=0;t<a.length;t++){let l=a[t];const d=l[0];if(!(d<=n.K))if(n.K=d,l=l[1],2==n.I)if("c"==l[0]){n.M=l[1],n.ba=l[2];const t=l[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const a=l[4];null!=a&&(n.za=a,n.j.info("SVER="+n.za));const d=l[5];null!=d&&"number"===typeof d&&d>0&&(r=1.5*d,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const u=e.g;if(u){const e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ot(s,s.h),s.h=null))}if(r.G){const e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,gt(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var i=e;if((r=n).na=yn(r,r.L?r.ba:null,r.W),i.L){lt(r.h,i);var o=i,c=r.O;c&&(o.H=c),o.D&&(Xe(o),$e(o)),r.g=i}else ln(r);n.i.length>0&&rn(n)}else"stop"!=l[0]&&"close"!=l[0]||fn(n,7);else 3==n.I&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?fn(n,7):en(n):"noop"!=l[0]&&n.l&&n.l.qa(l),n.A=0)}Ce()}catch(d){}}qe.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==$t(e)?t.j():this.Y(e)},qe.prototype.Y=function(e){try{if(e==this.g)e:{const l=$t(this.g),c=this.g.ya();this.g.ca();if(!(l<3)&&(3!=l||this.g&&(this.h.h||this.g.la()||Jt(this.g)))){this.K||4!=l||7==c||Ce(),Xe(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Qe(e))return e.g.la();const t=Jt(e.g);if(""===t)return"";let n="";const r=t.length,a=4==$t(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return et(e),Ze(e),"";e.h.i=new s.TextDecoder}for(let s=0;s<r;s++)e.h.h=!0,n+=e.h.i.decode(t[s],{stream:!(a&&s==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,a,s,i){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+s+" "+i})}(this.i,this.v,this.B,this.l,this.S,l,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,a=this.g;if((r=a.g?a.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(r)){var i=r;break t}}i=null}if(!(e=i)){this.o=!1,this.m=3,Te(12),et(this),Ze(this);break e}Re(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,tt(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Ye(this,n),t==We){4==l&&(this.m=4,Te(14),e=!1),Re(this.i,this.l,null,"[Incomplete Response]");break}if(t==He){this.m=4,Te(15),Re(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}Re(this.i,this.l,t,null),tt(this,t)}if(Qe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=l||0!=n.length||this.h.h||(this.m=1,Te(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),dn(o),o.P=!0,Te(11))}}else Re(this.i,this.l,n,"[Invalid Chunked Response]"),et(this),Ze(this)}else Re(this.i,this.l,n,null),tt(this,n);4==l&&et(this),this.o&&!this.K&&(4==l?mn(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&$t(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(L(e[r]))continue;var n=ze(e[r]);const a=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[a]||[];t[a]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,Te(12)):(this.m=0,Te(13)),et(this),Ze(this)}}}catch(te){}},qe.prototype.cancel=function(){this.K=!0,et(this)},qe.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(Ce(),Te(17)),et(this),this.m=2,Ze(this)):Je(this,this.T-e)};var nt=class{constructor(e,t){this.g=e,this.map=t}};function rt(e){this.l=e||10,s.PerformanceNavigationTiming?e=(e=s.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function at(e){return!!e.h||!!e.g&&e.g.size>=e.j}function st(e){return e.h?1:e.g?e.g.size:0}function it(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ot(e,t){e.g?e.g.add(t):e.h=t}function lt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ct(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return j(e.i)}rt.prototype.cancel=function(){if(this.i=ct(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var dt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ut(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof ut?(this.l=e.l,mt(this,e.j),this.o=e.o,this.g=e.g,pt(this,e.u),this.h=e.h,ft(this,Ot(e.i)),this.m=e.m):e&&(t=String(e).match(dt))?(this.l=!1,mt(this,t[1]||"",!0),this.o=xt(t[2]||""),this.g=xt(t[3]||"",!0),pt(this,t[4]),this.h=xt(t[5]||"",!0),ft(this,t[6]||"",!0),this.m=xt(t[7]||"")):(this.l=!1,this.i=new kt(null,this.l))}function ht(e){return new ut(e)}function mt(e,t,n){e.j=n?xt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function pt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function ft(e,t,n){t instanceof kt?(e.i=t,function(e,t){t&&!e.j&&(Et(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(At(this,t),Tt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=vt(t,_t)),e.i=new kt(t,e.l))}function gt(e,t,n){e.i.set(t,n)}function yt(e){return gt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function xt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function vt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,bt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function bt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ut.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(vt(t,wt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(vt(t,wt,!0),"@"),e.push(Be(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(vt(n,"/"==n.charAt(0)?Nt:jt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",vt(n,St)),e.join("")},ut.prototype.resolve=function(e){const t=ht(this);let n=!!e.j;n?mt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)pt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var a=t.h.lastIndexOf("/");-1!=a&&(r=t.h.slice(0,a+1)+r)}if(".."==(a=r)||"."==a)r="";else if(-1!=a.indexOf("./")||-1!=a.indexOf("/.")){r=0==a.lastIndexOf("/",0),a=a.split("/");const e=[];for(let t=0;t<a.length;){const n=a[t++];"."==n?r&&t==a.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==a.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=a}return n?t.h=r:n=""!==e.i.toString(),n?ft(t,Ot(e.i)):n=!!e.m,n&&(t.m=e.m),t};var wt=/[#\/\?@]/g,jt=/[#\?:]/g,Nt=/[#\?]/g,_t=/[#\?@]/g,St=/#/g;function kt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Et(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let a,s=null;r>=0?(a=e[n].substring(0,r),s=e[n].substring(r+1)):a=e[n],t(a,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function At(e,t){Et(e),t=Pt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ct(e,t){return Et(e),t=Pt(e,t),e.g.has(t)}function Dt(e,t){Et(e);let n=[];if("string"===typeof t)Ct(e,t)&&(n=n.concat(e.g.get(Pt(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function Tt(e,t,n){At(e,t),n.length>0&&(e.i=null,e.g.set(Pt(e,t),j(n)),e.h+=n.length)}function Ot(e){const t=new kt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function Pt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function It(e,t,n,r,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),r(n)}catch(s){}}function Rt(){this.g=new ve}function Mt(e){this.i=e.Sb||null,this.h=e.ab||!1}function Lt(e,t){ce.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Ft(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function Ut(e){e.readyState=4,e.l=null,e.j=null,e.B=null,Bt(e)}function Bt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function zt(e){let t="";return V(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function qt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=zt(n),"string"===typeof e?null!=n&&Be(n):gt(e,t,n))}function Vt(e){ce.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=kt.prototype).add=function(e,t){Et(this),this.i=null,e=Pt(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Et(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return Et(this),this.i=null,Ct(this,e=Pt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=Dt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const a=Be(n);n=Dt(this,n);for(let t=0;t<n.length;t++){let r=a;""!==n[t]&&(r+="="+Be(n[t])),e.push(r)}}return this.i=e.join("&")},d(Mt,be),Mt.prototype.g=function(){return new Lt(this.i,this.h)},d(Lt,ce),(e=Lt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,Bt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||s).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Ut(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Bt(this)),this.g&&(this.readyState=3,Bt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ft(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ut(this):Bt(this),3==this.readyState&&Ft(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,Ut(this))},e.Na=function(e){this.g&&(this.response=e,Ut(this))},e.ga=function(){this.g&&Ut(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Lt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Vt,ce);var Ht=/^https?$/i,Wt=["POST","PUT"];function Gt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Kt(e),Yt(e)}function Kt(e){e.A||(e.A=!0,de(e,"complete"),de(e,"error"))}function Qt(e){if(e.h&&"undefined"!=typeof a)if(e.v&&4==$t(e))setTimeout(e.Ca.bind(e),0);else if(de(e,"readystatechange"),4==$t(e)){e.h=!1;try{const a=e.ca();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){let t=String(e.D).match(dt)[1]||null;!t&&s.self&&s.self.location&&(t=s.self.location.protocol.slice(0,-1)),r=!Ht.test(t?t.toLowerCase():"")}n=r}if(n)de(e,"complete"),de(e,"success");else{e.o=6;try{var i=$t(e)>2?e.g.statusText:""}catch(o){i=""}e.l=i+" ["+e.ca()+"]",Kt(e)}}finally{Yt(e)}}}function Yt(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||de(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function $t(e){return e.g?e.g.readyState:0}function Jt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Xt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Zt(e){this.za=0,this.i=[],this.j=new Ie,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Xt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Xt("baseRetryDelayMs",5e3,e),this.Za=Xt("retryDelaySeedMs",1e4,e),this.Ta=Xt("forwardChannelMaxRetries",2,e),this.va=Xt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new rt(e&&e.concurrentRequestLimit),this.Ba=new Rt,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function en(e){if(nn(e),3==e.I){var t=e.V++,n=ht(e.J);if(gt(n,"SID",e.M),gt(n,"RID",t),gt(n,"TYPE","terminate"),sn(e,n),(t=new qe(e,e.j,t)).M=2,t.A=yt(ht(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.A,n=!0),n||(t.g=xn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),$e(t)}gn(e)}function tn(e){e.g&&(dn(e),e.g.cancel(),e.g=null)}function nn(e){tn(e),e.v&&(s.clearTimeout(e.v),e.v=null),hn(e),e.h.cancel(),e.m&&("number"===typeof e.m&&s.clearTimeout(e.m),e.m=null)}function rn(e){if(!at(e.h)&&!e.m){e.m=!0;var t=e.Ea;C||O(),D||(C(),D=!0),T.add(t,e),e.D=0}}function an(e,t){var n;n=t?t.l:e.V++;const r=ht(e.J);gt(r,"SID",e.M),gt(r,"RID",n),gt(r,"AID",e.K),sn(e,r),e.u&&e.o&&qt(r,e.u,e.o),n=new qe(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=on(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),ot(e.h,n),Ge(n,r,t)}function sn(e,t){e.H&&V(e.H,function(e,n){gt(t,n,e)}),e.l&&V({},function(e,n){gt(t,n,e)})}function on(e,t,n){n=Math.min(e.i.length,n);const r=e.l?l(e.l.Ka,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let c=0;c<n;c++){var s=a[c].g;const n=a[c].map;if((s-=t)<0)t=Math.max(0,a[c].g-100),l=!1;else try{s="req"+s+"_"||0;try{var o=n instanceof Map?n:Object.entries(n);for(const[t,n]of o){let r=n;i(n)&&(r=ye(n)),e.push(s+t+"="+encodeURIComponent(r))}}catch(N){throw e.push(s+"type="+encodeURIComponent("_badmap")),N}}catch(N){r&&r(n)}}if(l){o=e.join("&");break e}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function ln(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;C||O(),D||(C(),D=!0),T.add(t,e),e.A=0}}function cn(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=Pe(l(e.Da,e),pn(e,e.A)),e.A++,!0)}function dn(e){null!=e.B&&(s.clearTimeout(e.B),e.B=null)}function un(e){e.g=new qe(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=ht(e.na);gt(t,"RID","rpc"),gt(t,"SID",e.M),gt(t,"AID",e.K),gt(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&gt(t,"TO",e.ia),gt(t,"TYPE","xmlhttp"),sn(e,t),e.u&&e.o&&qt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=yt(ht(t)),n.u=null,n.R=!0,Ke(n,e)}function hn(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function mn(e,t){var n=null;if(e.g==t){hn(e),dn(e),e.g=null;var r=2}else{if(!it(e.h,t))return;n=t.G,lt(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var a=e.D;de(r=Ee(),new Oe(r,n)),rn(e)}else ln(e);else if(3==(a=t.m)||0==a&&t.X>0||!(1==r&&function(e,t){return!(st(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=Pe(l(e.Ea,e,t),pn(e,e.D)),e.D++,!0))}(e,t)||2==r&&cn(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),a){case 1:fn(e,5);break;case 4:fn(e,10);break;case 3:fn(e,6);break;default:fn(e,2)}}function pn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function fn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.bb,e),r=e.Ua;const t=!r;r=new ut(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||mt(r,"https"),yt(r),t?function(e,t){const n=new Ie;if(s.Image){const r=new Image;r.onload=c(It,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(It,n,"TestLoadImage: error",!1,t,r),r.onabort=c(It,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(It,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ie;const n=new AbortController,r=setTimeout(()=>{n.abort(),It(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?It(0,0,!0,t):It(0,0,!1,t)}).catch(()=>{clearTimeout(r),It(0,0,!1,t)})}(r.toString(),n)}else Te(2);e.I=0,e.l&&e.l.pa(t),gn(e),nn(e)}function gn(e){if(e.I=0,e.ja=[],e.l){const t=ct(e.h);0==t.length&&0==e.i.length||(_(e.ja,t),_(e.ja,e.i),e.h.i.length=0,j(e.i),e.i.length=0),e.l.oa()}}function yn(e,t,n){var r=n instanceof ut?ht(n):new ut(n);if(""!=r.g)t&&(r.g=t+"."+r.g),pt(r,r.u);else{var a=s.location;r=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;const e=new ut(null);r&&mt(e,r),t&&(e.g=t),a&&pt(e,a),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&gt(r,n,t),gt(r,"VER",e.ka),sn(e,r),r}function xn(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Vt(new Mt({ab:n})):new Vt(e.ma)).Fa(e.L),t}function vn(){}function bn(){}function wn(e,t){ce.call(this),this.g=new Zt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!L(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!L(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new _n(this)}function jn(e){Ne.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Nn(){_e.call(this),this.status=1}function _n(e){this.g=e}(e=Vt.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Me.g(),this.g.onreadystatechange=u(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(i){return void Gt(this,i)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),a=s.FormData&&e instanceof s.FormData,!(Array.prototype.indexOf.call(Wt,t,void 0)>=0)||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(i){Gt(this,i)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,de(this,"complete"),de(this,"abort"),Yt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yt(this,!0)),Vt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Qt(this):this.Xa())},e.Xa=function(){Qt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return $t(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),xe(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Zt.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){Te(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=yn(this,null,this.W),rn(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const a=new qe(this,this.j,e);let s=this.o;if(this.U&&(s?(s=H(s),G(s,this.U)):s=this.U),null!==this.u||this.R||(a.J=s,s=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=on(this,a,t),gt(n=ht(this.J),"RID",e),gt(n,"CVER",22),this.G&&gt(n,"X-HTTP-Session-Id",this.G),sn(this,n),s&&(this.R?t="headers="+Be(zt(s))+"&"+t:this.u&&qt(n,this.u,s)),ot(this.h,a),this.Ra&&gt(n,"TYPE","init"),this.S?(gt(n,"$req",t),gt(n,"SID","null"),a.U=!0,Ge(a,n,null)):Ge(a,n,t),this.I=2}}else 3==this.I&&(e?an(this,e):0==this.i.length||at(this.h)||an(this))},e.Da=function(){if(this.v=null,un(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=Pe(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Te(10),tn(this),un(this))},e.Va=function(){null!=this.C&&(this.C=null,tn(this),cn(this),Te(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),Te(2)):(this.j.info("Failed to ping google.com"),Te(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=vn.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},bn.prototype.g=function(e,t){return new wn(e,t)},d(wn,ce),wn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){en(this.g)},wn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=ye(e),e=n);t.i.push(new nt(t.Ya++,e)),3==t.I&&rn(t)},wn.prototype.N=function(){this.g.l=null,delete this.j,en(this.g),delete this.g,wn.Z.N.call(this)},d(jn,Ne),d(Nn,_e),d(_n,vn),_n.prototype.ra=function(){de(this.g,"a")},_n.prototype.qa=function(e){de(this.g,new jn(e))},_n.prototype.pa=function(e){de(this.g,new Nn)},_n.prototype.oa=function(){de(this.g,"b")},bn.prototype.createWebChannel=bn.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,v=w.createWebChannelTransport=function(){return new bn},x=w.getStatEventTarget=function(){return Ee()},y=w.Event=Se,g=w.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Le.NO_ERROR=0,Le.TIMEOUT=8,Le.HTTP_ERROR=6,f=w.ErrorCode=Le,Fe.COMPLETE="complete",p=w.EventType=Fe,we.EventType=je,je.OPEN="a",je.CLOSE="b",je.ERROR="c",je.MESSAGE="d",ce.prototype.listen=ce.prototype.J,m=w.WebChannel=we,w.FetchXmlHttpFactory=Mt,Vt.prototype.listenOnce=Vt.prototype.K,Vt.prototype.getLastError=Vt.prototype.Ha,Vt.prototype.getLastErrorCode=Vt.prototype.ya,Vt.prototype.getStatus=Vt.prototype.ca,Vt.prototype.getResponseJson=Vt.prototype.La,Vt.prototype.getResponseText=Vt.prototype.la,Vt.prototype.send=Vt.prototype.ea,Vt.prototype.setWithCredentials=Vt.prototype.Fa,h=w.XhrIo=Vt}).apply("undefined"!==typeof b?b:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const j="@firebase/firestore",N="4.9.2";class _{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_.UNAUTHENTICATED=new _(null),_.GOOGLE_CREDENTIALS=new _("google-credentials-uid"),_.FIRST_PARTY=new _("first-party-uid"),_.MOCK_USER=new _("mock-user");let S="12.3.0";const k=new l.Vy("@firebase/firestore");function E(){return k.logLevel}function A(e){if(k.logLevel<=l.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(T);k.debug("Firestore (".concat(S,"): ").concat(e),...a)}}function C(e){if(k.logLevel<=l.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(T);k.error("Firestore (".concat(S,"): ").concat(e),...a)}}function D(e){if(k.logLevel<=l.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(T);k.warn("Firestore (".concat(S,"): ").concat(e),...a)}}function T(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function O(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,P(e,r,n)}function P(e,t,n){let r="FIRESTORE (".concat(S,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw C(r),new Error(r)}function I(e,t,n,r){let a="Unexpected state";"string"==typeof n?a=n:r=n,e||P(t,a,r)}function R(e,t){return e}const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends c.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class F{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class U{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class B{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(_.UNAUTHENTICATED))}shutdown(){}}class z{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class q{constructor(e){this.t=e,this.currentUser=_.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){I(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let a=new F;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new F,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=a;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},i=e=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>i(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?i(e):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new F)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(I("string"==typeof t.accessToken,31837,{l:t}),new U(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return I(null===e||"string"==typeof e,2055,{h:e}),new _(e)}}class V{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=_.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class H{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new V(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(_.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class W{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,i.xZ)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){I(void 0===this.o,3512);const n=e=>{null!=e.error&&A("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,A("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new W(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(I("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new W(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function K(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Q{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=K(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Y(e,t){return e<t?-1:e>t?1:0}function $(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),a=t.charAt(r);if(n!==a)return Z(n)===Z(a)?Y(n,a):Z(n)?1:-1}return Y(e.length,t.length)}const J=55296,X=57343;function Z(e){const t=e.charCodeAt(0);return t>=J&&t<=X}function ee(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const te="__name__";class ne{constructor(e,t,n){void 0===t?t=0:t>e.length&&O(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&O(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ne.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ne?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=ne.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Y(e.length,t.length)}static compareSegments(e,t){const n=ne.isNumericId(e),r=ne.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?ne.extractNumericId(e).compare(ne.extractNumericId(t)):$(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return r.fromString(e.substring(4,e.length-2))}}class re extends ne{construct(e,t,n){return new re(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n){if(a.indexOf("//")>=0)throw new L(M.INVALID_ARGUMENT,"Invalid segment (".concat(a,"). Paths must not contain // in them."));e.push(...a.split("/").filter(e=>e.length>0))}return new re(e)}static emptyPath(){return new re([])}}const ae=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class se extends ne{construct(e,t,n){return new se(e,t,n)}static isValidIdentifier(e){return ae.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),se.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===te}static keyField(){return new se([te])}static fromServerFormat(e){const t=[];let n="",r=0;const a=()=>{if(0===n.length)throw new L(M.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new L(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new L(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(a(),r++)}if(a(),s)throw new L(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new se(t)}static emptyPath(){return new se([])}}class ie{constructor(e){this.path=e}static fromPath(e){return new ie(re.fromString(e))}static fromName(e){return new ie(re.fromString(e).popFirst(5))}static empty(){return new ie(re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===re.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new re(e.slice()))}}function oe(e,t,n){if(!n)throw new L(M.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function le(e){if(!ie.isDocumentKey(e))throw new L(M.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function ce(e){if(ie.isDocumentKey(e))throw new L(M.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function de(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function ue(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":O(12329,{type:typeof e})}function he(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new L(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ue(e);throw new L(M.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function me(e,t){if(t<=0)throw new L(M.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}function pe(e,t){const n={typeString:e};return t&&(n.value=t),n}function fe(e,t){if(!de(e))throw new L(M.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const a=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const i=e[r];if(a&&typeof i!==a){n="JSON field '".concat(r,"' must be a ").concat(a,".");break}if(void 0!==s&&i!==s.value){n="Expected '".concat(r,"' field to equal '").concat(s.value,"'");break}}if(n)throw new L(M.INVALID_ARGUMENT,n);return!0}const ge=-62135596800,ye=1e6;class xe{static now(){return xe.fromMillis(Date.now())}static fromDate(e){return xe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*ye);return new xe(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ge)throw new L(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ye}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(fe(e,xe._jsonSchema))return new xe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ge;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xe._jsonSchemaVersion="firestore/timestamp/1.0",xe._jsonSchema={type:pe("string",xe._jsonSchemaVersion),seconds:pe("number"),nanoseconds:pe("number")};class ve{static fromTimestamp(e){return new ve(e)}static min(){return new ve(new xe(0,0))}static max(){return new ve(new xe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const be=-1;class we{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}we.UNKNOWN_ID=-1;function je(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=ve.fromTimestamp(1e9===r?new xe(n+1,0):new xe(n,r));return new _e(a,ie.empty(),t)}function Ne(e){return new _e(e.readTime,e.key,be)}class _e{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new _e(ve.min(),ie.empty(),be)}static max(){return new _e(ve.max(),ie.empty(),be)}}function Se(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ie.comparator(e.documentKey,t.documentKey),0!==n?n:Y(e.largestBatchId,t.largestBatchId))}const ke="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ee{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Ae(e){if(e.code!==M.FAILED_PRECONDITION||e.message!==ke)throw e;A("LocalStore","Unexpectedly lost primary lease")}class Ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&O(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ce((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Ce?t:Ce.resolve(t)}catch(e){return Ce.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Ce.reject(t)}static resolve(e){return new Ce((t,n)=>{t(e)})}static reject(e){return new Ce((t,n)=>{n(e)})}static waitFor(e){return new Ce((t,n)=>{let r=0,a=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++a,s&&a===r&&t()},e=>n(e))}),s=!0,a===r&&t()})}static or(e){let t=Ce.resolve(!1);for(const n of e)t=t.next(e=>e?Ce.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Ce((n,r)=>{const a=e.length,s=new Array(a);let i=0;for(let o=0;o<a;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++i,i===a&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Ce((n,r)=>{const a=()=>{!0===e()?t().next(()=>{a()},r):n()};a()})}}function De(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Te(e){return"IndexedDbTransactionError"===e.name}class Oe{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Oe.ce=-1;const Pe=-1;function Ie(e){return null==e}function Re(e){return 0===e&&1/e==-1/0}function Me(e){return"number"==typeof e&&Number.isInteger(e)&&!Re(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Le="\x01";function Fe(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Be(t)),t=Ue(e.get(n),t);return Be(t)}function Ue(e,t){let n=t;const r=e.length;for(let a=0;a<r;a++){const t=e.charAt(a);switch(t){case"\0":n+="\x01\x10";break;case Le:n+="\x01\x11";break;default:n+=t}}return n}function Be(e){return e+Le+"\x01"}const ze="remoteDocuments",qe="owner",Ve="mutationQueues",He="mutations";const We="documentMutations",Ge="remoteDocumentsV14",Ke="remoteDocumentGlobal",Qe="targets",Ye="targetDocuments",$e="targetGlobal",Je="collectionParents",Xe="clientMetadata",Ze="bundles",et="namedQueries",tt="indexConfiguration",nt="indexState",rt="indexEntries",at="documentOverlays",st="globals",it=[Ve,He,We,ze,Qe,qe,$e,Ye,Xe,Ke,Je,Ze,et],ot=[Ve,He,We,Ge,Qe,qe,$e,Ye,Xe,Ke,Je,Ze,et,at],lt=ot,ct=[...lt,tt,nt,rt];function dt(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ut(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ht(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class mt{constructor(e,t){this.comparator=e,this.root=t||ft.EMPTY}insert(e,t){return new mt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ft.BLACK,null,null))}remove(e){return new mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ft.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pt(this.root,e,this.comparator,!1)}getReverseIterator(){return new pt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pt(this.root,e,this.comparator,!0)}}class pt{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ft{constructor(e,t,n,r,a){this.key=e,this.value=t,this.color=null!=n?n:ft.RED,this.left=null!=r?r:ft.EMPTY,this.right=null!=a?a:ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,a){return new ft(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const a=n(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return ft.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw O(43730,{key:this.key,value:this.value});if(this.right.isRed())throw O(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw O(27949);return e+(this.isRed()?0:1)}}ft.EMPTY=null,ft.RED=!0,ft.BLACK=!1,ft.EMPTY=new class{constructor(){this.size=0}get key(){throw O(57766)}get value(){throw O(16141)}get color(){throw O(16727)}get left(){throw O(29726)}get right(){throw O(36894)}copy(e,t,n,r,a){return this}insert(e,t,n){return new ft(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class gt{constructor(e){this.comparator=e,this.data=new mt(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yt(this.data.getIterator())}getIteratorFrom(e){return new yt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof gt))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new gt(this.comparator);return t.data=e,t}}class yt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class xt{constructor(e){this.fields=e,e.sort(se.comparator)}static empty(){return new xt([])}unionWith(e){let t=new gt(se.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new xt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ee(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class vt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class bt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new vt("Invalid base64 string: "+e):e}}(e);return new bt(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new bt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}bt.EMPTY_BYTE_STRING=new bt("");const wt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jt(e){if(I(!!e,39018),"string"==typeof e){let t=0;const n=wt.exec(e);if(I(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Nt(e.seconds),nanos:Nt(e.nanos)}}function Nt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function _t(e){return"string"==typeof e?bt.fromBase64String(e):bt.fromUint8Array(e)}const St="server_timestamp",kt="__type__",Et="__previous_value__",At="__local_write_time__";function Ct(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[kt])||void 0===t?void 0:t.stringValue)===St}function Dt(e){const t=e.mapValue.fields[Et];return Ct(t)?Dt(t):t}function Tt(e){const t=jt(e.mapValue.fields[At].timestampValue);return new xe(t.seconds,t.nanos)}class Ot{constructor(e,t,n,r,a,s,i,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=i,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const Pt="(default)";class It{constructor(e,t){this.projectId=e,this.database=t||Pt}static empty(){return new It("","")}get isDefaultDatabase(){return this.database===Pt}isEqual(e){return e instanceof It&&e.projectId===this.projectId&&e.database===this.database}}const Rt="__type__",Mt="__max__",Lt={mapValue:{fields:{__type__:{stringValue:Mt}}}},Ft="__vector__",Ut="value";function Bt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ct(e)?4:rn(e)?9007199254740991:tn(e)?10:11:O(28295,{value:e})}function zt(e,t){if(e===t)return!0;const n=Bt(e);if(n!==Bt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Tt(e).isEqual(Tt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=jt(e.timestampValue),r=jt(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return _t(e.bytesValue).isEqual(_t(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Nt(e.geoPointValue.latitude)===Nt(t.geoPointValue.latitude)&&Nt(e.geoPointValue.longitude)===Nt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Nt(e.integerValue)===Nt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Nt(e.doubleValue),r=Nt(t.doubleValue);return n===r?Re(n)===Re(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ee(e.arrayValue.values||[],t.arrayValue.values||[],zt);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(dt(n)!==dt(r))return!1;for(const a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!zt(n[a],r[a])))return!1;return!0}(e,t);default:return O(52216,{left:e})}}function qt(e,t){return void 0!==(e.values||[]).find(e=>zt(e,t))}function Vt(e,t){if(e===t)return 0;const n=Bt(e),r=Bt(t);if(n!==r)return Y(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Y(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Nt(e.integerValue||e.doubleValue),r=Nt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ht(e.timestampValue,t.timestampValue);case 4:return Ht(Tt(e),Tt(t));case 5:return $(e.stringValue,t.stringValue);case 6:return function(e,t){const n=_t(e),r=_t(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let a=0;a<n.length&&a<r.length;a++){const e=Y(n[a],r[a]);if(0!==e)return e}return Y(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Y(Nt(e.latitude),Nt(t.latitude));return 0!==n?n:Y(Nt(e.longitude),Nt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Wt(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,a,s;const i=e.fields||{},o=t.fields||{},l=null===(n=i[Ut])||void 0===n?void 0:n.arrayValue,c=null===(r=o[Ut])||void 0===r?void 0:r.arrayValue,d=Y((null===l||void 0===l||null===(a=l.values)||void 0===a?void 0:a.length)||0,(null===c||void 0===c||null===(s=c.values)||void 0===s?void 0:s.length)||0);return 0!==d?d:Wt(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Lt.mapValue&&t===Lt.mapValue)return 0;if(e===Lt.mapValue)return 1;if(t===Lt.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),a=t.fields||{},s=Object.keys(a);r.sort(),s.sort();for(let i=0;i<r.length&&i<s.length;++i){const e=$(r[i],s[i]);if(0!==e)return e;const t=Vt(n[r[i]],a[s[i]]);if(0!==t)return t}return Y(r.length,s.length)}(e.mapValue,t.mapValue);default:throw O(23264,{he:n})}}function Ht(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Y(e,t);const n=jt(e),r=jt(t),a=Y(n.seconds,r.seconds);return 0!==a?a:Y(n.nanos,r.nanos)}function Wt(e,t){const n=e.values||[],r=t.values||[];for(let a=0;a<n.length&&a<r.length;++a){const e=Vt(n[a],r[a]);if(e)return e}return Y(n.length,r.length)}function Gt(e){return Kt(e)}function Kt(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=jt(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return _t(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return ie.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Kt(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const a of t)r?r=!1:n+=",",n+="".concat(a,":").concat(Kt(e.fields[a]));return n+"}"}(e.mapValue):O(61005,{value:e})}function Qt(e){switch(Bt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Dt(e);return t?16+Qt(t):16;case 5:return 2*e.stringValue.length;case 6:return _t(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Qt(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return ut(e.fields,(e,n)=>{t+=e.length+Qt(n)}),t}(e.mapValue);default:throw O(13486,{value:e})}}function Yt(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function $t(e){return!!e&&"integerValue"in e}function Jt(e){return!!e&&"arrayValue"in e}function Xt(e){return!!e&&"nullValue"in e}function Zt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function en(e){return!!e&&"mapValue"in e}function tn(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Rt])||void 0===t?void 0:t.stringValue)===Ft}function nn(e){if(e.geoPointValue)return{geoPointValue:(0,s.A)({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:(0,s.A)({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ut(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=nn(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=nn(e.arrayValue.values[n]);return t}return(0,s.A)({},e)}function rn(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Mt}class an{constructor(e){this.value=e}static empty(){return new an({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!en(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=nn(t)}setAll(e){let t=se.emptyPath(),n={},r=[];e.forEach((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=a.popLast()}e?n[a.lastSegment()]=nn(e):r.push(a.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,n,r)}delete(e){const t=this.field(e.popLast());en(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];en(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ut(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new an(nn(this.value))}}function sn(e){const t=[];return ut(e.fields,(e,n)=>{const r=new se([e]);if(en(n)){const e=sn(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new xt(t)}class on{constructor(e,t,n,r,a,s,i){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=a,this.data=s,this.documentState=i}static newInvalidDocument(e){return new on(e,0,ve.min(),ve.min(),ve.min(),an.empty(),0)}static newFoundDocument(e,t,n,r){return new on(e,1,t,ve.min(),n,r,0)}static newNoDocument(e,t){return new on(e,2,t,ve.min(),ve.min(),an.empty(),0)}static newUnknownDocument(e,t){return new on(e,3,t,ve.min(),ve.min(),an.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ve.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=an.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=an.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof on&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new on(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ln{constructor(e,t){this.position=e,this.inclusive=t}}function cn(e,t,n){let r=0;for(let a=0;a<e.position.length;a++){const s=t[a],i=e.position[a];if(r=s.field.isKeyField()?ie.comparator(ie.fromName(i.referenceValue),n.key):Vt(i,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function dn(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!zt(e.position[n],t.position[n]))return!1;return!0}class un{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function hn(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class mn{}class pn extends mn{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new jn(e,t,n):"array-contains"===t?new kn(e,n):"in"===t?new En(e,n):"not-in"===t?new An(e,n):"array-contains-any"===t?new Cn(e,n):new pn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Nn(e,n):new _n(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(Vt(t,this.value)):null!==t&&Bt(this.value)===Bt(t)&&this.matchesComparison(Vt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return O(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fn extends mn{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new fn(e,t)}matches(e){return gn(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function gn(e){return"and"===e.op}function yn(e){return xn(e)&&gn(e)}function xn(e){for(const t of e.filters)if(t instanceof fn)return!1;return!0}function vn(e){if(e instanceof pn)return e.field.canonicalString()+e.op.toString()+Gt(e.value);if(yn(e))return e.filters.map(e=>vn(e)).join(",");{const t=e.filters.map(e=>vn(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function bn(e,t){return e instanceof pn?function(e,t){return t instanceof pn&&e.op===t.op&&e.field.isEqual(t.field)&&zt(e.value,t.value)}(e,t):e instanceof fn?function(e,t){return t instanceof fn&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&bn(n,t.filters[r]),!0)}(e,t):void O(19439)}function wn(e){return e instanceof pn?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Gt(e.value))}(e):e instanceof fn?function(e){return e.op.toString()+" {"+e.getFilters().map(wn).join(" ,")+"}"}(e):"Filter"}class jn extends pn{constructor(e,t,n){super(e,t,n),this.key=ie.fromName(n.referenceValue)}matches(e){const t=ie.comparator(e.key,this.key);return this.matchesComparison(t)}}class Nn extends pn{constructor(e,t){super(e,"in",t),this.keys=Sn("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class _n extends pn{constructor(e,t){super(e,"not-in",t),this.keys=Sn("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Sn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>ie.fromName(e.referenceValue))}class kn extends pn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jt(t)&&qt(t.arrayValue,this.value)}}class En extends pn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&qt(this.value.arrayValue,t)}}class An extends pn{constructor(e,t){super(e,"not-in",t)}matches(e){if(qt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!qt(this.value.arrayValue,t)}}class Cn extends pn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jt(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>qt(this.value.arrayValue,e))}}class Dn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=a,this.startAt=s,this.endAt=i,this.Te=null}}function Tn(e){return new Dn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function On(e){const t=R(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>vn(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Ie(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Gt(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Gt(e)).join(",")),t.Te=e}return t.Te}function Pn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!hn(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!bn(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!dn(e.startAt,t.startAt)&&dn(e.endAt,t.endAt)}function In(e){return ie.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Rn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=a,this.limitType=s,this.startAt=i,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Mn(e,t,n,r,a,s,i,o){return new Rn(e,t,n,r,a,s,i,o)}function Ln(e){return new Rn(e)}function Fn(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Un(e){return null!==e.collectionGroup}function Bn(e){const t=R(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new gt(se.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new un(r,n))}),e.has(se.keyField().canonicalString())||t.Ie.push(new un(se.keyField(),n))}return t.Ie}function zn(e){const t=R(e);return t.Ee||(t.Ee=qn(t,Bn(e))),t.Ee}function qn(e,t){if("F"===e.limitType)return Tn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new un(e.field,t)});const n=e.endAt?new ln(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ln(e.startAt.position,e.startAt.inclusive):null;return Tn(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Vn(e,t){const n=e.filters.concat([t]);return new Rn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Hn(e,t,n){return new Rn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Wn(e,t){return Pn(zn(e),zn(t))&&e.limitType===t.limitType}function Gn(e){return"".concat(On(zn(e)),"|lt:").concat(e.limitType)}function Kn(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>wn(e)).join(", "),"]")),Ie(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Gt(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Gt(e)).join(",")),"Target(".concat(t,")")}(zn(e)),"; limitType=").concat(e.limitType,")")}function Qn(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ie.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Bn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=cn(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Bn(e),t))&&!(e.endAt&&!function(e,t,n){const r=cn(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Bn(e),t))}(e,t)}function Yn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function $n(e){return(t,n)=>{let r=!1;for(const a of Bn(e)){const e=Jn(a,t,n);if(0!==e)return e;r=r||a.field.isKeyField()}return 0}}function Jn(e,t,n){const r=e.field.isKeyField()?ie.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?Vt(r,a):O(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return O(19790,{direction:e.dir})}}class Xn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,a]of n)if(this.equalsFn(r,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ut(this.inner,(t,n)=>{for(const[r,a]of n)e(r,a)})}isEmpty(){return ht(this.inner)}size(){return this.innerSize}}const Zn=new mt(ie.comparator);function er(){return Zn}const tr=new mt(ie.comparator);function nr(){let e=tr;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.insert(a.key,a);return e}function rr(e){let t=tr;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function ar(){return ir()}function sr(){return ir()}function ir(){return new Xn(e=>e.toString(),(e,t)=>e.isEqual(t))}const or=new mt(ie.comparator),lr=new gt(ie.comparator);function cr(){let e=lr;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.add(a);return e}const dr=new gt(Y);function ur(){return dr}function hr(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Re(t)?"-0":t}}function mr(e){return{integerValue:""+e}}function pr(e,t){return Me(t)?mr(t):hr(e,t)}class fr{constructor(){this._=void 0}}function gr(e,t,n){return e instanceof vr?function(e,t){const n={fields:{[kt]:{stringValue:St},[At]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Ct(t)&&(t=Dt(t)),t&&(n.fields[Et]=t),{mapValue:n}}(n,t):e instanceof br?wr(e,t):e instanceof jr?Nr(e,t):function(e,t){const n=xr(e,t),r=Sr(n)+Sr(e.Ae);return $t(n)&&$t(e.Ae)?mr(r):hr(e.serializer,r)}(e,t)}function yr(e,t,n){return e instanceof br?wr(e,t):e instanceof jr?Nr(e,t):n}function xr(e,t){return e instanceof _r?function(e){return $t(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class vr extends fr{}class br extends fr{constructor(e){super(),this.elements=e}}function wr(e,t){const n=kr(t);for(const r of e.elements)n.some(e=>zt(e,r))||n.push(r);return{arrayValue:{values:n}}}class jr extends fr{constructor(e){super(),this.elements=e}}function Nr(e,t){let n=kr(t);for(const r of e.elements)n=n.filter(e=>!zt(e,r));return{arrayValue:{values:n}}}class _r extends fr{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Sr(e){return Nt(e.integerValue||e.doubleValue)}function kr(e){return Jt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Er{constructor(e,t){this.field=e,this.transform=t}}class Ar{constructor(e,t){this.version=e,this.transformResults=t}}class Cr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Cr}static exists(e){return new Cr(void 0,e)}static updateTime(e){return new Cr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Dr(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Tr{}function Or(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new qr(e.key,Cr.none()):new Lr(e.key,e.data,Cr.none());{const n=e.data,r=an.empty();let a=new gt(se.comparator);for(let e of t.fields)if(!a.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),a=a.add(e)}return new Fr(e.key,r,new xt(a.toArray()),Cr.none())}}function Pr(e,t,n){e instanceof Lr?function(e,t,n){const r=e.value.clone(),a=Br(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Fr?function(e,t,n){if(!Dr(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Br(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(Ur(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Ir(e,t,n,r){return e instanceof Lr?function(e,t,n,r){if(!Dr(e.precondition,t))return n;const a=e.value.clone(),s=zr(e.fieldTransforms,r,t);return a.setAll(s),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof Fr?function(e,t,n,r){if(!Dr(e.precondition,t))return n;const a=zr(e.fieldTransforms,r,t),s=t.data;return s.setAll(Ur(e)),s.setAll(a),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Dr(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Rr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),a=xr(r.transform,e||null);null!=a&&(null===n&&(n=an.empty()),n.set(r.field,a))}return n||null}function Mr(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ee(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof br&&t instanceof br||e instanceof jr&&t instanceof jr?ee(e.elements,t.elements,zt):e instanceof _r&&t instanceof _r?zt(e.Ae,t.Ae):e instanceof vr&&t instanceof vr}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Lr extends Tr{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Fr extends Tr{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Ur(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Br(e,t,n){const r=new Map;I(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let a=0;a<n.length;a++){const s=e[a],i=s.transform,o=t.data.field(s.field);r.set(s.field,yr(i,o,n[a]))}return r}function zr(e,t,n){const r=new Map;for(const a of e){const e=a.transform,s=n.data.field(a.field);r.set(a.field,gr(e,s,t))}return r}class qr extends Tr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Vr extends Tr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Hr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Pr(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ir(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ir(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=sr();return this.mutations.forEach(r=>{const a=e.get(r.key),s=a.overlayedDocument;let i=this.applyToLocalView(s,a.mutatedFields);i=t.has(r.key)?null:i;const o=Or(s,i);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(ve.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),cr())}isEqual(e){return this.batchId===e.batchId&&ee(this.mutations,e.mutations,(e,t)=>Mr(e,t))&&ee(this.baseMutations,e.baseMutations,(e,t)=>Mr(e,t))}}class Wr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){I(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=or;const a=e.mutations;for(let s=0;s<a.length;s++)r=r.insert(a[s].key,n[s].version);return new Wr(e,t,n,r)}}class Gr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Kr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qr,Yr;function $r(e){switch(e){case M.OK:return O(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return O(15467,{code:e})}}function Jr(e){if(void 0===e)return C("GRPC error has no .code"),M.UNKNOWN;switch(e){case Qr.OK:return M.OK;case Qr.CANCELLED:return M.CANCELLED;case Qr.UNKNOWN:return M.UNKNOWN;case Qr.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case Qr.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case Qr.INTERNAL:return M.INTERNAL;case Qr.UNAVAILABLE:return M.UNAVAILABLE;case Qr.UNAUTHENTICATED:return M.UNAUTHENTICATED;case Qr.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case Qr.NOT_FOUND:return M.NOT_FOUND;case Qr.ALREADY_EXISTS:return M.ALREADY_EXISTS;case Qr.PERMISSION_DENIED:return M.PERMISSION_DENIED;case Qr.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case Qr.ABORTED:return M.ABORTED;case Qr.OUT_OF_RANGE:return M.OUT_OF_RANGE;case Qr.UNIMPLEMENTED:return M.UNIMPLEMENTED;case Qr.DATA_LOSS:return M.DATA_LOSS;default:return O(39323,{code:e})}}(Yr=Qr||(Qr={}))[Yr.OK=0]="OK",Yr[Yr.CANCELLED=1]="CANCELLED",Yr[Yr.UNKNOWN=2]="UNKNOWN",Yr[Yr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yr[Yr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yr[Yr.NOT_FOUND=5]="NOT_FOUND",Yr[Yr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yr[Yr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yr[Yr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yr[Yr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yr[Yr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yr[Yr.ABORTED=10]="ABORTED",Yr[Yr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yr[Yr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yr[Yr.INTERNAL=13]="INTERNAL",Yr[Yr.UNAVAILABLE=14]="UNAVAILABLE",Yr[Yr.DATA_LOSS=15]="DATA_LOSS";let Xr=null;function Zr(){return new TextEncoder}const ea=new r([4294967295,4294967295],0);function ta(e){const t=Zr().encode(e),n=new a;return n.update(t),new Uint8Array(n.digest())}function na(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),a=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new r([n,a],0),new r([s,i],0)]}class ra{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new aa("Invalid padding: ".concat(t));if(n<0)throw new aa("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new aa("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new aa("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=r.fromNumber(this.ge)}ye(e,t,n){let a=e.add(t.multiply(r.fromNumber(n)));return 1===a.compare(ea)&&(a=new r([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=ta(e),[n,r]=na(t);for(let a=0;a<this.hashCount;a++){const e=this.ye(n,r,a);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new ra(a,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;const t=ta(e),[n,r]=na(t);for(let a=0;a<this.hashCount;a++){const e=this.ye(n,r,a);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class aa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class sa{constructor(e,t,n,r,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ia.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new sa(ve.min(),r,new mt(Y),er(),cr())}}class ia{constructor(e,t,n,r,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ia(n,t,cr(),cr(),cr())}}class oa{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class la{constructor(e,t){this.targetId=e,this.Ce=t}}class ca{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bt.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class da{constructor(){this.ve=0,this.Fe=ma(),this.Me=bt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=cr(),t=cr(),n=cr();return this.Fe.forEach((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:O(38017,{changeType:a})}}),new ia(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=ma()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,I(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class ua{constructor(e){this.Ge=e,this.ze=new Map,this.je=er(),this.Je=ha(),this.He=ha(),this.Ye=new mt(Y)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:O(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(In(s))if(0===n){const e=new ie(s.path);this.et(t,e,on.newNoDocument(e,ve.min()))}else I(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var a;const n=this.ut(e),s=n?this.ct(n,e,r):1;if(0!==s){this.it(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(a=Xr)||void 0===a||a.lt(function(e,t,n,r,a){var s,i,o,l,c;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},u=t.unchangedNames;return u&&(d.bloomFilter={applied:0===a,hashCount:null!==(s=null===u||void 0===u?void 0:u.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(i=null===u||void 0===u||null===(o=u.bits)||void 0===o||null===(o=o.bitmap)||void 0===o?void 0:o.length)&&void 0!==i?i:0,padding:null!==(l=null===u||void 0===u||null===(c=u.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.Ce,this.Ge.ht(),n,s))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:a=0}=t;let s,i;try{s=_t(n).toUint8Array()}catch(e){if(e instanceof vt)return D("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{i=new ra(s,r,a)}catch(e){return D(e instanceof aa?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===i.ge?null:i}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const a=this.Ge.ht(),s="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const a=this.ot(r);if(a){if(n.current&&In(a.target)){const t=new ie(a.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,on.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=cr();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new sa(e,t,this.Ye,this.je,n);return this.je=er(),this.Je=ha(),this.He=ha(),this.Ye=new mt(Y),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new da,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new gt(Y),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new gt(Y),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||A("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new da),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ha(){return new mt(ie.comparator)}function ma(){return new mt(ie.comparator)}const pa={asc:"ASCENDING",desc:"DESCENDING"},fa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ga={and:"AND",or:"OR"};class ya{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xa(e,t){return e.useProto3Json||Ie(t)?t:{value:t}}function va(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function ba(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function wa(e,t){return va(e,t.toTimestamp())}function ja(e){return I(!!e,49232),ve.fromTimestamp(function(e){const t=jt(e);return new xe(t.seconds,t.nanos)}(e))}function Na(e,t){return _a(e,t).canonicalString()}function _a(e,t){const n=function(e){return new re(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Sa(e){const t=re.fromString(e);return I(Wa(t),10190,{key:t.toString()}),t}function ka(e,t){return Na(e.databaseId,t.path)}function Ea(e,t){const n=Sa(t);if(n.get(1)!==e.databaseId.projectId)throw new L(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new L(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ie(Ta(n))}function Aa(e,t){return Na(e.databaseId,t)}function Ca(e){const t=Sa(e);return 4===t.length?re.emptyPath():Ta(t)}function Da(e){return new re(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Ta(e){return I(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Oa(e,t,n){return{name:ka(e,t),fields:n.value.mapValue.fields}}function Pa(e,t){let n;if(t instanceof Lr)n={update:Oa(e,t.key,t.value)};else if(t instanceof qr)n={delete:ka(e,t.key)};else if(t instanceof Fr)n={update:Oa(e,t.key,t.data),updateMask:Ha(t.fieldMask)};else{if(!(t instanceof Vr))return O(16599,{Vt:t.type});n={verify:ka(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof vr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof br)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof jr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof _r)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw O(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:wa(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:O(27497)}(e,t.precondition)),n}function Ia(e,t){return{documents:[Aa(e,t.path)]}}function Ra(e,t){const n={structuredQuery:{}},r=t.path;let a;null!==t.collectionGroup?(a=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Aa(e,a);const s=function(e){if(0!==e.length)return Va(fn.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const i=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:za(e.field),direction:Fa(e.dir)}}(e))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);const o=xa(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:a}}function Ma(e){let t=Ca(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){I(1===r,65062);const e=n.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=La(e);return t instanceof fn&&yn(t)?t.getFilters():[t]}(n.where));let i=[];n.orderBy&&(i=function(e){return e.map(e=>function(e){return new un(qa(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Ie(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new ln(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new ln(n,t)}(n.endAt)),Mn(t,a,i,s,o,"F",l,c)}function La(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=qa(e.unaryFilter.field);return pn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=qa(e.unaryFilter.field);return pn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=qa(e.unaryFilter.field);return pn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=qa(e.unaryFilter.field);return pn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return O(61313);default:return O(60726)}}(e):void 0!==e.fieldFilter?function(e){return pn.create(qa(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return O(58110);default:return O(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return fn.create(e.compositeFilter.filters.map(e=>La(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return O(1026)}}(e.compositeFilter.op))}(e):O(30097,{filter:e})}function Fa(e){return pa[e]}function Ua(e){return fa[e]}function Ba(e){return ga[e]}function za(e){return{fieldPath:e.canonicalString()}}function qa(e){return se.fromServerFormat(e.fieldPath)}function Va(e){return e instanceof pn?function(e){if("=="===e.op){if(Zt(e.value))return{unaryFilter:{field:za(e.field),op:"IS_NAN"}};if(Xt(e.value))return{unaryFilter:{field:za(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Zt(e.value))return{unaryFilter:{field:za(e.field),op:"IS_NOT_NAN"}};if(Xt(e.value))return{unaryFilter:{field:za(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:za(e.field),op:Ua(e.op),value:e.value}}}(e):e instanceof fn?function(e){const t=e.getFilters().map(e=>Va(e));return 1===t.length?t[0]:{compositeFilter:{op:Ba(e.op),filters:t}}}(e):O(54877,{filter:e})}function Ha(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Wa(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Ga{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ve.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ve.min(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:bt.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=i,this.expectedCount=o}withSequenceNumber(e){return new Ga(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ga(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ga(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ga(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Ka{constructor(e){this.yt=e}}function Qa(e){const t=Ma({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Hn(t,t.limit,"L"):t}class Ya{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Nt(e.integerValue));else if("doubleValue"in e){const n=Nt(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Re(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=jt(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(_t(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?rn(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):tn(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):O(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const a=Ut,s=(null===(n=r[a].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(Nt(s)),this.Ot(a,t),this.Ct(r[a],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),ie.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Ya.Kt=new Ya;class $a{constructor(){this.Cn=new Ja}addToCollectionParentIndex(e,t){return this.Cn.add(t),Ce.resolve()}getCollectionParents(e,t){return Ce.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Ce.resolve()}deleteFieldIndex(e,t){return Ce.resolve()}deleteAllFieldIndexes(e){return Ce.resolve()}createTargetIndexes(e,t){return Ce.resolve()}getDocumentsMatchingTarget(e,t){return Ce.resolve(null)}getIndexType(e,t){return Ce.resolve(0)}getFieldIndexes(e,t){return Ce.resolve([])}getNextCollectionGroupToUpdate(e){return Ce.resolve(null)}getMinOffset(e,t){return Ce.resolve(_e.min())}getMinOffsetFromCollectionGroup(e,t){return Ce.resolve(_e.min())}updateCollectionGroup(e,t,n){return Ce.resolve()}updateIndexEntries(e,t){return Ce.resolve()}}class Ja{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new gt(re.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new gt(re.comparator)).toArray()}}new Uint8Array(0);const Xa={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Za=41943040;class es{static withCacheSize(e){return new es(e,es.DEFAULT_COLLECTION_PERCENTILE,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}es.DEFAULT_COLLECTION_PERCENTILE=10,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,es.DEFAULT=new es(Za,es.DEFAULT_COLLECTION_PERCENTILE,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),es.DISABLED=new es(-1,0,0);class ts{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ts(0)}static cr(){return new ts(-1)}}const ns="LruGarbageCollector",rs=1048576;function as(e,t){let[n,r]=e,[a,s]=t;const i=Y(n,a);return 0===i?Y(r,s):i}class ss{constructor(e){this.Ir=e,this.buffer=new gt(as),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();as(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class is{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){A(ns,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Te(e)?A(ns,"Ignoring IndexedDB error during garbage collection: ",e):await Ae(e)}await this.Vr(3e5)})}}class os{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Ce.resolve(Oe.ce);const n=new ss(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; disabled"),Ce.resolve(Xa)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),Xa):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,a,s,i,o,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(A("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,i=Date.now(),this.removeTargets(e,n,t))).next(t=>(a=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(c=Date.now(),E()<=l.$b.DEBUG&&A("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-d,"ms\n\tDetermined least recently used ").concat(r," in ")+(i-s)+"ms\n"+"\tRemoved ".concat(a," targets in ")+(o-i)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-o)+"ms\n"+"Total Duration: ".concat(c-d,"ms")),Ce.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:e})))}}function ls(e,t){return new os(e,t)}class cs{constructor(){this.changes=new Xn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,on.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ds{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class us{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Ir(n.mutation,e,xt.empty(),xe.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,cr()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cr();const r=ar();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=nr();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=ar();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,cr()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let a=er();const s=ir(),i=ir();return t.forEach((e,t)=>{const i=n.get(t.key);r.has(t.key)&&(void 0===i||i.mutation instanceof Fr)?a=a.insert(t.key,t):void 0!==i?(s.set(t.key,i.mutation.getFieldMask()),Ir(i.mutation,t,i.mutation.getFieldMask(),xe.now())):s.set(t.key,xt.empty())}),this.recalculateAndSaveOverlays(e,a).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return i.set(e,new ds(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),i))}recalculateAndSaveOverlays(e,t){const n=ir();let r=new mt((e,t)=>e-t),a=cr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const a of e)a.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let i=n.get(e)||xt.empty();i=a.applyToLocalView(s,i),n.set(e,i);const o=(r.get(a.batchId)||cr()).add(e);r=r.insert(a.batchId,o)})}).next(()=>{const s=[],i=r.getReverseIterator();for(;i.hasNext();){const r=i.getNext(),o=r.key,l=r.value,c=sr();l.forEach(e=>{if(!a.has(e)){const r=Or(t.get(e),n.get(e));null!==r&&c.set(e,r),a=a.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Ce.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return ie.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Un(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(a=>{const s=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Ce.resolve(ar());let i=be,o=a;return s.next(t=>Ce.forEach(t,(t,n)=>(i<n.largestBatchId&&(i=n.largestBatchId),a.get(t)?Ce.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,a)).next(()=>this.computeViews(e,o,t,cr())).next(e=>({batchId:i,changes:rr(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ie(t)).next(e=>{let t=nr();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const a=t.collectionGroup;let s=nr();return this.indexManager.getCollectionParents(e,a).next(i=>Ce.forEach(i,i=>{const o=function(e,t){return new Rn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,i.child(a));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,r))).next(e=>{a.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,on.newInvalidDocument(r)))});let n=nr();return e.forEach((e,r)=>{const s=a.get(e);void 0!==s&&Ir(s.mutation,r,xt.empty(),xe.now()),Qn(t,r)&&(n=n.insert(e,r))}),n})}}class hs{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Ce.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ja(e.createTime)}}(t)),Ce.resolve()}getNamedQuery(e,t){return Ce.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Qa(e.bundledQuery),readTime:ja(e.readTime)}}(t)),Ce.resolve()}}class ms{constructor(){this.overlays=new mt(ie.comparator),this.qr=new Map}getOverlay(e,t){return Ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ar();return Ce.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),Ce.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),Ce.resolve()}getOverlaysForCollection(e,t,n){const r=ar(),a=t.length+1,s=new ie(t.child("")),i=this.overlays.getIteratorFrom(s);for(;i.hasNext();){const e=i.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===a&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Ce.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let a=new mt((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=a.get(e.largestBatchId);null===t&&(t=ar(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const i=ar(),o=a.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>i.set(e,t)),!(i.size()>=r)););return Ce.resolve(i)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Gr(t,n));let a=this.qr.get(t);void 0===a&&(a=cr(),this.qr.set(t,a)),this.qr.set(t,a.add(n.key))}}class ps{constructor(){this.sessionToken=bt.EMPTY_BYTE_STRING}getSessionToken(e){return Ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ce.resolve()}}class fs{constructor(){this.Qr=new gt(gs.$r),this.Ur=new gt(gs.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new gs(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new gs(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new ie(new re([])),n=new gs(t,e),r=new gs(t,e+1),a=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),a.push(e.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ie(new re([])),n=new gs(t,e),r=new gs(t,e+1);let a=cr();return this.Ur.forEachInRange([n,r],e=>{a=a.add(e.key)}),a}containsKey(e){const t=new gs(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class gs{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ie.comparator(e.key,t.key)||Y(e.Yr,t.Yr)}static Kr(e,t){return Y(e.Yr,t.Yr)||ie.comparator(e.key,t.key)}}class ys{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new gt(gs.$r)}checkEmpty(e){return Ce.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Hr(a,t,n,r);this.mutationQueue.push(s);for(const i of r)this.Zr=this.Zr.add(new gs(i.key,a)),this.indexManager.addToCollectionParentIndex(e,i.key.path.popLast());return Ce.resolve(s)}lookupMutationBatch(e,t){return Ce.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),a=r<0?0:r;return Ce.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Ce.resolve(0===this.mutationQueue.length?Pe:this.tr-1)}getAllMutationBatches(e){return Ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new gs(t,0),r=new gs(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);a.push(t)}),Ce.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new gt(Y);return t.forEach(e=>{const t=new gs(e,0),r=new gs(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),Ce.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let a=n;ie.isDocumentKey(a)||(a=a.child(""));const s=new gs(new ie(a),0);let i=new gt(Y);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(i=i.add(e.Yr)),!0)},s),Ce.resolve(this.ti(i))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){I(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return Ce.forEach(t.mutations,r=>{const a=new gs(r.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new gs(t,0),r=this.Zr.firstAfterOrEqual(n);return Ce.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ce.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class xs{constructor(e){this.ri=e,this.docs=new mt(ie.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),a=r?r.size:0,s=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Ce.resolve(n?n.document.mutableCopy():on.newInvalidDocument(t))}getEntries(e,t){let n=er();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():on.newInvalidDocument(e))}),Ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let a=er();const s=t.path,i=new ie(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:e,value:{document:i}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Se(Ne(i),n)<=0||(r.has(i.key)||Qn(t,i))&&(a=a.insert(i.key,i.mutableCopy()))}return Ce.resolve(a)}getAllFromCollectionGroup(e,t,n,r){O(9500)}ii(e,t){return Ce.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new vs(this)}getSize(e){return Ce.resolve(this.size)}}class vs extends cs{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),Ce.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class bs{constructor(e){this.persistence=e,this.si=new Xn(e=>On(e),Pn),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.oi=0,this._i=new fs,this.targetCount=0,this.ai=ts.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),Ce.resolve()}getLastRemoteSnapshotVersion(e){return Ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ce.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Ce.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ts(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Ce.resolve()}updateTargetData(e,t){return this.Pr(t),Ce.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Ce.resolve()}removeTargets(e,t,n){let r=0;const a=[];return this.si.forEach((s,i)=>{i.sequenceNumber<=t&&null===n.get(i.targetId)&&(this.si.delete(s),a.push(this.removeMatchingKeysForTargetId(e,i.targetId)),r++)}),Ce.waitFor(a).next(()=>r)}getTargetCount(e){return Ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return Ce.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Ce.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,a=[];return r&&t.forEach(t=>{a.push(r.markPotentiallyOrphaned(e,t))}),Ce.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return Ce.resolve(n)}containsKey(e,t){return Ce.resolve(this._i.containsKey(t))}}class ws{constructor(e,t){this.ui={},this.overlays={},this.ci=new Oe(0),this.li=!1,this.li=!0,this.hi=new ps,this.referenceDelegate=e(this),this.Pi=new bs(this),this.indexManager=new $a,this.remoteDocumentCache=function(e){return new xs(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new Ka(t),this.Ii=new hs(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ms,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new ys(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){A("MemoryPersistence","Starting transaction:",e);const r=new js(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return Ce.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class js extends Ee{constructor(e){super(),this.currentSequenceNumber=e}}class Ns{constructor(e){this.persistence=e,this.Ri=new fs,this.Vi=null}static mi(e){return new Ns(e)}get fi(){if(this.Vi)return this.Vi;throw O(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Ce.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Ce.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Ce.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ce.forEach(this.fi,n=>{const r=ie.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,ve.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Ce.or([()=>Ce.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class _s{constructor(e,t){this.persistence=e,this.pi=new Xn(e=>Fe(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=ls(this,t)}static mi(e,t){return new _s(e,t)}Ei(){}di(e){return Ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Ce.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?Ce.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,a.removeEntry(r,ve.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Ce.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Ce.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Ce.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Ce.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Qt(e.data.value)),t}br(e,t,n){return Ce.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Ce.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ss{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=cr(),r=cr();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new Ss(e,t.fromCache,n,r)}}class ks{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Es{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(0,c.nr)()?8:De((0,c.ZQ)())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const a={result:null};return this.ys(e,t).next(e=>{a.result=e}).next(()=>{if(!a.result)return this.ws(e,t,r,n).next(e=>{a.result=e})}).next(()=>{if(a.result)return;const n=new ks;return this.Ss(e,t,n).next(r=>{if(a.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>a.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(E()<=l.$b.DEBUG&&A("QueryEngine","SDK will not create cache indexes for query:",Kn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ce.resolve()):(E()<=l.$b.DEBUG&&A("QueryEngine","Query:",Kn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(E()<=l.$b.DEBUG&&A("QueryEngine","The SDK decides to create cache indexes for query:",Kn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zn(t))):Ce.resolve())}ys(e,t){if(Fn(t))return Ce.resolve(null);let n=zn(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Hn(t,null,"F"),n=zn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const a=cr(...r);return this.ps.getDocuments(e,a).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.Ds(t,r);return this.Cs(t,s,a,n.readTime)?this.ys(e,Hn(t,null,"F")):this.vs(e,s,t,n)}))})))}ws(e,t,n,r){return Fn(t)||r.isEqual(ve.min())?Ce.resolve(null):this.ps.getDocuments(e,n).next(a=>{const s=this.Ds(t,a);return this.Cs(t,s,n,r)?Ce.resolve(null):(E()<=l.$b.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Kn(t)),this.vs(e,s,t,je(r,be)).next(e=>e))})}Ds(e,t){let n=new gt($n(e));return t.forEach((t,r)=>{Qn(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}Ss(e,t,n){return E()<=l.$b.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",Kn(t)),this.ps.getDocumentsMatchingQuery(e,t,_e.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const As="LocalStore",Cs=3e8;class Ds{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new mt(Y),this.xs=new Xn(e=>On(e),Pn),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new us(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Ts(e,t,n,r){return new Ds(e,t,n,r)}async function Os(e,t){const n=R(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(a=>(r=a,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const a=[],s=[];let i=cr();for(const e of r){a.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}return n.localDocuments.getDocuments(e,i).next(e=>({Ls:e,removedBatchIds:a,addedBatchIds:s}))})})}function Ps(e){const t=R(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Is(e,t,n){let r=cr(),a=cr();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=er();return n.forEach((n,s)=>{const i=e.get(n);s.isFoundDocument()!==i.isFoundDocument()&&(a=a.add(n)),s.isNoDocument()&&s.version.isEqual(ve.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!i.isValidDocument()||s.version.compareTo(i.version)>0||0===s.version.compareTo(i.version)&&i.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):A(As,"Ignoring outdated watch update for ",n,". Current version:",i.version," Watch version:",s.version)}),{ks:r,qs:a}})}function Rs(e,t){const n=R(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Pe),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Ms(e,t){const n=R(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(a=>a?(r=a,Ce.resolve(r)):n.Pi.allocateTargetId(e).next(a=>(r=new Ga(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function Ls(e,t,n){const r=R(e),a=r.Ms.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,a))}catch(e){if(!Te(e))throw e;A(As,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(a.target)}function Fs(e,t,n){const r=R(e);let a=ve.min(),s=cr();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=R(e),a=r.xs.get(n);return void 0!==a?Ce.resolve(r.Ms.get(a)):r.Pi.getTargetData(t,n)}(r,e,zn(t)).next(t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?a:ve.min(),n?s:cr())).next(e=>(Us(r,Yn(t),e),{documents:e,Qs:s})))}function Us(e,t,n){let r=e.Os.get(t)||ve.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class Bs{constructor(){this.activeTargetIds=ur()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zs{constructor(){this.Mo=new Bs,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Bs,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class qs{Oo(e){}shutdown(){}}const Vs="ConnectivityMonitor";class Hs{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){A(Vs,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){A(Vs,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ws=null;function Gs(){return null===Ws?Ws=268435456+Math.round(2147483648*Math.random()):Ws++,"0x"+Ws.toString(16)}const Ks="RestConnection",Qs={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ys{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===Pt?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,a){const s=Gs(),i=this.zo(e,t.toUriEncodedString());A(Ks,"Sending RPC '".concat(e,"' ").concat(s,":"),i,n);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,r,a);const{host:l}=new URL(i),d=(0,c.zJ)(l);return this.Jo(e,i,o,n,d).then(t=>(A(Ks,"Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw D(Ks,"RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",i,"request:",n),t})}Ho(e,t,n,r,a,s){return this.Go(e,t,n,r,a)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+S,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Qs[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class $s{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Js="WebChannelConnection";class Xs extends Ys{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,a){const s=Gs();return new Promise((a,i)=>{const o=new h;o.setWithCredentials(!0),o.listenOnce(p.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case f.NO_ERROR:const n=o.getResponseJson();A(Js,"XHR for RPC '".concat(e,"' ").concat(s," received:"),JSON.stringify(n)),a(n);break;case f.TIMEOUT:A(Js,"RPC '".concat(e,"' ").concat(s," timed out")),i(new L(M.DEADLINE_EXCEEDED,"Request time out"));break;case f.HTTP_ERROR:const r=o.getStatus();if(A(Js,"RPC '".concat(e,"' ").concat(s," failed with status:"),r,"response text:",o.getResponseText()),r>0){var t;let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(t)>=0?t:M.UNKNOWN}(n.status);i(new L(e,n.message))}else i(new L(M.UNKNOWN,"Server responded with status "+o.getStatus()))}else i(new L(M.UNAVAILABLE,"Connection failed."));break;default:O(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{A(Js,"RPC '".concat(e,"' ").concat(s," completed."))}});const l=JSON.stringify(r);A(Js,"RPC '".concat(e,"' ").concat(s," sending request:"),r),o.send(t,"POST",l,n,15)})}T_(e,t,n){const r=Gs(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=v(),i=x(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=a.join("");A(Js,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const d=s.createWebChannel(c,o);this.I_(d);let u=!1,h=!1;const p=new $s({Yo:t=>{h?A(Js,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(u||(A(Js,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),d.open(),u=!0),A(Js,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),d.send(t))},Zo:()=>d.close()}),f=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return f(d,m.EventType.OPEN,()=>{h||(A(Js,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),p.o_())}),f(d,m.EventType.CLOSE,()=>{h||(h=!0,A(Js,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.a_(),this.E_(d))}),f(d,m.EventType.ERROR,t=>{h||(h=!0,D(Js,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),p.a_(new L(M.UNAVAILABLE,"The operation could not be completed")))}),f(d,m.EventType.MESSAGE,t=>{if(!h){var n;const a=t.data[0];I(!!a,16349);const s=a,i=(null===s||void 0===s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(i){A(Js,"RPC '".concat(e,"' stream ").concat(r," received error:"),i);const t=i.status;let n=function(e){const t=Qr[e];if(void 0!==t)return Jr(t)}(t),a=i.message;void 0===n&&(n=M.INTERNAL,a="Unknown error status: "+t+" with message "+i.message),h=!0,p.a_(new L(n,a)),d.close()}else A(Js,"RPC '".concat(e,"' stream ").concat(r," received:"),a),p.u_(a)}}),f(i,y.STAT_EVENT,t=>{t.stat===g.PROXY?A(Js,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===g.NOPROXY&&A(Js,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Zs(){return"undefined"!=typeof document?document:null}function ei(e){return new ya(e,!0)}class ti{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&A("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const ni="PersistentStream";class ri{constructor(e,t,n,r,a,s,i,o){this.Mi=e,this.S_=n,this.b_=r,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=i,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ti(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(C(t.toString()),C("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===M.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new L(M.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return A(ni,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(A(ni,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ai extends ri{constructor(e,t,n,r,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:O(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(I(void 0===t||"string"==typeof t,58123),bt.fromBase64String(t||"")):(I(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),bt.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(e){const t=void 0===e.code?M.UNKNOWN:Jr(e.code);return new L(t,e.message||"")}(i);n=new ca(r,a,s,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const a=Ea(e,r.document.name),s=ja(r.document.updateTime),i=r.document.createTime?ja(r.document.createTime):ve.min(),o=new an({mapValue:{fields:r.document.fields}}),l=on.newFoundDocument(a,s,i,o),c=r.targetIds||[],d=r.removedTargetIds||[];n=new oa(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const a=Ea(e,r.document),s=r.readTime?ja(r.readTime):ve.min(),i=on.newNoDocument(a,s),o=r.removedTargetIds||[];n=new oa([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const a=Ea(e,r.document),s=r.removedTargetIds||[];n=new oa([],s,a,null)}else{if(!("filter"in t))return O(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:a}=e,s=new Kr(r,a),i=e.targetId;n=new la(i,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return ve.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?ve.min():t.readTime?ja(t.readTime):ve.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Da(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=In(r)?{documents:Ia(e,r)}:{query:Ra(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=ba(e,t.resumeToken);const r=xa(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(ve.min())>0){n.readTime=va(e,t.snapshotVersion.toTimestamp());const r=xa(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return O(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Da(this.serializer),t.removeTarget=e,this.q_(t)}}class si extends ri{constructor(e,t,n,r,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return I(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,I(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){I(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(I(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?ja(e.updateTime):ja(t);return n.isEqual(ve.min())&&(n=ja(t)),new Ar(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=ja(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Da(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Pa(this.serializer,e))};this.q_(t)}}class ii{}class oi extends ii{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new L(M.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(a=>{let[s,i]=a;return this.connection.Go(e,_a(t,n),r,s,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new L(M.UNKNOWN,e.toString())})}Ho(e,t,n,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[i,o]=s;return this.connection.Ho(e,_a(t,n),r,i,o,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new L(M.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class li{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(C(t),this.aa=!1):A("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const ci="RemoteStore";class di{constructor(e,t,n,r,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{vi(this)&&(A(ci,"Restarting streams for network reachability change."),await async function(e){const t=R(e);t.Ea.add(4),await hi(t),t.Ra.set("Unknown"),t.Ea.delete(4),await ui(t)}(this))})}),this.Ra=new li(n,r)}}async function ui(e){if(vi(e))for(const t of e.da)await t(!0)}async function hi(e){for(const t of e.da)await t(!1)}function mi(e,t){const n=R(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),xi(n)?yi(n):Fi(n).O_()&&fi(n,t))}function pi(e,t){const n=R(e),r=Fi(n);n.Ia.delete(t),r.O_()&&gi(n,t),0===n.Ia.size&&(r.O_()?r.L_():vi(n)&&n.Ra.set("Unknown"))}function fi(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ve.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Fi(e).Y_(t)}function gi(e,t){e.Va.Ue(t),Fi(e).Z_(t)}function yi(e){e.Va=new ua({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Fi(e).start(),e.Ra.ua()}function xi(e){return vi(e)&&!Fi(e).x_()&&e.Ia.size>0}function vi(e){return 0===R(e).Ea.size}function bi(e){e.Va=void 0}async function wi(e){e.Ra.set("Online")}async function ji(e){e.Ia.forEach((t,n)=>{fi(e,t)})}async function Ni(e,t){bi(e),xi(e)?(e.Ra.ha(t),yi(e)):e.Ra.set("Unknown")}async function _i(e,t,n){if(e.Ra.set("Online"),t instanceof ca&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){A(ci,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Si(e,n)}else if(t instanceof oa?e.Va.Ze(t):t instanceof la?e.Va.st(t):e.Va.tt(t),!n.isEqual(ve.min()))try{const t=await Ps(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const a=e.Ia.get(r);a&&e.Ia.set(r,a.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(bt.EMPTY_BYTE_STRING,r.snapshotVersion)),gi(e,t);const a=new Ga(r.target,t,n,r.sequenceNumber);fi(e,a)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){A(ci,"Failed to raise snapshot:",t),await Si(e,t)}}async function Si(e,t,n){if(!Te(t))throw t;e.Ea.add(1),await hi(e),e.Ra.set("Offline"),n||(n=()=>Ps(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{A(ci,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await ui(e)})}function ki(e,t){return t().catch(n=>Si(e,n,t))}async function Ei(e){const t=R(e),n=Ui(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Pe;for(;Ai(t);)try{const e=await Rs(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,Ci(t,e)}catch(e){await Si(t,e)}Di(t)&&Ti(t)}function Ai(e){return vi(e)&&e.Ta.length<10}function Ci(e,t){e.Ta.push(t);const n=Ui(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Di(e){return vi(e)&&!Ui(e).x_()&&e.Ta.length>0}function Ti(e){Ui(e).start()}async function Oi(e){Ui(e).ra()}async function Pi(e){const t=Ui(e);for(const n of e.Ta)t.ea(n.mutations)}async function Ii(e,t,n){const r=e.Ta.shift(),a=Wr.from(r,t,n);await ki(e,()=>e.remoteSyncer.applySuccessfulWrite(a)),await Ei(e)}async function Ri(e,t){t&&Ui(e).X_&&await async function(e,t){if(function(e){return $r(e)&&e!==M.ABORTED}(t.code)){const n=e.Ta.shift();Ui(e).B_(),await ki(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Ei(e)}}(e,t),Di(e)&&Ti(e)}async function Mi(e,t){const n=R(e);n.asyncQueue.verifyOperationInProgress(),A(ci,"RemoteStore received new credentials");const r=vi(n);n.Ea.add(3),await hi(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await ui(n)}async function Li(e,t){const n=R(e);t?(n.Ea.delete(2),await ui(n)):t||(n.Ea.add(2),await hi(n),n.Ra.set("Unknown"))}function Fi(e){return e.ma||(e.ma=function(e,t,n){const r=R(e);return r.sa(),new ai(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:wi.bind(null,e),t_:ji.bind(null,e),r_:Ni.bind(null,e),H_:_i.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),xi(e)?yi(e):e.Ra.set("Unknown")):(await e.ma.stop(),bi(e))})),e.ma}function Ui(e){return e.fa||(e.fa=function(e,t,n){const r=R(e);return r.sa(),new si(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Oi.bind(null,e),r_:Ri.bind(null,e),ta:Pi.bind(null,e),na:Ii.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await Ei(e)):(await e.fa.stop(),e.Ta.length>0&&(A(ci,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class Bi{constructor(e,t,n,r,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=a,this.deferred=new F,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,a){const s=Date.now()+n,i=new Bi(e,t,s,r,a);return i.start(n),i}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new L(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zi(e,t){if(C("AsyncQueue","".concat(t,": ").concat(e)),Te(e))return new L(M.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class qi{static emptySet(e){return new qi(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||ie.comparator(t.key,n.key):(e,t)=>ie.comparator(e.key,t.key),this.keyedMap=nr(),this.sortedSet=new mt(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof qi))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new qi;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Vi{constructor(){this.ga=new mt(ie.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):O(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Hi{constructor(e,t,n,r,a,s,i,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=i,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,a){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Hi(e,t,qi.emptySet(t),s,n,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Wi{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Gi{constructor(){this.queries=Ki(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=R(e),r=n.queries;n.queries=Ki(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new L(M.ABORTED,"Firestore shutting down"))}}function Ki(){return new Xn(e=>Gn(e),Wn)}async function Qi(e,t){const n=R(e);let r=3;const a=t.query;let s=n.queries.get(a);s?!s.ba()&&t.Da()&&(r=2):(s=new Wi,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(a,!0);break;case 1:s.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(e){const n=zi(e,"Initialization of query '".concat(Kn(t.query),"' failed"));return void t.onError(n)}n.queries.set(a,s),s.Sa.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&Xi(n)}async function Yi(e,t){const n=R(e),r=t.query;let a=3;const s=n.queries.get(r);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?a=t.Da()?0:1:!s.ba()&&t.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function $i(e,t){const n=R(e);let r=!1;for(const a of t){const e=a.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(a)&&(r=!0);t.wa=a}}r&&Xi(n)}function Ji(e,t,n){const r=R(e),a=r.queries.get(t);if(a)for(const s of a.Sa)s.onError(n);r.queries.delete(t)}function Xi(e){e.Ca.forEach(e=>{e.next()})}var Zi,eo;(eo=Zi||(Zi={})).Ma="default",eo.Cache="cache";class to{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Hi(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Hi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zi.Cache}}class no{constructor(e){this.key=e}}class ro{constructor(e){this.key=e}}class ao{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=cr(),this.mutatedKeys=cr(),this.eu=$n(e),this.tu=new qi(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Vi,r=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,s=r,i=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),d=Qn(this.query,t)?t:null,u=!!c&&this.mutatedKeys.has(c.key),h=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let m=!1;c&&d?c.data.isEqual(d.data)?u!==h&&(n.track({type:3,doc:d}),m=!0):this.su(c,d)||(n.track({type:2,doc:d}),m=!0,(o&&this.eu(d,o)>0||l&&this.eu(d,l)<0)&&(i=!0)):!c&&d?(n.track({type:0,doc:d}),m=!0):c&&!d&&(n.track({type:1,doc:c}),m=!0,(o||l)&&(i=!0)),m&&(d?(s=s.add(d),a=h?a.add(e):a.delete(e)):(s=s.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),a=a.delete(e.key),n.track({type:1,doc:e})}return{tu:s,iu:n,Cs:i,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return O(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const i=t&&!r?this._u():[],o=0===this.Xa.size&&this.current&&!r?1:0,l=o!==this.Za;return this.Za=o,0!==s.length||l?{snapshot:new Hi(this.query,e.tu,a,s,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:i}:{au:i}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Vi,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=cr(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new ro(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new no(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=cr();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Hi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const so="SyncEngine";class io{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class oo{constructor(e){this.key=e,this.hu=!1}}class lo{constructor(e,t,n,r,a,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Xn(e=>Gn(e),Wn),this.Iu=new Map,this.Eu=new Set,this.du=new mt(ie.comparator),this.Au=new Map,this.Ru=new fs,this.Vu={},this.mu=new Map,this.fu=ts.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function co(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=To(e);let a;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.lu()):a=await ho(r,t,n,!0),a}async function uo(e,t){const n=To(e);await ho(n,t,!0,!1)}async function ho(e,t,n,r){const a=await Ms(e.localStore,zn(t)),s=a.targetId,i=e.sharedClientState.addLocalQueryTarget(s,n);let o;return r&&(o=await mo(e,t,s,"current"===i,a.resumeToken)),e.isPrimaryClient&&n&&mi(e.remoteStore,a),o}async function mo(e,t,n,r,a){e.pu=(t,n,r)=>async function(e,t,n,r){let a=t.view.ru(n);a.Cs&&(a=await Fs(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,a)}));const s=r&&r.targetChanges.get(t.targetId),i=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(a,e.isPrimaryClient,s,i);return So(e,t.targetId,o.au),o.snapshot}(e,t,n,r);const s=await Fs(e.localStore,t,!0),i=new ao(t,s.Qs),o=i.ru(s.documents),l=ia.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,a),c=i.applyChanges(o,e.isPrimaryClient,l);So(e,n,c.au);const d=new io(t,n,i);return e.Tu.set(t,d),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function po(e,t,n){const r=R(e),a=r.Tu.get(t),s=r.Iu.get(a.targetId);if(s.length>1)return r.Iu.set(a.targetId,s.filter(e=>!Wn(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await Ls(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),n&&pi(r.remoteStore,a.targetId),No(r,a.targetId)}).catch(Ae)):(No(r,a.targetId),await Ls(r.localStore,a.targetId,!0))}async function fo(e,t){const n=R(e),r=n.Tu.get(t),a=n.Iu.get(r.targetId);n.isPrimaryClient&&1===a.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),pi(n.remoteStore,r.targetId))}async function go(e,t){const n=R(e);try{const e=await function(e,t){const n=R(e),r=t.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const i=[];t.targetChanges.forEach((s,o)=>{const l=a.get(o);if(!l)return;i.push(n.Pi.removeMatchingKeys(e,s.removedDocuments,o).next(()=>n.Pi.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(bt.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),a=a.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=Cs||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,s)&&i.push(n.Pi.updateTargetData(e,c))});let o=er(),l=cr();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&i.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),i.push(Is(e,s,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!r.isEqual(ve.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));i.push(t)}return Ce.waitFor(i).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Ms=a,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(I(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?I(r.hu,14607):e.removedDocuments.size>0&&(I(r.hu,42227),r.hu=!1))}),await Ao(n,e,t)}catch(e){await Ae(e)}}function yo(e,t,n){const r=R(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const a=r.view.va(t);a.snapshot&&e.push(a.snapshot)}),function(e,t){const n=R(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const a of n.Sa)a.va(t)&&(r=!0)}),r&&Xi(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function xo(e,t,n){const r=R(e);r.sharedClientState.updateQueryState(t,"rejected",n);const a=r.Au.get(t),s=a&&a.key;if(s){let e=new mt(ie.comparator);e=e.insert(s,on.newNoDocument(s,ve.min()));const n=cr().add(s),a=new sa(ve.min(),new Map,new mt(Y),e,n);await go(r,a),r.du=r.du.remove(s),r.Au.delete(t),Eo(r)}else await Ls(r.localStore,t,!1).then(()=>No(r,t,n)).catch(Ae)}async function vo(e,t){const n=R(e),r=t.batch.batchId;try{const e=await function(e,t){const n=R(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),a=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const a=n.batch,s=a.keys();let i=Ce.resolve();return s.forEach(e=>{i=i.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);I(null!==s,48541),t.version.compareTo(s)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),i.next(()=>e.mutationQueue.removeMutationBatch(t,a))}(n,e,t,a).next(()=>a.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=cr();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);jo(n,r,null),wo(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ao(n,e)}catch(e){await Ae(e)}}async function bo(e,t,n){const r=R(e);try{const e=await function(e,t){const n=R(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(I(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);jo(r,t,n),wo(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Ao(r,e)}catch(n){await Ae(n)}}function wo(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function jo(e,t,n){const r=R(e);let a=r.Vu[r.currentUser.toKey()];if(a){const e=a.get(t);e&&(n?e.reject(n):e.resolve(),a=a.remove(t)),r.Vu[r.currentUser.toKey()]=a}}function No(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||_o(e,t)})}function _o(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(pi(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Eo(e))}function So(e,t,n){for(const r of n)r instanceof no?(e.Ru.addReference(r.key,t),ko(e,r)):r instanceof ro?(A(so,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||_o(e,r.key)):O(19791,{wu:r})}function ko(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(A(so,"New document in limbo: "+n),e.Eu.add(r),Eo(e))}function Eo(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new ie(re.fromString(t)),r=e.fu.next();e.Au.set(r,new oo(n)),e.du=e.du.insert(n,r),mi(e.remoteStore,new Ga(zn(Ln(n.path)),r,"TargetPurposeLimboResolution",Oe.ce))}}async function Ao(e,t,n){const r=R(e),a=[],s=[],i=[];r.Tu.isEmpty()||(r.Tu.forEach((e,o)=>{i.push(r.pu(o,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const a=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,a?"current":"not-current")}if(e){a.push(e);const t=Ss.As(o.targetId,e);s.push(t)}}))}),await Promise.all(i),r.Pu.H_(a),await async function(e,t){const n=R(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Ce.forEach(t,t=>Ce.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Ce.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Te(e))throw e;A(As,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,a)}}}(r.localStore,s))}async function Co(e,t){const n=R(e);if(!n.currentUser.isEqual(t)){A(so,"User change. New user:",t.toKey());const e=await Os(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new L(M.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Ao(n,e.Ls)}}function Do(e,t){const n=R(e),r=n.Au.get(t);if(r&&r.hu)return cr().add(r.key);{let e=cr();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function To(e){const t=R(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=go.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Do.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=xo.bind(null,t),t.Pu.H_=$i.bind(null,t.eventManager),t.Pu.yu=Ji.bind(null,t.eventManager),t}function Oo(e){const t=R(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=vo.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=bo.bind(null,t),t}class Po{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ei(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Ts(this.persistence,new Es,e.initialUser,this.serializer)}Cu(e){return new ws(Ns.mi,this.serializer)}Du(e){return new zs}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Po.provider={build:()=>new Po};class Io extends Po{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){I(this.persistence.referenceDelegate instanceof _s,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new is(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?es.withCacheSize(this.cacheSizeBytes):es.DEFAULT;return new ws(e=>_s.mi(e,t),this.serializer)}}class Ro{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>yo(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Co.bind(null,this.syncEngine),await Li(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Gi}createDatastore(e){const t=ei(e.databaseInfo.databaseId),n=function(e){return new Xs(e)}(e.databaseInfo);return function(e,t,n,r){return new oi(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,a){return new di(e,t,n,r,a)}(this.localStore,this.datastore,e.asyncQueue,e=>yo(this.syncEngine,e,0),Hs.v()?new Hs:new qs)}createSyncEngine(e,t){return function(e,t,n,r,a,s,i){const o=new lo(e,t,n,r,a,s);return i&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=R(e);A(ci,"RemoteStore shutting down."),t.Ea.add(5),await hi(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Ro.provider={build:()=>new Ro};class Mo{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):C("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const Lo="FirestoreClient";class Fo{constructor(e,t,n,r,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=_.UNAUTHENTICATED,this.clientId=Q.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async e=>{A(Lo,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(A(Lo,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new F;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=zi(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Uo(e,t){e.asyncQueue.verifyOperationInProgress(),A(Lo,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Os(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Bo(e,t){e.asyncQueue.verifyOperationInProgress();const n=await zo(e);A(Lo,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Mi(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Mi(t.remoteStore,n)),e._onlineComponents=t}async function zo(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){A(Lo,"Using user provided OfflineComponentProvider");try{await Uo(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===M.FAILED_PRECONDITION||e.code===M.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;D("Error using user provided cache. Falling back to memory cache: "+n),await Uo(e,new Po)}}else A(Lo,"Using default OfflineComponentProvider"),await Uo(e,new Io(void 0));return e._offlineComponents}async function qo(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(A(Lo,"Using user provided OnlineComponentProvider"),await Bo(e,e._uninitializedComponentsProvider._online)):(A(Lo,"Using default OnlineComponentProvider"),await Bo(e,new Ro))),e._onlineComponents}function Vo(e){return qo(e).then(e=>e.syncEngine)}async function Ho(e){const t=await qo(e),n=t.eventManager;return n.onListen=co.bind(null,t.syncEngine),n.onUnlisten=po.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=uo.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=fo.bind(null,t.syncEngine),n}function Wo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new F;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,a){const s=new Mo({next:o=>{s.Nu(),t.enqueueAndForget(()=>Yi(e,i));const l=o.docs.has(n);!l&&o.fromCache?a.reject(new L(M.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?a.reject(new L(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(o)},error:e=>a.reject(e)}),i=new to(Ln(n.path),s,{includeMetadataChanges:!0,qa:!0});return Qi(e,i)}(await Ho(e),e.asyncQueue,t,n,r)),r.promise}function Go(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new F;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,a){const s=new Mo({next:n=>{s.Nu(),t.enqueueAndForget(()=>Yi(e,i)),n.fromCache&&"server"===r.source?a.reject(new L(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:e=>a.reject(e)}),i=new to(n,s,{includeMetadataChanges:!0,qa:!0});return Qi(e,i)}(await Ho(e),e.asyncQueue,t,n,r)),r.promise}function Ko(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Qo=new Map,Yo="firestore.googleapis.com",$o=!0;class Jo{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new L(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Yo,this.ssl=$o}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:$o;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Za;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<rs)throw new L(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new L(M.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ko(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new L(M.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new L(M.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new L(M.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xo{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jo({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new L(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jo(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new B;switch(e.type){case"firstParty":return new H(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new L(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Qo.get(e);t&&(A("ComponentProvider","Removing Datastore"),Qo.delete(e),t.terminate())}(this),Promise.resolve()}}class Zo{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Zo(this.firestore,e,this._query)}}class el{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new el(this.firestore,e,this._key)}toJSON(){return{type:el._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(fe(t,el._jsonSchema))return new el(e,n||null,new ie(re.fromString(t.referencePath)))}}el._jsonSchemaVersion="firestore/documentReference/1.0",el._jsonSchema={type:pe("string",el._jsonSchemaVersion),referencePath:pe("string")};class tl extends Zo{constructor(e,t,n){super(e,t,Ln(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new el(this.firestore,null,new ie(e))}withConverter(e){return new tl(this.firestore,e,this._path)}}function nl(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=(0,c.Ku)(e),oe("collection","path",t),e instanceof Xo){const n=re.fromString(t,...r);return ce(n),new tl(e,null,n)}{if(!(e instanceof el||e instanceof tl))throw new L(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(re.fromString(t,...r));return ce(n),new tl(e.firestore,null,n)}}function rl(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=(0,c.Ku)(e),1===arguments.length&&(t=Q.newId()),oe("doc","path",t),e instanceof Xo){const n=re.fromString(t,...r);return le(n),new el(e,null,new ie(n))}{if(!(e instanceof el||e instanceof tl))throw new L(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(re.fromString(t,...r));return le(n),new el(e.firestore,e instanceof tl?e.converter:null,new ie(n))}}const al="AsyncQueue";class sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ti(this,"async_queue_retry"),this._c=()=>{const e=Zs();e&&A(al,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Zs();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Zs();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new F;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Te(e))throw e;A(al,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,C("INTERNAL UNHANDLED ERROR: ",il(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Bi.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&O(47125,{Pc:il(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function il(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function ol(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class ll extends Xo{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new sl,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sl(e),this._firestoreClient=void 0,await e}}}function cl(e,t){const n="object"==typeof e?e:(0,i.Sx)(),r="string"==typeof e?e:t||Pt,a=(0,i.j6)(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const e=(0,c.yU)("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=he(e,Xo);const a=(0,c.zJ)(t),i=e._getSettings(),o=(0,s.A)((0,s.A)({},i),{},{emulatorOptions:e._getEmulatorOptions()}),l="".concat(t,":").concat(n);a&&((0,c.gE)("https://".concat(l)),(0,c.P1)("Firestore",!0)),i.host!==Yo&&i.host!==l&&D("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=(0,s.A)((0,s.A)({},i),{},{host:l,ssl:a,emulatorOptions:r});if(!(0,c.bD)(d,o)&&(e._setSettings(d),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=_.MOCK_USER;else{var u;t=(0,c.Fy)(r.mockUserToken,null===(u=e._app)||void 0===u?void 0:u.options.projectId);const a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new L(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new _(a)}e._authCredentials=new z(new U(t,n))}}(a,...e)}return a}function dl(e){if(e._terminated)throw new L(M.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||ul(e),e._firestoreClient}function ul(e){var t,n,r;const a=e._freezeSettings(),s=function(e,t,n,r){return new Ot(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Ko(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||null!==(n=a.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=a.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new Fo(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class hl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new hl(bt.fromBase64String(e))}catch(e){throw new L(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new hl(bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:hl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(fe(e,hl._jsonSchema))return hl.fromBase64String(e.bytes)}}hl._jsonSchemaVersion="firestore/bytes/1.0",hl._jsonSchema={type:pe("string",hl._jsonSchemaVersion),bytes:pe("string")};class ml{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new L(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new se(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class pl{constructor(e){this._methodName=e}}class fl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:fl._jsonSchemaVersion}}static fromJSON(e){if(fe(e,fl._jsonSchema))return new fl(e.latitude,e.longitude)}}fl._jsonSchemaVersion="firestore/geoPoint/1.0",fl._jsonSchema={type:pe("string",fl._jsonSchemaVersion),latitude:pe("number"),longitude:pe("number")};class gl{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:gl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(fe(e,gl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new gl(e.vectorValues);throw new L(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}gl._jsonSchemaVersion="firestore/vectorValue/1.0",gl._jsonSchema={type:pe("string",gl._jsonSchemaVersion),vectorValues:pe("object")};const yl=/^__.*__$/;class xl{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Fr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Lr(e,this.data,t,this.fieldTransforms)}}class vl{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Fr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function bl(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw O(40011,{Ac:e})}}class wl{constructor(e,t,n,r,a,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===a&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new wl((0,s.A)((0,s.A)({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ul(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(bl(this.Ac)&&yl.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class jl{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ei(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new wl({Ac:e,methodName:t,Dc:n,path:se.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Nl(e){const t=e._freezeSettings(),n=ei(e._databaseId);return new jl(e._databaseId,!!t.ignoreUndefinedProperties,n)}function _l(e,t,n,r,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=e.Cc(s.merge||s.mergeFields?2:0,t,n,a);Rl("Data must be an object, but it was:",i,r);const o=Pl(r,i);let l,c;if(s.merge)l=new xt(i.fieldMask),c=i.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const a=Ml(t,r,n);if(!i.contains(a))throw new L(M.INVALID_ARGUMENT,"Field '".concat(a,"' is specified in your field mask but missing from your input data."));Bl(e,a)||e.push(a)}l=new xt(e),c=i.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=i.fieldTransforms;return new xl(new an(o),l,c)}class Sl extends pl{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sl}}function kl(e,t,n){return new wl({Ac:3,Dc:t.settings.Dc,methodName:e._methodName,fc:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class El extends pl{_toFieldTransform(e){return new Er(e.path,new vr)}isEqual(e){return e instanceof El}}class Al extends pl{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=kl(this,e,!0),n=this.vc.map(e=>Ol(e,t)),r=new br(n);return new Er(e.path,r)}isEqual(e){return e instanceof Al&&(0,c.bD)(this.vc,e.vc)}}function Cl(e,t,n,r){const a=e.Cc(1,t,n);Rl("Data must be an object, but it was:",a,r);const s=[],i=an.empty();ut(r,(e,r)=>{const o=Fl(t,e,n);r=(0,c.Ku)(r);const l=a.yc(o);if(r instanceof Sl)s.push(o);else{const e=Ol(r,l);null!=e&&(s.push(o),i.set(o,e))}});const o=new xt(s);return new vl(i,o,a.fieldTransforms)}function Dl(e,t,n,r,a,s){const i=e.Cc(1,t,n),o=[Ml(t,r,n)],l=[a];if(s.length%2!=0)throw new L(M.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let c=0;c<s.length;c+=2)o.push(Ml(t,s[c])),l.push(s[c+1]);const d=[],u=an.empty();for(let m=o.length-1;m>=0;--m)if(!Bl(d,o[m])){const e=o[m];let t=l[m];t=(0,c.Ku)(t);const n=i.yc(e);if(t instanceof Sl)d.push(e);else{const r=Ol(t,n);null!=r&&(d.push(e),u.set(e,r))}}const h=new xt(d);return new vl(u,h,i.fieldTransforms)}function Tl(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Ol(n,e.Cc(r?4:3,t))}function Ol(e,t){if(Il(e=(0,c.Ku)(e)))return Rl("Unsupported field value:",t,e),Pl(e,t);if(e instanceof pl)return function(e,t){if(!bl(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const a of e){let e=Ol(a,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,c.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return pr(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=xe.fromDate(e);return{timestampValue:va(t.serializer,n)}}if(e instanceof xe){const n=new xe(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:va(t.serializer,n)}}if(e instanceof fl)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof hl)return{bytesValue:ba(t.serializer,e._byteString)};if(e instanceof el){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Na(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof gl)return function(e,t){return{mapValue:{fields:{[Rt]:{stringValue:Ft},[Ut]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return hr(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(ue(e)))}(e,t)}function Pl(e,t){const n={};return ht(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ut(e,(e,r)=>{const a=Ol(r,t.mc(e));null!=a&&(n[e]=a)}),{mapValue:{fields:n}}}function Il(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof xe||e instanceof fl||e instanceof hl||e instanceof el||e instanceof pl||e instanceof gl)}function Rl(e,t,n){if(!Il(n)||!de(n)){const r=ue(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function Ml(e,t,n){if((t=(0,c.Ku)(t))instanceof ml)return t._internalPath;if("string"==typeof t)return Fl(e,t);throw Ul("Field path arguments must be of type string or ",e,!1,void 0,n)}const Ll=new RegExp("[~\\*/\\[\\]]");function Fl(e,t,n){if(t.search(Ll)>=0)throw Ul("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new ml(...t.split("."))._internalPath}catch(r){throw Ul("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Ul(e,t,n,r,a){const s=r&&!r.isEmpty(),i=void 0!==a;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||i)&&(l+=" (found",s&&(l+=" in field ".concat(r)),i&&(l+=" in document ".concat(a)),l+=")"),new L(M.INVALID_ARGUMENT,o+e+l)}function Bl(e,t){return e.some(e=>e.isEqual(t))}class zl{constructor(e,t,n,r,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new el(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new ql(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Vl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class ql extends zl{data(){return super.data()}}function Vl(e,t){return"string"==typeof t?Fl(e,t):t instanceof ml?t._internalPath:t._delegate._internalPath}function Hl(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new L(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wl{}class Gl extends Wl{}function Kl(e,t){let n=[];for(var r=arguments.length,a=new Array(r>2?r-2:0),s=2;s<r;s++)a[s-2]=arguments[s];t instanceof Wl&&n.push(t),n=n.concat(a),function(e){const t=e.filter(e=>e instanceof $l).length,n=e.filter(e=>e instanceof Ql).length;if(t>1||t>0&&n>0)throw new L(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)e=i._apply(e);return e}class Ql extends Gl{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Ql(e,t,n)}_apply(e){const t=this._parse(e);return ic(e._query,t),new Zo(e.firestore,e.converter,Vn(e._query,t))}_parse(e){const t=Nl(e.firestore),n=function(e,t,n,r,a,s,i){let o;if(a.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new L(M.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){sc(i,s);const t=[];for(const n of i)t.push(ac(r,e,n));o={arrayValue:{values:t}}}else o=ac(r,e,i)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||sc(i,s),o=Tl(n,t,i,"in"===s||"not-in"===s);return pn.create(a,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Yl(e,t,n){const r=t,a=Vl("where",e);return Ql._create(a,r,n)}class $l extends Wl{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new $l(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:fn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const a of r)ic(n,a),n=Vn(n,a)}(e._query,t),new Zo(e.firestore,e.converter,Vn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Jl extends Gl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Jl(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new L(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new L(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new un(t,n)}(e._query,this._field,this._direction);return new Zo(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Rn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Xl(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Vl("orderBy",e);return Jl._create(n,t)}class Zl extends Gl{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Zl(e,t,n)}_apply(e){return new Zo(e.firestore,e.converter,Hn(e._query,this._limit,this._limitType))}}function ec(e){return me("limit",e),Zl._create("limit",e,"F")}class tc extends Gl{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new tc(e,t,n)}_apply(e){const t=rc(e,this.type,this._docOrFields,this._inclusive);return new Zo(e.firestore,e.converter,function(e,t){return new Rn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function nc(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return tc._create("startAfter",t,!1)}function rc(e,t,n,r){if(n[0]=(0,c.Ku)(n[0]),n[0]instanceof zl)return function(e,t,n,r,a){if(!r)throw new L(M.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));const s=[];for(const i of Bn(e))if(i.field.isKeyField())s.push(Yt(t,r.key));else{const e=r.data.field(i.field);if(Ct(e))throw new L(M.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+i.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=i.field.canonicalString();throw new L(M.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}s.push(e)}return new ln(s,a)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const a=Nl(e.firestore);return function(e,t,n,r,a,s){const i=e.explicitOrderBy;if(a.length>i.length)throw new L(M.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const o=[];for(let l=0;l<a.length;l++){const s=a[l];if(i[l].field.isKeyField()){if("string"!=typeof s)throw new L(M.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof s));if(!Un(e)&&-1!==s.indexOf("/"))throw new L(M.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(s,"' contains a slash."));const n=e.path.child(re.fromString(s));if(!ie.isDocumentKey(n))throw new L(M.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(n,"' is not because it contains an odd number of segments."));const a=new ie(n);o.push(Yt(t,a))}else{const e=Tl(n,r,s);o.push(e)}}return new ln(o,s)}(e._query,e.firestore._databaseId,a,t,n,r)}}function ac(e,t,n){if("string"==typeof(n=(0,c.Ku)(n))){if(""===n)throw new L(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Un(t)&&-1!==n.indexOf("/"))throw new L(M.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(re.fromString(n));if(!ie.isDocumentKey(r))throw new L(M.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Yt(e,new ie(r))}if(n instanceof el)return Yt(e,n._key);throw new L(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(ue(n),"."))}function sc(e,t){if(!Array.isArray(e)||0===e.length)throw new L(M.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function ic(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new L(M.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new L(M.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class oc{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Bt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_t(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw O(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return ut(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[Ut].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>Nt(e.doubleValue));return new gl(n)}convertGeoPoint(e){return new fl(Nt(e.latitude),Nt(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Dt(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Tt(e));default:return null}}convertTimestamp(e){const t=jt(e);return new xe(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=re.fromString(e);I(Wa(n),9688,{name:e});const r=new It(n.get(1),n.get(3)),a=new ie(n.popFirst(5));return r.isEqual(t)||C("Document ".concat(a," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),a}}function lc(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class cc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dc extends zl{constructor(e,t,n,r,a,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new uc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Vl("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=dc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}dc._jsonSchemaVersion="firestore/documentSnapshot/1.0",dc._jsonSchema={type:pe("string",dc._jsonSchemaVersion),bundleSource:pe("string","DocumentSnapshot"),bundleName:pe("string"),bundle:pe("string")};class uc extends dc{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class hc{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new cc(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new uc(this._firestore,this._userDataWriter,n.key,n,new cc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new L(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new uc(e._firestore,e._userDataWriter,n.doc.key,n.doc,new cc(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new uc(e._firestore,e._userDataWriter,t.doc.key,t.doc,new cc(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,s=-1;return 0!==t.type&&(a=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:mc(t.type),doc:r,oldIndex:a,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Q.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function mc(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return O(61501,{type:e})}}function pc(e){e=he(e,el);const t=he(e.firestore,ll);return Wo(dl(t),e._key).then(n=>Nc(t,e,n))}hc._jsonSchemaVersion="firestore/querySnapshot/1.0",hc._jsonSchema={type:pe("string",hc._jsonSchemaVersion),bundleSource:pe("string","QuerySnapshot"),bundleName:pe("string"),bundle:pe("string")};class fc extends oc{constructor(e){super(),this.firestore=e}convertBytes(e){return new hl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new el(this.firestore,null,t)}}function gc(e){e=he(e,Zo);const t=he(e.firestore,ll),n=dl(t),r=new fc(t);return Hl(e._query),Go(n,e._query).then(n=>new hc(t,r,e,n))}function yc(e,t,n){e=he(e,el);const r=he(e.firestore,ll),a=lc(e.converter,t,n);return jc(r,[_l(Nl(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,Cr.none())])}function xc(e,t,n){e=he(e,el);const r=he(e.firestore,ll),a=Nl(r);let s;for(var i=arguments.length,o=new Array(i>3?i-3:0),l=3;l<i;l++)o[l-3]=arguments[l];return s="string"==typeof(t=(0,c.Ku)(t))||t instanceof ml?Dl(a,"updateDoc",e._key,t,n,o):Cl(a,"updateDoc",e._key,t),jc(r,[s.toMutation(e._key,Cr.exists(!0))])}function vc(e){return jc(he(e.firestore,ll),[new qr(e._key,Cr.none())])}function bc(e,t){const n=he(e.firestore,ll),r=rl(e),a=lc(e.converter,t);return jc(n,[_l(Nl(e.firestore),"addDoc",r._key,a,null!==e.converter,{}).toMutation(r._key,Cr.exists(!1))]).then(()=>r)}function wc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=(0,c.Ku)(e);let a={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof n[s]||ol(n[s])||(a=n[s++]);const i={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(ol(n[s])){var o,l,d;const e=n[s];n[s]=null===(o=e.next)||void 0===o?void 0:o.bind(e),n[s+1]=null===(l=e.error)||void 0===l?void 0:l.bind(e),n[s+2]=null===(d=e.complete)||void 0===d?void 0:d.bind(e)}let u,h,m;if(e instanceof el)h=he(e.firestore,ll),m=Ln(e._key.path),u={next:t=>{n[s]&&n[s](Nc(h,e,t))},error:n[s+1],complete:n[s+2]};else{const t=he(e,Zo);h=he(t.firestore,ll),m=t._query;const r=new fc(h);u={next:e=>{n[s]&&n[s](new hc(h,r,t,e))},error:n[s+1],complete:n[s+2]},Hl(e._query)}return function(e,t,n,r){const a=new Mo(r),s=new to(t,a,n);return e.asyncQueue.enqueueAndForget(async()=>Qi(await Ho(e),s)),()=>{a.Nu(),e.asyncQueue.enqueueAndForget(async()=>Yi(await Ho(e),s))}}(dl(h),m,i,u)}function jc(e,t){return function(e,t){const n=new F;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Oo(e);try{const e=await function(e,t){const n=R(e),r=xe.now(),a=t.reduce((e,t)=>e.add(t.key),cr());let s,i;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=er(),l=cr();return n.Ns.getEntries(e,a).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(a=>{s=a;const i=[];for(const e of t){const t=Rr(e,s.get(e.key).overlayedDocument);null!=t&&i.push(new Fr(e.key,t,sn(t.value.mapValue),Cr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,i,t)}).next(t=>{i=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:i.batchId,changes:rr(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new mt(Y)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await Ao(r,e.changes),await Ei(r.remoteStore)}catch(e){const t=zi(e,"Failed to persist write");n.reject(t)}}(await Vo(e),t,n)),n.promise}(dl(e),t)}function Nc(e,t,n){const r=n.docs.get(t._key),a=new fc(e);return new dc(e,a,t._key,r,new cc(n.hasPendingWrites,n.fromCache),t.converter)}class _c{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Nl(e)}set(e,t,n){this._verifyNotCommitted();const r=Sc(e,this._firestore),a=lc(r.converter,t,n),s=_l(this._dataReader,"WriteBatch.set",r._key,a,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Cr.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Sc(e,this._firestore);let a;for(var s=arguments.length,i=new Array(s>3?s-3:0),o=3;o<s;o++)i[o-3]=arguments[o];return a="string"==typeof(t=(0,c.Ku)(t))||t instanceof ml?Dl(this._dataReader,"WriteBatch.update",r._key,t,n,i):Cl(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(a.toMutation(r._key,Cr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Sc(e,this._firestore);return this._mutations=this._mutations.concat(new qr(t._key,Cr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new L(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Sc(e,t){if((e=(0,c.Ku)(e)).firestore!==t)throw new L(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function kc(){return new Sl("deleteField")}function Ec(){return new El("serverTimestamp")}function Ac(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Al("arrayUnion",t)}function Cc(e){return dl(e=he(e,ll)),new _c(e,t=>jc(e,t))}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){S=e}(i.MF),(0,i.om)(new o.uA("firestore",(e,n)=>{let{instanceIdentifier:r,options:a}=n;const i=e.getProvider("app").getImmediate(),o=new ll(new q(e.getProvider("auth-internal")),new G(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new L(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new It(e.options.projectId,t)}(i,r),i);return a=(0,s.A)({useFetchStreams:t},a),o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(j,N,e),(0,i.KO)(j,N,"esm2020")}()},6672:(e,t,n)=>{"use strict";var r=n(5043);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=n,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),a="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:a,fetchPriority:s}):"script"===n&&i.d.X(e,{crossOrigin:r,integrity:a,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);i.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},6770:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2777);t.toNumber=function(e){return r.isSymbol(e)?NaN:Number(e)}},7004:(e,t,n)=>{"use strict";var r=n(8853),a=n(5043),s=n(7950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(i(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var m=Object.assign,p=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),w=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),k=Symbol.for("react.lazy");Symbol.for("react.scope");var E=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var A=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var C=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=C&&e[C]||e["@@iterator"])?e:null}var T=Symbol.for("react.client.reference");function O(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===T?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case y:return"Fragment";case v:return"Profiler";case x:return"StrictMode";case N:return"Suspense";case _:return"SuspenseList";case E:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case w:return e.displayName||"Context";case b:return(e._context.displayName||"Context")+".Consumer";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case S:return null!==(t=e.displayName||null)?t:O(e.type)||"Memo";case k:t=e._payload,e=e._init;try{return O(e(t))}catch(n){}}return null}var P=Array.isArray,I=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M={pending:!1,data:null,method:null,action:null},L=[],F=-1;function U(e){return{current:e}}function B(e){0>F||(e.current=L[F],L[F]=null,F--)}function z(e,t){F++,L[F]=e.current,e.current=t}var q,V,H=U(null),W=U(null),G=U(null),K=U(null);function Q(e,t){switch(z(G,t),z(W,e),z(H,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?yu(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=xu(t=yu(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(H),z(H,e)}function Y(){B(H),B(W),B(G)}function $(e){null!==e.memoizedState&&z(K,e);var t=H.current,n=xu(t,e.type);t!==n&&(z(W,e),z(H,n))}function J(e){W.current===e&&(B(H),B(W)),K.current===e&&(B(K),dh._currentValue=M)}function X(e){if(void 0===q)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);q=t&&t[1]||"",V=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+q+e+V}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var r=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(s){r=s}e.call(n.prototype)}}else{try{throw Error()}catch(i){r=i}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(o){if(o&&r&&"string"===typeof o.stack)return[o.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=r.DetermineComponentFrameRoot(),i=s[0],o=s[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(a=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===l.length||a===c.length)for(r=l.length-1,a=c.length-1;1<=r&&0<=a&&l[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(l[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||l[r]!==c[a]){var d="\n"+l[r].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=r&&0<=a);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?X(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return X(e.type);case 16:return X("Lazy");case 13:return e.child!==t&&null!==t?X("Suspense Fallback"):X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return X("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var re=Object.prototype.hasOwnProperty,ae=r.unstable_scheduleCallback,se=r.unstable_cancelCallback,ie=r.unstable_shouldYield,oe=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,de=r.unstable_ImmediatePriority,ue=r.unstable_UserBlockingPriority,he=r.unstable_NormalPriority,me=r.unstable_LowPriority,pe=r.unstable_IdlePriority,fe=r.log,ge=r.unstable_setDisableYieldValue,ye=null,xe=null;function ve(e){if("function"===typeof fe&&ge(e),xe&&"function"===typeof xe.setStrictMode)try{xe.setStrictMode(ye,e)}catch(t){}}var be=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(we(e)/je|0)|0},we=Math.log,je=Math.LN2;var Ne=256,_e=262144,Se=4194304;function ke(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ee(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~s)?a=ke(r):0!==(i&=o)?a=ke(i):n||0!==(n=o&~e)&&(a=ke(n)):0!==(o=r&~s)?a=ke(o):0!==i?a=ke(i):n||0!==(n=r&~e)&&(a=ke(n)),0===a?0:0!==t&&t!==a&&0===(t&s)&&((s=a&-a)>=(n=t&-t)||32===s&&0!==(4194048&n))?t:a}function Ae(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ce(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function De(){var e=Se;return 0===(62914560&(Se<<=1))&&(Se=4194304),e}function Te(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Oe(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Pe(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-be(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function Ie(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-be(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function Re(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Me(n))&(e.suspendedLanes|t))?0:n}function Me(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Le(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Fe(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:kh(e.type)}function Ue(e,t){var n=R.p;try{return R.p=e,t()}finally{R.p=n}}var Be=Math.random().toString(36).slice(2),ze="__reactFiber$"+Be,qe="__reactProps$"+Be,Ve="__reactContainer$"+Be,He="__reactEvents$"+Be,We="__reactListeners$"+Be,Ge="__reactHandles$"+Be,Ke="__reactResources$"+Be,Qe="__reactMarker$"+Be;function Ye(e){delete e[ze],delete e[qe],delete e[He],delete e[We],delete e[Ge]}function $e(e){var t=e[ze];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ve]||n[ze]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Mu(e);null!==e;){if(n=e[ze])return n;e=Mu(e)}return t}n=(e=n).parentNode}return null}function Je(e){if(e=e[ze]||e[Ve]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Xe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function Ze(e){var t=e[Ke];return t||(t=e[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Qe]=!0}var tt=new Set,nt={};function rt(e,t){at(e,t),at(e+"Capture",t)}function at(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},ot={};function lt(e,t,n){if(a=t,re.call(ot,a)||!re.call(it,a)&&(st.test(a)?ot[a]=!0:(it[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function ct(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function dt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function ut(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function mt(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function pt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ht(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function yt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function xt(e,t,n,r,a,s,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ut(t)):e.value!==""+ut(t)&&(e.value=""+ut(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?bt(e,i,ut(t)):null!=n?bt(e,i,ut(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=s&&(e.defaultChecked=!!s),null!=a&&(e.checked=a&&"function"!==typeof a&&"symbol"!==typeof a),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ut(o):e.removeAttribute("name")}function vt(e,t,n,r,a,s,i,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return void mt(e);n=null!=n?""+ut(n):"",t=null!=t?""+ut(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:a)&&"symbol"!==typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i),mt(e)}function bt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function wt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ut(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function jt(e,t,n){null==t||((t=""+ut(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ut(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Nt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(i(92));if(P(r)){if(1<r.length)throw Error(i(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ut(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),mt(e)}function _t(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Et(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var a in t)r=t[a],t.hasOwnProperty(a)&&n[a]!==r&&kt(e,a,r)}else for(var s in t)t.hasOwnProperty(s)&&kt(e,s,t[s])}function At(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ct=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Dt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tt(e){return Dt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ot(){}var Pt=null;function It(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Rt=null,Mt=null;function Lt(e){var t=Je(e);if(t&&(e=t.stateNode)){var n=e[qe]||null;e:switch(e=t.stateNode,t.type){case"input":if(xt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+yt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=r[qe]||null;if(!a)throw Error(i(90));xt(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&pt(r)}break e;case"textarea":jt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&wt(e,!!n.multiple,t,!1)}}}var Ft=!1;function Ut(e,t,n){if(Ft)return e(t,n);Ft=!0;try{return e(t)}finally{if(Ft=!1,(null!==Rt||null!==Mt)&&(Zc(),Rt&&(t=Rt,e=Mt,Mt=Rt=null,Lt(t),e)))for(t=0;t<e.length;t++)Lt(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[qe]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var zt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),qt=!1;if(zt)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){qt=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch(Jh){qt=!1}var Ht=null,Wt=null,Gt=null;function Kt(){if(Gt)return Gt;var e,t,n=Wt,r=n.length,a="value"in Ht?Ht.value:Ht.textContent,s=a.length;for(e=0;e<r&&n[e]===a[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===a[s-t];t++);return Gt=a.slice(e,1<t?1-t:void 0)}function Qt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Yt(){return!0}function $t(){return!1}function Jt(e){function t(t,n,r,a,s){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Yt:$t,this.isPropagationStopped=$t,this}return m(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Yt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Yt)},persist:function(){},isPersistent:Yt}),t}var Xt,Zt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Jt(tn),rn=m({},tn,{view:0,detail:0}),an=Jt(rn),sn=m({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Xt=e.screenX-en.screenX,Zt=e.screenY-en.screenY):Zt=Xt=0,en=e),Xt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),on=Jt(sn),ln=Jt(m({},sn,{dataTransfer:0})),cn=Jt(m({},rn,{relatedTarget:0})),dn=Jt(m({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),un=Jt(m({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=Jt(m({},tn,{data:0})),mn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=fn[e])&&!!t[e]}function yn(){return gn}var xn=Jt(m({},rn,{key:function(e){if(e.key){var t=mn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Qt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?pn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yn,charCode:function(e){return"keypress"===e.type?Qt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Qt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),vn=Jt(m({},sn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),bn=Jt(m({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yn})),wn=Jt(m({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=Jt(m({},sn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Nn=Jt(m({},tn,{newState:0,oldState:0})),_n=[9,13,27,32],Sn=zt&&"CompositionEvent"in window,kn=null;zt&&"documentMode"in document&&(kn=document.documentMode);var En=zt&&"TextEvent"in window&&!kn,An=zt&&(!Sn||kn&&8<kn&&11>=kn),Cn=String.fromCharCode(32),Dn=!1;function Tn(e,t){switch(e){case"keyup":return-1!==_n.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function On(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pn=!1;var In={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!In[e.type]:"textarea"===t}function Mn(e,t,n,r){Rt?Mt?Mt.push(r):Mt=[r]:Rt=r,0<(t=ru(t,"onChange")).length&&(n=new nn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ln=null,Fn=null;function Un(e){Yd(e,0)}function Bn(e){if(pt(Xe(e)))return e}function zn(e,t){if("change"===e)return t}var qn=!1;if(zt){var Vn;if(zt){var Hn="oninput"in document;if(!Hn){var Wn=document.createElement("div");Wn.setAttribute("oninput","return;"),Hn="function"===typeof Wn.oninput}Vn=Hn}else Vn=!1;qn=Vn&&(!document.documentMode||9<document.documentMode)}function Gn(){Ln&&(Ln.detachEvent("onpropertychange",Kn),Fn=Ln=null)}function Kn(e){if("value"===e.propertyName&&Bn(Fn)){var t=[];Mn(t,Fn,e,It(e)),Ut(Un,t)}}function Qn(e,t,n){"focusin"===e?(Gn(),Fn=n,(Ln=t).attachEvent("onpropertychange",Kn)):"focusout"===e&&Gn()}function Yn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Bn(Fn)}function $n(e,t){if("click"===e)return Bn(t)}function Jn(e,t){if("input"===e||"change"===e)return Bn(t)}var Xn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Zn(e,t){if(Xn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!re.call(t,a)||!Xn(e[a],t[a]))return!1}return!0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tr(e,t){var n,r=er(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=er(r)}}function nr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rr(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function ar(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var sr=zt&&"documentMode"in document&&11>=document.documentMode,ir=null,or=null,lr=null,cr=!1;function dr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;cr||null==ir||ir!==ft(r)||("selectionStart"in(r=ir)&&ar(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},lr&&Zn(lr,r)||(lr=r,0<(r=ru(or,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ir)))}function ur(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hr={animationend:ur("Animation","AnimationEnd"),animationiteration:ur("Animation","AnimationIteration"),animationstart:ur("Animation","AnimationStart"),transitionrun:ur("Transition","TransitionRun"),transitionstart:ur("Transition","TransitionStart"),transitioncancel:ur("Transition","TransitionCancel"),transitionend:ur("Transition","TransitionEnd")},mr={},pr={};function fr(e){if(mr[e])return mr[e];if(!hr[e])return e;var t,n=hr[e];for(t in n)if(n.hasOwnProperty(t)&&t in pr)return mr[e]=n[t];return e}zt&&(pr=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);var gr=fr("animationend"),yr=fr("animationiteration"),xr=fr("animationstart"),vr=fr("transitionrun"),br=fr("transitionstart"),wr=fr("transitioncancel"),jr=fr("transitionend"),Nr=new Map,_r="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sr(e,t){Nr.set(e,t),rt(t,[e])}_r.push("scrollEnd");var kr="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Er=[],Ar=0,Cr=0;function Dr(){for(var e=Ar,t=Cr=Ar=0;t<e;){var n=Er[t];Er[t++]=null;var r=Er[t];Er[t++]=null;var a=Er[t];Er[t++]=null;var s=Er[t];if(Er[t++]=null,null!==r&&null!==a){var i=r.pending;null===i?a.next=a:(a.next=i.next,i.next=a),r.pending=a}0!==s&&Ir(n,a,s)}}function Tr(e,t,n,r){Er[Ar++]=e,Er[Ar++]=t,Er[Ar++]=n,Er[Ar++]=r,Cr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Or(e,t,n,r){return Tr(e,t,n,r),Rr(e)}function Pr(e,t){return Tr(e,null,null,t),Rr(e)}function Ir(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(r=s.alternate)&&(r.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(a=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,a&&null!==t&&(a=31-be(n),null===(r=(e=s.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),s):null}function Rr(e){if(50<Hc)throw Hc=0,Wc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Mr={};function Lr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(e,t,n,r){return new Lr(e,t,n,r)}function Ur(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Br(e,t){var n=e.alternate;return null===n?((n=Fr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function zr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function qr(e,t,n,r,a,s){var o=0;if(r=e,"function"===typeof e)Ur(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,H.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case E:return(e=Fr(31,n,t,a)).elementType=E,e.lanes=s,e;case y:return Vr(n.children,a,s,t);case x:o=8,a|=24;break;case v:return(e=Fr(12,n,t,2|a)).elementType=v,e.lanes=s,e;case N:return(e=Fr(13,n,t,a)).elementType=N,e.lanes=s,e;case _:return(e=Fr(19,n,t,a)).elementType=_,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:o=10;break e;case b:o=9;break e;case j:o=11;break e;case S:o=14;break e;case k:o=16,r=null;break e}o=29,n=Error(i(130,null===e?"null":typeof e,"")),r=null}return(t=Fr(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Vr(e,t,n,r){return(e=Fr(7,e,r,t)).lanes=n,e}function Hr(e,t,n){return(e=Fr(6,e,null,t)).lanes=n,e}function Wr(e){var t=Fr(18,null,null,0);return t.stateNode=e,t}function Gr(e,t,n){return(t=Fr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Kr=new WeakMap;function Qr(e,t){if("object"===typeof e&&null!==e){var n=Kr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Kr.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Yr=[],$r=0,Jr=null,Xr=0,Zr=[],ea=0,ta=null,na=1,ra="";function aa(e,t){Yr[$r++]=Xr,Yr[$r++]=Jr,Jr=e,Xr=t}function sa(e,t,n){Zr[ea++]=na,Zr[ea++]=ra,Zr[ea++]=ta,ta=e;var r=na;e=ra;var a=32-be(r)-1;r&=~(1<<a),n+=1;var s=32-be(t)+a;if(30<s){var i=a-a%5;s=(r&(1<<i)-1).toString(32),r>>=i,a-=i,na=1<<32-be(t)+a|n<<a|r,ra=s+e}else na=1<<s|n<<a|r,ra=e}function ia(e){null!==e.return&&(aa(e,1),sa(e,1,0))}function oa(e){for(;e===Jr;)Jr=Yr[--$r],Yr[$r]=null,Xr=Yr[--$r],Yr[$r]=null;for(;e===ta;)ta=Zr[--ea],Zr[ea]=null,ra=Zr[--ea],Zr[ea]=null,na=Zr[--ea],Zr[ea]=null}function la(e,t){Zr[ea++]=na,Zr[ea++]=ra,Zr[ea++]=ta,na=t.id,ra=t.overflow,ta=e}var ca=null,da=null,ua=!1,ha=null,ma=!1,pa=Error(i(519));function fa(e){throw wa(Qr(Error(i(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),pa}function ga(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[ze]=e,t[qe]=r,n){case"dialog":$d("cancel",t),$d("close",t);break;case"iframe":case"object":case"embed":$d("load",t);break;case"video":case"audio":for(n=0;n<Kd.length;n++)$d(Kd[n],t);break;case"source":$d("error",t);break;case"img":case"image":case"link":$d("error",t),$d("load",t);break;case"details":$d("toggle",t);break;case"input":$d("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":$d("invalid",t);break;case"textarea":$d("invalid",t),Nt(t,r.value,r.defaultValue,r.children)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||cu(t.textContent,n)?(null!=r.popover&&($d("beforetoggle",t),$d("toggle",t)),null!=r.onScroll&&$d("scroll",t),null!=r.onScrollEnd&&$d("scrollend",t),null!=r.onClick&&(t.onclick=Ot),t=!0):t=!1,t||fa(e,!0)}function ya(e){for(ca=e.return;ca;)switch(ca.tag){case 5:case 31:case 13:return void(ma=!1);case 27:case 3:return void(ma=!0);default:ca=ca.return}}function xa(e){if(e!==ca)return!1;if(!ua)return ya(e),ua=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||vu(e.type,e.memoizedProps)),t=!t),t&&da&&fa(e),ya(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));da=Ru(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));da=Ru(e)}else 27===n?(n=da,ku(e.type)?(e=Iu,Iu=null,da=e):da=n):da=ca?Pu(e.stateNode.nextSibling):null;return!0}function va(){da=ca=null,ua=!1}function ba(){var e=ha;return null!==e&&(null===Dc?Dc=e:Dc.push.apply(Dc,e),ha=null),e}function wa(e){null===ha?ha=[e]:ha.push(e)}var ja=U(null),Na=null,_a=null;function Sa(e,t,n){z(ja,t._currentValue),t._currentValue=n}function ka(e){e._currentValue=ja.current,B(ja)}function Ea(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Aa(e,t,n,r){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var s=a.dependencies;if(null!==s){var o=a.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=a;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ea(s.return,n,e),r||(o=null);break e}s=l.next}}else if(18===a.tag){if(null===(o=a.return))throw Error(i(341));o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),Ea(o,n,e),o=null}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}function Ca(e,t,n,r){e=null;for(var a=t,s=!1;null!==a;){if(!s)if(0!==(524288&a.flags))s=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var o=a.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=a.type;Xn(a.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(a===K.current){if(null===(o=a.alternate))throw Error(i(387));o.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(dh):e=[dh])}a=a.return}null!==e&&Aa(t,e,n,r),t.flags|=262144}function Da(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ta(e){Na=e,_a=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Oa(e){return Ia(Na,e)}function Pa(e,t){return null===Na&&Ta(e),Ia(e,t)}function Ia(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===_a){if(null===e)throw Error(i(308));_a=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else _a=_a.next=t;return n}var Ra="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ma=r.unstable_scheduleCallback,La=r.unstable_NormalPriority,Fa={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ua(){return{controller:new Ra,data:new Map,refCount:0}}function Ba(e){e.refCount--,0===e.refCount&&Ma(La,function(){e.controller.abort()})}var za=null,qa=0,Va=0,Ha=null;function Wa(){if(0===--qa&&null!==za){null!==Ha&&(Ha.status="fulfilled");var e=za;za=null,Va=0,Ha=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ga=I.S;I.S=function(e,t){Pc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===za){var n=za=[];qa=0,Va=qd(),Ha={status:"pending",value:void 0,then:function(e){n.push(e)}}}qa++,t.then(Wa,Wa)}(0,t),null!==Ga&&Ga(e,t)};var Ka=U(null);function Qa(){var e=Ka.current;return null!==e?e:pc.pooledCache}function Ya(e,t){z(Ka,null===t?Ka.current:t.pool)}function $a(){var e=Qa();return null===e?null:{parent:Fa._currentValue,pool:e}}var Ja=Error(i(460)),Xa=Error(i(474)),Za=Error(i(542)),es={then:function(){}};function ts(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ns(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Ot,Ot),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e;default:if("string"===typeof t.status)t.then(Ot,Ot);else{if(null!==(e=pc)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e}throw as=t,Ja}}function rs(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw as=t,Ja;throw t}}var as=null;function ss(){if(null===as)throw Error(i(459));var e=as;return as=null,e}function is(e){if(e===Ja||e===Za)throw Error(i(483))}var os=null,ls=0;function cs(e){var t=ls;return ls+=1,null===os&&(os=[]),ns(os,e,t)}function ds(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function us(e,t){if(t.$$typeof===p)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=Br(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Hr(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===y?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===k&&rs(s)===t.type)?(ds(t=a(t,n.props),n),t.return=e,t):(ds(t=qr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Gr(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,r,s){return null===t||7!==t.tag?((t=Vr(n,e.mode,r,s)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Hr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case f:return ds(n=qr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Gr(t,e.mode,n)).return=e,t;case k:return h(e,t=rs(t),n)}if(P(t)||D(t))return(t=Vr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,cs(t),n);if(t.$$typeof===w)return h(e,Pa(e,t),n);us(e,t)}return null}function m(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case f:return n.key===a?c(e,t,n,r):null;case g:return n.key===a?d(e,t,n,r):null;case k:return m(e,t,n=rs(n),r)}if(P(n)||D(n))return null!==a?null:u(e,t,n,r,null);if("function"===typeof n.then)return m(e,t,cs(n),r);if(n.$$typeof===w)return m(e,t,Pa(e,n),r);us(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case f:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case g:return d(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return p(e,t,n,r=rs(r),a)}if(P(r)||D(r))return u(t,e=e.get(n)||null,r,a,null);if("function"===typeof r.then)return p(e,t,n,cs(r),a);if(r.$$typeof===w)return p(e,t,n,Pa(t,r),a);us(t,r)}return null}function x(l,c,d,u){if("object"===typeof d&&null!==d&&d.type===y&&null===d.key&&(d=d.props.children),"object"===typeof d&&null!==d){switch(d.$$typeof){case f:e:{for(var v=d.key;null!==c;){if(c.key===v){if((v=d.type)===y){if(7===c.tag){n(l,c.sibling),(u=a(c,d.props.children)).return=l,l=u;break e}}else if(c.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===k&&rs(v)===c.type){n(l,c.sibling),ds(u=a(c,d.props),d),u.return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}d.type===y?((u=Vr(d.props.children,l.mode,u,d.key)).return=l,l=u):(ds(u=qr(d.type,d.key,d.props,null,l.mode,u),d),u.return=l,l=u)}return o(l);case g:e:{for(v=d.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){n(l,c.sibling),(u=a(c,d.children||[])).return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}(u=Gr(d,l.mode,u)).return=l,l=u}return o(l);case k:return x(l,c,d=rs(d),u)}if(P(d))return function(a,i,o,l){for(var c=null,d=null,u=i,f=i=0,g=null;null!==u&&f<o.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var y=m(a,u,o[f],l);if(null===y){null===u&&(u=g);break}e&&u&&null===y.alternate&&t(a,u),i=s(y,i,f),null===d?c=y:d.sibling=y,d=y,u=g}if(f===o.length)return n(a,u),ua&&aa(a,f),c;if(null===u){for(;f<o.length;f++)null!==(u=h(a,o[f],l))&&(i=s(u,i,f),null===d?c=u:d.sibling=u,d=u);return ua&&aa(a,f),c}for(u=r(u);f<o.length;f++)null!==(g=p(u,a,f,o[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),i=s(g,i,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(a,e)}),ua&&aa(a,f),c}(l,c,d,u);if(D(d)){if("function"!==typeof(v=D(d)))throw Error(i(150));return function(a,o,l,c){if(null==l)throw Error(i(151));for(var d=null,u=null,f=o,g=o=0,y=null,x=l.next();null!==f&&!x.done;g++,x=l.next()){f.index>g?(y=f,f=null):y=f.sibling;var v=m(a,f,x.value,c);if(null===v){null===f&&(f=y);break}e&&f&&null===v.alternate&&t(a,f),o=s(v,o,g),null===u?d=v:u.sibling=v,u=v,f=y}if(x.done)return n(a,f),ua&&aa(a,g),d;if(null===f){for(;!x.done;g++,x=l.next())null!==(x=h(a,x.value,c))&&(o=s(x,o,g),null===u?d=x:u.sibling=x,u=x);return ua&&aa(a,g),d}for(f=r(f);!x.done;g++,x=l.next())null!==(x=p(f,a,g,x.value,c))&&(e&&null!==x.alternate&&f.delete(null===x.key?g:x.key),o=s(x,o,g),null===u?d=x:u.sibling=x,u=x);return e&&f.forEach(function(e){return t(a,e)}),ua&&aa(a,g),d}(l,c,d=v.call(d),u)}if("function"===typeof d.then)return x(l,c,cs(d),u);if(d.$$typeof===w)return x(l,c,Pa(l,d),u);us(l,d)}return"string"===typeof d&&""!==d||"number"===typeof d||"bigint"===typeof d?(d=""+d,null!==c&&6===c.tag?(n(l,c.sibling),(u=a(c,d)).return=l,l=u):(n(l,c),(u=Hr(d,l.mode,u)).return=l,l=u),o(l)):n(l,c)}return function(e,t,n,r){try{ls=0;var a=x(e,t,n,r);return os=null,a}catch(i){if(i===Ja||i===Za)throw i;var s=Fr(29,i,null,e.mode);return s.lanes=r,s.return=e,s}}}var ms=hs(!0),ps=hs(!1),fs=!1;function gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ys(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function xs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function vs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&mc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Rr(e),Ir(e,null,n),t}return Tr(e,r,t,n),Rr(e)}function bs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ie(e,n)}}function ws(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var i={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?a=s=i:s=s.next=i,n=n.next}while(null!==n);null===s?a=s=t:s=s.next=t}else a=s=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var js=!1;function Ns(){if(js){if(null!==Ha)throw Ha}}function _s(e,t,n,r){js=!1;var a=e.updateQueue;fs=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=a.baseState;for(i=0,d=c=l=null,o=s;;){var h=-536870913&o.lane,p=h!==o.lane;if(p?(gc&h)===h:(r&h)===h){0!==h&&h===Va&&(js=!0),null!==d&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var f=e,g=o;h=t;var y=n;switch(g.tag){case 1:if("function"===typeof(f=g.payload)){u=f.call(y,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=g.payload)?f.call(y,u,h):f)||void 0===h)break e;u=m({},u,h);break e;case 2:fs=!0}}null!==(h=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=a.callbacks)?a.callbacks=[h]:p.push(h))}else p={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,i|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(p=o).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null===s&&(a.shared.lanes=0),_c|=i,e.lanes=i,e.memoizedState=u}}function Ss(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function ks(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ss(n[e],t)}var Es=U(null),As=U(0);function Cs(e,t){z(As,e=jc),z(Es,t),jc=e|t.baseLanes}function Ds(){z(As,jc),z(Es,Es.current)}function Ts(){jc=As.current,B(Es),B(As)}var Os=U(null),Ps=null;function Is(e){var t=e.alternate;z(Us,1&Us.current),z(Os,e),null===Ps&&(null===t||null!==Es.current||null!==t.memoizedState)&&(Ps=e)}function Rs(e){z(Us,Us.current),z(Os,e),null===Ps&&(Ps=e)}function Ms(e){22===e.tag?(z(Us,Us.current),z(Os,e),null===Ps&&(Ps=e)):Ls()}function Ls(){z(Us,Us.current),z(Os,Os.current)}function Fs(e){B(Os),Ps===e&&(Ps=null),B(Us)}var Us=U(0);function Bs(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Tu(n)||Ou(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zs=0,qs=null,Vs=null,Hs=null,Ws=!1,Gs=!1,Ks=!1,Qs=0,Ys=0,$s=null,Js=0;function Xs(){throw Error(i(321))}function Zs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return!1;return!0}function ei(e,t,n,r,a,s){return zs=s,qs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,I.H=null===e||null===e.memoizedState?go:yo,Ks=!1,s=n(r,a),Ks=!1,Gs&&(s=ni(t,n,r,a)),ti(e),s}function ti(e){I.H=fo;var t=null!==Vs&&null!==Vs.next;if(zs=0,Hs=Vs=qs=null,Ws=!1,Ys=0,$s=null,t)throw Error(i(300));null===e||Po||null!==(e=e.dependencies)&&Da(e)&&(Po=!0)}function ni(e,t,n,r){qs=e;var a=0;do{if(Gs&&($s=null),Ys=0,Gs=!1,25<=a)throw Error(i(301));if(a+=1,Hs=Vs=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}I.H=xo,s=t(n,r)}while(Gs);return s}function ri(){var e=I.H,t=e.useState()[0];return t="function"===typeof t.then?ci(t):t,e=e.useState()[0],(null!==Vs?Vs.memoizedState:null)!==e&&(qs.flags|=1024),t}function ai(){var e=0!==Qs;return Qs=0,e}function si(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function ii(e){if(Ws){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Ws=!1}zs=0,Hs=Vs=qs=null,Gs=!1,Ys=Qs=0,$s=null}function oi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Hs?qs.memoizedState=Hs=e:Hs=Hs.next=e,Hs}function li(){if(null===Vs){var e=qs.alternate;e=null!==e?e.memoizedState:null}else e=Vs.next;var t=null===Hs?qs.memoizedState:Hs.next;if(null!==t)Hs=t,Vs=e;else{if(null===e){if(null===qs.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(Vs=e).memoizedState,baseState:Vs.baseState,baseQueue:Vs.baseQueue,queue:Vs.queue,next:null},null===Hs?qs.memoizedState=Hs=e:Hs=Hs.next=e}return Hs}function ci(e){var t=Ys;return Ys+=1,null===$s&&($s=[]),e=ns($s,e,t),t=qs,null===(null===Hs?t.memoizedState:Hs.next)&&(t=t.alternate,I.H=null===t||null===t.memoizedState?go:yo),e}function di(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ci(e);if(e.$$typeof===w)return Oa(e)}throw Error(i(438,String(e)))}function ui(e){var t=null,n=qs.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=qs.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=A;return t.index++,n}function hi(e,t){return"function"===typeof t?t(e):t}function mi(e){return pi(li(),Vs,e)}function pi(e,t,n){var r=e.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=n;var a=e.baseQueue,s=r.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}t.baseQueue=a=s,r.pending=null}if(s=e.baseState,null===a)e.memoizedState=s;else{var l=o=null,c=null,d=t=a.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(gc&h)===h:(zs&h)===h){var m=d.revertLane;if(0===m)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===Va&&(u=!0);else{if((zs&m)===m){d=d.next,m===Va&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=h,o=s):c=c.next=h,qs.lanes|=m,_c|=m}h=d.action,Ks&&n(s,h),s=d.hasEagerState?d.eagerState:n(s,h)}else m={lane:h,revertLane:d.revertLane,gesture:d.gesture,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=m,o=s):c=c.next=m,qs.lanes|=h,_c|=h;d=d.next}while(null!==d&&d!==t);if(null===c?o=s:c.next=l,!Xn(s,e.memoizedState)&&(Po=!0,u&&null!==(n=Ha)))throw n;e.memoizedState=s,e.baseState=o,e.baseQueue=c,r.lastRenderedState=s}return null===a&&(r.lanes=0),[e.memoizedState,r.dispatch]}function fi(e){var t=li(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);Xn(s,t.memoizedState)||(Po=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function gi(e,t,n){var r=qs,a=li(),s=ua;if(s){if(void 0===n)throw Error(i(407));n=n()}else n=t();var o=!Xn((Vs||a).memoizedState,n);if(o&&(a.memoizedState=n,Po=!0),a=a.queue,zi(vi.bind(null,r,a,e),[e]),a.getSnapshot!==t||o||null!==Hs&&1&Hs.memoizedState.tag){if(r.flags|=2048,Mi(9,{destroy:void 0},xi.bind(null,r,a,n,t),null),null===pc)throw Error(i(349));s||0!==(127&zs)||yi(r,t,n)}return n}function yi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=qs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function xi(e,t,n,r){t.value=n,t.getSnapshot=r,bi(t)&&wi(e)}function vi(e,t,n){return n(function(){bi(t)&&wi(e)})}function bi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xn(e,n)}catch(r){return!0}}function wi(e){var t=Pr(e,2);null!==t&&Qc(t,e,2)}function ji(e){var t=oi();if("function"===typeof e){var n=e;if(e=n(),Ks){ve(!0);try{n()}finally{ve(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:e},t}function Ni(e,t,n,r){return e.baseState=n,pi(e,Vs,"function"===typeof r?r:hi)}function _i(e,t,n,r,a){if(ho(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==I.T?n(!0):s.isTransition=!1,r(s),null===(n=t.pending)?(s.next=t.pending=s,Si(t,s)):(s.next=n.next,t.pending=n.next=s)}}function Si(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var s=I.T,i={};I.T=i;try{var o=n(a,r),l=I.S;null!==l&&l(i,o),ki(e,t,o)}catch(c){Ai(e,t,c)}finally{null!==s&&null!==i.types&&(s.types=i.types),I.T=s}}else try{ki(e,t,s=n(a,r))}catch(d){Ai(e,t,d)}}function ki(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Ei(e,t,n)},function(n){return Ai(e,t,n)}):Ei(e,t,n)}function Ei(e,t,n){t.status="fulfilled",t.value=n,Ci(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Si(e,n)))}function Ai(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Ci(t),t=t.next}while(t!==r)}e.action=null}function Ci(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Di(e,t){return t}function Ti(e,t){if(ua){var n=pc.formState;if(null!==n){e:{var r=qs;if(ua){if(da){t:{for(var a=da,s=ma;8!==a.nodeType;){if(!s){a=null;break t}if(null===(a=Pu(a.nextSibling))){a=null;break t}}a="F!"===(s=a.data)||"F"===s?a:null}if(a){da=Pu(a.nextSibling),r="F!"===a.data;break e}}fa(r)}r=!1}r&&(t=n[0])}}return(n=oi()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Di,lastRenderedState:t},n.queue=r,n=lo.bind(null,qs,r),r.dispatch=n,r=ji(!1),s=uo.bind(null,qs,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=oi()).queue=a,n=_i.bind(null,qs,a,s,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function Oi(e){return Pi(li(),Vs,e)}function Pi(e,t,n){if(t=pi(e,t,Di)[0],e=mi(hi)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=ci(t)}catch(i){if(i===Ja)throw Za;throw i}else r=t;var a=(t=li()).queue,s=a.dispatch;return n!==t.memoizedState&&(qs.flags|=2048,Mi(9,{destroy:void 0},Ii.bind(null,a,n),null)),[r,s,e]}function Ii(e,t){e.action=t}function Ri(e){var t=li(),n=Vs;if(null!==n)return Pi(t,n,e);li(),t=t.memoizedState;var r=(n=li()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Mi(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=qs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Li(){return li().memoizedState}function Fi(e,t,n,r){var a=oi();qs.flags|=e,a.memoizedState=Mi(1|t,{destroy:void 0},n,void 0===r?null:r)}function Ui(e,t,n,r){var a=li();r=void 0===r?null:r;var s=a.memoizedState.inst;null!==Vs&&null!==r&&Zs(r,Vs.memoizedState.deps)?a.memoizedState=Mi(t,s,n,r):(qs.flags|=e,a.memoizedState=Mi(1|t,s,n,r))}function Bi(e,t){Fi(8390656,8,e,t)}function zi(e,t){Ui(2048,8,e,t)}function qi(e){var t=li().memoizedState;return function(e){qs.flags|=4;var t=qs.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},qs.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&mc))throw Error(i(440));return t.impl.apply(void 0,arguments)}}function Vi(e,t){return Ui(4,2,e,t)}function Hi(e,t){return Ui(4,4,e,t)}function Wi(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Gi(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Ui(4,4,Wi.bind(null,t,e),n)}function Ki(){}function Qi(e,t){var n=li();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Zs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Yi(e,t){var n=li();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Zs(t,r[1]))return r[0];if(r=e(),Ks){ve(!0);try{e()}finally{ve(!1)}}return n.memoizedState=[r,t],r}function $i(e,t,n){return void 0===n||0!==(1073741824&zs)&&0===(261930&gc)?e.memoizedState=t:(e.memoizedState=n,e=Kc(),qs.lanes|=e,_c|=e,n)}function Ji(e,t,n,r){return Xn(n,t)?n:null!==Es.current?(e=$i(e,n,r),Xn(e,t)||(Po=!0),e):0===(42&zs)||0!==(1073741824&zs)&&0===(261930&gc)?(Po=!0,e.memoizedState=n):(e=Kc(),qs.lanes|=e,_c|=e,t)}function Xi(e,t,n,r,a){var s=R.p;R.p=0!==s&&8>s?s:8;var i=I.T,o={};I.T=o,uo(e,!1,t,n);try{var l=a(),c=I.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)co(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Gc());else co(e,t,r,Gc())}catch(d){co(e,t,{then:function(){},status:"rejected",reason:d},Gc())}finally{R.p=s,null!==i&&null!==o.types&&(i.types=o.types),I.T=i}}function Zi(){}function eo(e,t,n,r){if(5!==e.tag)throw Error(i(476));var a=to(e).queue;Xi(e,a,t,M,null===n?Zi:function(){return no(e),n(r)})}function to(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:M},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function no(e){var t=to(e);null===t.next&&(t=e.alternate.memoizedState),co(e,t.next.queue,{},Gc())}function ro(){return Oa(dh)}function ao(){return li().memoizedState}function so(){return li().memoizedState}function io(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Gc(),r=vs(t,e=xs(n),n);return null!==r&&(Qc(r,t,n),bs(r,t,n)),t={cache:Ua()},void(e.payload=t)}t=t.return}}function oo(e,t,n){var r=Gc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ho(e)?mo(t,n):null!==(n=Or(e,t,n,r))&&(Qc(n,e,r),po(n,t,r))}function lo(e,t,n){co(e,t,n,Gc())}function co(e,t,n,r){var a={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(ho(e))mo(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,n);if(a.hasEagerState=!0,a.eagerState=o,Xn(o,i))return Tr(e,t,a,0),null===pc&&Dr(),!1}catch(l){}if(null!==(n=Or(e,t,a,r)))return Qc(n,e,r),po(n,t,r),!0}return!1}function uo(e,t,n,r){if(r={lane:2,revertLane:qd(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},ho(e)){if(t)throw Error(i(479))}else null!==(t=Or(e,n,r,2))&&Qc(t,e,2)}function ho(e){var t=e.alternate;return e===qs||null!==t&&t===qs}function mo(e,t){Gs=Ws=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function po(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ie(e,n)}}var fo={readContext:Oa,use:di,useCallback:Xs,useContext:Xs,useEffect:Xs,useImperativeHandle:Xs,useLayoutEffect:Xs,useInsertionEffect:Xs,useMemo:Xs,useReducer:Xs,useRef:Xs,useState:Xs,useDebugValue:Xs,useDeferredValue:Xs,useTransition:Xs,useSyncExternalStore:Xs,useId:Xs,useHostTransitionStatus:Xs,useFormState:Xs,useActionState:Xs,useOptimistic:Xs,useMemoCache:Xs,useCacheRefresh:Xs};fo.useEffectEvent=Xs;var go={readContext:Oa,use:di,useCallback:function(e,t){return oi().memoizedState=[e,void 0===t?null:t],e},useContext:Oa,useEffect:Bi,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Fi(4194308,4,Wi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fi(4194308,4,e,t)},useInsertionEffect:function(e,t){Fi(4,2,e,t)},useMemo:function(e,t){var n=oi();t=void 0===t?null:t;var r=e();if(Ks){ve(!0);try{e()}finally{ve(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=oi();if(void 0!==n){var a=n(t);if(Ks){ve(!0);try{n(t)}finally{ve(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=oo.bind(null,qs,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},oi().memoizedState=e},useState:function(e){var t=(e=ji(e)).queue,n=lo.bind(null,qs,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ki,useDeferredValue:function(e,t){return $i(oi(),e,t)},useTransition:function(){var e=ji(!1);return e=Xi.bind(null,qs,e.queue,!0,!1),oi().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=qs,a=oi();if(ua){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===pc)throw Error(i(349));0!==(127&gc)||yi(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Bi(vi.bind(null,r,s,e),[e]),r.flags|=2048,Mi(9,{destroy:void 0},xi.bind(null,r,s,n,t),null),n},useId:function(){var e=oi(),t=pc.identifierPrefix;if(ua){var n=ra;t="_"+t+"R_"+(n=(na&~(1<<32-be(na)-1)).toString(32)+n),0<(n=Qs++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Js++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ro,useFormState:Ti,useActionState:Ti,useOptimistic:function(e){var t=oi();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=uo.bind(null,qs,!0,n),n.dispatch=t,[e,t]},useMemoCache:ui,useCacheRefresh:function(){return oi().memoizedState=io.bind(null,qs)},useEffectEvent:function(e){var t=oi(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&mc))throw Error(i(440));return n.impl.apply(void 0,arguments)}}},yo={readContext:Oa,use:di,useCallback:Qi,useContext:Oa,useEffect:zi,useImperativeHandle:Gi,useInsertionEffect:Vi,useLayoutEffect:Hi,useMemo:Yi,useReducer:mi,useRef:Li,useState:function(){return mi(hi)},useDebugValue:Ki,useDeferredValue:function(e,t){return Ji(li(),Vs.memoizedState,e,t)},useTransition:function(){var e=mi(hi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:ao,useHostTransitionStatus:ro,useFormState:Oi,useActionState:Oi,useOptimistic:function(e,t){return Ni(li(),0,e,t)},useMemoCache:ui,useCacheRefresh:so};yo.useEffectEvent=qi;var xo={readContext:Oa,use:di,useCallback:Qi,useContext:Oa,useEffect:zi,useImperativeHandle:Gi,useInsertionEffect:Vi,useLayoutEffect:Hi,useMemo:Yi,useReducer:fi,useRef:Li,useState:function(){return fi(hi)},useDebugValue:Ki,useDeferredValue:function(e,t){var n=li();return null===Vs?$i(n,e,t):Ji(n,Vs.memoizedState,e,t)},useTransition:function(){var e=fi(hi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:ao,useHostTransitionStatus:ro,useFormState:Ri,useActionState:Ri,useOptimistic:function(e,t){var n=li();return null!==Vs?Ni(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ui,useCacheRefresh:so};function vo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:m({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}xo.useEffectEvent=qi;var bo={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Gc(),a=xs(r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=vs(e,a,r))&&(Qc(t,e,r),bs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Gc(),a=xs(r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=vs(e,a,r))&&(Qc(t,e,r),bs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gc(),r=xs(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=vs(e,r,n))&&(Qc(t,e,n),bs(t,e,n))}};function wo(e,t,n,r,a,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!Zn(n,r)||!Zn(a,s))}function jo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&bo.enqueueReplaceState(t,t.state,null)}function No(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=m({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}function _o(e){kr(e)}function So(e){console.error(e)}function ko(e){kr(e)}function Eo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Ao(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Co(e,t,n){return(n=xs(n)).tag=3,n.payload={element:null},n.callback=function(){Eo(e,t)},n}function Do(e){return(e=xs(e)).tag=3,e}function To(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"===typeof a){var s=r.value;e.payload=function(){return a(s)},e.callback=function(){Ao(t,n,r)}}var i=n.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){Ao(t,n,r),"function"!==typeof a&&(null===Mc?Mc=new Set([this]):Mc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Oo=Error(i(461)),Po=!1;function Io(e,t,n,r){t.child=null===e?ps(t,null,n,r):ms(t,e.child,n,r)}function Ro(e,t,n,r,a){n=n.render;var s=t.ref;if("ref"in r){var i={};for(var o in r)"ref"!==o&&(i[o]=r[o])}else i=r;return Ta(t),r=ei(e,t,n,i,s,a),o=ai(),null===e||Po?(ua&&o&&ia(t),t.flags|=1,Io(e,t,r,a),t.child):(si(e,t,a),al(e,t,a))}function Mo(e,t,n,r,a){if(null===e){var s=n.type;return"function"!==typeof s||Ur(s)||void 0!==s.defaultProps||null!==n.compare?((e=qr(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Lo(e,t,s,r,a))}if(s=e.child,!sl(e,a)){var i=s.memoizedProps;if((n=null!==(n=n.compare)?n:Zn)(i,r)&&e.ref===t.ref)return al(e,t,a)}return t.flags|=1,(e=Br(s,r)).ref=t.ref,e.return=t,t.child=e}function Lo(e,t,n,r,a){if(null!==e){var s=e.memoizedProps;if(Zn(s,r)&&e.ref===t.ref){if(Po=!1,t.pendingProps=r=s,!sl(e,a))return t.lanes=e.lanes,al(e,t,a);0!==(131072&e.flags)&&(Po=!0)}}return Ho(e,t,n,r,a)}function Fo(e,t,n,r){var a=r.children,s=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(s=null!==s?s.baseLanes|n:n,null!==e){for(r=t.child=e.child,a=0;null!==r;)a=a|r.lanes|r.childLanes,r=r.sibling;r=a&~s}else r=0,t.child=null;return Bo(e,t,s,n,r)}if(0===(536870912&n))return r=t.lanes=536870912,Bo(e,t,null!==s?s.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ya(0,null!==s?s.cachePool:null),null!==s?Cs(t,s):Ds(),Ms(t)}else null!==s?(Ya(0,s.cachePool),Cs(t,s),Ls(),t.memoizedState=null):(null!==e&&Ya(0,null),Ds(),Ls());return Io(e,t,a,n),t.child}function Uo(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bo(e,t,n,r,a){var s=Qa();return s=null===s?null:{parent:Fa._currentValue,pool:s},t.memoizedState={baseLanes:n,cachePool:s},null!==e&&Ya(0,null),Ds(),Ms(t),null!==e&&Ca(e,t,r,!0),t.childLanes=a,null}function zo(e,t){return(t=Zo({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function qo(e,t,n){return ms(t,e.child,null,n),(e=zo(t,t.pendingProps)).flags|=2,Fs(t),t.memoizedState=null,e}function Vo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(i(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ho(e,t,n,r,a){return Ta(t),n=ei(e,t,n,r,void 0,a),r=ai(),null===e||Po?(ua&&r&&ia(t),t.flags|=1,Io(e,t,n,a),t.child):(si(e,t,a),al(e,t,a))}function Wo(e,t,n,r,a,s){return Ta(t),t.updateQueue=null,n=ni(t,r,n,a),ti(e),r=ai(),null===e||Po?(ua&&r&&ia(t),t.flags|=1,Io(e,t,n,s),t.child):(si(e,t,s),al(e,t,s))}function Go(e,t,n,r,a){if(Ta(t),null===t.stateNode){var s=Mr,i=n.contextType;"object"===typeof i&&null!==i&&(s=Oa(i)),s=new n(r,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=bo,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=r,s.state=t.memoizedState,s.refs={},gs(t),i=n.contextType,s.context="object"===typeof i&&null!==i?Oa(i):Mr,s.state=t.memoizedState,"function"===typeof(i=n.getDerivedStateFromProps)&&(vo(t,n,i,r),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(i=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),i!==s.state&&bo.enqueueReplaceState(s,s.state,null),_s(t,r,s,a),Ns(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=No(n,o);s.props=l;var c=s.context,d=n.contextType;i=Mr,"object"===typeof d&&null!==d&&(i=Oa(d));var u=n.getDerivedStateFromProps;d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==i)&&jo(t,s,r,i),fs=!1;var h=t.memoizedState;s.state=h,_s(t,r,s,a),Ns(),c=t.memoizedState,o||h!==c||fs?("function"===typeof u&&(vo(t,n,u,r),c=t.memoizedState),(l=fs||wo(t,n,l,r,h,c,i))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=i,r=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,ys(e,t),d=No(n,i=t.memoizedProps),s.props=d,u=t.pendingProps,h=s.context,c=n.contextType,l=Mr,"object"===typeof c&&null!==c&&(l=Oa(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==u||h!==l)&&jo(t,s,r,l),fs=!1,h=t.memoizedState,s.state=h,_s(t,r,s,a),Ns();var m=t.memoizedState;i!==u||h!==m||fs||null!==e&&null!==e.dependencies&&Da(e.dependencies)?("function"===typeof o&&(vo(t,n,o,r),m=t.memoizedState),(d=fs||wo(t,n,d,r,h,m,l)||null!==e&&null!==e.dependencies&&Da(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,m,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),s.props=r,s.state=m,s.context=l,r=d):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return s=r,Vo(e,t),r=0!==(128&t.flags),s||r?(s=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&r?(t.child=ms(t,e.child,null,a),t.child=ms(t,null,n,a)):Io(e,t,n,a),t.memoizedState=s.state,e=t.child):e=al(e,t,a),e}function Ko(e,t,n,r){return va(),t.flags|=256,Io(e,t,n,r),t.child}var Qo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yo(e){return{baseLanes:e,cachePool:$a()}}function $o(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ec),e}function Jo(e,t,n){var r,a=t.pendingProps,s=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Us.current)),r&&(s=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(ua){if(s?Is(t):Ls(),(e=da)?null!==(e=null!==(e=Du(e,ma))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:na,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},(n=Wr(e)).return=t,t.child=n,ca=t,da=null):e=null,null===e)throw fa(t);return Ou(e)?t.lanes=32:t.lanes=536870912,null}var l=a.children;return a=a.fallback,s?(Ls(),l=Zo({mode:"hidden",children:l},s=t.mode),a=Vr(a,s,n,null),l.return=t,a.return=t,l.sibling=a,t.child=l,(a=t.child).memoizedState=Yo(n),a.childLanes=$o(e,r,n),t.memoizedState=Qo,Uo(null,a)):(Is(t),Xo(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(o)256&t.flags?(Is(t),t.flags&=-257,t=el(e,t,n)):null!==t.memoizedState?(Ls(),t.child=e.child,t.flags|=128,t=null):(Ls(),l=a.fallback,s=t.mode,a=Zo({mode:"visible",children:a.children},s),(l=Vr(l,s,n,null)).flags|=2,a.return=t,l.return=t,a.sibling=l,t.child=a,ms(t,e.child,null,n),(a=t.child).memoizedState=Yo(n),a.childLanes=$o(e,r,n),t.memoizedState=Qo,t=Uo(null,a));else if(Is(t),Ou(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var d=r.dgst;r=d,(a=Error(i(419))).stack="",a.digest=r,wa({value:a,source:null,stack:null}),t=el(e,t,n)}else if(Po||Ca(e,t,n,!1),r=0!==(n&e.childLanes),Po||r){if(null!==(r=pc)&&(0!==(a=Re(r,n))&&a!==c.retryLane))throw c.retryLane=a,Pr(e,a),Qc(r,e,a),Oo;Tu(l)||id(),t=el(e,t,n)}else Tu(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,da=Pu(l.nextSibling),ca=t,ua=!0,ha=null,ma=!1,null!==e&&la(t,e),(t=Xo(t,a.children)).flags|=4096);return t}return s?(Ls(),l=a.fallback,s=t.mode,d=(c=e.child).sibling,(a=Br(c,{mode:"hidden",children:a.children})).subtreeFlags=65011712&c.subtreeFlags,null!==d?l=Br(d,l):(l=Vr(l,s,n,null)).flags|=2,l.return=t,a.return=t,a.sibling=l,t.child=a,Uo(null,a),a=t.child,null===(l=e.child.memoizedState)?l=Yo(n):(null!==(s=l.cachePool)?(c=Fa._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=$a(),l={baseLanes:l.baseLanes|n,cachePool:s}),a.memoizedState=l,a.childLanes=$o(e,r,n),t.memoizedState=Qo,Uo(e.child,a)):(Is(t),e=(n=e.child).sibling,(n=Br(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Xo(e,t){return(t=Zo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Zo(e,t){return(e=Fr(22,e,null,t)).lanes=0,e}function el(e,t,n){return ms(t,e.child,null,n),(e=Xo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ea(e.return,t,n)}function nl(e,t,n,r,a,s){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,treeForkCount:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a,i.treeForkCount=s)}function rl(e,t,n){var r=t.pendingProps,a=r.revealOrder,s=r.tail;r=r.children;var i=Us.current,o=0!==(2&i);if(o?(i=1&i|2,t.flags|=128):i&=1,z(Us,i),Io(e,t,r,n),r=ua?Xr:0,!o&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,n,t);else if(19===e.tag)tl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Bs(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),nl(t,!1,a,n,s,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Bs(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}nl(t,!0,n,null,s,r);break;case"together":nl(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function al(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),_c|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ca(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Br(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Br(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Da(e))}function il(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Po=!0;else{if(!sl(e,n)&&0===(128&t.flags))return Po=!1,function(e,t,n){switch(t.tag){case 3:Q(t,t.stateNode.containerInfo),Sa(0,Fa,e.memoizedState.cache),va();break;case 27:case 5:$(t);break;case 4:Q(t,t.stateNode.containerInfo);break;case 10:Sa(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Rs(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Is(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Jo(e,t,n):(Is(t),null!==(e=al(e,t,n))?e.sibling:null);Is(t);break;case 19:var a=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Ca(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return rl(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),z(Us,Us.current),r)break;return null;case 22:return t.lanes=0,Fo(e,t,n,t.pendingProps);case 24:Sa(0,Fa,e.memoizedState.cache)}return al(e,t,n)}(e,t,n);Po=0!==(131072&e.flags)}else Po=!1,ua&&0!==(1048576&t.flags)&&sa(t,Xr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=rs(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var a=e.$$typeof;if(a===j){t.tag=11,t=Ro(null,t,e,r,n);break e}if(a===S){t.tag=14,t=Mo(null,t,e,r,n);break e}}throw t=O(e)||e,Error(i(306,t,""))}Ur(e)?(r=No(e,r),t.tag=1,t=Go(null,t,e,r,n)):(t.tag=0,t=Ho(null,t,e,r,n))}return t;case 0:return Ho(e,t,t.type,t.pendingProps,n);case 1:return Go(e,t,r=t.type,a=No(r,t.pendingProps),n);case 3:e:{if(Q(t,t.stateNode.containerInfo),null===e)throw Error(i(387));r=t.pendingProps;var s=t.memoizedState;a=s.element,ys(e,t),_s(t,r,null,n);var o=t.memoizedState;if(r=o.cache,Sa(0,Fa,r),r!==s.cache&&Aa(t,[Fa],n,!0),Ns(),r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ko(e,t,r,n);break e}if(r!==a){wa(a=Qr(Error(i(424)),t)),t=Ko(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(da=Pu(e.firstChild),ca=t,ua=!0,ha=null,ma=!0,n=ps(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(va(),r===a){t=al(e,t,n);break e}Io(e,t,r,n)}t=t.child}return t;case 26:return Vo(e,t),null===e?(n=Wu(t.type,null,t.pendingProps,null))?t.memoizedState=n:ua||(n=t.type,e=t.pendingProps,(r=gu(G.current).createElement(n))[ze]=t,r[qe]=e,hu(r,n,e),et(r),t.stateNode=r):t.memoizedState=Wu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&ua&&(r=t.stateNode=Lu(t.type,t.pendingProps,G.current),ca=t,ma=!0,a=da,ku(t.type)?(Iu=a,da=Pu(r.firstChild)):da=a),Io(e,t,t.pendingProps.children,n),Vo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ua&&((a=r=da)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Qe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===s)return e}if(null===(e=Pu(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,ma))?(t.stateNode=r,ca=t,da=Pu(r.firstChild),ma=!1,a=!0):a=!1),a||fa(t)),$(t),a=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,r=s.children,vu(a,s)?r=null:null!==o&&vu(a,o)&&(t.flags|=32),null!==t.memoizedState&&(a=ei(e,t,ri,null,null,n),dh._currentValue=a),Vo(e,t),Io(e,t,r,n),t.child;case 6:return null===e&&ua&&((e=n=da)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Pu(e.nextSibling)))return null}return e}(n,t.pendingProps,ma))?(t.stateNode=n,ca=t,da=null,e=!0):e=!1),e||fa(t)),null;case 13:return Jo(e,t,n);case 4:return Q(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ms(t,null,r,n):Io(e,t,r,n),t.child;case 11:return Ro(e,t,t.type,t.pendingProps,n);case 7:return Io(e,t,t.pendingProps,n),t.child;case 8:case 12:return Io(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,Sa(0,t.type,r.value),Io(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,Ta(t),r=r(a=Oa(a)),t.flags|=1,Io(e,t,r,n),t.child;case 14:return Mo(e,t,t.type,t.pendingProps,n);case 15:return Lo(e,t,t.type,t.pendingProps,n);case 19:return rl(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,a=0!==(128&t.flags);if(t.flags&=-129,null===e){if(ua){if("hidden"===r.mode)return e=zo(t,r),t.lanes=536870912,Uo(null,e);if(Rs(t),(e=da)?null!==(e=null!==(e=Du(e,ma))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:na,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},(n=Wr(e)).return=t,t.child=n,ca=t,da=null):e=null,null===e)throw fa(t);return t.lanes=536870912,null}return zo(t,r)}var s=e.memoizedState;if(null!==s){var o=s.dehydrated;if(Rs(t),a)if(256&t.flags)t.flags&=-257,t=qo(e,t,n);else{if(null===t.memoizedState)throw Error(i(558));t.child=e.child,t.flags|=128,t=null}else if(Po||Ca(e,t,n,!1),a=0!==(n&e.childLanes),Po||a){if(null!==(r=pc)&&0!==(o=Re(r,n))&&o!==s.retryLane)throw s.retryLane=o,Pr(e,o),Qc(r,e,o),Oo;id(),t=qo(e,t,n)}else e=s.treeContext,da=Pu(o.nextSibling),ca=t,ua=!0,ha=null,ma=!1,null!==e&&la(t,e),(t=zo(t,r)).flags|=4096;return t}return(e=Br(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Fo(e,t,n,t.pendingProps);case 24:return Ta(t),r=Oa(Fa),null===e?(null===(a=Qa())&&(a=pc,s=Ua(),a.pooledCache=s,s.refCount++,null!==s&&(a.pooledCacheLanes|=n),a=s),t.memoizedState={parent:r,cache:a},gs(t),Sa(0,Fa,a)):(0!==(e.lanes&n)&&(ys(e,t),_s(t,null,null,n),Ns()),a=e.memoizedState,s=t.memoizedState,a.parent!==r?(a={parent:r,cache:r},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),Sa(0,Fa,r)):(r=s.cache,Sa(0,Fa,r),r!==a.cache&&Aa(t,[Fa],n,!0))),Io(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function ol(e){e.flags|=4}function ll(e,t,n,r,a){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&a)===a)if(e.stateNode.complete)e.flags|=8192;else{if(!rd())throw as=es,Xa;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!ah(t)){if(!rd())throw as=es,Xa;e.flags|=8192}}function dl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?De():536870912,e.lanes|=t,Ac|=t)}function ul(e,t){if(!ua)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function ml(e,t,n){var r=t.pendingProps;switch(oa(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),ka(Fa),Y(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(xa(t)?ol(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,ba())),hl(t),null;case 26:var a=t.type,s=t.memoizedState;return null===e?(ol(t),null!==s?(hl(t),cl(t,s)):(hl(t),ll(t,a,0,0,n))):s?s!==e.memoizedState?(ol(t),hl(t),cl(t,s)):(hl(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&ol(t),hl(t),ll(t,a,0,0,n)),null;case 27:if(J(t),n=G.current,a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ol(t);else{if(!r){if(null===t.stateNode)throw Error(i(166));return hl(t),null}e=H.current,xa(t)?ga(t):(e=Lu(a,r,n),t.stateNode=e,ol(t))}return hl(t),null;case 5:if(J(t),a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ol(t);else{if(!r){if(null===t.stateNode)throw Error(i(166));return hl(t),null}if(s=H.current,xa(t))ga(t);else{var o=gu(G.current);switch(s){case 1:s=o.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:s=o.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":s=o.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":s=o.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":(s=o.createElement("div")).innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s="string"===typeof r.is?o.createElement("select",{is:r.is}):o.createElement("select"),r.multiple?s.multiple=!0:r.size&&(s.size=r.size);break;default:s="string"===typeof r.is?o.createElement(a,{is:r.is}):o.createElement(a)}}s[ze]=t,s[qe]=r;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)s.appendChild(o.stateNode);else if(4!==o.tag&&27!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=s;e:switch(hu(s,a,r),a){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&ol(t)}}return hl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&ol(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(e=G.current,xa(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(a=ca))switch(a.tag){case 27:case 5:r=a.memoizedProps}e[ze]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||cu(e.nodeValue,n)))||fa(t,!0)}else(e=gu(e).createTextNode(r))[ze]=t,t.stateNode=e}return hl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=xa(t),null!==n){if(null===e){if(!r)throw Error(i(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(i(557));e[ze]=t}else va(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),e=!1}else n=ba(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Fs(t),t):(Fs(t),null);if(0!==(128&t.flags))throw Error(i(558))}return hl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=xa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[ze]=t}else va(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),a=!1}else a=ba(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(Fs(t),t):(Fs(t),null)}return Fs(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(a=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(a=r.alternate.memoizedState.cachePool.pool),s=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(s=r.memoizedState.cachePool.pool),s!==a&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),dl(t,t.updateQueue),hl(t),null);case 4:return Y(),null===e&&Zd(t.stateNode.containerInfo),hl(t),null;case 10:return ka(t.type),hl(t),null;case 19:if(B(Us),null===(r=t.memoizedState))return hl(t),null;if(a=0!==(128&t.flags),null===(s=r.rendering))if(a)ul(r,!1);else{if(0!==Nc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Bs(e))){for(t.flags|=128,ul(r,!1),e=s.updateQueue,t.updateQueue=e,dl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)zr(n,e),n=n.sibling;return z(Us,1&Us.current|2),ua&&aa(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&le()>Ic&&(t.flags|=128,a=!0,ul(r,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=Bs(s))){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,dl(t,e),ul(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!ua)return hl(t),null}else 2*le()-r.renderingStartTime>Ic&&536870912!==n&&(t.flags|=128,a=!0,ul(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=r.last)?e.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=le(),e.sibling=null,n=Us.current,z(Us,a?1&n|2:1&n),ua&&aa(t,r.treeForkCount),e):(hl(t),null);case 22:case 23:return Fs(t),Ts(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(hl(t),6&t.subtreeFlags&&(t.flags|=8192)):hl(t),null!==(n=t.updateQueue)&&dl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&B(Ka),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),ka(Fa),hl(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function pl(e,t){switch(oa(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ka(Fa),Y(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return J(t),null;case 31:if(null!==t.memoizedState){if(Fs(t),null===t.alternate)throw Error(i(340));va()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Fs(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));va()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(Us),null;case 4:return Y(),null;case 10:return ka(t.type),null;case 22:case 23:return Fs(t),Ts(),null!==e&&B(Ka),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return ka(Fa),null;default:return null}}function fl(e,t){switch(oa(t),t.tag){case 3:ka(Fa),Y();break;case 26:case 27:case 5:J(t);break;case 4:Y();break;case 31:null!==t.memoizedState&&Fs(t);break;case 13:Fs(t);break;case 19:B(Us);break;case 10:ka(t.type);break;case 22:case 23:Fs(t),Ts(),null!==e&&B(Ka);break;case 24:ka(Fa)}}function gl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var s=n.create,i=n.inst;r=s(),i.destroy=r}n=n.next}while(n!==a)}}catch(o){Nd(t,t.return,o)}}function yl(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var s=a.next;r=s;do{if((r.tag&e)===e){var i=r.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,a=t;var l=n,c=o;try{c()}catch(d){Nd(a,l,d)}}}r=r.next}while(r!==s)}}catch(d){Nd(t,t.return,d)}}function xl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{ks(t,n)}catch(r){Nd(e,e.return,r)}}}function vl(e,t,n){n.props=No(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Nd(e,t,r)}}function bl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(a){Nd(e,t,a)}}function wl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(a){Nd(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(s){Nd(e,t,s)}else n.current=null}function jl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){Nd(e,e.return,a)}}function Nl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,s=null,o=null,l=null,c=null,d=null,u=null;for(p in n){var h=n[p];if(n.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(p)||du(e,t,p,null,r,h)}}for(var m in r){var p=r[m];if(h=n[m],r.hasOwnProperty(m)&&(null!=p||null!=h))switch(m){case"type":s=p;break;case"name":a=p;break;case"checked":d=p;break;case"defaultChecked":u=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(i(137,t));break;default:p!==h&&du(e,t,m,p,r,h)}}return void xt(e,o,l,c,d,u,s,a);case"select":for(s in p=o=l=m=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(s)||du(e,t,s,null,r,c)}for(a in r)if(s=r[a],c=n[a],r.hasOwnProperty(a)&&(null!=s||null!=c))switch(a){case"value":m=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&du(e,t,a,s,r,c)}return t=l,n=o,r=p,void(null!=m?wt(e,!!n,m,!1):!!r!==!!n&&(null!=t?wt(e,!!n,t,!0):wt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=m=null,n)if(a=n[l],n.hasOwnProperty(l)&&null!=a&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:du(e,t,l,null,r,a)}for(o in r)if(a=r[o],s=n[o],r.hasOwnProperty(o)&&(null!=a||null!=s))switch(o){case"value":m=a;break;case"defaultValue":p=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(i(91));break;default:a!==s&&du(e,t,o,a,r,s)}return void jt(e,m,p);case"option":for(var f in n)if(m=n[f],n.hasOwnProperty(f)&&null!=m&&!r.hasOwnProperty(f))if("selected"===f)e.selected=!1;else du(e,t,f,null,r,m);for(c in r)if(m=r[c],p=n[c],r.hasOwnProperty(c)&&m!==p&&(null!=m||null!=p))if("selected"===c)e.selected=m&&"function"!==typeof m&&"symbol"!==typeof m;else du(e,t,c,m,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)m=n[g],n.hasOwnProperty(g)&&null!=m&&!r.hasOwnProperty(g)&&du(e,t,g,null,r,m);for(d in r)if(m=r[d],p=n[d],r.hasOwnProperty(d)&&m!==p&&(null!=m||null!=p))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(i(137,t));break;default:du(e,t,d,m,r,p)}return;default:if(At(t)){for(var y in n)m=n[y],n.hasOwnProperty(y)&&void 0!==m&&!r.hasOwnProperty(y)&&uu(e,t,y,void 0,r,m);for(u in r)m=r[u],p=n[u],!r.hasOwnProperty(u)||m===p||void 0===m&&void 0===p||uu(e,t,u,m,r,p);return}}for(var x in n)m=n[x],n.hasOwnProperty(x)&&null!=m&&!r.hasOwnProperty(x)&&du(e,t,x,null,r,m);for(h in r)m=r[h],p=n[h],!r.hasOwnProperty(h)||m===p||null==m&&null==p||du(e,t,h,m,r,p)}(r,e.type,n,t),r[qe]=t}catch(a){Nd(e,e.return,a)}}function _l(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&ku(e.type)||4===e.tag}function Sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||_l(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&ku(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function kl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ot));else if(4!==r&&(27===r&&ku(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(kl(e,t,n),e=e.sibling;null!==e;)kl(e,t,n),e=e.sibling}function El(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&ku(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(El(e,t,n),e=e.sibling;null!==e;)El(e,t,n),e=e.sibling}function Al(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);hu(t,r,n),t[ze]=e,t[qe]=n}catch(s){Nd(e,e.return,s)}}var Cl=!1,Dl=!1,Tl=!1,Ol="function"===typeof WeakSet?WeakSet:Set,Pl=null;function Il(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Ql(e,n),4&r&&gl(5,n);break;case 1:if(Ql(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(i){Nd(n,n.return,i)}else{var a=No(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){Nd(n,n.return,o)}}64&r&&xl(n),512&r&&bl(n,n.return);break;case 3:if(Ql(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{ks(e,t)}catch(i){Nd(n,n.return,i)}}break;case 27:null===t&&4&r&&Al(n);case 26:case 5:Ql(e,n),null===t&&4&r&&jl(n),512&r&&bl(n,n.return);break;case 12:Ql(e,n);break;case 31:Ql(e,n),4&r&&Bl(e,n);break;case 13:Ql(e,n),4&r&&zl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Ed.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||Cl)){t=null!==t&&null!==t.memoizedState||Dl,a=Cl;var s=Dl;Cl=r,(Dl=t)&&!s?$l(e,n,0!==(8772&n.subtreeFlags)):Ql(e,n),Cl=a,Dl=s}break;case 30:break;default:Ql(e,n)}}function Rl(e){var t=e.alternate;null!==t&&(e.alternate=null,Rl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ye(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ml=null,Ll=!1;function Fl(e,t,n){for(n=n.child;null!==n;)Ul(e,t,n),n=n.sibling}function Ul(e,t,n){if(xe&&"function"===typeof xe.onCommitFiberUnmount)try{xe.onCommitFiberUnmount(ye,n)}catch(s){}switch(n.tag){case 26:Dl||wl(n,t),Fl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Dl||wl(n,t);var r=Ml,a=Ll;ku(n.type)&&(Ml=n.stateNode,Ll=!1),Fl(e,t,n),Fu(n.stateNode),Ml=r,Ll=a;break;case 5:Dl||wl(n,t);case 6:if(r=Ml,a=Ll,Ml=null,Fl(e,t,n),Ll=a,null!==(Ml=r))if(Ll)try{(9===Ml.nodeType?Ml.body:"HTML"===Ml.nodeName?Ml.ownerDocument.body:Ml).removeChild(n.stateNode)}catch(i){Nd(n,t,i)}else try{Ml.removeChild(n.stateNode)}catch(i){Nd(n,t,i)}break;case 18:null!==Ml&&(Ll?(Eu(9===(e=Ml).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Hh(e)):Eu(Ml,n.stateNode));break;case 4:r=Ml,a=Ll,Ml=n.stateNode.containerInfo,Ll=!0,Fl(e,t,n),Ml=r,Ll=a;break;case 0:case 11:case 14:case 15:yl(2,n,t),Dl||yl(4,n,t),Fl(e,t,n);break;case 1:Dl||(wl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&vl(n,t,r)),Fl(e,t,n);break;case 21:Fl(e,t,n);break;case 22:Dl=(r=Dl)||null!==n.memoizedState,Fl(e,t,n),Dl=r;break;default:Fl(e,t,n)}}function Bl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Hh(e)}catch(n){Nd(t,t.return,n)}}}function zl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Hh(e)}catch(n){Nd(t,t.return,n)}}function ql(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Ol),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Ol),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Ad.bind(null,e,t);t.then(r,r)}})}function Vl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(ku(l.type)){Ml=l.stateNode,Ll=!1;break e}break;case 5:Ml=l.stateNode,Ll=!1;break e;case 3:case 4:Ml=l.stateNode.containerInfo,Ll=!0;break e}l=l.return}if(null===Ml)throw Error(i(160));Ul(s,o,a),Ml=null,Ll=!1,null!==(s=a.alternate)&&(s.return=null),a.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Wl(t,e),t=t.sibling}var Hl=null;function Wl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Vl(t,e),Gl(e),4&r&&(yl(3,e,e.return),gl(3,e),yl(5,e,e.return));break;case 1:Vl(t,e),Gl(e),512&r&&(Dl||null===n||wl(n,n.return)),64&r&&Cl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var a=Hl;if(Vl(t,e),Gl(e),512&r&&(Dl||null===n||wl(n,n.return)),4&r){var s=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(r){case"title":(!(s=a.getElementsByTagName("title")[0])||s[Qe]||s[ze]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=a.createElement(r),a.head.insertBefore(s,a.querySelector("head > title"))),hu(s,r,n),s[ze]=e,et(s),r=s;break e;case"link":var o=nh("link","href",a).get(r+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}hu(s=a.createElement(r),r,n),a.head.appendChild(s);break;case"meta":if(o=nh("meta","content",a).get(r+(n.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}hu(s=a.createElement(r),r,n),a.head.appendChild(s);break;default:throw Error(i(468,r))}s[ze]=e,et(s),r=s}e.stateNode=r}else rh(a,e.type,e.stateNode);else e.stateNode=Ju(a,r,e.memoizedProps);else s!==r?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===r?rh(a,e.type,e.stateNode):Ju(a,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Nl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Vl(t,e),Gl(e),512&r&&(Dl||null===n||wl(n,n.return)),null!==n&&4&r&&Nl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Vl(t,e),Gl(e),512&r&&(Dl||null===n||wl(n,n.return)),32&e.flags){a=e.stateNode;try{_t(a,"")}catch(f){Nd(e,e.return,f)}}4&r&&null!=e.stateNode&&Nl(e,a=e.memoizedProps,null!==n?n.memoizedProps:a),1024&r&&(Tl=!0);break;case 6:if(Vl(t,e),Gl(e),4&r){if(null===e.stateNode)throw Error(i(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(f){Nd(e,e.return,f)}}break;case 3:if(th=null,a=Hl,Hl=zu(t.containerInfo),Vl(t,e),Hl=a,Gl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Hh(t.containerInfo)}catch(f){Nd(e,e.return,f)}Tl&&(Tl=!1,Kl(e));break;case 4:r=Hl,Hl=zu(e.stateNode.containerInfo),Vl(t,e),Gl(e),Hl=r;break;case 12:default:Vl(t,e),Gl(e);break;case 31:case 19:Vl(t,e),Gl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,ql(e,r)));break;case 13:Vl(t,e),Gl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Oc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,ql(e,r)));break;case 22:a=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,d=Cl,u=Dl;if(Cl=d||a,Dl=u||c,Vl(t,e),Dl=u,Cl=d,Gl(e),8192&r)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===n||c||Cl||Dl||Yl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,a)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,m=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==m||"boolean"===typeof m?"":(""+m).trim()}}catch(f){Nd(c,c.return,f)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(f){Nd(c,c.return,f)}}}else if(18===t.tag){if(null===n){c=t;try{var p=c.stateNode;a?Au(p,!0):Au(c.stateNode,!1)}catch(f){Nd(c,c.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,ql(e,n))));case 30:case 21:}}function Gl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(_l(r)){n=r;break}r=r.return}if(null==n)throw Error(i(160));switch(n.tag){case 27:var a=n.stateNode;El(e,Sl(e),a);break;case 5:var s=n.stateNode;32&n.flags&&(_t(s,""),n.flags&=-33),El(e,Sl(e),s);break;case 3:case 4:var o=n.stateNode.containerInfo;kl(e,Sl(e),o);break;default:throw Error(i(161))}}catch(l){Nd(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Ql(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Il(e,t.alternate,t),t=t.sibling}function Yl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:yl(4,t,t.return),Yl(t);break;case 1:wl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&vl(t,t.return,n),Yl(t);break;case 27:Fu(t.stateNode);case 26:case 5:wl(t,t.return),Yl(t);break;case 22:null===t.memoizedState&&Yl(t);break;default:Yl(t)}e=e.sibling}}function $l(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:$l(a,s,n),gl(4,s);break;case 1:if($l(a,s,n),"function"===typeof(a=(r=s).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){Nd(r,r.return,c)}if(null!==(a=(r=s).updateQueue)){var o=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)Ss(l[a],o)}catch(c){Nd(r,r.return,c)}}n&&64&i&&xl(s),bl(s,s.return);break;case 27:Al(s);case 26:case 5:$l(a,s,n),n&&null===r&&4&i&&jl(s),bl(s,s.return);break;case 12:$l(a,s,n);break;case 31:$l(a,s,n),n&&4&i&&Bl(a,s);break;case 13:$l(a,s,n),n&&4&i&&zl(a,s);break;case 22:null===s.memoizedState&&$l(a,s,n),bl(s,s.return);break;case 30:break;default:$l(a,s,n)}t=t.sibling}}function Jl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ba(n))}function Xl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ba(e))}function Zl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,n,r),t=t.sibling}function ec(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Zl(e,t,n,r),2048&a&&gl(9,t);break;case 1:case 31:case 13:default:Zl(e,t,n,r);break;case 3:Zl(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ba(e)));break;case 12:if(2048&a){Zl(e,t,n,r),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,o=s.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Nd(t,t.return,l)}}else Zl(e,t,n,r);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,null!==t.memoizedState?2&s._visibility?Zl(e,t,n,r):nc(e,t):2&s._visibility?Zl(e,t,n,r):(s._visibility|=2,tc(e,t,n,r,0!==(10256&t.subtreeFlags)||!1)),2048&a&&Jl(i,t);break;case 24:Zl(e,t,n,r),2048&a&&Xl(t.alternate,t)}}function tc(e,t,n,r,a){for(a=a&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var s=e,i=t,o=n,l=r,c=i.flags;switch(i.tag){case 0:case 11:case 15:tc(s,i,o,l,a),gl(8,i);break;case 23:break;case 22:var d=i.stateNode;null!==i.memoizedState?2&d._visibility?tc(s,i,o,l,a):nc(s,i):(d._visibility|=2,tc(s,i,o,l,a)),a&&2048&c&&Jl(i.alternate,i);break;case 24:tc(s,i,o,l,a),a&&2048&c&&Xl(i.alternate,i);break;default:tc(s,i,o,l,a)}t=t.sibling}}function nc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:nc(n,r),2048&a&&Jl(r.alternate,r);break;case 24:nc(n,r),2048&a&&Xl(r.alternate,r);break;default:nc(n,r)}t=t.sibling}}var rc=8192;function ac(e,t,n){if(e.subtreeFlags&rc)for(e=e.child;null!==e;)sc(e,t,n),e=e.sibling}function sc(e,t,n){switch(e.tag){case 26:ac(e,t,n),e.flags&rc&&null!==e.memoizedState&&function(e,t,n,r){if("stylesheet"===n.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var a=Gu(r.href),s=t.querySelector(Ku(a));if(s)return null!==(t=s._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ih.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=s,void et(s);s=t.ownerDocument||t,r=Qu(r),(a=Uu.get(a))&&Zu(r,a),et(s=s.createElement("link"));var i=s;i._p=new Promise(function(e,t){i.onload=e,i.onerror=t}),hu(s,"link",r),n.instance=s}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=ih.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Hl,e.memoizedState,e.memoizedProps);break;case 5:default:ac(e,t,n);break;case 3:case 4:var r=Hl;Hl=zu(e.stateNode.containerInfo),ac(e,t,n),Hl=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=rc,rc=16777216,ac(e,t,n),rc=r):ac(e,t,n))}}function ic(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function oc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Pl=r,dc(r,e)}ic(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:oc(e),2048&e.flags&&yl(9,e,e.return);break;case 3:case 12:default:oc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):oc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Pl=r,dc(r,e)}ic(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:yl(8,t,t.return),cc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function dc(e,t){for(;null!==Pl;){var n=Pl;switch(n.tag){case 0:case 11:case 15:yl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Ba(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Pl=r;else e:for(n=e;null!==Pl;){var a=(r=Pl).sibling,s=r.return;if(Rl(r),r===n){Pl=null;break e}if(null!==a){a.return=s,Pl=a;break e}Pl=s}}}var uc={getCacheForType:function(e){var t=Oa(Fa),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Oa(Fa).controller.signal}},hc="function"===typeof WeakMap?WeakMap:Map,mc=0,pc=null,fc=null,gc=0,yc=0,xc=null,vc=!1,bc=!1,wc=!1,jc=0,Nc=0,_c=0,Sc=0,kc=0,Ec=0,Ac=0,Cc=null,Dc=null,Tc=!1,Oc=0,Pc=0,Ic=1/0,Rc=null,Mc=null,Lc=0,Fc=null,Uc=null,Bc=0,zc=0,qc=null,Vc=null,Hc=0,Wc=null;function Gc(){return 0!==(2&mc)&&0!==gc?gc&-gc:null!==I.T?qd():Fe()}function Kc(){if(0===Ec)if(0===(536870912&gc)||ua){var e=_e;0===(3932160&(_e<<=1))&&(_e=262144),Ec=e}else Ec=536870912;return null!==(e=Os.current)&&(e.flags|=32),Ec}function Qc(e,t,n){(e!==pc||2!==yc&&9!==yc)&&null===e.cancelPendingCommit||(td(e,0),Xc(e,gc,Ec,!1)),Oe(e,n),0!==(2&mc)&&e===pc||(e===pc&&(0===(2&mc)&&(Sc|=n),4===Nc&&Xc(e,gc,Ec,!1)),Rd(e))}function Yc(e,t,n){if(0!==(6&mc))throw Error(i(327));for(var r=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Ae(e,t),a=r?function(e,t){var n=mc;mc|=2;var r=ad(),a=sd();pc!==e||gc!==t?(Rc=null,Ic=le()+500,td(e,t)):bc=Ae(e,t);e:for(;;)try{if(0!==yc&&null!==fc){t=fc;var s=xc;t:switch(yc){case 1:yc=0,xc=null,hd(e,t,s,1);break;case 2:case 9:if(ts(s)){yc=0,xc=null,ud(t);break}t=function(){2!==yc&&9!==yc||pc!==e||(yc=7),Rd(e)},s.then(t,t);break e;case 3:yc=7;break e;case 4:yc=5;break e;case 7:ts(s)?(yc=0,xc=null,ud(t)):(yc=0,xc=null,hd(e,t,s,7));break;case 5:var o=null;switch(fc.tag){case 26:o=fc.memoizedState;case 5:case 27:var l=fc;if(o?ah(o):l.stateNode.complete){yc=0,xc=null;var c=l.sibling;if(null!==c)fc=c;else{var d=l.return;null!==d?(fc=d,md(d)):fc=null}break t}}yc=0,xc=null,hd(e,t,s,5);break;case 6:yc=0,xc=null,hd(e,t,s,6);break;case 8:ed(),Nc=6;break e;default:throw Error(i(462))}}cd();break}catch(u){nd(e,u)}return _a=Na=null,I.H=r,I.A=a,mc=n,null!==fc?0:(pc=null,gc=0,Dr(),Nc)}(e,t):od(e,t,!0),s=r;;){if(0===a){bc&&!r&&Xc(e,t,0,!1);break}if(n=e.current.alternate,!s||Jc(n)){if(2===a){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;a=Cc;var c=l.current.memoizedState.isDehydrated;if(c&&(td(l,o).flags|=256),2!==(o=od(l,o,!1))){if(wc&&!c){l.errorRecoveryDisabledLanes|=s,Sc|=s,a=4;break e}s=Dc,Dc=a,null!==s&&(null===Dc?Dc=s:Dc.push.apply(Dc,s))}a=o}if(s=!1,2!==a)continue}}if(1===a){td(e,0),Xc(e,t,0,!0);break}e:{switch(r=e,s=a){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Xc(r,t,Ec,!vc);break e;case 2:Dc=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(a=Oc+300-le())){if(Xc(r,t,Ec,!vc),0!==Ee(r,0,!0))break e;Bc=t,r.timeoutHandle=wu($c.bind(null,r,n,Dc,Rc,Tc,t,Ec,Sc,Ac,vc,s,"Throttled",-0,0),a)}else $c(r,n,Dc,Rc,Tc,t,Ec,Sc,Ac,vc,s,null,-0,0)}break}a=od(e,t,!1),s=!1}Rd(e)}function $c(e,t,n,r,a,s,i,o,l,c,d,u,h,m){if(e.timeoutHandle=-1,8192&(u=t.subtreeFlags)||16785408===(16785408&u)){sc(t,s,u={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ot});var p=(62914560&s)===s?Oc-le():(4194048&s)===s?Pc-le():0;if(null!==(p=function(e,t){return e.stylesheets&&0===e.count&&lh(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sh&&(sh=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var a=n[r],s=a.transferSize,i=a.initiatorType,o=a.duration;if(s&&o&&mu(i)){for(i=0,o=a.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>o)break;var d=l.transferSize,u=l.initiatorType;d&&mu(u)&&(i+=d*((l=l.responseEnd)<o?1:(o-c)/(l-c)))}if(--r,t+=8*(s+i)/(a.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var a=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sh?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(a)}}:null}(u,p)))return Bc=s,e.cancelPendingCommit=p(fd.bind(null,e,t,s,n,r,a,i,o,l,d,u,null,h,m)),void Xc(e,s,i,!c)}fd(e,t,s,n,r,a,i,o,l)}function Jc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],s=a.getSnapshot;a=a.value;try{if(!Xn(s(),a))return!1}catch(i){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xc(e,t,n,r){t&=~kc,t&=~Sc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var s=31-be(a),i=1<<s;r[s]=-1,a&=~i}0!==n&&Pe(e,n,t)}function Zc(){return 0!==(6&mc)||(Md(0,!1),!1)}function ed(){if(null!==fc){if(0===yc)var e=fc.return;else _a=Na=null,ii(e=fc),os=null,ls=0,e=fc;for(;null!==e;)fl(e.alternate,e),e=e.return;fc=null}}function td(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,ju(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Bc=0,ed(),pc=e,fc=n=Br(e.current,null),gc=t,yc=0,xc=null,vc=!1,bc=Ae(e,t),wc=!1,Ac=Ec=kc=Sc=_c=Nc=0,Dc=Cc=null,Tc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-be(r),s=1<<a;t|=e[a],r&=~s}return jc=t,Dr(),n}function nd(e,t){qs=null,I.H=fo,t===Ja||t===Za?(t=ss(),yc=3):t===Xa?(t=ss(),yc=4):yc=t===Oo?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,xc=t,null===fc&&(Nc=1,Eo(e,Qr(t,e.current)))}function rd(){var e=Os.current;return null===e||((4194048&gc)===gc?null===Ps:((62914560&gc)===gc||0!==(536870912&gc))&&e===Ps)}function ad(){var e=I.H;return I.H=fo,null===e?fo:e}function sd(){var e=I.A;return I.A=uc,e}function id(){Nc=4,vc||(4194048&gc)!==gc&&null!==Os.current||(bc=!0),0===(134217727&_c)&&0===(134217727&Sc)||null===pc||Xc(pc,gc,Ec,!1)}function od(e,t,n){var r=mc;mc|=2;var a=ad(),s=sd();pc===e&&gc===t||(Rc=null,td(e,t)),t=!1;var i=Nc;e:for(;;)try{if(0!==yc&&null!==fc){var o=fc,l=xc;switch(yc){case 8:ed(),i=6;break e;case 3:case 2:case 9:case 6:null===Os.current&&(t=!0);var c=yc;if(yc=0,xc=null,hd(e,o,l,c),n&&bc){i=0;break e}break;default:c=yc,yc=0,xc=null,hd(e,o,l,c)}}ld(),i=Nc;break}catch(d){nd(e,d)}return t&&e.shellSuspendCounter++,_a=Na=null,mc=r,I.H=a,I.A=s,null===fc&&(pc=null,gc=0,Dr()),i}function ld(){for(;null!==fc;)dd(fc)}function cd(){for(;null!==fc&&!ie();)dd(fc)}function dd(e){var t=il(e.alternate,e,jc);e.memoizedProps=e.pendingProps,null===t?md(e):fc=t}function ud(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Wo(n,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=Wo(n,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:ii(t);default:fl(n,t),t=il(n,t=fc=zr(t,jc),jc)}e.memoizedProps=e.pendingProps,null===t?md(e):fc=t}function hd(e,t,n,r){_a=Na=null,ii(t),os=null,ls=0;var a=t.return;try{if(function(e,t,n,r,a){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Ca(t,n,a,!0),null!==(n=Os.current)){switch(n.tag){case 31:case 13:return null===Ps?id():null===n.alternate&&0===Nc&&(Nc=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===es?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),_d(e,r,a)),!1;case 22:return n.flags|=65536,r===es?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),_d(e,r,a)),!1}throw Error(i(435,n.tag))}return _d(e,r,a),id(),!1}if(ua)return null!==(t=Os.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==pa&&wa(Qr(e=Error(i(422),{cause:r}),n))):(r!==pa&&wa(Qr(t=Error(i(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,r=Qr(r,n),ws(e,a=Co(e.stateNode,r,a)),4!==Nc&&(Nc=2)),!1;var s=Error(i(520),{cause:r});if(s=Qr(s,n),null===Cc?Cc=[s]:Cc.push(s),4!==Nc&&(Nc=2),null===t)return!0;r=Qr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,ws(n,e=Co(n.stateNode,r,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Mc||!Mc.has(s))))return n.flags|=65536,a&=-a,n.lanes|=a,To(a=Do(a),e,n,r),ws(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,gc))return Nc=1,Eo(e,Qr(n,e.current)),void(fc=null)}catch(s){if(null!==a)throw fc=a,s;return Nc=1,Eo(e,Qr(n,e.current)),void(fc=null)}32768&t.flags?(ua||1===r?e=!0:bc||0!==(536870912&gc)?e=!1:(vc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Os.current)&&13===r.tag&&(r.flags|=16384))),pd(t,e)):md(t)}function md(e){var t=e;do{if(0!==(32768&t.flags))return void pd(t,vc);e=t.return;var n=ml(t.alternate,t,jc);if(null!==n)return void(fc=n);if(null!==(t=t.sibling))return void(fc=t);fc=t=e}while(null!==t);0===Nc&&(Nc=5)}function pd(e,t){do{var n=pl(e.alternate,e);if(null!==n)return n.flags&=32767,void(fc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(fc=e);fc=e=n}while(null!==e);Nc=6,fc=null}function fd(e,t,n,r,a,s,o,l,c){e.cancelPendingCommit=null;do{bd()}while(0!==Lc);if(0!==(6&mc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(s=t.lanes|t.childLanes,function(e,t,n,r,a,s){var i=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=i&~n;0<n;){var d=31-be(n),u=1<<d;o[d]=0,l[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var m=h[d];null!==m&&(m.lane&=-536870913)}n&=~u}0!==r&&Pe(e,r,0),0!==s&&0===a&&0!==e.tag&&(e.suspendedLanes|=s&~(i&~t))}(e,n,s|=Cr,o,l,c),e===pc&&(fc=pc=null,gc=0),Uc=t,Fc=e,Bc=n,zc=s,qc=a,Vc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ae(he,function(){return wd(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=I.T,I.T=null,a=R.p,R.p=2,o=mc,mc|=4;try{!function(e,t){if(e=e.containerInfo,pu=vh,ar(e=rr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var p;h!==n||0!==a&&3!==h.nodeType||(l=o+a),h!==s||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)m=h,h=p;for(;;){if(h===e)break t;if(m===n&&++d===a&&(l=o),m===s&&++u===r&&(c=o),null!==(p=h.nextSibling))break;m=(h=m).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(fu={focusedElem:e,selectionRange:n},vh=!1,Pl=t;null!==Pl;)if(e=(t=Pl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Pl=e;else for(;null!==Pl;){switch(s=(t=Pl).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(a=e[n]).ref.impl=a.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,a=s.memoizedProps,s=s.memoizedState,r=n.stateNode;try{var f=No(n.type,a);e=r.getSnapshotBeforeUpdate(f,s),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){Nd(n,n.return,y)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))Cu(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Cu(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,Pl=e;break}Pl=t.return}}(e,t)}finally{mc=o,R.p=a,I.T=r}}Lc=1,gd(),yd(),xd()}}function gd(){if(1===Lc){Lc=0;var e=Fc,t=Uc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=I.T,I.T=null;var r=R.p;R.p=2;var a=mc;mc|=4;try{Wl(t,e);var s=fu,i=rr(e.containerInfo),o=s.focusedElem,l=s.selectionRange;if(i!==o&&o&&o.ownerDocument&&nr(o.ownerDocument.documentElement,o)){if(null!==l&&ar(o)){var c=l.start,d=l.end;if(void 0===d&&(d=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(d,o.value.length);else{var u=o.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var m=h.getSelection(),p=o.textContent.length,f=Math.min(l.start,p),g=void 0===l.end?f:Math.min(l.end,p);!m.extend&&f>g&&(i=g,g=f,f=i);var y=tr(o,f),x=tr(o,g);if(y&&x&&(1!==m.rangeCount||m.anchorNode!==y.node||m.anchorOffset!==y.offset||m.focusNode!==x.node||m.focusOffset!==x.offset)){var v=u.createRange();v.setStart(y.node,y.offset),m.removeAllRanges(),f>g?(m.addRange(v),m.extend(x.node,x.offset)):(v.setEnd(x.node,x.offset),m.addRange(v))}}}}for(u=[],m=o;m=m.parentNode;)1===m.nodeType&&u.push({element:m,left:m.scrollLeft,top:m.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<u.length;o++){var b=u[o];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}vh=!!pu,fu=pu=null}finally{mc=a,R.p=r,I.T=n}}e.current=t,Lc=2}}function yd(){if(2===Lc){Lc=0;var e=Fc,t=Uc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=I.T,I.T=null;var r=R.p;R.p=2;var a=mc;mc|=4;try{Il(e,t.alternate,t)}finally{mc=a,R.p=r,I.T=n}}Lc=3}}function xd(){if(4===Lc||3===Lc){Lc=0,oe();var e=Fc,t=Uc,n=Bc,r=Vc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Lc=5:(Lc=0,Uc=Fc=null,vd(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Mc=null),Le(n),t=t.stateNode,xe&&"function"===typeof xe.onCommitFiberRoot)try{xe.onCommitFiberRoot(ye,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=I.T,a=R.p,R.p=2,I.T=null;try{for(var s=e.onRecoverableError,i=0;i<r.length;i++){var o=r[i];s(o.value,{componentStack:o.stack})}}finally{I.T=t,R.p=a}}0!==(3&Bc)&&bd(),Rd(e),a=e.pendingLanes,0!==(261930&n)&&0!==(42&a)?e===Wc?Hc++:(Hc=0,Wc=e):Hc=0,Md(0,!1)}}function vd(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ba(t)))}function bd(){return gd(),yd(),xd(),wd()}function wd(){if(5!==Lc)return!1;var e=Fc,t=zc;zc=0;var n=Le(Bc),r=I.T,a=R.p;try{R.p=32>n?32:n,I.T=null,n=qc,qc=null;var s=Fc,o=Bc;if(Lc=0,Uc=Fc=null,Bc=0,0!==(6&mc))throw Error(i(331));var l=mc;if(mc|=4,lc(s.current),ec(s,s.current,o,n),mc=l,Md(0,!1),xe&&"function"===typeof xe.onPostCommitFiberRoot)try{xe.onPostCommitFiberRoot(ye,s)}catch(c){}return!0}finally{R.p=a,I.T=r,vd(e,t)}}function jd(e,t,n){t=Qr(n,t),null!==(e=vs(e,t=Co(e.stateNode,t,2),2))&&(Oe(e,2),Rd(e))}function Nd(e,t,n){if(3===e.tag)jd(e,e,n);else for(;null!==t;){if(3===t.tag){jd(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Mc||!Mc.has(r))){e=Qr(n,e),null!==(r=vs(t,n=Do(2),2))&&(To(n,r,t,e),Oe(r,2),Rd(r));break}}t=t.return}}function _d(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(wc=!0,a.add(n),e=Sd.bind(null,e,t,n),t.then(e,e))}function Sd(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,pc===e&&(gc&n)===n&&(4===Nc||3===Nc&&(62914560&gc)===gc&&300>le()-Oc?0===(2&mc)&&td(e,0):kc|=n,Ac===gc&&(Ac=0)),Rd(e)}function kd(e,t){0===t&&(t=De()),null!==(e=Pr(e,t))&&(Oe(e,t),Rd(e))}function Ed(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),kd(e,n)}function Ad(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==r&&r.delete(t),kd(e,n)}var Cd=null,Dd=null,Td=!1,Od=!1,Pd=!1,Id=0;function Rd(e){e!==Dd&&null===e.next&&(null===Dd?Cd=Dd=e:Dd=Dd.next=e),Od=!0,Td||(Td=!0,_u(function(){0!==(6&mc)?ae(de,Ld):Fd()}))}function Md(e,t){if(!Pd&&Od){Pd=!0;do{for(var n=!1,r=Cd;null!==r;){if(!t)if(0!==e){var a=r.pendingLanes;if(0===a)var s=0;else{var i=r.suspendedLanes,o=r.pingedLanes;s=(1<<31-be(42|e)+1)-1,s=201326741&(s&=a&~(i&~o))?201326741&s|1:s?2|s:0}0!==s&&(n=!0,zd(r,s))}else s=gc,0===(3&(s=Ee(r,r===pc?s:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ae(r,s)||(n=!0,zd(r,s));r=r.next}}while(n);Pd=!1}}function Ld(){Fd()}function Fd(){Od=Td=!1;var e=0;0!==Id&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==bu&&(bu=e,!0);return bu=null,!1}()&&(e=Id);for(var t=le(),n=null,r=Cd;null!==r;){var a=r.next,s=Ud(r,t);0===s?(r.next=null,null===n?Cd=a:n.next=a,null===a&&(Dd=n)):(n=r,(0!==e||0!==(3&s))&&(Od=!0)),r=a}0!==Lc&&5!==Lc||Md(e,!1),0!==Id&&(Id=0)}function Ud(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var i=31-be(s),o=1<<i,l=a[i];-1===l?0!==(o&n)&&0===(o&r)||(a[i]=Ce(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(n=gc,n=Ee(e,e===(t=pc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===yc||9===yc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&se(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ae(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&se(r),Le(n)){case 2:case 8:n=ue;break;case 32:default:n=he;break;case 268435456:n=pe}return r=Bd.bind(null,e),n=ae(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&se(r),e.callbackPriority=2,e.callbackNode=null,2}function Bd(e,t){if(0!==Lc&&5!==Lc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(bd()&&e.callbackNode!==n)return null;var r=gc;return 0===(r=Ee(e,e===pc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Yc(e,r,t),Ud(e,le()),null!=e.callbackNode&&e.callbackNode===n?Bd.bind(null,e):null)}function zd(e,t){if(bd())return null;Yc(e,t,!0)}function qd(){if(0===Id){var e=Va;0===e&&(e=Ne,0===(261888&(Ne<<=1))&&(Ne=256)),Id=e}return Id}function Vd(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Tt(""+e)}function Hd(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Wd=0;Wd<_r.length;Wd++){var Gd=_r[Wd];Sr(Gd.toLowerCase(),"on"+(Gd[0].toUpperCase()+Gd.slice(1)))}Sr(gr,"onAnimationEnd"),Sr(yr,"onAnimationIteration"),Sr(xr,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(vr,"onTransitionRun"),Sr(br,"onTransitionStart"),Sr(wr,"onTransitionCancel"),Sr(jr,"onTransitionEnd"),at("onMouseEnter",["mouseout","mouseover"]),at("onMouseLeave",["mouseout","mouseover"]),at("onPointerEnter",["pointerout","pointerover"]),at("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kd));function Yd(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(d){kr(d)}a.currentTarget=null,s=l}else for(i=0;i<r.length;i++){if(l=(o=r[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(d){kr(d)}a.currentTarget=null,s=l}}}}function $d(e,t){var n=t[He];void 0===n&&(n=t[He]=new Set);var r=e+"__bubble";n.has(r)||(eu(t,e,2,!1),n.add(r))}function Jd(e,t,n){var r=0;t&&(r|=4),eu(n,e,r,t)}var Xd="_reactListening"+Math.random().toString(36).slice(2);function Zd(e){if(!e[Xd]){e[Xd]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Qd.has(t)||Jd(t,!1,e),Jd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Xd]||(t[Xd]=!0,Jd("selectionchange",!1,t))}}function eu(e,t,n,r){switch(kh(t)){case 2:var a=bh;break;case 8:a=wh;break;default:a=jh}n=a.bind(null,t,n,e),a=void 0,!qt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function tu(e,t,n,r,a){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var o=r.stateNode.containerInfo;if(o===a)break;if(4===i)for(i=r.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===a)return;i=i.return}for(;null!==o;){if(null===(i=$e(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){r=s=i;continue e}o=o.parentNode}}r=r.return}Ut(function(){var r=s,a=It(n),i=[];e:{var o=Nr.get(e);if(void 0!==o){var c=nn,d=e;switch(e){case"keypress":if(0===Qt(n))break e;case"keydown":case"keyup":c=xn;break;case"focusin":d="focus",c=cn;break;case"focusout":d="blur",c=cn;break;case"beforeblur":case"afterblur":c=cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=on;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=bn;break;case gr:case yr:case xr:c=dn;break;case jr:c=wn;break;case"scroll":case"scrollend":c=an;break;case"wheel":c=jn;break;case"copy":case"cut":case"paste":c=un;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=vn;break;case"toggle":case"beforetoggle":c=Nn}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),m=u?null!==o?o+"Capture":null:o;u=[];for(var p,f=r;null!==f;){var g=f;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===m||null!=(g=Bt(f,m))&&u.push(nu(f,g,p)),h)break;f=f.return}0<u.length&&(o=new c(o,d,null,n,a),i.push({event:o,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Pt||!(d=n.relatedTarget||n.fromElement)||!$e(d)&&!d[Ve])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(d=(d=n.relatedTarget||n.toElement)?$e(d):null)&&(h=l(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=r),c!==d)){if(u=on,g="onMouseLeave",m="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=vn,g="onPointerLeave",m="onPointerEnter",f="pointer"),h=null==c?o:Xe(c),p=null==d?o:Xe(d),(o=new u(g,f+"leave",c,n,a)).target=h,o.relatedTarget=p,g=null,$e(a)===r&&((u=new u(m,f+"enter",d,n,a)).target=p,u.relatedTarget=h,g=u),h=g,c&&d)e:{for(u=au,f=d,p=0,g=m=c;g;g=u(g))p++;g=0;for(var y=f;y;y=u(y))g++;for(;0<p-g;)m=u(m),p--;for(;0<g-p;)f=u(f),g--;for(;p--;){if(m===f||null!==f&&m===f.alternate){u=m;break e}m=u(m),f=u(f)}u=null}else u=null;null!==c&&su(i,o,c,u,!1),null!==d&&null!==h&&su(i,h,d,u,!0)}if("select"===(c=(o=r?Xe(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var x=zn;else if(Rn(o))if(qn)x=Jn;else{x=Yn;var v=Qn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&At(r.elementType)&&(x=zn):x=$n;switch(x&&(x=x(e,r))?Mn(i,x,n,a):(v&&v(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&bt(o,"number",o.value)),v=r?Xe(r):window,e){case"focusin":(Rn(v)||"true"===v.contentEditable)&&(ir=v,or=r,lr=null);break;case"focusout":lr=or=ir=null;break;case"mousedown":cr=!0;break;case"contextmenu":case"mouseup":case"dragend":cr=!1,dr(i,n,a);break;case"selectionchange":if(sr)break;case"keydown":case"keyup":dr(i,n,a)}var b;if(Sn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Pn?Tn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(An&&"ko"!==n.locale&&(Pn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Pn&&(b=Kt()):(Wt="value"in(Ht=a)?Ht.value:Ht.textContent,Pn=!0)),0<(v=ru(r,w)).length&&(w=new hn(w,e,null,n,a),i.push({event:w,listeners:v}),b?w.data=b:null!==(b=On(n))&&(w.data=b))),(b=En?function(e,t){switch(e){case"compositionend":return On(t);case"keypress":return 32!==t.which?null:(Dn=!0,Cn);case"textInput":return(e=t.data)===Cn&&Dn?null:e;default:return null}}(e,n):function(e,t){if(Pn)return"compositionend"===e||!Sn&&Tn(e,t)?(e=Kt(),Gt=Wt=Ht=null,Pn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return An&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=ru(r,"onBeforeInput")).length&&(v=new hn("onBeforeInput","beforeinput",null,n,a),i.push({event:v,listeners:w}),v.data=b)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var s=Vd((a[qe]||null).action),i=r.submitter;i&&null!==(t=(t=i[qe]||null)?Vd(t.formAction):i.getAttribute("formAction"))&&(s=t,i=null);var o=new nn("action","action",null,r,a);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Id){var e=i?Hd(a,i):new FormData(a);eo(n,{pending:!0,data:e,method:a.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=i?Hd(a,i):new FormData(a),eo(n,{pending:!0,data:e,method:a.method,action:s},s,e))},currentTarget:a}]})}}(i,e,r,n,a)}Yd(i,t)})}function nu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ru(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,s=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===s||(null!=(a=Bt(e,n))&&r.unshift(nu(e,a,s)),null!=(a=Bt(e,t))&&r.push(nu(e,a,s))),3===e.tag)return r;e=e.return}return[]}function au(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function su(e,t,n,r,a){for(var s=t._reactName,i=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===c||(l=c,a?null!=(c=Bt(n,s))&&i.unshift(nu(n,c,l)):a||null!=(c=Bt(n,s))&&i.push(nu(n,c,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var iu=/\r\n?/g,ou=/\u0000|\uFFFD/g;function lu(e){return("string"===typeof e?e:""+e).replace(iu,"\n").replace(ou,"")}function cu(e,t){return t=lu(t),lu(e)===t}function du(e,t,n,r,a,s){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||_t(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&_t(e,""+r);break;case"className":ct(e,"class",r);break;case"tabIndex":ct(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,n,r);break;case"style":Et(e,r,s);break;case"data":if("object"!==t){ct(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Tt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&du(e,t,"name",a.name,a,null),du(e,t,"formEncType",a.formEncType,a,null),du(e,t,"formMethod",a.formMethod,a,null),du(e,t,"formTarget",a.formTarget,a,null)):(du(e,t,"encType",a.encType,a,null),du(e,t,"method",a.method,a,null),du(e,t,"target",a.target,a,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Tt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Ot);break;case"onScroll":null!=r&&$d("scroll",e);break;case"onScrollEnd":null!=r&&$d("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(i(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Tt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":$d("beforetoggle",e),$d("toggle",e),lt(e,"popover",r);break;case"xlinkActuate":dt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":dt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":dt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":dt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":dt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":dt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":dt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":dt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":dt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":lt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&lt(e,n=Ct.get(n)||n,r)}}function uu(e,t,n,r,a,s){switch(n){case"style":Et(e,r,s);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(i(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=n}}break;case"children":"string"===typeof r?_t(e,r):("number"===typeof r||"bigint"===typeof r)&&_t(e,""+r);break;case"onScroll":null!=r&&$d("scroll",e);break;case"onScrollEnd":null!=r&&$d("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Ot);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"===typeof(s=null!=(s=e[qe]||null)?s[n]:null)&&e.removeEventListener(t,s,a),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):lt(e,n,r):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,a)))}}function hu(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$d("error",e),$d("load",e);var r,a=!1,s=!1;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(null!=o)switch(r){case"src":a=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:du(e,t,r,o,n,null)}}return s&&du(e,t,"srcSet",n.srcSet,n,null),void(a&&du(e,t,"src",n.src,n,null));case"input":$d("invalid",e);var l=r=o=s=null,c=null,d=null;for(a in n)if(n.hasOwnProperty(a)){var u=n[a];if(null!=u)switch(a){case"name":s=u;break;case"type":o=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":r=u;break;case"defaultValue":l=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(i(137,t));break;default:du(e,t,a,u,n,null)}}return void vt(e,r,l,c,d,o,s,!1);case"select":for(s in $d("invalid",e),a=o=r=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":r=l;break;case"defaultValue":o=l;break;case"multiple":a=l;default:du(e,t,s,l,n,null)}return t=r,n=o,e.multiple=!!a,void(null!=t?wt(e,!!a,t,!1):null!=n&&wt(e,!!a,n,!0));case"textarea":for(o in $d("invalid",e),r=s=a=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":a=l;break;case"defaultValue":s=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:du(e,t,o,l,n,null)}return void Nt(e,a,s,r);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(a=n[c]))if("selected"===c)e.selected=a&&"function"!==typeof a&&"symbol"!==typeof a;else du(e,t,c,a,n,null);return;case"dialog":$d("beforetoggle",e),$d("toggle",e),$d("cancel",e),$d("close",e);break;case"iframe":case"object":$d("load",e);break;case"video":case"audio":for(a=0;a<Kd.length;a++)$d(Kd[a],e);break;case"image":$d("error",e),$d("load",e);break;case"details":$d("toggle",e);break;case"embed":case"source":case"link":$d("error",e),$d("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in n)if(n.hasOwnProperty(d)&&null!=(a=n[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:du(e,t,d,a,n,null)}return;default:if(At(t)){for(u in n)n.hasOwnProperty(u)&&(void 0!==(a=n[u])&&uu(e,t,u,a,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(a=n[l])&&du(e,t,l,a,n,null))}function mu(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var pu=null,fu=null;function gu(e){return 9===e.nodeType?e:e.ownerDocument}function yu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function xu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function vu(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var bu=null;var wu="function"===typeof setTimeout?setTimeout:void 0,ju="function"===typeof clearTimeout?clearTimeout:void 0,Nu="function"===typeof Promise?Promise:void 0,_u="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Nu?function(e){return Nu.resolve(null).then(e).catch(Su)}:wu;function Su(e){setTimeout(function(){throw e})}function ku(e){return"head"===e}function Eu(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)||"/&"===n){if(0===r)return e.removeChild(a),void Hh(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Fu(e.ownerDocument.documentElement);else if("head"===n){Fu(n=e.ownerDocument.head);for(var s=n.firstChild;s;){var i=s.nextSibling,o=s.nodeName;s[Qe]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=i}}else"body"===n&&Fu(e.ownerDocument.body);n=a}while(n);Hh(t)}function Au(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Cu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Cu(n),Ye(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Du(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Pu(e.nextSibling)))return null}return e}function Tu(e){return"$?"===e.data||"$~"===e.data}function Ou(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Pu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Iu=null;function Ru(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Pu(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Mu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Lu(e,t,n){switch(t=gu(n),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function Fu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ye(e)}var Uu=new Map,Bu=new Set;function zu(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var qu=R.d;R.d={f:function(){var e=qu.f(),t=Zc();return e||t},r:function(e){var t=Je(e);null!==t&&5===t.tag&&"form"===t.type?no(t):qu.r(e)},D:function(e){qu.D(e),Hu("dns-prefetch",e,null)},C:function(e,t){qu.C(e,t),Hu("preconnect",e,t)},L:function(e,t,n){qu.L(e,t,n);var r=Vu;if(r&&e&&t){var a='link[rel="preload"][as="'+yt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+yt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(a+='[imagesizes="'+yt(n.imageSizes)+'"]')):a+='[href="'+yt(e)+'"]';var s=a;switch(t){case"style":s=Gu(e);break;case"script":s=Yu(e)}Uu.has(s)||(e=m({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Uu.set(s,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Ku(s))||"script"===t&&r.querySelector($u(s))||(hu(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){qu.m(e,t);var n=Vu;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+yt(r)+'"][href="'+yt(e)+'"]',s=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Yu(e)}if(!Uu.has(s)&&(e=m({rel:"modulepreload",href:e},t),Uu.set(s,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector($u(s)))return}hu(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r)}}},X:function(e,t){qu.X(e,t);var n=Vu;if(n&&e){var r=Ze(n).hoistableScripts,a=Yu(e),s=r.get(a);s||((s=n.querySelector($u(a)))||(e=m({src:e,async:!0},t),(t=Uu.get(a))&&eh(e,t),et(s=n.createElement("script")),hu(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(a,s))}},S:function(e,t,n){qu.S(e,t,n);var r=Vu;if(r&&e){var a=Ze(r).hoistableStyles,s=Gu(e);t=t||"default";var i=a.get(s);if(!i){var o={loading:0,preload:null};if(i=r.querySelector(Ku(s)))o.loading=5;else{e=m({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Uu.get(s))&&Zu(e,n);var l=i=r.createElement("link");et(l),hu(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Xu(i,t,r)}i={type:"stylesheet",instance:i,count:1,state:o},a.set(s,i)}}},M:function(e,t){qu.M(e,t);var n=Vu;if(n&&e){var r=Ze(n).hoistableScripts,a=Yu(e),s=r.get(a);s||((s=n.querySelector($u(a)))||(e=m({src:e,async:!0,type:"module"},t),(t=Uu.get(a))&&eh(e,t),et(s=n.createElement("script")),hu(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(a,s))}}};var Vu="undefined"===typeof document?null:document;function Hu(e,t,n){var r=Vu;if(r&&"string"===typeof t&&t){var a=yt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"===typeof n&&(a+='[crossorigin="'+n+'"]'),Bu.has(a)||(Bu.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(hu(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function Wu(e,t,n,r){var a,s,o,l,c=(c=G.current)?zu(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Gu(n.href),(r=(n=Ze(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Gu(n.href);var d=Ze(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Ku(e)))&&!d._p&&(u.instance=d,u.state.loading=5),Uu.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Uu.set(e,n),d||(a=c,s=e,o=n,l=u.state,a.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=a.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),hu(s,"link",o),et(s),a.head.appendChild(s))))),t&&null===r)throw Error(i(528,""));return u}if(t&&null!==r)throw Error(i(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Yu(n),(r=(n=Ze(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Gu(e){return'href="'+yt(e)+'"'}function Ku(e){return'link[rel="stylesheet"]['+e+"]"}function Qu(e){return m({},e,{"data-precedence":e.precedence,precedence:null})}function Yu(e){return'[src="'+yt(e)+'"]'}function $u(e){return"script[async]"+e}function Ju(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+yt(n.href)+'"]');if(r)return t.instance=r,et(r),r;var a=m({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),hu(r,"style",a),Xu(r,n.precedence,e),t.instance=r;case"stylesheet":a=Gu(n.href);var s=e.querySelector(Ku(a));if(s)return t.state.loading|=4,t.instance=s,et(s),s;r=Qu(n),(a=Uu.get(a))&&Zu(r,a),et(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),hu(s,"link",r),t.state.loading|=4,Xu(s,n.precedence,e),t.instance=s;case"script":return s=Yu(n.src),(a=e.querySelector($u(s)))?(t.instance=a,et(a),a):(r=n,(a=Uu.get(s))&&eh(r=m({},n),a),et(a=(e=e.ownerDocument||e).createElement("script")),hu(a,"link",r),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Xu(r,n.precedence,e));return t.instance}function Xu(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,s=a,i=0;i<r.length;i++){var o=r[i];if(o.dataset.precedence===t)s=o;else if(s!==a)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Zu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function nh(e,t,n){if(null===th){var r=new Map,a=th=new Map;a.set(n,r)}else(r=(a=th).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var s=n[a];if(!(s[Qe]||s[ze]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var i=s.getAttribute(t)||"";i=e+i;var o=r.get(i);o?o.push(s):r.set(i,[s])}}return r}function rh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function ah(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sh=0;function ih(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var oh=null;function lh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,oh=new Map,t.forEach(ch,e),oh=null,ih.call(e))}function ch(e,t){if(!(4&t.state.loading)){var n=oh.get(e);if(n)var r=n.get(null);else{n=new Map,oh.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<a.length;s++){var i=a[s];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(n.set(i.dataset.precedence,i),r=i)}r&&n.set(null,r)}i=(a=t.instance).getAttribute("data-precedence"),(s=n.get(i)||r)===r&&n.set(null,a),n.set(i,a),this.count++,r=ih.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),s?s.parentNode.insertBefore(a,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var dh={$$typeof:w,Provider:null,Consumer:null,_currentValue:M,_currentValue2:M,_threadCount:0};function uh(e,t,n,r,a,s,i,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Te(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Te(0),this.hiddenUpdates=Te(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hh(e,t,n,r,a,s,i,o,l,c,d,u){return e=new uh(e,t,n,i,l,c,d,u,o),t=1,!0===s&&(t|=24),s=Fr(3,null,null,t),e.current=s,s.stateNode=e,(t=Ua()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:r,isDehydrated:n,cache:t},gs(s),e}function mh(e){return e?e=Mr:Mr}function ph(e,t,n,r,a,s){a=mh(a),null===r.context?r.context=a:r.pendingContext=a,(r=xs(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(r.callback=s),null!==(n=vs(e,r,t))&&(Qc(n,0,t),bs(n,e,t))}function fh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function gh(e,t){fh(e,t),(e=e.alternate)&&fh(e,t)}function yh(e){if(13===e.tag||31===e.tag){var t=Pr(e,67108864);null!==t&&Qc(t,0,67108864),gh(e,67108864)}}function xh(e){if(13===e.tag||31===e.tag){var t=Gc(),n=Pr(e,t=Me(t));null!==n&&Qc(n,0,t),gh(e,t)}}var vh=!0;function bh(e,t,n,r){var a=I.T;I.T=null;var s=R.p;try{R.p=2,jh(e,t,n,r)}finally{R.p=s,I.T=a}}function wh(e,t,n,r){var a=I.T;I.T=null;var s=R.p;try{R.p=8,jh(e,t,n,r)}finally{R.p=s,I.T=a}}function jh(e,t,n,r){if(vh){var a=Nh(r);if(null===a)tu(e,t,r,_h,n),Rh(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Ah=Mh(Ah,e,t,n,r,a),!0;case"dragenter":return Ch=Mh(Ch,e,t,n,r,a),!0;case"mouseover":return Dh=Mh(Dh,e,t,n,r,a),!0;case"pointerover":var s=a.pointerId;return Th.set(s,Mh(Th.get(s)||null,e,t,n,r,a)),!0;case"gotpointercapture":return s=a.pointerId,Oh.set(s,Mh(Oh.get(s)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Rh(e,r),4&t&&-1<Ih.indexOf(e)){for(;null!==a;){var s=Je(a);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var i=ke(s.pendingLanes);if(0!==i){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-be(i);o.entanglements[1]|=l,i&=~l}Rd(s),0===(6&mc)&&(Ic=le()+500,Md(0,!1))}}break;case 31:case 13:null!==(o=Pr(s,2))&&Qc(o,0,2),Zc(),gh(s,2)}if(null===(s=Nh(r))&&tu(e,t,r,_h,n),s===a)break;a=s}null!==a&&r.stopPropagation()}else tu(e,t,r,null,n)}}function Nh(e){return Sh(e=It(e))}var _h=null;function Sh(e){if(_h=null,null!==(e=$e(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(31===n){if(null!==(e=d(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return _h=e,null}function kh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case de:return 2;case ue:return 8;case he:case me:return 32;case pe:return 268435456;default:return 32}default:return 32}}var Eh=!1,Ah=null,Ch=null,Dh=null,Th=new Map,Oh=new Map,Ph=[],Ih="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Rh(e,t){switch(e){case"focusin":case"focusout":Ah=null;break;case"dragenter":case"dragleave":Ch=null;break;case"mouseover":case"mouseout":Dh=null;break;case"pointerover":case"pointerout":Th.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oh.delete(t.pointerId)}}function Mh(e,t,n,r,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=Je(t))&&yh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lh(e){var t=$e(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void Ue(e.priority,function(){xh(n)})}else if(31===t){if(null!==(t=d(n)))return e.blockedOn=t,void Ue(e.priority,function(){xh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Fh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Nh(e.nativeEvent);if(null!==n)return null!==(t=Je(n))&&yh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Pt=r,n.target.dispatchEvent(r),Pt=null,t.shift()}return!0}function Uh(e,t,n){Fh(e)&&n.delete(t)}function Bh(){Eh=!1,null!==Ah&&Fh(Ah)&&(Ah=null),null!==Ch&&Fh(Ch)&&(Ch=null),null!==Dh&&Fh(Dh)&&(Dh=null),Th.forEach(Uh),Oh.forEach(Uh)}function zh(e,t){e.blockedOn===t&&(e.blockedOn=null,Eh||(Eh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bh)))}var qh=null;function Vh(e){qh!==e&&(qh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){qh===e&&(qh=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],a=e[t+2];if("function"!==typeof r){if(null===Sh(r||n))continue;break}var s=Je(n);null!==s&&(e.splice(t,3),t-=3,eo(s,{pending:!0,data:a,method:n.method,action:r},r,a))}}))}function Hh(e){function t(t){return zh(t,e)}null!==Ah&&zh(Ah,e),null!==Ch&&zh(Ch,e),null!==Dh&&zh(Dh,e),Th.forEach(t),Oh.forEach(t);for(var n=0;n<Ph.length;n++){var r=Ph[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Ph.length&&null===(n=Ph[0]).blockedOn;)Lh(n),null===n.blockedOn&&Ph.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],s=n[r+1],i=a[qe]||null;if("function"===typeof s)i||Vh(n);else if(i){var o=null;if(s&&s.hasAttribute("formAction")){if(a=s,i=s[qe]||null)o=i.formAction;else if(null!==Sh(a))continue}else o=i.action;"function"===typeof o?n[r+1]=o:(n.splice(r,3),r-=3),Vh(n)}}}function Wh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return a=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==a&&(a(),a=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==a&&(a(),a=null)}}}function Gh(e){this._internalRoot=e}function Kh(e){this._internalRoot=e}Kh.prototype.render=Gh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));ph(t.current,Gc(),e,t,null,null)},Kh.prototype.unmount=Gh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ph(e.current,2,null,e,null,null),Zc(),t[Ve]=null}},Kh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ph.length&&0!==t&&t<Ph[n].priority;n++);Ph.splice(n,0,e),0===n&&Lh(e)}};var Qh=a.version;if("19.2.0"!==Qh)throw Error(i(527,Qh,"19.2.0"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return u(a),e;if(s===r)return u(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=s;break}if(c===r){o=!0,r=a,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,r=a;break}if(c===r){o=!0,r=s,n=a;break}c=c.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Yh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{ye=$h.inject(Yh),xe=$h}catch(Xh){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var n=!1,r="",a=_o,s=So,l=ko;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hh(e,1,!1,null,0,n,r,null,a,s,l,Wh),e[Ve]=t.current,Zd(e),new Gh(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(i(299));var r=!1,a="",s=_o,l=So,c=ko,d=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(d=n.formState)),(t=hh(e,1,!0,t,0,r,a,d,s,l,c,Wh)).context=mh(null),n=t.current,(a=xs(r=Me(r=Gc()))).callback=null,vs(n,a,r),n=r,t.current.lanes=n,Oe(t,n),Rd(t),e[Ve]=t.current,Zd(e),new Kh(t)},t.version="19.2.0"},7043:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2777),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.isKey=function(e,t){return!Array.isArray(e)&&(!("number"!==typeof e&&"boolean"!==typeof e&&null!=e&&!r.isSymbol(e))||("string"===typeof e&&(s.test(e)||!a.test(e))||null!=t&&Object.hasOwn(t,e)))}},7231:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(3799),a=n(4879);t.range=function(e,t,n){n&&"number"!==typeof n&&r.isIterateeCall(e,t,n)&&(t=n=void 0),e=a.toFinite(e),void 0===t?(t=e,e=0):t=a.toFinite(t),n=void 0===n?e<t?1:-1:a.toFinite(n);const s=Math.max(Math.ceil((t-e)/(n||1)),0),i=new Array(s);for(let r=0;r<s;r++)i[r]=e,e+=n;return i}},7237:(e,t,n)=>{"use strict";n(8365)},7260:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isUnsafeProperty=function(e){return"__proto__"===e}},7283:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,r,s,i){if("function"!==typeof r)throw new TypeError("The listener must be a function");var o=new a(r,s||e,i),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function i(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,s=r.length,i=new Array(s);a<s;a++)i[a]=r[a].fn;return i},o.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,a,s,i){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,d=this._events[o],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,a),!0;case 5:return d.fn.call(d.context,t,r,a,s),!0;case 6:return d.fn.call(d.context,t,r,a,s,i),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];d.fn.apply(d.context,l)}else{var h,m=d.length;for(c=0;c<m;c++)switch(d[c].once&&this.removeListener(e,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context);break;case 2:d[c].fn.call(d[c].context,t);break;case 3:d[c].fn.call(d[c].context,t,r);break;case 4:d[c].fn.call(d[c].context,t,r,a);break;default:if(!l)for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];d[c].fn.apply(d[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,r,a){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return i(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||a&&!o.once||r&&o.context!==r||i(this,s);else{for(var l=0,c=[],d=o.length;l<d;l++)(o[l].fn!==t||a&&!o[l].once||r&&o[l].context!==r)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:i(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&i(this,t)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o},7312:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.flatten=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=[],r=Math.floor(t),a=(e,t)=>{for(let s=0;s<e.length;s++){const i=e[s];Array.isArray(i)&&t<r?a(i,t+1):n.push(i)}};return a(e,0),n}},7330:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9323);t.property=function(e){return function(t){return r.get(t,e)}}},7599:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});t.argumentsTag="[object Arguments]",t.arrayBufferTag="[object ArrayBuffer]",t.arrayTag="[object Array]",t.bigInt64ArrayTag="[object BigInt64Array]",t.bigUint64ArrayTag="[object BigUint64Array]",t.booleanTag="[object Boolean]",t.dataViewTag="[object DataView]",t.dateTag="[object Date]",t.errorTag="[object Error]",t.float32ArrayTag="[object Float32Array]",t.float64ArrayTag="[object Float64Array]",t.functionTag="[object Function]",t.int16ArrayTag="[object Int16Array]",t.int32ArrayTag="[object Int32Array]",t.int8ArrayTag="[object Int8Array]",t.mapTag="[object Map]",t.numberTag="[object Number]",t.objectTag="[object Object]",t.regexpTag="[object RegExp]",t.setTag="[object Set]",t.stringTag="[object String]",t.symbolTag="[object Symbol]",t.uint16ArrayTag="[object Uint16Array]",t.uint32ArrayTag="[object Uint32Array]",t.uint8ArrayTag="[object Uint8Array]",t.uint8ClampedArrayTag="[object Uint8ClampedArray]"},7736:(e,t,n)=>{var r=n(3738).default,a=n(9045);e.exports=function(e){var t=a(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},7770:(e,t,n)=>{e.exports=n(9323).get},7820:(e,t,n)=>{e.exports=n(5414).throttle},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(6672)},8181:(e,t,n)=>{"use strict";n.r(t),n.d(t,{phase5Topics:()=>r});const r=[{name:"Project Introduction: Ask Gemini Web App",order:1,maxTime:null,keyConcepts:["Overview"],description:"Understand full-stack development: frontend communicates with backend server built in Node.js & Express, which integrates with Gemini API.",deliverable:"No video \u2013 intro only",video:null},{name:"Express App Setup & Structure",order:2,maxTime:null,keyConcepts:["Node.js runtime","express()","Project folder structure"],description:"Initialize Express server, install dependencies, organize project folders (server code, frontend files).",deliverable:"1 Video: Show setup, folder structure, app.listen(), basic server code.",video:1},{name:"Backend Routes & Request Handling",order:3,maxTime:null,keyConcepts:["Express routes (app.get(), app.post())","express.json()"],description:"Handle frontend requests via GET/POST. Parse incoming request data (JSON), structure server responses.",deliverable:"1 Video: Demonstrate routes handling user inputs.",video:1},{name:"Gemini API Integration on Backend",order:4,maxTime:null,keyConcepts:["fetch() / axios","Promises","async/await","environment variables (.env, dotenv)"],description:"Securely communicate with Gemini API from server. Handle asynchronous responses, parse JSON, return data to frontend.",deliverable:"1 Video: Show API integration + explain API key security + backend response processing.",video:1},{name:"Frontend-Backend Interaction Demo",order:5,maxTime:null,keyConcepts:["DOM manipulation","fetch() (frontend)","Event handling"],description:"Send user input to backend, receive AI-generated content, update frontend dynamically. Demonstrate full-stack communication.",deliverable:"1 Video: Demo full app flow (frontend \u2192 backend \u2192 Gemini \u2192 frontend).",video:1},{name:"Mini Projects / Practice Exercises",order:6,maxTime:null,keyConcepts:["Node.js","Express routes","fetch()/axios","JSON responses"],description:"Practice building small backend APIs: AI Fun Facts, AI Daily Journal Prompter, AI Helper Bot with multiple endpoints. Apply async JS and Gemini API integration.",deliverable:"1 Video per mini-project: Demo working backend + explain code and API usage.",video:3},{name:"Project Wrap-Up & Reflection",order:7,maxTime:null,keyConcepts:["Review All Learned Concepts"],description:"Review Node.js, Express.js, backend routing, API integration, async operations, full-stack flow. Reflect on building a functional backend app with AI.",deliverable:'1 Video: Demonstrate final full-stack "Ask Gemini" app + reflect on learning outcomes.',video:1}]},8210:function(e,t,n){var r;!function(){"use strict";var a,s=1e9,i={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},o=!0,l="[DecimalError] ",c=l+"Invalid argument: ",d=l+"Exponent out of range: ",u=Math.floor,h=Math.pow,m=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,p=1e7,f=9007199254740991,g=u(1286742750677284.5),y={};function x(e,t){var n,r,a,s,i,l,c,d,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),o?A(t,h):t;if(c=e.d,d=t.d,i=e.e,a=t.e,c=c.slice(),s=i-a){for(s<0?(r=c,s=-s,l=d.length):(r=d,a=i,l=c.length),s>(l=(i=Math.ceil(h/7))>l?i+1:l+1)&&(s=l,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for((l=c.length)-(s=d.length)<0&&(s=l,r=d,d=c,c=r),n=0;s;)n=(c[--s]=c[s]+d[s]+n)/p|0,c[s]%=p;for(n&&(c.unshift(n),++a),l=c.length;0==c[--l];)c.pop();return t.d=c,t.e=a,o?A(t,h):t}function v(e,t,n){if(e!==~~e||e<t||e>n)throw Error(c+e)}function b(e){var t,n,r,a=e.length-1,s="",i=e[0];if(a>0){for(s+=i,t=1;t<a;t++)(n=7-(r=e[t]+"").length)&&(s+=S(n)),s+=r;(n=7-(r=(i=e[t])+"").length)&&(s+=S(n))}else if(0===i)return"0";for(;i%10===0;)i/=10;return s+i}y.absoluteValue=y.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},y.comparedTo=y.cmp=function(e){var t,n,r,a,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(t=0,n=(r=s.d.length)<(a=e.d.length)?r:a;t<n;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return r===a?0:r>a^s.s<0?1:-1},y.decimalPlaces=y.dp=function(){var e=this,t=e.d.length-1,n=7*(t-e.e);if(t=e.d[t])for(;t%10==0;t/=10)n--;return n<0?0:n},y.dividedBy=y.div=function(e){return w(this,new this.constructor(e))},y.dividedToIntegerBy=y.idiv=function(e){var t=this.constructor;return A(w(this,new t(e),0,1),t.precision)},y.equals=y.eq=function(e){return!this.cmp(e)},y.exponent=function(){return N(this)},y.greaterThan=y.gt=function(e){return this.cmp(e)>0},y.greaterThanOrEqualTo=y.gte=function(e){return this.cmp(e)>=0},y.isInteger=y.isint=function(){return this.e>this.d.length-2},y.isNegative=y.isneg=function(){return this.s<0},y.isPositive=y.ispos=function(){return this.s>0},y.isZero=function(){return 0===this.s},y.lessThan=y.lt=function(e){return this.cmp(e)<0},y.lessThanOrEqualTo=y.lte=function(e){return this.cmp(e)<1},y.logarithm=y.log=function(e){var t,n=this,r=n.constructor,s=r.precision,i=s+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(a))throw Error(l+"NaN");if(n.s<1)throw Error(l+(n.s?"NaN":"-Infinity"));return n.eq(a)?new r(0):(o=!1,t=w(k(n,i),k(e,i),i),o=!0,A(t,s))},y.minus=y.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?C(t,e):x(t,(e.s=-e.s,e))},y.modulo=y.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(!(e=new r(e)).s)throw Error(l+"NaN");return n.s?(o=!1,t=w(n,e,0,1).times(e),o=!0,n.minus(t)):A(new r(n),a)},y.naturalExponential=y.exp=function(){return j(this)},y.naturalLogarithm=y.ln=function(){return k(this)},y.negated=y.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},y.plus=y.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?x(t,e):C(t,(e.s=-e.s,e))},y.precision=y.sd=function(e){var t,n,r,a=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(c+e);if(t=N(a)+1,n=7*(r=a.d.length-1)+1,r=a.d[r]){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},y.squareRoot=y.sqrt=function(){var e,t,n,r,a,s,i,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(l+"NaN")}for(e=N(c),o=!1,0==(a=Math.sqrt(+c))||a==1/0?(((t=b(c.d)).length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=u((e+1)/2)-(e<0||e%2),r=new d(t=a==1/0?"5e"+e:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+e)):r=new d(a.toString()),a=i=(n=d.precision)+3;;)if(r=(s=r).plus(w(c,s,i+2)).times(.5),b(s.d).slice(0,i)===(t=b(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&"4999"==t){if(A(s,n+1,0),s.times(s).eq(c)){r=s;break}}else if("9999"!=t)break;i+=4}return o=!0,A(r,n)},y.times=y.mul=function(e){var t,n,r,a,s,i,l,c,d,u=this,h=u.constructor,m=u.d,f=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,n=u.e+e.e,(c=m.length)<(d=f.length)&&(s=m,m=f,f=s,i=c,c=d,d=i),s=[],r=i=c+d;r--;)s.push(0);for(r=d;--r>=0;){for(t=0,a=c+r;a>r;)l=s[a]+f[r]*m[a-r-1]+t,s[a--]=l%p|0,t=l/p|0;s[a]=(s[a]+t)%p|0}for(;!s[--i];)s.pop();return t?++n:s.shift(),e.d=s,e.e=n,o?A(e,h.precision):e},y.toDecimalPlaces=y.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(v(e,0,s),void 0===t?t=r.rounding:v(t,0,8),A(n,e+N(n)+1,t))},y.toExponential=function(e,t){var n,r=this,a=r.constructor;return void 0===e?n=D(r,!0):(v(e,0,s),void 0===t?t=a.rounding:v(t,0,8),n=D(r=A(new a(r),e+1,t),!0,e+1)),n},y.toFixed=function(e,t){var n,r,a=this,i=a.constructor;return void 0===e?D(a):(v(e,0,s),void 0===t?t=i.rounding:v(t,0,8),n=D((r=A(new i(a),e+N(a)+1,t)).abs(),!1,e+N(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},y.toInteger=y.toint=function(){var e=this,t=e.constructor;return A(new t(e),N(e)+1,t.rounding)},y.toNumber=function(){return+this},y.toPower=y.pow=function(e){var t,n,r,s,i,c,d=this,h=d.constructor,m=+(e=new h(e));if(!e.s)return new h(a);if(!(d=new h(d)).s){if(e.s<1)throw Error(l+"Infinity");return d}if(d.eq(a))return d;if(r=h.precision,e.eq(a))return A(d,r);if(c=(t=e.e)>=(n=e.d.length-1),i=d.s,c){if((n=m<0?-m:m)<=f){for(s=new h(a),t=Math.ceil(r/7+4),o=!1;n%2&&T((s=s.times(d)).d,t),0!==(n=u(n/2));)T((d=d.times(d)).d,t);return o=!0,e.s<0?new h(a).div(s):A(s,r)}}else if(i<0)throw Error(l+"NaN");return i=i<0&&1&e.d[Math.max(t,n)]?-1:1,d.s=1,o=!1,s=e.times(k(d,r+12)),o=!0,(s=j(s)).s=i,s},y.toPrecision=function(e,t){var n,r,a=this,i=a.constructor;return void 0===e?r=D(a,(n=N(a))<=i.toExpNeg||n>=i.toExpPos):(v(e,1,s),void 0===t?t=i.rounding:v(t,0,8),r=D(a=A(new i(a),e,t),e<=(n=N(a))||n<=i.toExpNeg,e)),r},y.toSignificantDigits=y.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(v(e,1,s),void 0===t?t=n.rounding:v(t,0,8)),A(new n(this),e,t)},y.toString=y.valueOf=y.val=y.toJSON=function(){var e=this,t=N(e),n=e.constructor;return D(e,t<=n.toExpNeg||t>=n.toExpPos)};var w=function(){function e(e,t){var n,r=0,a=e.length;for(e=e.slice();a--;)n=e[a]*t+r,e[a]=n%p|0,r=n/p|0;return r&&e.unshift(r),e}function t(e,t,n,r){var a,s;if(n!=r)s=n>r?1:-1;else for(a=s=0;a<n;a++)if(e[a]!=t[a]){s=e[a]>t[a]?1:-1;break}return s}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*p+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,a,s,i){var o,c,d,u,h,m,f,g,y,x,v,b,w,j,_,S,k,E,C=r.constructor,D=r.s==a.s?1:-1,T=r.d,O=a.d;if(!r.s)return new C(r);if(!a.s)throw Error(l+"Division by zero");for(c=r.e-a.e,k=O.length,_=T.length,g=(f=new C(D)).d=[],d=0;O[d]==(T[d]||0);)++d;if(O[d]>(T[d]||0)&&--c,(b=null==s?s=C.precision:i?s+(N(r)-N(a))+1:s)<0)return new C(0);if(b=b/7+2|0,d=0,1==k)for(u=0,O=O[0],b++;(d<_||u)&&b--;d++)w=u*p+(T[d]||0),g[d]=w/O|0,u=w%O|0;else{for((u=p/(O[0]+1)|0)>1&&(O=e(O,u),T=e(T,u),k=O.length,_=T.length),j=k,x=(y=T.slice(0,k)).length;x<k;)y[x++]=0;(E=O.slice()).unshift(0),S=O[0],O[1]>=p/2&&++S;do{u=0,(o=t(O,y,k,x))<0?(v=y[0],k!=x&&(v=v*p+(y[1]||0)),(u=v/S|0)>1?(u>=p&&(u=p-1),1==(o=t(h=e(O,u),y,m=h.length,x=y.length))&&(u--,n(h,k<m?E:O,m))):(0==u&&(o=u=1),h=O.slice()),(m=h.length)<x&&h.unshift(0),n(y,h,x),-1==o&&(o=t(O,y,k,x=y.length))<1&&(u++,n(y,k<x?E:O,x)),x=y.length):0===o&&(u++,y=[0]),g[d++]=u,o&&y[0]?y[x++]=T[j]||0:(y=[T[j]],x=1)}while((j++<_||void 0!==y[0])&&b--)}return g[0]||g.shift(),f.e=c,A(f,i?s+N(f)+1:s)}}();function j(e,t){var n,r,s,i,l,c=0,u=0,m=e.constructor,p=m.precision;if(N(e)>16)throw Error(d+N(e));if(!e.s)return new m(a);for(null==t?(o=!1,l=p):l=t,i=new m(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(l+=Math.log(h(2,u))/Math.LN10*2+5|0,n=r=s=new m(a),m.precision=l;;){if(r=A(r.times(e),l),n=n.times(++c),b((i=s.plus(w(r,n,l))).d).slice(0,l)===b(s.d).slice(0,l)){for(;u--;)s=A(s.times(s),l);return m.precision=p,null==t?(o=!0,A(s,p)):s}s=i}}function N(e){for(var t=7*e.e,n=e.d[0];n>=10;n/=10)t++;return t}function _(e,t,n){if(t>e.LN10.sd())throw o=!0,n&&(e.precision=n),Error(l+"LN10 precision limit exceeded");return A(new e(e.LN10),t)}function S(e){for(var t="";e--;)t+="0";return t}function k(e,t){var n,r,s,i,c,d,u,h,m,p=1,f=e,g=f.d,y=f.constructor,x=y.precision;if(f.s<1)throw Error(l+(f.s?"NaN":"-Infinity"));if(f.eq(a))return new y(0);if(null==t?(o=!1,h=x):h=t,f.eq(10))return null==t&&(o=!0),_(y,h);if(h+=10,y.precision=h,r=(n=b(g)).charAt(0),i=N(f),!(Math.abs(i)<15e14))return u=_(y,h+2,x).times(i+""),f=k(new y(r+"."+n.slice(1)),h-10).plus(u),y.precision=x,null==t?(o=!0,A(f,x)):f;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=b((f=f.times(e)).d)).charAt(0),p++;for(i=N(f),r>1?(f=new y("0."+n),i++):f=new y(r+"."+n.slice(1)),d=c=f=w(f.minus(a),f.plus(a),h),m=A(f.times(f),h),s=3;;){if(c=A(c.times(m),h),b((u=d.plus(w(c,new y(s),h))).d).slice(0,h)===b(d.d).slice(0,h))return d=d.times(2),0!==i&&(d=d.plus(_(y,h+2,x).times(i+""))),d=w(d,new y(p),h),y.precision=x,null==t?(o=!0,A(d,x)):d;d=u,s+=2}}function E(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(a=t.length;48===t.charCodeAt(a-1);)--a;if(t=t.slice(r,a)){if(a-=r,n=n-r-1,e.e=u(n/7),e.d=[],r=(n+1)%7,n<0&&(r+=7),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=7;r<a;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),o&&(e.e>g||e.e<-g))throw Error(d+n)}else e.s=0,e.e=0,e.d=[0];return e}function A(e,t,n){var r,a,s,i,l,c,m,f,y=e.d;for(i=1,s=y[0];s>=10;s/=10)i++;if((r=t-i)<0)r+=7,a=t,m=y[f=0];else{if((f=Math.ceil((r+1)/7))>=(s=y.length))return e;for(m=s=y[f],i=1;s>=10;s/=10)i++;a=(r%=7)-7+i}if(void 0!==n&&(l=m/(s=h(10,i-a-1))%10|0,c=t<0||void 0!==y[f+1]||m%s,c=n<4?(l||c)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||c||6==n&&(r>0?a>0?m/h(10,i-a):0:y[f-1])%10&1||n==(e.s<0?8:7))),t<1||!y[0])return c?(s=N(e),y.length=1,t=t-s-1,y[0]=h(10,(7-t%7)%7),e.e=u(-t/7)||0):(y.length=1,y[0]=e.e=e.s=0),e;if(0==r?(y.length=f,s=1,f--):(y.length=f+1,s=h(10,7-r),y[f]=a>0?(m/h(10,i-a)%h(10,a)|0)*s:0),c)for(;;){if(0==f){(y[0]+=s)==p&&(y[0]=1,++e.e);break}if(y[f]+=s,y[f]!=p)break;y[f--]=0,s=1}for(r=y.length;0===y[--r];)y.pop();if(o&&(e.e>g||e.e<-g))throw Error(d+N(e));return e}function C(e,t){var n,r,a,s,i,l,c,d,u,h,m=e.constructor,f=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),o?A(t,f):t;if(c=e.d,h=t.d,r=t.e,d=e.e,c=c.slice(),i=d-r){for((u=i<0)?(n=c,i=-i,l=h.length):(n=h,r=d,l=c.length),i>(a=Math.max(Math.ceil(f/7),l)+2)&&(i=a,n.length=1),n.reverse(),a=i;a--;)n.push(0);n.reverse()}else{for((u=(a=c.length)<(l=h.length))&&(l=a),a=0;a<l;a++)if(c[a]!=h[a]){u=c[a]<h[a];break}i=0}for(u&&(n=c,c=h,h=n,t.s=-t.s),l=c.length,a=h.length-l;a>0;--a)c[l++]=0;for(a=h.length;a>i;){if(c[--a]<h[a]){for(s=a;s&&0===c[--s];)c[s]=p-1;--c[s],c[a]+=p}c[a]-=h[a]}for(;0===c[--l];)c.pop();for(;0===c[0];c.shift())--r;return c[0]?(t.d=c,t.e=r,o?A(t,f):t):new m(0)}function D(e,t,n){var r,a=N(e),s=b(e.d),i=s.length;return t?(n&&(r=n-i)>0?s=s.charAt(0)+"."+s.slice(1)+S(r):i>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+S(-a-1)+s,n&&(r=n-i)>0&&(s+=S(r))):a>=i?(s+=S(a+1-i),n&&(r=n-a-1)>0&&(s=s+"."+S(r))):((r=a+1)<i&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-i)>0&&(a+1===i&&(s+="."),s+=S(r))),e.s<0?"-"+s:s}function T(e,t){if(e.length>t)return e.length=t,!0}function O(e){if(!e||"object"!==typeof e)throw Error(l+"Object expected");var t,n,r,a=["precision",1,s,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if(void 0!==(r=e[n=a[t]])){if(!(u(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(c+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(c+n+": "+r);this[n]=new this(r)}return this}i=function e(t){var n,r,a;function s(e){var t=this;if(!(t instanceof s))return new s(e);if(t.constructor=s,e instanceof s)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"===typeof e){if(0*e!==0)throw Error(c+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):E(t,e.toString())}if("string"!==typeof e)throw Error(c+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!m.test(e))throw Error(c+e);E(t,e)}if(s.prototype=y,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=e,s.config=s.set=O,void 0===t&&(t={}),t)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<a.length;)t.hasOwnProperty(r=a[n++])||(t[r]=this[r]);return s.config(t),s}(i),i.default=i.Decimal=i,a=new i(1),void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}()},8268:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2132);t.isMatch=function(e,t){return r.isMatchWith(e,t,()=>{})}},8346:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toArray=function(e){return Array.isArray(e)?e:Array.from(e)}},8365:(e,t,n)=>{"use strict";var r=n(5043);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=r.useSyncExternalStore,i=r.useRef,o=r.useEffect,l=r.useMemo,c=r.useDebugValue},8396:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5508);t.cloneDeep=function(e){return r.cloneDeepWith(e)}},8420:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isLength=function(e){return Number.isSafeInteger(e)&&e>=0}},8443:(e,t,n)=>{"use strict";e.exports=n(9717)},8845:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8268),a=n(3272),s=n(8396),i=n(9323),o=n(5303);t.matchesProperty=function(e,t){switch(typeof e){case"object":var n;Object.is(null===(n=e)||void 0===n?void 0:n.valueOf(),-0)&&(e="-0");break;case"number":e=a.toKey(e)}return t=s.cloneDeep(t),function(n){const a=i.get(n,e);return void 0===a?o.has(n,e):void 0===t?void 0===a:r.isMatch(a,t)}}},8853:(e,t,n)=>{"use strict";e.exports=n(5896)},9045:(e,t,n)=>{var r=n(3738).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9232:(e,t,n)=>{"use strict";n.d(t,{MF:()=>ue,j6:()=>ie,xZ:()=>oe,om:()=>se,Sx:()=>me,Wp:()=>he,KO:()=>pe});var r=n(9379),a=n(9606),s=n(2965),i=n(1776);let o,l;const c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,m=new WeakMap;let p={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return d.get(e);if("objectStoreNames"===t)return e.objectStoreNames||u.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return y(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(l||(l=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(x(this),n),y(c.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return y(e.apply(x(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];const s=e.call(x(this),t,...r);return u.set(s,t.sort?t.sort():[t]),y(s)}}function g(e){return"function"===typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(d.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",s),e.removeEventListener("abort",s)},a=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",s),e.addEventListener("abort",s)});d.set(e,t)}(e),t=e,(o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,p):e);var t}function y(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",s)},a=()=>{t(y(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&c.set(t,e)}).catch(()=>{}),m.set(t,e),t}(e);if(h.has(e))return h.get(e);const t=g(e);return t!==e&&(h.set(e,t),m.set(t,e)),t}const x=e=>m.get(e);const v=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],w=new Map;function j(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=b.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!v.includes(n))return;const s=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let s=t.store;for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return r&&(s=s.index(o.shift())),(await Promise.all([s[n](...o),a&&t.done]))[0]};return w.set(t,s),s}p=(e=>(0,r.A)((0,r.A)({},e),{},{get:(t,n,r)=>j(t,n)||e.get(t,n,r),has:(t,n)=>!!j(t,n)||e.has(t,n)}))(p);class N{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const _="@firebase/app",S="0.14.6",k=new s.Vy("@firebase/app"),E="@firebase/app-compat",A="@firebase/analytics-compat",C="@firebase/analytics",D="@firebase/app-check-compat",T="@firebase/app-check",O="@firebase/auth",P="@firebase/auth-compat",I="@firebase/database",R="@firebase/data-connect",M="@firebase/database-compat",L="@firebase/functions",F="@firebase/functions-compat",U="@firebase/installations",B="@firebase/installations-compat",z="@firebase/messaging",q="@firebase/messaging-compat",V="@firebase/performance",H="@firebase/performance-compat",W="@firebase/remote-config",G="@firebase/remote-config-compat",K="@firebase/storage",Q="@firebase/storage-compat",Y="@firebase/firestore",$="@firebase/ai",J="@firebase/firestore-compat",X="firebase",Z="[DEFAULT]",ee={[_]:"fire-core",[E]:"fire-core-compat",[C]:"fire-analytics",[A]:"fire-analytics-compat",[T]:"fire-app-check",[D]:"fire-app-check-compat",[O]:"fire-auth",[P]:"fire-auth-compat",[I]:"fire-rtdb",[R]:"fire-data-connect",[M]:"fire-rtdb-compat",[L]:"fire-fn",[F]:"fire-fn-compat",[U]:"fire-iid",[B]:"fire-iid-compat",[z]:"fire-fcm",[q]:"fire-fcm-compat",[V]:"fire-perf",[H]:"fire-perf-compat",[W]:"fire-rc",[G]:"fire-rc-compat",[K]:"fire-gcs",[Q]:"fire-gcs-compat",[Y]:"fire-fst",[J]:"fire-fst-compat",[$]:"fire-vertex","fire-js":"fire-js",[X]:"fire-js-all"},te=new Map,ne=new Map,re=new Map;function ae(e,t){try{e.container.addComponent(t)}catch(n){k.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function se(e){const t=e.name;if(re.has(t))return k.debug("There were multiple attempts to register component ".concat(t,".")),!1;re.set(t,e);for(const n of te.values())ae(n,e);for(const n of ne.values())ae(n,e);return!0}function ie(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function oe(e){return null!==e&&void 0!==e&&void 0!==e.settings}const le={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ce=new i.FA("app","Firebase",le);class de{constructor(e,t,n){this._isDeleted=!1,this._options=(0,r.A)({},e),this._config=(0,r.A)({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new a.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ce.create("app-deleted",{appName:this._name})}}const ue="12.6.0";function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const s=(0,r.A)({name:Z,automaticDataCollectionEnabled:!0},t),o=s.name;if("string"!==typeof o||!o)throw ce.create("bad-app-name",{appName:String(o)});if(n||(n=(0,i.T9)()),!n)throw ce.create("no-options");const l=te.get(o);if(l){if((0,i.bD)(n,l.options)&&(0,i.bD)(s,l.config))return l;throw ce.create("duplicate-app",{appName:o})}const c=new a.h1(o);for(const r of re.values())c.addComponent(r);const d=new de(n,s,c);return te.set(o,d),d}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z;const t=te.get(e);if(!t&&e===Z&&(0,i.T9)())return he();if(!t)throw ce.create("no-app",{appName:e});return t}function pe(e,t,n){var r;let s=null!==(r=ee[e])&&void 0!==r?r:e;n&&(s+="-".concat(n));const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=['Unable to register library "'.concat(s,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),i&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void k.warn(e.join(" "))}se(new a.uA("".concat(s,"-version"),()=>({library:s,version:t}),"VERSION"))}const fe="firebase-heartbeat-store";let ge=null;function ye(){return ge||(ge=function(e,t){let{blocked:n,upgrade:r,blocking:a,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),o=y(i);return r&&i.addEventListener("upgradeneeded",e=>{r(y(i.result),e.oldVersion,e.newVersion,y(i.transaction),e)}),n&&i.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(fe)}catch(n){console.warn(n)}}}).catch(e=>{throw ce.create("idb-open",{originalErrorMessage:e.message})})),ge}async function xe(e,t){try{const n=(await ye()).transaction(fe,"readwrite"),r=n.objectStore(fe);await r.put(t,ve(e)),await n.done}catch(n){if(n instanceof i.g)k.warn(n.message);else{const e=ce.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});k.warn(e.message)}}}function ve(e){return"".concat(e.name,"!").concat(e.options.appId)}class be{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new je(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=we();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){k.warn(n)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=we(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const a of e){const e=n.find(e=>e.agent===a.agent);if(e){if(e.dates.push(a.date),Ne(n)>t){e.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Ne(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),a=(0,i.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return k.warn(t),""}}}function we(){return(new Date).toISOString().substring(0,10)}class je{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,i.zW)()&&(0,i.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ye()).transaction(fe),n=await t.objectStore(fe).get(ve(e));return await t.done,n}catch(t){if(t instanceof i.g)k.warn(t.message);else{const e=ce.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});k.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return xe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return xe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ne(e){return(0,i.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var _e;_e="",se(new a.uA("platform-logger",e=>new N(e),"PRIVATE")),se(new a.uA("heartbeat",e=>new be(e),"PRIVATE")),pe(_,S,_e),pe(_,S,"esm2020"),pe("fire-js","")},9323:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(7260),a=n(2489),s=n(3272),i=n(1444);t.get=function e(t,n,o){if(null==t)return o;switch(typeof n){case"string":{if(r.isUnsafeProperty(n))return o;const s=t[n];return void 0===s?a.isDeepKey(n)?e(t,i.toPath(n),o):o:s}case"number":case"symbol":{"number"===typeof n&&(n=s.toKey(n));const e=t[n];return void 0===e?o:e}default:{var l;if(Array.isArray(n))return function(e,t,n){if(0===t.length)return n;let a=e;for(let s=0;s<t.length;s++){if(null==a)return n;if(r.isUnsafeProperty(t[s]))return n;a=a[t[s]]}if(void 0===a)return n;return a}(t,n,o);if(n=Object.is(null===(l=n)||void 0===l?void 0:l.valueOf(),-0)?"-0":String(n),r.isUnsafeProperty(n))return o;const e=t[n];return void 0===e?o:e}}}},9379:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(4705);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){(0,r.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}},9390:(e,t,n)=>{"use strict";n.d(t,{CACHE_TTL:()=>a,queryCache:()=>r});const r=new class{constructor(){this.cache=new Map,this.inFlight=new Map,this.defaultTTL=3e5}async get(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.defaultTTL;const r=this.cache.get(e);if(r&&Date.now()-r.timestamp<n)return console.log("\ud83d\udce6 Cache HIT: ".concat(e)),r.data;const a=this.inFlight.get(e);if(a)return console.log("\u23f3 Cache INFLIGHT: ".concat(e," - Reusing ongoing fetch")),a;console.log("\ud83d\udd04 Cache MISS: ".concat(e," - Fetching from Firestore..."));const s=(async()=>{try{const n=await t();return this.cache.set(e,{data:n,timestamp:Date.now()}),n}finally{this.inFlight.delete(e)}})();return this.inFlight.set(e,s),s}invalidate(e){console.log("\ud83d\uddd1\ufe0f Cache INVALIDATE: ".concat(e)),this.cache.delete(e)}invalidatePattern(e){Array.from(this.cache.keys()).filter(t=>t.includes(e)).forEach(e=>{console.log("\ud83d\uddd1\ufe0f Cache INVALIDATE: ".concat(e)),this.cache.delete(e)})}clear(){console.log("\ud83d\uddd1\ufe0f Cache CLEAR ALL"),this.cache.clear()}getStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}},a={SHORT:12e4,MEDIUM:3e5,LONG:9e5,VERY_LONG:36e5}},9397:(e,t,n)=>{e.exports=n(2682).isPlainObject},9461:(e,t,n)=>{"use strict";e.exports=n(2330)},9599:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.identity=function(e){return e}},9606:(e,t,n)=>{"use strict";n.d(t,{h1:()=>o,uA:()=>a});var r=n(1776);class a{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const s="[DEFAULT]";class i{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(r)return null;throw a}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(a)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);const s=this.instances.get(r);return s&&e(s,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===s?void 0:a),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(i){}var a;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new i(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},9645:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6392),a=n(8346),s=n(1203);t.last=function(e){if(s.isArrayLike(e))return r.last(a.toArray(e))}},9709:(e,t)=>{"use strict";function n(e){return"symbol"===typeof e?1:null===e?2:void 0===e?3:e!==e?4:0}Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});t.compareValues=(e,t,r)=>{if(e!==t){const a=n(e),s=n(t);if(a===s&&0===a){if(e<t)return"desc"===r?1:-1;if(e>t)return"desc"===r?-1:1}return"desc"===r?s-a:a-s}return 0}},9717:(e,t,n)=>{"use strict";var r=n(5043),a=n(9461);var s="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=a.useSyncExternalStore,o=r.useRef,l=r.useEffect,c=r.useMemo,d=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var u=o(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;u=c(function(){function e(e){if(!l){if(l=!0,i=e,e=r(e),void 0!==a&&h.hasValue){var t=h.value;if(a(t,e))return o=t}return o=e}if(t=o,s(i,e))return t;var n=r(e);return void 0!==a&&a(t,n)?(i=e,t):(i=e,o=n)}var i,o,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,a]);var m=i(e,u[0],u[1]);return l(function(){h.hasValue=!0,h.value=m},[m]),d(m),m}},9859:(e,t,n)=>{e.exports=n(7231).range},9921:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObjectLike=function(e){return"object"===typeof e&&null!==e}},9972:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.eq=function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&r;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>i[e]=()=>r[e]);return i.default=()=>r,n.d(s,i),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+"."+{423:"68773219",453:"c313139e"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="campus-learning-dashboard:";n.l=(r,a,s,i)=>{if(e[r])e[r].push(a);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=r),e[r]=[a];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(m);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(n)),t)return t(n)},m=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var s=new Promise((n,r)=>a=e[t]=[n,r]);r.push(a[2]=s);var i=n.p+n.u(t),o=new Error;n.l(i,r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var s=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,a[1](o)}},"chunk-"+t,t)}};var t=(t,r)=>{var a,s,[i,o,l]=r,c=0;if(i.some(t=>0!==e[t])){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(l)l(n)}for(t&&t(r);c<i.length;c++)s=i[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkcampus_learning_dashboard=self.webpackChunkcampus_learning_dashboard||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{hasBrowserEnv:()=>vo,hasStandardBrowserEnv:()=>wo,hasStandardBrowserWebWorkerEnv:()=>jo,navigator:()=>bo,origin:()=>No});var t={};n.r(t),n.d(t,{scaleBand:()=>Cp,scaleDiverging:()=>_v,scaleDivergingLog:()=>Sv,scaleDivergingPow:()=>Ev,scaleDivergingSqrt:()=>Av,scaleDivergingSymlog:()=>kv,scaleIdentity:()=>xg,scaleImplicit:()=>Ep,scaleLinear:()=>yg,scaleLog:()=>Eg,scaleOrdinal:()=>Ap,scalePoint:()=>Tp,scalePow:()=>Mg,scaleQuantile:()=>Qg,scaleQuantize:()=>Yg,scaleRadial:()=>Ug,scaleSequential:()=>yv,scaleSequentialLog:()=>xv,scaleSequentialPow:()=>bv,scaleSequentialQuantile:()=>jv,scaleSequentialSqrt:()=>wv,scaleSequentialSymlog:()=>vv,scaleSqrt:()=>Lg,scaleSymlog:()=>Tg,scaleThreshold:()=>$g,scaleTime:()=>mv,scaleUtc:()=>pv,tickFormat:()=>fg});var r=n(5043),a=n.t(r,2),s=n(4391),i=n(3986),o=n(9379);const l=["sri"],c=["page"],d=["page","matches"],u=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],h=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],m=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var p="popstate";function f(){return j(function(e,t){let{pathname:n,search:r,hash:a}=e.location;return v("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:b(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function g(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function y(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function v(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return(0,o.A)((0,o.A)({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?w(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function b(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function w(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function j(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:a=document.defaultView,v5Compat:s=!1}=r,i=a.history,l="POP",c=null,d=u();function u(){return(i.state||{idx:null}).idx}function h(){l="POP";let e=u(),t=null==e?null:e-d;d=e,c&&c({action:l,location:f.location,delta:t})}function m(e){return N(e)}null==d&&(d=0,i.replaceState((0,o.A)((0,o.A)({},i.state),{},{idx:d}),""));let f={get action(){return l},get location(){return e(a,i)},listen(e){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(p,h),c=e,()=>{a.removeEventListener(p,h),c=null}},createHref:e=>t(a,e),createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let r=v(f.location,e,t);n&&n(r,e),d=u()+1;let o=x(r,d),h=f.createHref(r);try{i.pushState(o,"",h)}catch(m){if(m instanceof DOMException&&"DataCloneError"===m.name)throw m;a.location.assign(h)}s&&c&&c({action:l,location:f.location,delta:1})},replace:function(e,t){l="REPLACE";let r=v(f.location,e,t);n&&n(r,e),d=u();let a=x(r,d),o=f.createHref(r);i.replaceState(a,"",o),s&&c&&c({action:l,location:f.location,delta:0})},go:e=>i.go(e)};return f}function N(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),g(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:b(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function _(e,t){return S(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function S(e,t,n,r){let a=B(("string"===typeof t?w(t):t).pathname||"/",n);if(null==a)return null;let s=k(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let i=null;for(let o=0;null==i&&o<s.length;++o){let e=U(a);i=M(s[o],e,r)}return i}function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&i)return;g(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let c=W([r,l.relativePath]),d=n.concat(l);e.children&&e.children.length>0&&(g(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),k(e.children,t,d,c,i)),(null!=e.path||e.index)&&t.push({path:c,score:R(c,e.index),routesMeta:d})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of E(e.path))s(e,t,!0,r);else s(e,t)}),t}function E(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return a?[s,""]:[s];let i=E(r.join("/")),o=[];return o.push(...i.map(e=>""===e?s:[s,e].join("/"))),a&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var A=/^:[\w-]+$/,C=3,D=2,T=1,O=10,P=-2,I=e=>"*"===e;function R(e,t){let n=e.split("/"),r=n.length;return n.some(I)&&(r+=P),t&&(r+=D),n.filter(e=>!I(e)).reduce((e,t)=>e+(A.test(t)?C:""===t?T:O),r)}function M(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,a={},s="/",i=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===s?t:t.slice(s.length)||"/",d=L({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=L({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:W([s,d.pathname]),pathnameBase:G(W([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=W([s,d.pathnameBase]))}return i}function L(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=F(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1),l=r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=o[n]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:s,pathnameBase:i,pattern:e}}function F(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];y("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function U(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return y(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function B(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function z(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function q(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function V(e){let t=q(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function H(e,t,n){let r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=w(e):(r=(0,o.A)({},e),g(!r.pathname||!r.pathname.includes("?"),z("?","pathname","search",r)),g(!r.pathname||!r.pathname.includes("#"),z("#","pathname","hash",r)),g(!r.search||!r.search.includes("#"),z("#","search","hash",r)));let s,i=""===e||""===r.pathname,l=i?"/":r.pathname;if(null==l)s=n;else{let e=t.length-1;if(!a&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:a=""}="string"===typeof e?w(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:K(r),hash:Q(a)}}(r,s),d=l&&"/"!==l&&l.endsWith("/"),u=(i||"."===l)&&n.endsWith("/");return c.pathname.endsWith("/")||!d&&!u||(c.pathname+="/"),c}var W=e=>e.join("/").replace(/\/\/+/g,"/"),G=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),K=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Y(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var $=["POST","PUT","PATCH","DELETE"],J=(new Set($),["GET",...$]);new Set(J),Symbol("ResetLoaderData");var X=r.createContext(null);X.displayName="DataRouter";var Z=r.createContext(null);Z.displayName="DataRouterState";var ee=r.createContext(!1);var te=r.createContext({isTransitioning:!1});te.displayName="ViewTransition";var ne=r.createContext(new Map);ne.displayName="Fetchers";var re=r.createContext(null);re.displayName="Await";var ae=r.createContext(null);ae.displayName="Navigation";var se=r.createContext(null);se.displayName="Location";var ie=r.createContext({outlet:null,matches:[],isDataRoute:!1});ie.displayName="Route";var oe=r.createContext(null);oe.displayName="RouteError";function le(){return null!=r.useContext(se)}function ce(){return g(le(),"useLocation() may be used only in the context of a <Router> component."),r.useContext(se).location}var de="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ue(e){r.useContext(ae).static||r.useLayoutEffect(e)}function he(){let{isDataRoute:e}=r.useContext(ie);return e?function(){let{router:e}=je("useNavigate"),t=_e("useNavigate"),n=r.useRef(!1);ue(()=>{n.current=!0});let a=r.useCallback(async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y(n.current,de),n.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,(0,o.A)({fromRouteId:t},a)))},[e,t]);return a}():function(){g(le(),"useNavigate() may be used only in the context of a <Router> component.");let e=r.useContext(X),{basename:t,navigator:n}=r.useContext(ae),{matches:a}=r.useContext(ie),{pathname:s}=ce(),i=JSON.stringify(V(a)),o=r.useRef(!1);ue(()=>{o.current=!0});let l=r.useCallback(function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(y(o.current,de),!o.current)return;if("number"===typeof r)return void n.go(r);let l=H(r,JSON.parse(i),s,"path"===a.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:W([t,l.pathname])),(a.replace?n.replace:n.push)(l,a.state,a)},[t,n,i,s,e]);return l}()}r.createContext(null);function me(){let{matches:e}=r.useContext(ie),t=e[e.length-1];return t?t.params:{}}function pe(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=r.useContext(ie),{pathname:a}=ce(),s=JSON.stringify(V(n));return r.useMemo(()=>H(e,JSON.parse(s),a,"path"===t),[e,s,a,t])}function fe(e,t,n,a,s){g(le(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=r.useContext(ae),{matches:l}=r.useContext(ie),c=l[l.length-1],d=c?c.params:{},u=c?c.pathname:"/",h=c?c.pathnameBase:"/",m=c&&c.route;{let e=m&&m.path||"";Ee(u,!m||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let p,f=ce();if(t){var x;let e="string"===typeof t?w(t):t;g("/"===h||(null===(x=e.pathname)||void 0===x?void 0:x.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),p=e}else p=f;let v=p.pathname||"/",b=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");b="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let j=_(e,{pathname:b});y(m||null!=j,'No routes matched location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" ')),y(null==j||void 0!==j[j.length-1].route.element||void 0!==j[j.length-1].route.Component||void 0!==j[j.length-1].route.lazy,'Matched leaf route at location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let N=be(j&&j.map(e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:W([h,i.encodeLocation?i.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:W([h,i.encodeLocation?i.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),l,n,a,s);return t&&N?r.createElement(se.Provider,{value:{location:(0,o.A)({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:"POP"}},N):N}function ge(){let e=Se(),t=Y(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:a},i={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=r.createElement(r.Fragment,null,r.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),r.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",r.createElement("code",{style:i},"ErrorBoundary")," or"," ",r.createElement("code",{style:i},"errorElement")," prop on your route.")),r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:s},n):null,o)}var ye=r.createElement(ge,null),xe=class extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?r.createElement(ie.Provider,{value:this.props.routeContext},r.createElement(oe.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ve(e){let{routeContext:t,match:n,children:a}=e,s=r.useContext(X);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(ie.Provider,{value:t},a)}function be(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let s=e,i=null===n||void 0===n?void 0:n.errors;if(null!=i){let e=s.findIndex(e=>e.route.id&&void 0!==(null===i||void 0===i?void 0:i[e.route.id]));g(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(i).join(","))),s=s.slice(0,Math.min(s.length,e+1))}let o=!1,l=-1;if(n)for(let r=0;r<s.length;r++){let e=s[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=r),e.route.id){let{loaderData:t,errors:r}=n,a=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){o=!0,s=l>=0?s.slice(0,l+1):[s[0]];break}}}return s.reduceRight((e,c,d)=>{let u,h=!1,m=null,p=null;n&&(u=i&&c.route.id?i[c.route.id]:void 0,m=c.route.errorElement||ye,o&&(l<0&&0===d?(Ee("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):l===d&&(h=!0,p=c.route.hydrateFallbackElement||null)));let f=t.concat(s.slice(0,d+1)),g=()=>{let t;return t=u?m:h?p:c.route.Component?r.createElement(c.route.Component,null):c.route.element?c.route.element:e,r.createElement(ve,{match:c,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(c.route.ErrorBoundary||c.route.errorElement||0===d)?r.createElement(xe,{location:n.location,revalidation:n.revalidation,component:m,error:u,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0},unstable_onError:a}):g()},null)}function we(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function je(e){let t=r.useContext(X);return g(t,we(e)),t}function Ne(e){let t=r.useContext(Z);return g(t,we(e)),t}function _e(e){let t=function(e){let t=r.useContext(ie);return g(t,we(e)),t}(e),n=t.matches[t.matches.length-1];return g(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Se(){var e;let t=r.useContext(oe),n=Ne("useRouteError"),a=_e("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[a]}var ke={};function Ee(e,t,n){t||ke[e]||(ke[e]=!0,y(!1,n))}var Ae={};function Ce(e,t){e||Ae[t]||(Ae[t]=!0,console.warn(t))}r.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:a}=e;return fe(t,void 0,r,a,n)});function De(e){let{to:t,replace:n,state:a,relative:s}=e;g(le(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=r.useContext(ae);y(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=r.useContext(ie),{pathname:l}=ce(),c=he(),d=H(t,V(o),l,"path"===s),u=JSON.stringify(d);return r.useEffect(()=>{c(JSON.parse(u),{replace:n,state:a,relative:s})},[c,u,s,n,a]),null}function Te(e){g(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Oe(e){let{basename:t="/",children:n=null,location:a,navigationType:s="POP",navigator:i,static:o=!1}=e;g(!le(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=r.useMemo(()=>({basename:l,navigator:i,static:o,future:{}}),[l,i,o]);"string"===typeof a&&(a=w(a));let{pathname:d="/",search:u="",hash:h="",state:m=null,key:p="default"}=a,f=r.useMemo(()=>{let e=B(d,l);return null==e?null:{location:{pathname:e,search:u,hash:h,state:m,key:p},navigationType:s}},[l,d,u,h,m,p,s]);return y(null!=f,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(d).concat(u).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==f?null:r.createElement(ae.Provider,{value:c},r.createElement(se.Provider,{children:n,value:f}))}function Pe(e){let{children:t,location:n}=e;return fe(Ie(t),n)}r.Component;function Ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return r.Children.forEach(e,(e,a)=>{if(!r.isValidElement(e))return;let s=[...t,a];if(e.type===r.Fragment)return void n.push.apply(n,Ie(e.props.children,s));g(e.type===Te,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),g(!e.props.index||!e.props.children,"An index route cannot have child routes.");let i={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Ie(e.props.children,s)),n.push(i)}),n}var Re="get",Me="application/x-www-form-urlencoded";function Le(e){return null!=e&&"string"===typeof e.tagName}var Fe=null;var Ue=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Be(e){return null==e||Ue.has(e)?e:(y(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Me,'"')),null)}function ze(e,t){let n,r,a,s,i;if(function(e){return Le(e)&&"form"===e.tagName.toLowerCase()}(e)){let i=e.getAttribute("action");r=i?B(i,t):null,n=e.getAttribute("method")||Re,a=Be(e.getAttribute("enctype"))||Me,s=new FormData(e)}else if(function(e){return Le(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Le(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||i.getAttribute("action");if(r=o?B(o,t):null,n=e.getAttribute("formmethod")||i.getAttribute("method")||Re,a=Be(e.getAttribute("formenctype"))||Be(i.getAttribute("enctype"))||Me,s=new FormData(i,e),!function(){if(null===Fe)try{new FormData(document.createElement("form"),0),Fe=!1}catch(e){Fe=!0}return Fe}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,r)}}else{if(Le(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Re,r=null,a=Me,i=e}return s&&"text/plain"===a&&(i=s,s=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function qe(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Ve(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===B(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function He(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function We(e){return null!=e&&"string"===typeof e.page}function Ge(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ke(e,t,n,r,a,s){let i=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter((e,t)=>i(e,t)||o(e,t)):"data"===s?t.filter((t,s)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(i(t,s)||o(t,s))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function Qe(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1),[...new Set(r)];var r}function Ye(e,t){let n=new Set,r=new Set(t);return e.reduce((e,a)=>{if(t&&!We(a)&&"script"===a.as&&a.href&&r.has(a.href))return e;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(a));return n.has(s)||(n.add(s),e.push({key:s,link:a})),e},[])}function $e(e,t){return"lazy"===e.mode&&!0===t}function Je(){let e=r.useContext(X);return qe(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Xe(){let e=r.useContext(Z);return qe(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Ze=r.createContext(void 0);function et(){let e=r.useContext(Ze);return qe(e,"You must render this element inside a <HydratedRouter> element"),e}function tt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function nt(e,t,n){if(n&&!it)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}Ze.displayName="FrameworkContext";function rt(e){let{page:t}=e,n=(0,i.A)(e,c),{router:a}=Je(),s=r.useMemo(()=>_(a.routes,t,a.basename),[a.routes,t,a.basename]);return s?r.createElement(st,(0,o.A)({page:t,matches:s},n)):null}function at(e){let{manifest:t,routeModules:n}=et(),[a,s]=r.useState([]);return r.useEffect(()=>{let r=!1;return async function(e,t,n){return Ye((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await He(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(Ge).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?(0,o.A)((0,o.A)({},e),{},{rel:"prefetch",as:"style"}):(0,o.A)((0,o.A)({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{r||s(e)}),()=>{r=!0}},[e,t,n]),a}function st(e){let{page:t,matches:n}=e,a=(0,i.A)(e,d),s=ce(),{manifest:l,routeModules:c}=et(),{basename:u}=Je(),{loaderData:h,matches:m}=Xe(),p=r.useMemo(()=>Ke(t,n,m,l,s,"data"),[t,n,m,l,s]),f=r.useMemo(()=>Ke(t,n,m,l,s,"assets"),[t,n,m,l,s]),g=r.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let e=new Set,r=!1;if(n.forEach(t=>{var n;let a=l.routes[t.route.id];a&&a.hasLoader&&(!p.some(e=>e.route.id===t.route.id)&&t.route.id in h&&null!==(n=c[t.route.id])&&void 0!==n&&n.shouldRevalidate||a.hasClientLoader?r=!0:e.add(t.route.id))}),0===e.size)return[];let a=Ve(t,u,"data");return r&&e.size>0&&a.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[a.pathname+a.search]},[u,h,s,l,p,n,t,c]),y=r.useMemo(()=>Qe(f,l),[f,l]),x=at(f);return r.createElement(r.Fragment,null,g.map(e=>r.createElement("link",(0,o.A)({key:e,rel:"prefetch",as:"fetch",href:e},a))),y.map(e=>r.createElement("link",(0,o.A)({key:e,rel:"modulepreload",href:e},a))),x.map(e=>{let{key:t,link:n}=e;return r.createElement("link",(0,o.A)({key:t,nonce:a.nonce},n))}))}var it=!1;function ot(e){let{manifest:t,serverHandoffString:n,isSpaMode:a,renderMeta:s,routeDiscovery:c,ssr:d}=et(),{router:u,static:h,staticContext:m}=Je(),{matches:p}=Xe(),f=r.useContext(ee),g=$e(c,d);s&&(s.didRenderScripts=!0);let y=nt(p,null,a);r.useEffect(()=>{0},[]);let x=r.useMemo(()=>{var a;if(f)return null;let s=m?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",c=h?"".concat(null!==t.hmr&&void 0!==a&&a.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(y.map((e,n)=>{let r="route".concat(n),a=t.routes[e.route.id];qe(a,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:i,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=a,d=[...s?[{module:s,varName:"".concat(r,"_clientAction")}]:[],...i?[{module:i,varName:"".concat(r,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===d.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[d.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(d.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=(0,i.A)(e,l),a=new Set(t.state.matches.map(e=>e.route.id)),s=t.state.location.pathname.split("/").filter(Boolean),c=["/"];for(s.pop();s.length>0;)c.push("/".concat(s.join("/"))),s.pop();c.forEach(e=>{let n=_(t.routes,e,t.basename);n&&n.forEach(e=>a.add(e.route.id))});let d=[...a].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return(0,o.A)((0,o.A)({},r),{},{routes:d,sri:!!n||void 0})}(t,u),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(y.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return r.createElement(r.Fragment,null,r.createElement("script",(0,o.A)((0,o.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:s},type:void 0})),r.createElement("script",(0,o.A)((0,o.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:c},type:"module",async:!0})))},[]),v=it||f?[]:function(e){return[...new Set(e)]}(t.entry.imports.concat(Qe(y,t,{includeHydrateFallback:!0}))),b="object"===typeof t.sri?t.sri:{};return Ce(!f,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),it||f?null:r.createElement(r.Fragment,null,"object"===typeof t.sri?r.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:b})}}):null,g?null:r.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:b[t.url],suppressHydrationWarning:!0}),r.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:b[t.entry.module],suppressHydrationWarning:!0}),v.map(t=>r.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:b[t],suppressHydrationWarning:!0})),x)}function lt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}r.Component;function ct(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let a,s=r.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Y(t))return r.createElement(dt,{title:"Unhandled Thrown Response!"},r.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),s);if(t instanceof Error)0;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);new Error(e)}return r.createElement(dt,{title:"Application Error!",isOutsideRemixApp:n},r.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),r.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},a.stack),s)}function dt(e){var t;let{title:n,renderScripts:a,isOutsideRemixApp:s,children:i}=e,{routeModules:o}=et();return null!==o.root&&void 0!==t&&t.Layout&&!s?i:r.createElement("html",{lang:"en"},r.createElement("head",null,r.createElement("meta",{charSet:"utf-8"}),r.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),r.createElement("title",null,n)),r.createElement("body",null,r.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},i,a?r.createElement(ot,null):null)))}var ut="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ut&&(window.__reactRouterVersion="7.9.3")}catch(BM){}function ht(e){let{basename:t,children:n,window:a}=e,s=r.useRef();null==s.current&&(s.current=f({window:a,v5Compat:!0}));let i=s.current,[o,l]=r.useState({action:i.action,location:i.location}),c=r.useCallback(e=>{r.startTransition(()=>l(e))},[l]);return r.useLayoutEffect(()=>i.listen(c),[i,c]),r.createElement(Oe,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:i})}var mt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pt=r.forwardRef(function(e,t){let n,{onClick:a,discover:s="render",prefetch:l="none",relative:c,reloadDocument:d,replace:h,state:m,target:p,to:f,preventScrollReset:x,viewTransition:v}=e,w=(0,i.A)(e,u),{basename:j}=r.useContext(ae),N="string"===typeof f&&mt.test(f),_=!1;if("string"===typeof f&&N&&(n=f,ut))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),n=B(t.pathname,j);t.origin===e.origin&&null!=n?f=n+t.search+t.hash:_=!0}catch(BM){y(!1,'<Link to="'.concat(f,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let S=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g(le(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:a}=r.useContext(ae),{hash:s,pathname:i,search:o}=pe(e,{relative:t}),l=i;return"/"!==n&&(l="/"===i?n:W([n,i])),a.createHref({pathname:l,search:o,hash:s})}(f,{relative:c}),[k,E,A]=function(e,t){let n=r.useContext(Ze),[a,s]=r.useState(!1),[i,o]=r.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:h}=t,m=r.useRef(null);r.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=e=>{e.forEach(e=>{o(e.isIntersecting)})},t=new IntersectionObserver(e,{threshold:.5});return m.current&&t.observe(m.current),()=>{t.disconnect()}}},[e]),r.useEffect(()=>{if(a){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[a]);let p=()=>{s(!0)},f=()=>{s(!1),o(!1)};return n?"intent"!==e?[i,m,{}]:[i,m,{onFocus:tt(l,p),onBlur:tt(c,f),onMouseEnter:tt(d,p),onMouseLeave:tt(u,f),onTouchStart:tt(h,p)}]:[!1,m,{}]}(l,w),C=function(e){let{target:t,replace:n,state:a,preventScrollReset:s,relative:i,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=he(),c=ce(),d=pe(e,{relative:i});return r.useCallback(r=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(r,t)){r.preventDefault();let t=void 0!==n?n:b(c)===b(d);l(e,{replace:t,state:a,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,d,n,a,t,e,s,i,o])}(f,{replace:h,state:m,target:p,preventScrollReset:x,relative:c,viewTransition:v});let D=r.createElement("a",(0,o.A)((0,o.A)((0,o.A)({},w),A),{},{href:n||S,onClick:_||d?a:function(e){a&&a(e),e.defaultPrevented||C(e)},ref:lt(t,E),target:p,"data-discover":N||"render"!==s?void 0:"true"}));return k&&!N?r.createElement(r.Fragment,null,D,r.createElement(rt,{page:S})):D});pt.displayName="Link";var ft=r.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:a=!1,className:s="",end:l=!1,style:c,to:d,viewTransition:u,children:m}=e,p=(0,i.A)(e,h),f=pe(d,{relative:p.relative}),y=ce(),x=r.useContext(Z),{navigator:v,basename:b}=r.useContext(ae),w=null!=x&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.useContext(te);g(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=xt("useViewTransitionState"),s=pe(e,{relative:t});if(!n.isTransitioning)return!1;let i=B(n.currentLocation.pathname,a)||n.currentLocation.pathname,o=B(n.nextLocation.pathname,a)||n.nextLocation.pathname;return null!=L(s.pathname,o)||null!=L(s.pathname,i)}(f)&&!0===u,j=v.encodeLocation?v.encodeLocation(f).pathname:f.pathname,N=y.pathname,_=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;a||(N=N.toLowerCase(),_=_?_.toLowerCase():null,j=j.toLowerCase()),_&&b&&(_=B(_,b)||_);const S="/"!==j&&j.endsWith("/")?j.length-1:j.length;let k,E=N===j||!l&&N.startsWith(j)&&"/"===N.charAt(S),A=null!=_&&(_===j||!l&&_.startsWith(j)&&"/"===_.charAt(j.length)),C={isActive:E,isPending:A,isTransitioning:w},D=E?n:void 0;k="function"===typeof s?s(C):[s,E?"active":null,A?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let T="function"===typeof c?c(C):c;return r.createElement(pt,(0,o.A)((0,o.A)({},p),{},{"aria-current":D,className:k,ref:t,style:T,to:d,viewTransition:u}),"function"===typeof m?m(C):m)});ft.displayName="NavLink";var gt=r.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:a,navigate:s,reloadDocument:l,replace:c,state:d,method:u=Re,action:h,onSubmit:p,relative:f,preventScrollReset:y,viewTransition:x}=e,v=(0,i.A)(e,m),w=wt(),j=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=r.useContext(ae),a=r.useContext(ie);g(a,"useFormAction must be used inside a RouteContext");let[s]=a.matches.slice(-1),i=(0,o.A)({},pe(e||".",{relative:t})),l=ce();if(null==e){i.search=l.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();i.search=n?"?".concat(n):""}}e&&"."!==e||!s.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(i.pathname="/"===i.pathname?n:W([n,i.pathname]));return b(i)}(h,{relative:f}),N="get"===u.toLowerCase()?"get":"post",_="string"===typeof h&&mt.test(h);return r.createElement("form",(0,o.A)((0,o.A)({ref:t,method:N,action:j,onSubmit:l?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u;w(t||e.currentTarget,{fetcherKey:a,method:n,navigate:s,replace:c,state:d,relative:f,preventScrollReset:y,viewTransition:x})}},v),{},{"data-discover":_||"render"!==n?void 0:"true"}))});function yt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function xt(e){let t=r.useContext(X);return g(t,yt(e)),t}gt.displayName="Form";var vt=0,bt=()=>"__".concat(String(++vt),"__");function wt(){let{router:e}=xt("useSubmit"),{basename:t}=r.useContext(ae),n=_e("useRouteId");return r.useCallback(async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:i,encType:o,formData:l,body:c}=ze(r,t);if(!1===a.navigate){let t=a.fetcherKey||bt();await e.fetch(t,n,a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}var jt=n(4144),Nt=n(1547),_t=n(2970);class St{static getGoogleProvider(){return this.googleProvider||(this.googleProvider=new jt.HF,this.googleProvider.addScope("email"),this.googleProvider.addScope("profile"),this.googleProvider.addScope("https://www.googleapis.com/auth/calendar.readonly"),this.googleProvider.addScope("https://www.googleapis.com/auth/calendar.events"),this.googleProvider.setCustomParameters({prompt:"select_account",access_type:"offline"})),this.googleProvider}static async signInWithGoogle(){try{console.log("\ud83d\udd10 Signing in with Google...");const e=await(0,jt.df)(Nt.j2,this.getGoogleProvider());return console.log("\u2705 Sign-in successful:",e.user.email),await this.handleGoogleSignInResult(e.user)}catch(e){throw console.error("\u274c Sign-in failed:",e.code,e.message),e}}static async handleGoogleSignInResult(e){var t;const n=e.email;if(!n)throw await(0,jt.CI)(Nt.j2),new Error("No email address found in Google account");const r=null===(t=n.split("@")[1])||void 0===t?void 0:t.toLowerCase();if(!["navgurukul.org"].includes(r))throw await(0,jt.CI)(Nt.j2),new Error("Access denied. Only Navgurukul domain emails (@navgurukul.org) are allowed to sign in.");return await _t.UserService.getUserById(e.uid)||await _t.UserService.createUserWithId(e.uid,{name:e.displayName||"User",email:e.email,isAdmin:!1,skills:[],created_at:new Date,updated_at:new Date}),e}static async signOut(){try{await(0,jt.CI)(Nt.j2)}catch(e){throw console.error("Error signing out:",e),e}}static async getCurrentUserData(){const e=Nt.j2.currentUser;if(!e)return null;try{return await _t.UserService.getUserById(e.uid)}catch(t){return console.error("Error getting current user data:",t),null}}static onAuthStateChanged(e){return(0,jt.hg)(Nt.j2,e)}static async isAdmin(){const e=await this.getCurrentUserData();return(null===e||void 0===e?void 0:e.isAdmin)||!1}}St.googleProvider=void 0;var kt=n(6667);class Et{static async getWebhookByCampus(e){try{var t,n;const r=(0,kt.query)((0,kt.collection)(Nt.db,_t.I.CAMPUS_WEBHOOKS),(0,kt._M)("campus","==",e)),a=await(0,kt.getDocs)(r);if(a.empty)return null;const s=a.docs[0];return(0,o.A)((0,o.A)({id:s.id},s.data()),{},{created_at:null===(t=s.data().created_at)||void 0===t?void 0:t.toDate(),updated_at:null===(n=s.data().updated_at)||void 0===n?void 0:n.toDate()})}catch(r){throw console.error("Error fetching webhook:",r),r}}static async getAllWebhooks(){try{return(await(0,kt.getDocs)((0,kt.collection)(Nt.db,_t.I.CAMPUS_WEBHOOKS))).docs.map(e=>{var t,n;return(0,o.A)((0,o.A)({id:e.id},e.data()),{},{created_at:null===(t=e.data().created_at)||void 0===t?void 0:t.toDate(),updated_at:null===(n=e.data().updated_at)||void 0===n?void 0:n.toDate()})})}catch(e){throw console.error("Error fetching all webhooks:",e),e}}static async saveWebhook(e,t,n,r){try{const a=await this.getWebhookByCampus(e);if(a){const s=(0,kt.H9)(Nt.db,_t.I.CAMPUS_WEBHOOKS,a.id);return await(0,kt.mZ)(s,{webhook_url:t,updated_by:n,updated_by_name:r,updated_at:(0,kt.O5)()}),await this.createWebhookChangeNotification(e,n,r,a.webhook_url,t,"updated"),(0,o.A)((0,o.A)({},a),{},{webhook_url:t,updated_by:n,updated_by_name:r,updated_at:new Date})}{const a={campus:e,webhook_url:t,created_by:n,created_by_name:r,created_at:(0,kt.O5)(),updated_at:(0,kt.O5)()},s=await(0,kt.gS)((0,kt.collection)(Nt.db,_t.I.CAMPUS_WEBHOOKS),a);return await this.createWebhookChangeNotification(e,n,r,void 0,t,"created"),(0,o.A)((0,o.A)({id:s.id},a),{},{created_at:new Date,updated_at:new Date})}}catch(a){throw console.error("Error saving webhook:",a),a}}static async createWebhookChangeNotification(e,t,n,r,a,s){try{const i={campus:e,changed_by:t,changed_by_name:n,new_webhook_url:a,change_type:s,timestamp:(0,kt.O5)(),is_read:!1,read_by:[],created_at:(0,kt.O5)()};r&&(i.old_webhook_url=r),await(0,kt.gS)((0,kt.collection)(Nt.db,_t.I.WEBHOOK_CHANGE_NOTIFICATIONS),i)}catch(i){throw console.error("Error creating webhook change notification:",i),i}}static async getUnreadNotifications(e){try{const t=(0,kt.query)((0,kt.collection)(Nt.db,_t.I.WEBHOOK_CHANGE_NOTIFICATIONS),(0,kt._M)("is_read","==",!1),(0,kt.orderBy)("timestamp","desc"));return(await(0,kt.getDocs)(t)).docs.map(e=>{var t,n;return(0,o.A)((0,o.A)({id:e.id},e.data()),{},{timestamp:null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate(),created_at:null===(n=e.data().created_at)||void 0===n?void 0:n.toDate()})}).filter(t=>!t.read_by||!t.read_by.includes(e))}catch(t){throw console.error("Error fetching unread notifications:",t),t}}static async getAllNotifications(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{const t=(0,kt.query)((0,kt.collection)(Nt.db,_t.I.WEBHOOK_CHANGE_NOTIFICATIONS),(0,kt.orderBy)("timestamp","desc"),(0,kt.limit)(e));return(await(0,kt.getDocs)(t)).docs.map(e=>{var t,n;return(0,o.A)((0,o.A)({id:e.id},e.data()),{},{timestamp:null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate(),created_at:null===(n=e.data().created_at)||void 0===n?void 0:n.toDate()})})}catch(t){throw console.error("Error fetching all notifications:",t),t}}static async markNotificationAsRead(e,t){try{const n=(0,kt.H9)(Nt.db,_t.I.WEBHOOK_CHANGE_NOTIFICATIONS,e),r=await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,_t.I.WEBHOOK_CHANGE_NOTIFICATIONS),(0,kt._M)("__name__","==",e)));if(!r.empty){const e=r.docs[0].data().read_by||[];e.includes(t)||e.push(t),await(0,kt.mZ)(n,{read_by:e,is_read:!0})}}catch(n){throw console.error("Error marking notification as read:",n),n}}static async markAllNotificationsAsRead(e){try{const t=(await this.getUnreadNotifications(e)).map(t=>this.markNotificationAsRead(t.id,e));await Promise.all(t)}catch(t){throw console.error("Error marking all notifications as read:",t),t}}}function At(){const e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t+198e5)}function Ct(e){const t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t+198e5)}function Dt(e){return(e?Ct(e):At()).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"})}class Tt{static async rateLimit(){const e=Date.now()-this.lastRequestTime;if(e<this.RATE_LIMIT_DELAY){const t=this.RATE_LIMIT_DELAY-e;await new Promise(e=>setTimeout(e,t))}this.lastRequestTime=Date.now()}static isValidWebhookUrl(e){return!!e&&(!e.includes("YOUR_")&&!e.includes("WEBHOOK_URL")&&e.startsWith("https://discord.com/api/webhooks/"))}static async sendWebhook(e,t){const n=t||this.WEBHOOK_URL;if(!n)throw console.warn("\u26a0\ufe0f Discord webhook URL not configured"),new Error("Discord webhook URL not configured. Please set up webhook URLs in .env file.");if(!this.isValidWebhookUrl(n))throw console.error("\u26a0\ufe0f Invalid Discord webhook URL:",n),new Error("Invalid Discord webhook URL. Please replace placeholder URLs in .env with actual Discord webhook URLs. See README for instructions.");try{await this.rateLimit();const t=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw new Error("Discord API error: ".concat(t.status," ").concat(t.statusText," - ").concat(e))}console.log("\u2705 Discord webhook sent successfully")}catch(r){throw console.error("\u274c Failed to send Discord webhook:",r),r}}static async sendLoginNotification(e){const t=e.discord_user_id?"<@".concat(e.discord_user_id.replace(/[@#]/g,""),">"):e.name,n=e.login_time?e.login_time.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}):Dt(),r={title:"\u2705 Login Notification",description:"".concat(t," just logged in!"),color:1096065,fields:[{name:"\ud83d\udc64 User",value:e.name,inline:!0},{name:"\ud83c\udfeb Campus",value:e.campus||"N/A",inline:!0},{name:"\ud83c\udfad Role",value:e.role||"Student",inline:!0},{name:"\u23f0 Time (IST)",value:n,inline:!0}],timestamp:At().toISOString(),footer:{text:"Campus Learning Dashboard"}};await this.sendWebhook({embeds:[r]})}static async sendFirstTimeLoginNotification(e){const t=e.discord_user_id?"<@".concat(e.discord_user_id.replace(/[@#]/g,""),">"):e.name,n=e.login_time?e.login_time.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}):Dt(),r=e.campus_joining_date?e.campus_joining_date.toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}):"Not set",a=[{name:"\ud83d\udc64 User",value:e.name,inline:!0},{name:"\ud83c\udfeb Campus",value:e.campus||"Not set",inline:!0},{name:"\ud83c\udfad Role",value:e.role||"Student",inline:!0},{name:"\u23f0 Login Time",value:n,inline:!0}];e.house&&a.push({name:"\ud83c\udfe0 House",value:e.house,inline:!0}),e.campus_joining_date&&a.push({name:"\ud83d\udcc5 Joining Date",value:r,inline:!0});const s={title:"\ud83c\udf89 First-Time Login!",description:"".concat(t," has logged in for the **first time**! Welcome aboard! \ud83d\ude80"),color:16096779,fields:a,timestamp:At().toISOString(),footer:{text:"Campus Learning Dashboard - Welcome Team!"}};await this.sendWebhook({content:"\ud83c\udf8a **New User Alert!** \ud83c\udf8a",embeds:[s]})}static async sendHourlySummary(e){if(0===e.total_logins)return void console.log("No logins in the past hour, skipping summary");const t=e.users.slice(0,25).map((e,t)=>{const n=e.discord_user_id?"<@".concat(e.discord_user_id.replace(/[@#]/g,""),">"):e.name;return"".concat(t+1,". ").concat(n," (").concat(e.campus||"N/A",")")}).join("\n"),n=e.total_logins>25?"\n_...and ".concat(e.total_logins-25," more_"):"",r=e.by_campus?Object.entries(e.by_campus).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join(", "):"N/A",a={title:"\ud83d\udcca Hourly Attendance Summary",description:"**".concat(e.total_logins,"** users logged in during the past hour"),color:3900150,fields:[{name:"\ud83d\udc65 Active Users",value:t+n,inline:!1},{name:"\ud83c\udfeb By Campus",value:r,inline:!1}],timestamp:At().toISOString(),footer:{text:"Campus Learning Dashboard - Hourly Report"}};await this.sendWebhook({content:"\u23f0 **Hourly Attendance Update**",embeds:[a]})}static async sendDailySummary(e){if(0===e.total_logins)return void await this.sendWebhook({content:"\ud83d\udcc5 **Daily Attendance Report**",embeds:[{title:"\ud83d\udcca No Logins Today",description:"No users logged in today.",color:15680580,timestamp:At().toISOString(),footer:{text:"Campus Learning Dashboard - Daily Report"}}]});const t=e.users.slice(0,20).map((e,t)=>{const n=e.discord_user_id?"<@".concat(e.discord_user_id.replace(/[@#]/g,""),">"):e.name;return"".concat(t+1,". ").concat(n," - ").concat(e.campus||"N/A")}).join("\n"),n=e.total_logins>20?"\n_...and ".concat(e.total_logins-20," more users_"):"",r=e.by_campus?Object.entries(e.by_campus).sort((e,t)=>{let[,n]=e,[,r]=t;return r-n}).map(e=>{let[t,n]=e;return"\u2022 ".concat(t,": **").concat(n,"** users")}).join("\n"):"N/A",a=e.by_role?Object.entries(e.by_role).map(e=>{let[t,n]=e;return"\u2022 ".concat(t,": **").concat(n,"**")}).join("\n"):"N/A",s={title:"\ud83d\udcc5 Daily Attendance Report",description:"**".concat(e.total_logins,"** total logins on ").concat(e.date),color:9133302,fields:[{name:"\ud83c\udfc6 Today's Active Users",value:t+n,inline:!1},{name:"\ud83c\udfeb Campus Breakdown",value:r,inline:!0},{name:"\ud83c\udfad Role Breakdown",value:a,inline:!0}],timestamp:At().toISOString(),footer:{text:"Campus Learning Dashboard - Daily Report"}};await this.sendWebhook({content:"\ud83c\udf89 **Daily Attendance Report is Ready!**",embeds:[s]})}static async sendLowAttendanceAlert(e,t,n){const r=(t/e*100).toFixed(1),a={title:"\u26a0\ufe0f Low Attendance Alert",description:"Attendance is below expected levels for ".concat(n),color:16096779,fields:[{name:"\ud83d\udcca Statistics",value:"Expected: **".concat(e,"** users\nActual: **").concat(t,"** users\nAttendance Rate: **").concat(r,"%**"),inline:!1}],timestamp:At().toISOString(),footer:{text:"Campus Learning Dashboard - Alert System"}};await this.sendWebhook({content:"@here \ud83d\udea8 **Attention Required**",embeds:[a]})}static async sendCustomMessage(e,t){const n={title:e,description:t,color:arguments.length>2&&void 0!==arguments[2]?arguments[2]:3900150,timestamp:At().toISOString(),footer:{text:"Campus Learning Dashboard"}};await this.sendWebhook({embeds:[n]})}static async testConnection(){try{return await this.sendCustomMessage("\ud83e\uddea Test Message","Discord webhook is configured correctly! \u2705",1096065),!0}catch(e){return console.error("Discord webhook test failed:",e),!1}}static async getCampusWebhook(e){try{const t=this.webhookCache.get(e);if(t&&Date.now()-t.timestamp<this.CACHE_TTL)return t.url;const n=await Et.getWebhookByCampus(e);if(n&&n.webhook_url)return this.webhookCache.set(e,{url:n.webhook_url,timestamp:Date.now()}),n.webhook_url;const r=e.toLowerCase();let a=this.WEBHOOK_URL;switch(r){case"dharamshala":a=this.WEBHOOK_DHARAMSHALA||this.WEBHOOK_URL;break;case"dantewada":a=this.WEBHOOK_DANTEWADA||this.WEBHOOK_URL;break;case"jashpur":a=this.WEBHOOK_JASHPUR||this.WEBHOOK_URL;break;case"raigarh":a=this.WEBHOOK_RAIGARH||this.WEBHOOK_URL;break;case"pune":a=this.WEBHOOK_PUNE||this.WEBHOOK_URL;break;case"sarjapur":case"sarjapura":a=this.WEBHOOK_SARJAPUR||this.WEBHOOK_URL;break;case"kishanganj":a=this.WEBHOOK_KISHANGANJ||this.WEBHOOK_URL;break;case"eternal":a=this.WEBHOOK_ETERNAL||this.WEBHOOK_URL}return a}catch(t){console.error("Error fetching webhook from database, using fallback:",t);switch(e.toLowerCase()){case"dharamshala":return this.WEBHOOK_DHARAMSHALA||this.WEBHOOK_URL;case"dantewada":return this.WEBHOOK_DANTEWADA||this.WEBHOOK_URL;case"jashpur":return this.WEBHOOK_JASHPUR||this.WEBHOOK_URL;case"raigarh":return this.WEBHOOK_RAIGARH||this.WEBHOOK_URL;case"pune":return this.WEBHOOK_PUNE||this.WEBHOOK_URL;case"sarjapur":case"sarjapura":return this.WEBHOOK_SARJAPUR||this.WEBHOOK_URL;case"kishanganj":return this.WEBHOOK_KISHANGANJ||this.WEBHOOK_URL;case"eternal":return this.WEBHOOK_ETERNAL||this.WEBHOOK_URL;default:return this.WEBHOOK_URL}}}static clearWebhookCache(e){e?this.webhookCache.delete(e):this.webhookCache.clear()}static async sendAttendanceReport(e,t,n,r,a,s,i,o,l,c,d,u,h,m){const p=m?await this.getCampusWebhook(m):this.WEBHOOK_URL,f=e.toLocaleDateString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit"}),g=l.length>0?l.slice(0,50).join(", "):"None",y=l.length>50?"\n_...and ".concat(l.length-50," more_"):"",x=c.length>0?c.slice(0,30).join(", "):"None",v=c.length>30?"\n_...and ".concat(c.length-30," more_"):"",b=d.length>0?d.slice(0,30).join(", "):"None",w=d.length>30?"\n_...and ".concat(d.length-30," more_"):"",j=h.length>0?h.slice(0,20).map(e=>"".concat(e.name," (since ").concat(e.startDate,")")).join(", "):"None",N=h.length>20?"\n_...and ".concat(h.length-20," more_"):"";let _;_=a>=80?1096065:a>=60?16096779:15680580;const S=m?" - ".concat(m):"",k={title:"\ud83c\udf05 Morning Attendance".concat(S),description:"Attendance report for ".concat(f),color:_,fields:[{name:"\u2705 Present",value:"".concat(n," students"),inline:!1},{name:"\u274c Absent",value:"".concat(r," students"),inline:!1},{name:"\ud83c\udf73 Kitchen Leave",value:"".concat(s," students"),inline:!1},{name:"\ud83c\udfd6\ufe0f On Leave",value:"".concat(i," students"),inline:!1},{name:"\ufffd Unapproved Leave",value:"".concat(o," students"),inline:!1},{name:"\ufffd\ud83d\udcc8 Attendance Rate",value:"".concat(a.toFixed(1),"%"),inline:!1},{name:"\ud83d\udc65 Absent Students",value:g+y,inline:!1},{name:"\ud83c\udf73 Kitchen Leave Students",value:x+v,inline:!1},{name:"\ud83c\udfd6\ufe0f On Leave Students",value:b+w,inline:!1},{name:"\ud83d\udea8 Unapproved Leave Students",value:j+N,inline:!1}],timestamp:At().toISOString(),footer:{text:"Campus Learning Dashboard - Daily Report"}};await this.sendWebhook({embeds:[k]},p)}static async sendCampusAttendanceReport(e,t,n,r,a,s,i,o,l,c,d,u,h,m){await this.sendAttendanceReport(t,n,r,a,s,i,o,l,c,d,u,h,m,e)}}Tt.WEBHOOK_URL={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_URL||"",Tt.WEBHOOK_DHARAMSHALA={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_DHARAMSHALA||"",Tt.WEBHOOK_DANTEWADA={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_DANTEWADA||"",Tt.WEBHOOK_JASHPUR={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_JASHPUR||"",Tt.WEBHOOK_RAIGARH={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_RAIGARH||"",Tt.WEBHOOK_PUNE={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_PUNE||"",Tt.WEBHOOK_SARJAPUR={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_SARJAPUR||"",Tt.WEBHOOK_KISHANGANJ={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_KISHANGANJ||"",Tt.WEBHOOK_ETERNAL={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_ETERNAL||"",Tt.RATE_LIMIT_DELAY=2e3,Tt.lastRequestTime=0,Tt.webhookCache=new Map,Tt.CACHE_TTL=3e5;class Ot{static getTodayDate(){return(new Date).toISOString().split("T")[0]}static async isFirstTimeLogin(e){try{if("true"===localStorage.getItem("".concat(this.FIRST_LOGIN_KEY,"_").concat(e)))return!1}catch(t){console.warn("Error checking localStorage for first login:",t)}try{const t=(0,kt.collection)(Nt.db,"daily_logins"),n=await(0,kt.getDocs)(t);for(const r of n.docs){const t=await(0,kt.getDocs)((0,kt.collection)(Nt.db,"daily_logins",r.id,"logins"));if(t.docs.some(t=>t.id===e)){try{localStorage.setItem("".concat(this.FIRST_LOGIN_KEY,"_").concat(e),"true")}catch(BM){console.warn("Could not update localStorage:",BM)}return!1}}return!0}catch(t){return console.error("Error checking first time login in Firestore:",t),!1}}static markFirstLoginRecorded(e){try{localStorage.setItem("".concat(this.FIRST_LOGIN_KEY,"_").concat(e),"true")}catch(t){console.error("Error updating first login localStorage:",t)}}static hasLoggedInToday(e){try{const t=localStorage.getItem("".concat(this.LOGIN_STORAGE_KEY,"_").concat(e));return t===this.getTodayDate()}catch(t){return console.error("Error checking localStorage:",t),!1}}static markLoggedInToday(e){try{const t=this.getTodayDate();localStorage.setItem("".concat(this.LOGIN_STORAGE_KEY,"_").concat(e),t)}catch(t){console.error("Error updating localStorage:",t)}}static async recordLoginInFirestore(e){const t=this.getTodayDate(),n={user_id:e.id,user_name:e.name,user_email:e.email,role:e.role||(e.isAdmin?"admin":e.isMentor?"mentor":"student"),login_time:(0,kt.O5)(),updated_at:(0,kt.O5)(),date:t};e.campus&&(n.campus=e.campus),e.house&&(n.house=e.house),e.discord_user_id&&(n.discord_user_id=e.discord_user_id);try{const r=(0,kt.H9)(Nt.db,"daily_logins",t,"logins",e.id);await(0,kt.BN)(r,n,{merge:!0}),console.log("\u2705 Login recorded in Firestore")}catch(r){throw console.error("\u274c Failed to record login in Firestore:",r),r}}static async sendDiscordNotification(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.DISCORD_NOTIFICATIONS_ENABLED)if(t)try{const t={name:e.name,discord_user_id:e.discord_user_id,campus:e.campus,role:e.role||(e.isAdmin?"Admin":e.isMentor?"Mentor":"Student"),login_time:new Date,house:e.house,campus_joining_date:e.campus_joining_date};await Tt.sendFirstTimeLoginNotification(t),console.log("\ud83c\udf89 First-time login Discord notification sent")}catch(n){console.error("\u274c Failed to send Discord notification:",n)}else console.log("Regular login - no notification sent");else console.log("Discord notifications disabled, skipping")}static async trackLogin(e){if(e&&e.id)if(this.hasLoggedInToday(e.id))console.log("User already tracked today, skipping");else{console.log("\ud83d\udd04 Tracking login for:",e.name);try{const t=await this.isFirstTimeLogin(e.id);t&&console.log("\ud83c\udf89 First-time login detected for:",e.name),await this.recordLoginInFirestore(e);const n=e.campus&&e.campus_joining_date;t&&!n?(console.log("\u23f3 First-time login notification postponed - waiting for profile completion"),this.markLoggedInToday(e.id)):(this.sendDiscordNotification(e,t).catch(e=>{console.error("Discord notification error (non-blocking):",e)}),this.markLoggedInToday(e.id),t&&this.markFirstLoginRecorded(e.id)),console.log("\u2705 Login tracking complete")}catch(t){console.error("\u274c Login tracking failed:",t)}}else console.warn("Invalid user data, cannot track login")}static async getTodayLoginCount(){const e=this.getTodayDate();try{const t=(0,kt.collection)(Nt.db,"daily_logins",e,"logins");return(await(0,kt.getDocs)(t)).size}catch(t){return console.error("Error getting login count:",t),0}}static async getTodayLogins(){const e=this.getTodayDate();try{const t=(0,kt.collection)(Nt.db,"daily_logins",e,"logins");return(await(0,kt.getDocs)(t)).docs.map(e=>{var t;const n=e.data();return(0,o.A)((0,o.A)({},n),{},{login_time:(null===(t=n.login_time)||void 0===t?void 0:t.toDate())||new Date})})}catch(t){return console.error("Error getting today's logins:",t),[]}}static async getLoginsInRange(e,t){const n=[];try{const r=new Date(e),a=new Date(t);for(let e=r;e<=a;e.setDate(e.getDate()+1)){const t=e.toISOString().split("T")[0],r=await this.getLoginsByDate(t);n.push(...r)}return n}catch(r){return console.error("Error getting logins in range:",r),[]}}static async getLoginsByDate(e){try{const t=(0,kt.collection)(Nt.db,"daily_logins",e,"logins");return(await(0,kt.getDocs)(t)).docs.map(e=>{var t;const n=e.data();return(0,o.A)((0,o.A)({},n),{},{login_time:(null===(t=n.login_time)||void 0===t?void 0:t.toDate())||new Date})})}catch(t){return console.error("Error getting logins for ".concat(e,":"),t),[]}}static async sendDailySummary(e){const t=e||this.getTodayDate();try{const e=await this.getLoginsByDate(t),n={},r={};e.forEach(e=>{const t=e.campus||"Unknown",a=e.role||"Student";n[t]=(n[t]||0)+1,r[a]=(r[a]||0)+1});const a=e.map(e=>({name:e.user_name,discord_user_id:e.discord_user_id,campus:e.campus,role:e.role,login_time:e.login_time}));await Tt.sendDailySummary({date:t,total_logins:e.length,users:a,by_campus:n,by_role:r}),console.log("\u2705 Daily summary sent to Discord")}catch(n){throw console.error("\u274c Failed to send daily summary:",n),n}}static setDiscordNotificationsEnabled(e){this.DISCORD_NOTIFICATIONS_ENABLED=e,console.log("Discord notifications ".concat(e?"enabled":"disabled"))}static clearLocalStorage(){try{Object.keys(localStorage).forEach(e=>{e.startsWith(this.LOGIN_STORAGE_KEY)&&localStorage.removeItem(e)}),console.log("\u2705 Login tracking localStorage cleared")}catch(e){console.error("Error clearing localStorage:",e)}}static async checkAndSendPostponedNotification(e){if(e&&e.id)try{if("true"===localStorage.getItem("".concat(this.FIRST_LOGIN_KEY,"_").concat(e.id)))return;if(!(e.campus&&e.campus_joining_date))return;await this.isFirstTimeLogin(e.id)&&(console.log("\ud83c\udf89 Sending postponed first-time login notification for:",e.name),await this.sendDiscordNotification(e,!0),this.markFirstLoginRecorded(e.id),console.log("\u2705 Postponed first-time login notification sent"))}catch(t){console.error("Error sending postponed notification:",t)}}}Ot.LOGIN_STORAGE_KEY="last_login_date",Ot.FIRST_LOGIN_KEY="first_login_recorded",Ot.DISCORD_NOTIFICATIONS_ENABLED=!0;var Pt=n(579);const It=(0,r.createContext)(void 0),Rt=()=>{const e=(0,r.useContext)(It);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},Mt=e=>{let{children:t}=e;const[n,a]=(0,r.useState)(null),[s,i]=(0,r.useState)(null),[o,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(null);(0,r.useEffect)(()=>{console.log("\ud83d\ude80 Initializing auth listener...");const e=St.onAuthStateChanged(async e=>{if(console.log("\ud83d\udc64 Auth state changed:",e?e.email:"no user"),a(e),d(null),e){const e=setTimeout(()=>{console.warn("\u26a0\ufe0f Loading user data is taking too long..."),d("User data is taking too long to load. Please login again."),l(!1)},1e4);try{console.log("\ud83d\udce5 Loading user data...");const t=await St.getCurrentUserData();if(clearTimeout(e),!t)return console.warn("\u26a0\ufe0f User not found in database"),d("Your profile is not found. Please contact support or login again."),i(null),void l(!1);console.log("\u2705 User data loaded:",null===t||void 0===t?void 0:t.name),i(t),d(null),t&&Ot.trackLogin(t).catch(e=>{console.error("Login tracking error (non-blocking):",e)})}catch(t){clearTimeout(e),console.error("\u274c Error loading user data:",t),d("Failed to load user data. Please login again."),i(null)}}else i(null),d(null);l(!1)});return e},[]);const u={currentUser:n,userData:s,setUserData:i,loading:o,loadingError:c,signInWithGoogle:async()=>await St.signInWithGoogle(),signOut:async()=>{await St.signOut(),a(null),i(null)},isAdmin:()=>(null===s||void 0===s?void 0:s.isAdmin)||!1,isSuperMentor:()=>(null===s||void 0===s?void 0:s.isSuperMentor)||"super_mentor"===(null===s||void 0===s?void 0:s.role)||!1,isAcademicAssociate:()=>"academic_associate"===(null===s||void 0===s?void 0:s.role)||!1,isMentor:()=>(null===s||void 0===s?void 0:s.isMentor)||(null===s||void 0===s?void 0:s.isSuperMentor)||"mentor"===(null===s||void 0===s?void 0:s.role)||"super_mentor"===(null===s||void 0===s?void 0:s.role)||!1,isStudent:()=>{if(null!==s&&void 0!==s&&s.mentor_id)return!0;return!("admin"===(null===s||void 0===s?void 0:s.role)||"academic_associate"===(null===s||void 0===s?void 0:s.role)||"super_mentor"===(null===s||void 0===s?void 0:s.role)||"mentor"===(null===s||void 0===s?void 0:s.role))},impersonateUser:async e=>{if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)try{l(!0);let t=await _t.UserService.getUserByEmail(e);if(!t){console.log("\ud83d\udc64 Demo user not found, creating...",e);const n=e.split("@")[0].replace("."," ").replace(/(^\w|\s\w)/g,e=>e.toUpperCase());let r="student",a=!1,s=!1,i=!1;e.includes("admin")?(r="admin",a=!0):e.includes("mentor")&&(r="mentor",s=!0);const o={name:n,email:e,role:r,campus:"Dharamshala",house:"Bageshree",isAdmin:a,isMentor:s,isSuperMentor:i},l=await _t.UserService.createUser(o);if(t=await _t.UserService.getUserById(l),!t)throw new Error("Failed to create demo user")}if(!t)throw new Error("User data is null");const n={uid:t.id,email:t.email,displayName:t.name,emailVerified:!0,isAnonymous:!1,metadata:{},providerData:[],refreshToken:"",tenantId:null,delete:async()=>{},getIdToken:async()=>"mock-token",getIdTokenResult:async()=>({token:"mock-token",signInProvider:"custom",claims:{},authTime:Date.now(),issuedAtTime:Date.now(),expirationTime:Date.now()+3600}),reload:async()=>{},toJSON:()=>({}),phoneNumber:null,photoURL:null};a(n),i(t),l(!1),console.log("\ud83e\udd78 Impersonating user:",e)}catch(t){console.error("Impersonation failed:",t),d("Failed to impersonate user"),l(!1)}else console.error("Impersonation only allowed in development")}};return(0,Pt.jsx)(It.Provider,{value:u,children:t})},Lt=(0,r.createContext)(void 0),Ft=new Map,Ut=e=>{let{children:t}=e;const n=(0,r.useRef)(new Map),a=(0,r.useCallback)(async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e5;const a=n.current.get(e);if(a)return console.log("[Cache] Reusing pending request for: ".concat(e)),a;const s=Ft.get(e),i=Date.now();if(s&&i-s.timestamp<r)return console.log("[Cache] HIT (memory) for: ".concat(e,", age: ").concat(Math.round((i-s.timestamp)/1e3),"s")),s.data;try{const t="cache_".concat(e),n=localStorage.getItem(t);if(n){const a=JSON.parse(n);if(i-a.timestamp<r)return console.log("[Cache] HIT (localStorage) for: ".concat(e,", age: ").concat(Math.round((i-a.timestamp)/1e3),"s")),Ft.set(e,a),a.data;localStorage.removeItem(t)}}catch(l){console.warn("[Cache] Error reading from localStorage:",l)}console.log("[Cache] MISS for: ".concat(e,", fetching fresh data..."));const o=t().then(t=>{const r={data:t,timestamp:i,key:e};Ft.set(e,r);try{const t="cache_".concat(e);localStorage.setItem(t,JSON.stringify(r))}catch(l){console.warn("[Cache] Error writing to localStorage:",l)}return n.current.delete(e),t}).catch(t=>{throw n.current.delete(e),t});return n.current.set(e,o),o},[]),s=(0,r.useCallback)(e=>{if(e){console.log("[Cache] Invalidating cache for: ".concat(e)),Ft.delete(e);try{localStorage.removeItem("cache_".concat(e))}catch(t){console.warn("[Cache] Error removing from localStorage:",t)}}else{console.log("[Cache] Invalidating all cache"),Ft.clear();try{const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&n.startsWith("cache_")&&e.push(n)}e.forEach(e=>localStorage.removeItem(e))}catch(t){console.warn("[Cache] Error clearing localStorage:",t)}}},[]),i=(0,r.useCallback)(()=>{s()},[s]),o={getCachedData:a,invalidateCache:s,clearAllCache:i};return(0,Pt.jsx)(Lt.Provider,{value:o,children:t})},Bt=()=>{const e=(0,r.useContext)(Lt);if(!e)throw new Error("useDataCache must be used within DataCacheProvider");return e},zt=(e,t)=>{if(!t||0===Object.keys(t).length)return e;const n=Object.entries(t).sort((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}).map(e=>{let[t,n]=e;return"".concat(t,":").concat(JSON.stringify(n))}).join("|");return"".concat(e,"_").concat(n)},qt=()=>{const e=new Date,t=(e.getDay()+6)%7,n=new Date(e);return n.setDate(e.getDate()-t),n.setHours(0,0,0,0),n},Vt=e=>{const t=(e.getDay()+6)%7,n=new Date(e);return n.setDate(e.getDate()-t),n.setHours(0,0,0,0),n},Ht=e=>{const t=new Date(e);return t.setHours(23,59,59,999),t},Wt=e=>{if(!(e=>{const t=Ht(e);return new Date>t})(e))return 0;const t=Ht(e),n=(new Date).getTime()-t.getTime();return Math.floor(n/864e5)},Gt=e=>{const t=Ht(e),n=new Date,r=t.getTime()-n.getTime();return Math.ceil(r/864e5)},Kt=(e,t)=>{const n=Vt(e),r=Vt(t);return n.getTime()===r.getTime()},Qt=30,Yt=1,$t=10,Jt=["09:00","10:00","11:00","14:00","15:00","16:00","17:00"],Xt={Dharamshala:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Dantewada:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Eternal:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Jashpur:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Kishanganj:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Pune:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Raigarh:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Sarjapura:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Bageshree:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Malhar:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6},Bhairav:{timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"13:00",break_end:"14:00",max_sessions_per_day:6}},Zt={urgent:{weight:4,max_wait_days:1},high:{weight:3,max_wait_days:2},medium:{weight:2,max_wait_days:3},low:{weight:1,max_wait_days:7}},en=e=>Xt[e]||Xt.Dharamshala,tn=(e,t)=>en(e).working_days.includes(t);class nn{static async findAvailableSlots(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const a=[],s=en(e),i=Jt,o=(await _t.UserService.getUsersByCampus(e)).filter(e=>("mentor"===e.role||"academic_associate"===e.role||"admin"===e.role)&&"active"===e.status&&!r.includes(e.id));for(let l=new Date(t);l<=n;l.setDate(l.getDate()+1)){const t=l.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();if(tn(e,t))for(const n of i){const t=new Date(l),[r,i]=n.split(":").map(Number);t.setHours(r,i,0,0);const c=new Date(t);if(c.setMinutes(c.getMinutes()+Qt),!(t.getHours()<parseInt(s.start_time.split(":")[0])||c.getHours()>parseInt(s.end_time.split(":")[0]))){if(s.break_start&&s.break_end){const e=parseInt(s.break_start.split(":")[0]),n=parseInt(s.break_end.split(":")[0]);if(t.getHours()>=e&&c.getHours()<=n)continue}for(const t of o){if(await this.checkMentorAvailability(t.id,l,n,Qt)){const r=await this.getSessionsInTimeSlot(t.id,l,n,Qt),s={date:l.toISOString().split("T")[0],start_time:n,end_time:this.addMinutesToTime(n,Qt),mentor_id:t.id,mentor_name:t.name,campus:e,session_count:r.length,max_sessions:Yt,is_available:r.length<Yt};a.push(s)}}}}}return a.sort((e,t)=>e.date!==t.date?e.date.localeCompare(t.date):e.start_time!==t.start_time?e.start_time.localeCompare(t.start_time):t.is_available?1:-1)}static async checkMentorAvailability(e,t,n,r){try{const a=await _t.UserService.getUserById(e);if(!a)return!1;if("on_leave"===a.status&&a.leave_from&&a.leave_to){const e=new Date(a.leave_from),n=new Date(a.leave_to);if(t>=e&&t<=n)return!1}if((await this.getSessionsInTimeSlot(e,t,n,r)).length>=Yt)return!1;const s=t.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase(),i=await _t.UserService.getMentorAvailability(e);if(i.length>0){const e=i.find(e=>e.day_of_week===s&&e.start_time===n);if(e)return e.is_available}return!0}catch(a){return console.error("Error checking mentor availability:",a),!1}}static async getSessionsInTimeSlot(e,t,n,r){try{const a=new Date(t),[s,i]=n.split(":").map(Number);a.setHours(s,i,0,0);const o=new Date(a);o.setMinutes(o.getMinutes()+r);return(await xn.getSessionsByUser(e,"mentor")).filter(e=>{if(!e.scheduled_date||!e.scheduled_time)return!1;const n=new Date(e.scheduled_date);if(n.toDateString()!==t.toDateString())return!1;const[r,s]=e.scheduled_time.split(":").map(Number),i=new Date(n);i.setHours(r,s,0,0);const l=new Date(i);return l.setMinutes(l.getMinutes()+(e.duration_minutes||Qt)),!(l<=a||i>=o)})}catch(a){return console.error("Error getting sessions in time slot:",a),[]}}static async autoScheduleSession(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"medium";try{if(!await xn.getSessionById(e))return!1;const r=Zt[n],a=new Date,s=new Date;s.setDate(s.getDate()+r.max_wait_days);const i=await this.findAvailableSlots(t,a,s);if(0===i.length)return!1;const o=i.find(e=>e.is_available);if(!o)return!1;const l=new Date(o.date);return await xn.assignMentorToSession(e,o.mentor_id),await xn.updateSession(e,{scheduled_date:l,scheduled_time:o.start_time,status:"scheduled"}),!0}catch(r){return console.error("Error auto-scheduling session:",r),!1}}static async getUpcomingSessions(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$t;try{const r="student"===t?"mentee":"mentor"===t?"mentor":"all",a=(await xn.getSessionsByUser(e,r)).filter(e=>"scheduled"===e.status&&e.scheduled_date?new Date(e.scheduled_date)>=new Date:"assigned"===e.status||("mentor"===t||"admin"===t||"academic_associate"===t)&&"pending"===e.status).sort((e,t)=>{const n=e.scheduled_date?new Date(e.scheduled_date).getTime():new Date(e.created_at).getTime(),r=t.scheduled_date?new Date(t.scheduled_date).getTime():new Date(t.created_at).getTime();if(n!==r)return n-r;const a=e.scheduled_time||"00:00",s=t.scheduled_time||"00:00";return a.localeCompare(s)}).slice(0,n);return a}catch(r){return console.error("Error getting upcoming sessions:",r),[]}}static async isUserAvailable(e,t){try{const n=await _t.UserService.getUserById(e);if(!n)return!1;if("on_leave"===n.status&&n.leave_from&&n.leave_to){const e=new Date(n.leave_from),r=new Date(n.leave_to);if(t>=e&&t<=r)return!1}return"active"===n.status}catch(n){return console.error("Error checking user availability:",n),!1}}static async getSessionsByUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";return xn.getSessionsByUser(e,t)}static addMinutesToTime(e,t){const[n,r]=e.split(":").map(Number),a=new Date;return a.setHours(n,r+t,0,0),a.toTimeString().slice(0,5)}}class rn{static async createAssignment(e,t,n,r,a,s,i){try{if(!t||0===t.length)throw new Error("At least one student must be selected");const o={academic_associate_id:e,student_ids:t,campus:n,house:a,phase:s,created_at:kt.Timestamp.now(),updated_at:kt.Timestamp.now(),created_by:r,notes:i},l=await(0,kt.gS)((0,kt.collection)(Nt.db,this.COLLECTION),o);return console.log("\u2705 [AcademicAssociateService] Created assignment:",l.id,{aa:e,students:t.length,house:a,phase:s}),l.id}catch(o){throw console.error("\u274c [AcademicAssociateService] Error creating assignment:",o),o}}static async getAssignments(e){try{let t=(0,kt.collection)(Nt.db,this.COLLECTION);const n=[];null!==e&&void 0!==e&&e.campus&&n.push((0,kt._M)("campus","==",e.campus)),null!==e&&void 0!==e&&e.house&&n.push((0,kt._M)("house","==",e.house)),null!==e&&void 0!==e&&e.phase&&n.push((0,kt._M)("phase","==",e.phase)),n.length>0&&(t=(0,kt.query)(t,...n));const r=await(0,kt.getDocs)(t),a=[];return r.forEach(e=>{var t,n;const r=e.data();a.push({id:e.id,academic_associate_id:r.academic_associate_id,student_ids:r.student_ids,campus:r.campus,house:r.house,phase:r.phase,created_at:(null===(t=r.created_at)||void 0===t?void 0:t.toDate())||new Date,updated_at:(null===(n=r.updated_at)||void 0===n?void 0:n.toDate())||new Date,created_by:r.created_by,notes:r.notes})}),console.log("\u2705 [AcademicAssociateService] Retrieved ".concat(a.length," assignments"),{filters:e}),a}catch(t){throw console.error("\u274c [AcademicAssociateService] Error fetching assignments:",t),t}}static async getAssignedStudents(e){try{const t=(await this.getAssignments()).find(t=>t.academic_associate_id===e);if(!t)return console.log("\u26a0\ufe0f [AcademicAssociateService] No assignment found for AA: ".concat(e)),[];const n=t.student_ids.map(n=>({student_id:n,academic_associate_id:e,campus:t.campus,house:t.house,phase:t.phase,assigned_at:t.created_at,assigned_by:t.created_by}));return console.log("\u2705 [AcademicAssociateService] Retrieved ".concat(n.length," students for AA: ").concat(e)),n}catch(t){throw console.error("\u274c [AcademicAssociateService] Error fetching assigned students:",t),t}}static async getStudentAcademicAssociate(e){try{const t=(await this.getAssignments()).find(t=>t.student_ids.includes(e));return t&&console.log("\u2705 [AcademicAssociateService] Student ".concat(e," assigned to AA: ").concat(t.academic_associate_id)),t||null}catch(t){throw console.error("\u274c [AcademicAssociateService] Error fetching student AA:",t),t}}static async addStudentToAssignment(e,t){try{const n=(await this.getAssignments()).find(e=>e.academic_associate_id===t);if(!n)throw new Error("Assignment not found for AA: ".concat(t));if(n.student_ids.includes(e))throw new Error("Student ".concat(e," already assigned to this AA"));const r=[...n.student_ids,e];await(0,kt.mZ)((0,kt.H9)(Nt.db,this.COLLECTION,n.id),{student_ids:r,updated_at:kt.Timestamp.now()}),console.log("\u2705 [AcademicAssociateService] Added student ".concat(e," to AA ").concat(t))}catch(n){throw console.error("\u274c [AcademicAssociateService] Error adding student:",n),n}}static async removeStudentFromAssignment(e,t){try{const n=(await this.getAssignments()).find(e=>e.academic_associate_id===t);if(!n)throw new Error("Assignment not found for AA: ".concat(t));const r=n.student_ids.filter(t=>t!==e);await(0,kt.mZ)((0,kt.H9)(Nt.db,this.COLLECTION,n.id),{student_ids:r,updated_at:kt.Timestamp.now()}),console.log("\u2705 [AcademicAssociateService] Removed student ".concat(e," from AA ").concat(t))}catch(n){throw console.error("\u274c [AcademicAssociateService] Error removing student:",n),n}}static async updateAssignment(e,t){try{await(0,kt.mZ)((0,kt.H9)(Nt.db,this.COLLECTION,e),(0,o.A)((0,o.A)({},t),{},{updated_at:kt.Timestamp.now()})),console.log("\u2705 [AcademicAssociateService] Updated assignment:",e)}catch(n){throw console.error("\u274c [AcademicAssociateService] Error updating assignment:",n),n}}static async deleteAssignment(e){try{await(0,kt.kd)((0,kt.H9)(Nt.db,this.COLLECTION,e)),console.log("\u2705 [AcademicAssociateService] Deleted assignment:",e)}catch(t){throw console.error("\u274c [AcademicAssociateService] Error deleting assignment:",t),t}}static async getAcademicAssociatesSummary(e){try{const t=(await this.getAssignments({campus:e})).map(e=>({id:e.academic_associate_id,student_count:e.student_ids.length,house:e.house,phase:e.phase,notes:e.notes,updated_at:e.updated_at}));return console.log("\u2705 [AcademicAssociateService] Retrieved summary for ".concat(t.length," AAs")),t}catch(t){throw console.error("\u274c [AcademicAssociateService] Error fetching AA summary:",t),t}}}rn.COLLECTION="academic_associate_assignments";class an{static async createQueueEntry(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"medium";try{const s=await this.getMaxPositionForAA(n)+1,i={academic_associate_id:n,student_id:t,session_id:e,position:s,status:"waiting",campus:r,priority:a,added_at:new Date,updated_at:new Date},l=await(0,kt.gS)((0,kt.collection)(Nt.db,this.COLLECTION),(0,o.A)((0,o.A)({},i),{},{added_at:kt.Timestamp.now(),updated_at:kt.Timestamp.now()}));return console.log("\u2705 [RollingQueueService] Created queue entry:",{id:l.id,aa:n,student:t,position:s}),l.id}catch(s){throw console.error("\u274c [RollingQueueService] Error creating queue entry:",s),s}}static async getQueueForAA(e){try{const t=(0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("academic_associate_id","==",e),(0,kt.orderBy)("position","asc")),n=await(0,kt.getDocs)(t),r=[];return n.forEach(e=>{var t,n,a,s,i;const o=e.data();r.push({id:e.id,academic_associate_id:o.academic_associate_id,student_id:o.student_id,session_id:o.session_id,position:o.position,status:o.status,campus:o.campus,priority:o.priority,added_at:(null===(t=o.added_at)||void 0===t?void 0:t.toDate())||new Date,started_at:null===(n=o.started_at)||void 0===n?void 0:n.toDate(),completed_at:null===(a=o.completed_at)||void 0===a?void 0:a.toDate(),cancelled_at:null===(s=o.cancelled_at)||void 0===s?void 0:s.toDate(),notes:o.notes,updated_at:(null===(i=o.updated_at)||void 0===i?void 0:i.toDate())||new Date})}),console.log("\u2705 [RollingQueueService] Retrieved queue for AA ".concat(e,": ").concat(r.length," entries")),r}catch(t){throw console.error("\u274c [RollingQueueService] Error fetching queue:",t),t}}static async getNextInQueue(e){try{var t,n,r,a,s;const i=(0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("academic_associate_id","==",e),(0,kt._M)("status","==","waiting"),(0,kt.orderBy)("position","asc")),o=await(0,kt.getDocs)(i);if(o.empty)return console.log("\u26a0\ufe0f [RollingQueueService] No waiting entries for AA: ".concat(e)),null;const l=o.docs[0],c=l.data(),d={id:l.id,academic_associate_id:c.academic_associate_id,student_id:c.student_id,session_id:c.session_id,position:c.position,status:c.status,campus:c.campus,priority:c.priority,added_at:(null===(t=c.added_at)||void 0===t?void 0:t.toDate())||new Date,started_at:null===(n=c.started_at)||void 0===n?void 0:n.toDate(),completed_at:null===(r=c.completed_at)||void 0===r?void 0:r.toDate(),cancelled_at:null===(a=c.cancelled_at)||void 0===a?void 0:a.toDate(),notes:c.notes,updated_at:(null===(s=c.updated_at)||void 0===s?void 0:s.toDate())||new Date};return console.log("\u2705 [RollingQueueService] Next in queue for AA ".concat(e,": Position ").concat(d.position)),d}catch(i){throw console.error("\u274c [RollingQueueService] Error fetching next entry:",i),i}}static async getCurrentEntryForAA(e){try{var t,n,r,a,s;const i=(0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("academic_associate_id","==",e),(0,kt._M)("status","==","in_progress"),(0,kt.orderBy)("position","asc")),o=await(0,kt.getDocs)(i);if(o.empty)return null;const l=o.docs[0],c=l.data();return{id:l.id,academic_associate_id:c.academic_associate_id,student_id:c.student_id,session_id:c.session_id,position:c.position,status:c.status,campus:c.campus,priority:c.priority,added_at:(null===(t=c.added_at)||void 0===t?void 0:t.toDate())||new Date,started_at:null===(n=c.started_at)||void 0===n?void 0:n.toDate(),completed_at:null===(r=c.completed_at)||void 0===r?void 0:r.toDate(),cancelled_at:null===(a=c.cancelled_at)||void 0===a?void 0:a.toDate(),notes:c.notes,updated_at:(null===(s=c.updated_at)||void 0===s?void 0:s.toDate())||new Date}}catch(i){throw console.error("\u274c [RollingQueueService] Error fetching current entry:",i),i}}static async advanceQueue(e){try{const t=(0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("session_id","==",e)),n=await(0,kt.getDocs)(t);if(n.empty)return void console.warn("\u26a0\ufe0f [RollingQueueService] No queue entry found for session: ".concat(e));const r=n.docs[0],a=r.data(),s=a.academic_associate_id,i=a.position,o=(0,kt.wP)(Nt.db);o.update(r.ref,{status:"completed",completed_at:kt.Timestamp.now(),updated_at:kt.Timestamp.now()});const l=(0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("academic_associate_id","==",s),(0,kt._M)("position","==",i+1)),c=await(0,kt.getDocs)(l);if(c.empty)console.log("\u2139\ufe0f [RollingQueueService] No next entry in queue for AA ".concat(s," after position ").concat(i));else{const e=c.docs[0];o.update(e.ref,{status:"in_progress",started_at:kt.Timestamp.now(),updated_at:kt.Timestamp.now()}),console.log("\u2705 [RollingQueueService] Advanced queue for AA ".concat(s,": Position ").concat(i," completed, Position ").concat(i+1," started"))}await o.commit()}catch(t){throw console.error("\u274c [RollingQueueService] Error advancing queue:",t),t}}static async removeFromQueue(e){try{const t=(0,kt.H9)(Nt.db,this.COLLECTION,e),n=await(0,kt.x7)(t);if(!n.exists())throw new Error("Queue entry not found: ".concat(e));const r=n.data(),a=r.academic_associate_id,s=r.position,i=(0,kt.wP)(Nt.db);i.delete(t);const o=await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("academic_associate_id","==",a),(0,kt._M)("position",">",s)));o.forEach(e=>{const t=e.data().position;i.update(e.ref,{position:t-1,updated_at:kt.Timestamp.now()})}),await i.commit(),console.log("\u2705 [RollingQueueService] Removed entry from queue and reordered ".concat(o.size," remaining entries"))}catch(t){throw console.error("\u274c [RollingQueueService] Error removing from queue:",t),t}}static async reorderQueue(e,t){try{const n=(0,kt.H9)(Nt.db,this.COLLECTION,e),r=await(0,kt.x7)(n);if(!r.exists())throw new Error("Queue entry not found: ".concat(e));const a=r.data(),s=a.academic_associate_id,i=a.position,o=(0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("academic_associate_id","==",s),(0,kt.orderBy)("position","asc")),l=await(0,kt.getDocs)(o);if(t<1||t>l.size)throw new Error("Invalid position: ".concat(t,". Queue size: ").concat(l.size));const c=(0,kt.wP)(Nt.db);i<t?l.forEach(e=>{const n=e.data().position;n>i&&n<=t&&c.update(e.ref,{position:n-1,updated_at:kt.Timestamp.now()})}):i>t&&l.forEach(e=>{const n=e.data().position;n>=t&&n<i&&c.update(e.ref,{position:n+1,updated_at:kt.Timestamp.now()})}),c.update(n,{position:t,updated_at:kt.Timestamp.now()}),await c.commit(),console.log("\u2705 [RollingQueueService] Reordered entry ".concat(e," from position ").concat(i," to ").concat(t))}catch(n){throw console.error("\u274c [RollingQueueService] Error reordering queue:",n),n}}static async requeueSession(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};try{var s,i;const o=null!==(s=a.priority)&&void 0!==s?s:"medium";if(!(null===(i=a.toTop)||void 0===i||i))return await this.createQueueEntry(e,t,n,r,o);const l=await this.getCurrentEntryForAA(n),c=l?l.position+1:1,d=(0,kt.wP)(Nt.db),u=(0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("academic_associate_id","==",n),(0,kt.orderBy)("position","asc"));(await(0,kt.getDocs)(u)).forEach(e=>{const t=e.data().position;t>=c&&d.update(e.ref,{position:t+1,updated_at:kt.Timestamp.now()})});const h=(0,kt.H9)((0,kt.collection)(Nt.db,this.COLLECTION));return d.set(h,{academic_associate_id:n,student_id:t,session_id:e,position:c,status:"waiting",campus:r,priority:o,added_at:kt.Timestamp.now(),updated_at:kt.Timestamp.now()}),await d.commit(),console.log("\u2705 [RollingQueueService] Requeued session ".concat(e," for AA ").concat(n," at position ").concat(c)),h.id}catch(o){throw console.error("\u274c [RollingQueueService] Error requeuing session:",o),o}}static async getQueueStats(e){try{const t=await this.getQueueForAA(e),n=t.filter(e=>"waiting"===e.status).length,r=t.filter(e=>"in_progress"===e.status).length,a=t.filter(e=>"completed"===e.status).length,s=t.find(e=>"in_progress"===e.status),i=t.filter(e=>"waiting"===e.status);let o;if(i.length>0){const e=i.reduce((e,t)=>e+((new Date).getTime()-t.added_at.getTime()),0);o=Math.round(e/i.length/6e4)}const l={academic_associate_id:e,total_waiting:n,total_in_progress:r,total_completed:a,queue_length:t.length,avg_wait_time_minutes:o,current_session:s};return console.log("\u2705 [RollingQueueService] Queue stats for AA ".concat(e,":"),l),l}catch(t){throw console.error("\u274c [RollingQueueService] Error fetching queue stats:",t),t}}static async getQueueStatusByCampus(e){try{const t=await rn.getAssignments({campus:e}),n=new Set(t.map(e=>e.academic_associate_id)),r=Array.from(n),a=await Promise.all(r.map(e=>this.getQueueStats(e)));return console.log("\u2705 [RollingQueueService] Retrieved queue status for ".concat(a.length," AAs in campus: ").concat(e)),a}catch(t){throw console.error("\u274c [RollingQueueService] Error fetching queue status by campus:",t),t}}static async getMaxPositionForAA(e){try{const t=(0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("academic_associate_id","==",e),(0,kt.orderBy)("position","desc")),n=await(0,kt.getDocs)(t);return n.empty?0:n.docs[0].data().position}catch(t){throw console.error("\u274c [RollingQueueService] Error getting max position:",t),t}}static async getQueueEntryById(e){try{var t,n,r,a,s;const i=(0,kt.H9)(Nt.db,this.COLLECTION,e),o=await(0,kt.x7)(i);if(!o.exists())return null;const l=o.data();return{id:o.id,academic_associate_id:l.academic_associate_id,student_id:l.student_id,session_id:l.session_id,position:l.position,status:l.status,campus:l.campus,priority:l.priority,added_at:(null===(t=l.added_at)||void 0===t?void 0:t.toDate())||new Date,started_at:null===(n=l.started_at)||void 0===n?void 0:n.toDate(),completed_at:null===(r=l.completed_at)||void 0===r?void 0:r.toDate(),cancelled_at:null===(a=l.cancelled_at)||void 0===a?void 0:a.toDate(),notes:l.notes,updated_at:(null===(s=l.updated_at)||void 0===s?void 0:s.toDate())||new Date}}catch(i){throw console.error("\u274c [RollingQueueService] Error fetching entry:",i),i}}static async clearCompletedForAA(e){try{const t=(0,kt.query)((0,kt.collection)(Nt.db,this.COLLECTION),(0,kt._M)("academic_associate_id","==",e),(0,kt._M)("status","==","completed")),n=await(0,kt.getDocs)(t),r=(0,kt.wP)(Nt.db);return n.forEach(e=>{r.delete(e.ref)}),await r.commit(),console.log("\u2705 [RollingQueueService] Cleared ".concat(n.size," completed entries for AA ").concat(e)),n.size}catch(t){throw console.error("\u274c [RollingQueueService] Error clearing completed entries:",t),t}}}an.COLLECTION="rolling_queues";var sn=n(9390);class on extends _t.B{static async createPhase(e){try{return await this.create(_t.I.PHASES,e)}catch(t){throw console.error("Error creating phase:",t),t}}static async getAllPhases(){try{const{queryCache:e,CACHE_TTL:t}=await Promise.resolve().then(n.bind(n,9390));return await e.get("all-phases",async()=>(await this.getAll(_t.I.PHASES)).sort((e,t)=>e.order-t.order),t.LONG)}catch(e){throw console.error("Error fetching all phases:",e),e}}static async getPhaseById(e){try{return await this.getById(_t.I.PHASES,e)}catch(t){throw console.error("Error fetching phase by ID:",t),t}}static async updatePhase(e,t){try{return await this.update(_t.I.PHASES,e,t)}catch(n){throw console.error("Error updating phase:",n),n}}static async deletePhase(e){try{return await this.delete(_t.I.PHASES,e)}catch(t){throw console.error("Error deleting phase:",t),t}}}class ln extends _t.B{static async createTopic(e){try{return await this.create(_t.I.TOPICS,e)}catch(t){throw console.error("Error creating topic:",t),t}}static async getTopicsByPhase(e){try{const{queryCache:t,CACHE_TTL:r}=await Promise.resolve().then(n.bind(n,9390));return await t.get("topics-phase-".concat(e),async()=>(await this.getWhere(_t.I.TOPICS,"phase_id","==",e)).sort((e,t)=>e.order-t.order),r.LONG)}catch(t){throw console.error("Error fetching topics by phase:",t),t}}static async getTopicById(e){try{return await this.getById(_t.I.TOPICS,e)}catch(t){throw console.error("Error fetching topic by ID:",t),t}}static async updateTopic(e,t){try{return await this.update(_t.I.TOPICS,e,t)}catch(n){throw console.error("Error updating topic:",n),n}}static async deleteTopic(e){try{return await this.delete(_t.I.TOPICS,e)}catch(t){throw console.error("Error deleting topic:",t),t}}}class cn extends _t.B{static async getAllGoals(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{return await this.getAll(_t.I.DAILY_GOALS,"created_at","desc",e)}catch(t){throw console.error("Error fetching all goals:",t),t}}static async createGoal(e){try{const t=await this.create(_t.I.DAILY_GOALS,e);return sn.queryCache.invalidate("goals:student:".concat(e.student_id)),t}catch(t){throw console.error("Error creating goal:",t),t}}static async getGoalsByStudent(e,t){try{return await sn.queryCache.get("goals:student:".concat(e),async()=>{const n=(await this.getWhere(_t.I.DAILY_GOALS,"student_id","==",e)).sort((e,t)=>t.created_at.getTime()-e.created_at.getTime());return t?n.slice(0,t):n},sn.CACHE_TTL.SHORT)}catch(n){throw console.error("Error fetching goals by student:",n),n}}static async getTodaysGoal(e){try{const t=new Date,r=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0,0)),a=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+1,0,0,0,0)),{Timestamp:s}=await Promise.resolve().then(n.bind(n,6667)),i=s.fromDate(r),o=s.fromDate(a),l=(await this.getGoalsByStudent(e)).filter(e=>{const t=e.created_at,n=t.toMillis?t.toMillis():t.getTime(),r=i.toMillis(),a=o.toMillis();return n>=r&&n<a});return l.length>0?l[0]:null}catch(t){throw console.error("Error fetching today's goal:",t),t}}static async getPendingGoalsForMentor(e){try{return await this.getWhere(_t.I.DAILY_GOALS,"status","==","pending")}catch(t){throw console.error("Error fetching pending goals for mentor:",t),t}}static async updateGoal(e,t){try{return await this.update(_t.I.DAILY_GOALS,e,t)}catch(n){throw console.error("Error updating goal:",n),n}}static async reviewGoal(e,t,r,a){try{const{canReviewGoal:s}=await n.e(423).then(n.bind(n,5423)),{UserService:i}=await Promise.resolve().then(n.bind(n,2970)),l=await this.getById(_t.I.DAILY_GOALS,e);if(!l)throw new Error("Goal not found");const c=await i.getUserById(t);if(!c)throw new Error("Reviewer not found");console.log("\ud83d\udd0d Checking goal review permissions:",{reviewerId:c.id,reviewerName:c.name,reviewerRole:c.role,isAdmin:c.isAdmin,campus:c.campus,goalId:l.id,studentId:l.student_id});if(!await s(c,l))throw console.error("\u274c Permission denied for goal review:",{reviewerId:c.id,reviewerRole:c.role,goalStudentId:l.student_id}),new Error("You do not have permission to review this goal");return console.log("\u2705 Permission granted for goal review"),await this.updateGoal(e,(0,o.A)({status:r,reviewed_by:t,reviewed_at:new Date},a?{mentor_comment:a}:{}))}catch(s){throw console.error("Error reviewing goal:",s),s}}static async getGoalsByTopicAndStudent(e,t){try{return(await this.getGoalsByStudent(t)).filter(t=>t.topic_id===e)}catch(n){throw console.error("Error fetching goals by topic and student:",n),n}}}class dn extends _t.B{static async getAllReflections(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{return await this.getAll(_t.I.DAILY_REFLECTIONS,"created_at","desc",e)}catch(t){throw console.error("Error fetching all reflections:",t),t}}static async createReflection(e){try{const t=await this.create(_t.I.DAILY_REFLECTIONS,e);return sn.queryCache.invalidate("reflections:student:".concat(e.student_id)),t}catch(t){throw console.error("Error creating reflection:",t),t}}static async getReflectionsByStudent(e){try{return await sn.queryCache.get("reflections:student:".concat(e),async()=>(await this.getWhere(_t.I.DAILY_REFLECTIONS,"student_id","==",e)).sort((e,t)=>t.created_at.getTime()-e.created_at.getTime()),sn.CACHE_TTL.SHORT)}catch(t){throw console.error("Error fetching reflections by student:",t),t}}static async getReflectionByGoal(e){try{const t=await this.getWhere(_t.I.DAILY_REFLECTIONS,"goal_id","==",e);return t.length>0?t[0]:null}catch(t){throw console.error("Error fetching reflection by goal:",t),t}}static async getPendingReflectionsForMentor(e){try{return await this.getWhere(_t.I.DAILY_REFLECTIONS,"status","==","pending")}catch(t){throw console.error("Error fetching pending reflections for mentor:",t),t}}static async updateReflection(e,t){try{return await this.update(_t.I.DAILY_REFLECTIONS,e,t)}catch(n){throw console.error("Error updating reflection:",n),n}}static async reviewReflection(e,t,r,a,s){try{const{canReviewReflection:i}=await n.e(423).then(n.bind(n,5423)),{UserService:o}=await Promise.resolve().then(n.bind(n,2970)),l=await this.getById(_t.I.DAILY_REFLECTIONS,e);if(!l)throw new Error("Reflection not found");const c=await o.getUserById(t);if(!c)throw new Error("Reviewer not found");console.log("\ud83d\udd0d Checking reflection review permissions:",{reviewerId:c.id,reviewerName:c.name,reviewerRole:c.role,isAdmin:c.isAdmin,campus:c.campus,reflectionId:l.id,studentId:l.student_id});if(!await i(c,l))throw console.error("\u274c Permission denied for reflection review:",{reviewerId:c.id,reviewerRole:c.role,reflectionStudentId:l.student_id}),new Error("You do not have permission to review this reflection");console.log("\u2705 Permission granted for reflection review");const d={status:r,reviewed_by:t,reviewed_at:new Date,feedback_given_at:new Date};return"undefined"!==typeof a&&null!==a&&(d.mentor_notes=a),s&&(d.mentor_assessment=s),await this.updateReflection(e,d)}catch(i){throw console.error("Error reviewing reflection:",i),i}}static async markReflectionAsRead(e){try{return await this.updateReflection(e,{is_read_by_student:!0})}catch(t){throw console.error("Error marking reflection as read:",t),t}}}class un extends _t.B{static async markAttendance(e){try{const t=await this.getStudentAttendanceByDate(e.student_id,e.date);if(t)return await this.update(_t.I.ATTENDANCE,t.id,e),sn.queryCache.invalidate("attendance:student:".concat(e.student_id)),t.id;{const t=await this.create(_t.I.ATTENDANCE,e);return sn.queryCache.invalidate("attendance:student:".concat(e.student_id)),t}}catch(t){throw console.error("Error marking attendance:",t),t}}static async getStudentAttendanceByDate(e,t){try{const n=new Date(t);n.setHours(0,0,0,0);const r=new Date(t);r.setHours(23,59,59,999);return(await this.getStudentAttendance(e)).find(e=>{const t=e.date instanceof Date?e.date:new Date(e.date);return t>=n&&t<=r})||null}catch(n){throw console.error("Error fetching student attendance by date:",n),n}}static async getStudentAttendance(e,t,n){try{return await sn.queryCache.get("attendance:student:".concat(e),async()=>(await this.getWhere(_t.I.ATTENDANCE,"student_id","==",e)).sort((e,t)=>{const n=e.date instanceof Date?e.date:new Date(e.date);return(t.date instanceof Date?t.date:new Date(t.date)).getTime()-n.getTime()}),sn.CACHE_TTL.SHORT)}catch(r){throw console.error("Error fetching student attendance:",r),r}}static async updateAttendanceStatus(e,t,n,r){try{const a=await this.getStudentAttendanceByDate(e,t);if(a){const t=n&&r?"present":"absent";await this.update(_t.I.ATTENDANCE,a.id,{goal_reviewed:n,reflection_reviewed:r,present_status:t}),sn.queryCache.invalidate("attendance:student:".concat(e))}else{const a=n&&r?"present":"absent";await this.markAttendance({student_id:e,date:t,goal_reviewed:n,reflection_reviewed:r,present_status:a,created_at:new Date,updated_at:new Date})}}catch(a){throw console.error("Error updating attendance status:",a),a}}}class hn extends _t.B{static async createLeaveRequest(e){try{return await this.create(_t.I.LEAVE_REQUESTS,(0,o.A)((0,o.A)({},e),{},{status:"approved"}))}catch(t){throw console.error("Error creating leave request:",t),t}}static async getStudentLeaves(e){try{return(await this.getWhere(_t.I.LEAVE_REQUESTS,"student_id","==",e)).sort((e,t)=>{const n=e.start_date instanceof Date?e.start_date:new Date(e.start_date);return(t.start_date instanceof Date?t.start_date:new Date(t.start_date)).getTime()-n.getTime()})}catch(t){throw console.error("Error fetching student leaves:",t),t}}static async getLeavesByDateRange(e,t){try{return await this.getAll(_t.I.LEAVE_REQUESTS,"start_date","desc")}catch(n){throw console.error("Error fetching leaves by date range:",n),n}}}class mn extends _t.B{static async getCampusData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const r=Date.now(),a=this.campusCache[e];if(!t&&a&&a.lastFetched&&r-a.lastFetched<3e5)return a;if(t)try{sn.queryCache.invalidate("all-users")}catch(n){console.warn("Failed to invalidate all-users cache:",n)}const s=(await this.getAllUsers()).filter(t=>t.campus===e),i=s.map(e=>e.id),o=(await cn.getAllGoals()).filter(e=>i.includes(e.student_id)),l=(await dn.getAllReflections()).filter(e=>i.includes(e.student_id));return this.campusCache[e]={students:s,goals:o,reflections:l,lastFetched:r},this.campusCache[e]}catch(r){throw console.error("Error fetching campus data:",r),r}}static invalidateCampusCache(e){delete this.campusCache[e]}static async getAllUsers(){try{const{queryCache:e,CACHE_TTL:t}=await Promise.resolve().then(n.bind(n,9390));return await e.get("all-users",async()=>await this.getAll(_t.I.USERS,"created_at","desc"),t.MEDIUM)}catch(e){throw console.error("Error fetching all users:",e),e}}static async updateUserAdminStatus(e,t){try{await this.update(_t.I.USERS,e,{isAdmin:t,updated_at:new Date});const{queryCache:r}=await Promise.resolve().then(n.bind(n,9390));r.invalidate("all-users"),r.invalidate("all-mentors-with-capacity")}catch(r){throw console.error("Error updating user admin status:",r),r}}static async updateUserStatus(e,t){try{const n={status:t,updated_at:new Date};return n.unapproved_leave_start="unapproved_leave"===t?new Date:null,await this.update(_t.I.USERS,e,n)}catch(n){throw console.error("Error updating user status:",n),n}}static async updateUserRole(e,t){try{return await this.update(_t.I.USERS,e,{role:t,updated_at:new Date})}catch(n){throw console.error("Error updating user role:",n),n}}static async deleteUser(e){try{return await this.update(_t.I.USERS,e,{status:"inactive",deleted_at:new Date,updated_at:new Date})}catch(t){throw console.error("Error deleting user:",t),t}}static async permanentlyDeleteUser(e){try{return await this.delete(_t.I.USERS,e)}catch(t){throw console.error("Error permanently deleting user:",t),t}}static async assignMentor(e,t){try{await this.update(_t.I.USERS,e,{mentor_id:t,updated_at:new Date});const{UserService:r}=await Promise.resolve().then(n.bind(n,2970)),a=await r.getUserById(t);a&&!a.isMentor&&await r.updateUser(t,{isMentor:!0,updated_at:new Date});const{queryCache:s}=await Promise.resolve().then(n.bind(n,9390));s.invalidate("all-users"),s.invalidate("all-mentors-with-capacity")}catch(r){throw console.error("Error assigning mentor:",r),r}}static async getStudentsWithoutMentor(){try{return(await this.getAllUsers()).filter(e=>!e.mentor_id&&!e.isAdmin)}catch(e){throw console.error("Error getting students without mentor:",e),e}}static async getPotentialMentors(){try{return await this.getAllUsers()}catch(e){throw console.error("Error getting potential mentors:",e),e}}static async getStudentsByMentor(e){try{return await this.getWhere(_t.I.USERS,"mentor_id","==",e)}catch(t){throw console.error("Error getting students by mentor:",t),t}}static async getStudentCurrentPhase(e){try{const t=await cn.getGoalsByStudent(e,1);return t.length>0?t[0].phase_id:null}catch(t){throw console.error("Error getting student current phase:",t),t}}static async getSuggestedMentors(e){try{const t=await this.getStudentCurrentPhase(e);if(!t)return this.getPotentialMentors();const n=await on.getAllPhases(),r=n.find(e=>e.id===t);if(!r)return this.getPotentialMentors();const a=await this.getPotentialMentors(),s=await Promise.all(a.map(async e=>{const t=await this.getStudentCurrentPhase(e.id),r=t?n.find(e=>e.id===t):null;return(0,o.A)((0,o.A)({},e),{},{currentPhaseId:t,currentPhaseOrder:(null===r||void 0===r?void 0:r.order)||0,currentPhaseName:(null===r||void 0===r?void 0:r.name)||"Not Started"})}));return s.filter(e=>e.currentPhaseOrder>=r.order).sort((e,t)=>t.currentPhaseOrder-e.currentPhaseOrder)}catch(t){return console.error("Error getting suggested mentors:",t),this.getPotentialMentors()}}static async getStudentCurrentTopicAndPhase(e){try{const t=await cn.getGoalsByStudent(e,1);if(0===t.length)return null;const n=t[0],r=await ln.getTopicById(n.topic_id),a=await on.getPhaseById(n.phase_id);return r&&a?{topic:r.name,phase:a.name,topicId:r.id,phaseId:a.id}:null}catch(t){return console.error("Error getting student current topic and phase:",t),null}}}mn.campusCache={};class pn extends _t.B{static async getMentorCapacity(e){try{const{UserService:t}=await Promise.resolve().then(n.bind(n,2970)),r=await t.getUserById(e);if(!r)return null;const a=await t.getStudentsByMentor(e),s=r.isSuperMentor?999:r.max_mentees||2,i=a.length;return{mentor:r,current_mentees:i,max_mentees:s,available_slots:r.isSuperMentor?999:Math.max(0,s-i),mentee_names:a.map(e=>e.name)}}catch(t){return console.error("Error getting mentor capacity:",t),null}}static async getMentorsWithCapacityPaginated(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1?arguments[1]:void 0;try{console.log("\ud83d\udd0d MentorshipService: Loading paginated mentors (limit: ".concat(e,")..."));const{UserService:r}=await Promise.resolve().then(n.bind(n,2970)),{db:a}=await Promise.resolve().then(n.bind(n,1547)),{collection:s,query:i,orderBy:l,limit:c,startAfter:d,getDocs:u}=await Promise.resolve().then(n.bind(n,6667));let h=i(s(a,"users"),l("name","asc"),c(e+1));t&&(h=i(s(a,"users"),l("name","asc"),d(t),c(e+1)));const m=(await u(h)).docs,p=m.length>e,f=p?m.slice(0,e):m,g=f.length>0?f[f.length-1]:null;console.log("\ud83d\udccb MentorshipService: Fetched ".concat(f.length," users, hasMore: ").concat(p));const y=f.map(e=>(0,o.A)({id:e.id},e.data())),x=await Promise.all(y.map(async e=>{try{const t=await r.getStudentsByMentor(e.id),n=e.isSuperMentor?999:e.max_mentees||2,a=t.length;return{mentor:e,current_mentees:a,max_mentees:n,available_slots:e.isSuperMentor?999:Math.max(0,n-a),mentee_names:t.map(e=>e.name)}}catch(t){return console.warn("\u26a0\ufe0f MentorshipService: Error processing user ".concat(e.id,":"),t),{mentor:e,current_mentees:0,max_mentees:e.isSuperMentor?999:e.max_mentees||2,available_slots:e.isSuperMentor?999:e.max_mentees||2,mentee_names:[]}}}));return console.log("\u2705 MentorshipService: Processed ".concat(x.length," mentors with capacity")),{mentors:x,hasMore:p,lastDoc:g}}catch(r){throw console.error("\u274c MentorshipService: Error getting paginated mentors:",r),r}}static async getAllMentorsWithCapacity(){try{console.log("\ud83d\udd0d MentorshipService: Loading all mentors with capacity...");const{queryCache:e,CACHE_TTL:t}=await Promise.resolve().then(n.bind(n,9390)),{UserService:r}=await Promise.resolve().then(n.bind(n,2970));return await e.get("all-mentors-with-capacity",async()=>{console.log("\ud83d\udccb MentorshipService: Fetching all users...");const e=await r.getAll("users");console.log("\u2705 MentorshipService: Found ".concat(e.length," users"));const t=await Promise.all(e.map(async e=>{try{const t=await r.getStudentsByMentor(e.id),n=e.isSuperMentor?999:e.max_mentees||2,a=t.length;return{mentor:e,current_mentees:a,max_mentees:n,available_slots:e.isSuperMentor?999:Math.max(0,n-a),mentee_names:t.map(e=>e.name)}}catch(t){return console.warn("\u26a0\ufe0f MentorshipService: Error processing user ".concat(e.id,":"),t),{mentor:e,current_mentees:0,max_mentees:e.isSuperMentor?999:e.max_mentees||2,available_slots:e.isSuperMentor?999:e.max_mentees||2,mentee_names:[]}}}));return console.log("\u2705 MentorshipService: Processed ".concat(t.length," mentors with capacity")),t},t.MEDIUM)}catch(e){throw console.error("\u274c MentorshipService: Error getting mentors with capacity:",e),e}}static async getAvailableMentors(){try{return(await this.getAllMentorsWithCapacity()).filter(e=>e.available_slots>0)}catch(e){return console.error("Error getting available mentors:",e),[]}}static async requestMentorChange(e,t,r,a){try{console.log("\ud83d\udd27 MentorshipService.requestMentorChange called with:",{studentId:e,requestedMentorId:t,currentMentorId:r,reason:(null===a||void 0===a?void 0:a.substring(0,50))+"..."});const{UserService:s}=await Promise.resolve().then(n.bind(n,2970));console.log("\ud83d\udce5 Fetching student info...");const i=await s.getUserById(e);console.log("\ud83d\udce5 Fetching requested mentor info...");const o=await s.getUserById(t);console.log("\ud83d\udce5 Fetching current mentor info...");const l=r?await s.getUserById(r):null;if(!i||!o){const e="Student or requested mentor not found - student: ".concat(!!i,", requestedMentor: ").concat(!!o);throw console.error("\u274c",e),new Error(e)}console.log("\u2705 All user data fetched successfully");const c={student_id:e,student_name:i.name,student_email:i.email,requested_mentor_id:t,requested_mentor_name:o.name,status:"pending",created_at:new Date};r&&(c.current_mentor_id=r),null!==l&&void 0!==l&&l.name&&(c.current_mentor_name=l.name),a&&(c.reason=a),console.log("\ud83d\udcbe Creating mentor request document...",c);const d=await this.create(this.MENTOR_REQUESTS_COLLECTION,c);return console.log("\u2705 Request document created with ID:",d),console.log("\ud83d\udd04 Updating student pending_mentor_id..."),await s.updateUser(e,{pending_mentor_id:t}),console.log("\u2705 Student updated successfully"),console.log("\ud83c\udf89 Mentor change request completed successfully"),d}catch(s){throw console.error("\u274c MentorshipService.requestMentorChange error:",s),s}}static async getPendingMentorRequests(){try{return await this.getWhere(this.MENTOR_REQUESTS_COLLECTION,"status","==","pending")}catch(e){return console.error("Error getting pending requests:",e),[]}}static async getStudentMentorRequests(e){try{return await this.getWhere(this.MENTOR_REQUESTS_COLLECTION,"student_id","==",e)}catch(t){return console.error("Error getting student requests:",t),[]}}static async approveMentorRequest(e,t,r,a){try{const{UserService:s}=await Promise.resolve().then(n.bind(n,2970)),i=await this.getById(this.MENTOR_REQUESTS_COLLECTION,e);if(!i)throw new Error("Request not found");if("pending"!==i.status)throw new Error("Request is not pending");const o=await this.getMentorCapacity(i.requested_mentor_id);if(!o||o.available_slots<=0)throw new Error("Mentor has no available slots");if("super_mentor"===r){if(!(await s.getAssignedMentees(t)).includes(i.student_id))throw new Error("Super mentor can only approve requests for their assigned mentees")}else if("academic_associate"===r){const e=await s.getUserById(t),n=await s.getUserById(i.student_id);if(null===e||void 0===e||!e.campus||null===n||void 0===n||!n.campus||e.campus!==n.campus)throw new Error("Academic associate can only approve requests for students on their campus")}else if("admin"!==r)throw new Error("Only academic associate or higher can approve mentor change requests");const l={status:"approved",reviewed_at:new Date,reviewed_by:t};a&&(l.admin_notes=a),await this.update(this.MENTOR_REQUESTS_COLLECTION,e,l),await s.updateUser(i.student_id,{mentor_id:i.requested_mentor_id,pending_mentor_id:""})}catch(s){throw console.error("Error approving mentor request:",s),s}}static async rejectMentorRequest(e,t,r,a){try{const{UserService:s}=await Promise.resolve().then(n.bind(n,2970)),i=await this.getById(this.MENTOR_REQUESTS_COLLECTION,e);if(!i)throw new Error("Request not found");if("pending"!==i.status)throw new Error("Request is not pending");if("super_mentor"===r){if(!(await s.getAssignedMentees(t)).includes(i.student_id))throw new Error("Super mentor can only reject requests for their assigned mentees")}else if("academic_associate"===r){const e=await s.getUserById(t),n=await s.getUserById(i.student_id);if(null===e||void 0===e||!e.campus||null===n||void 0===n||!n.campus||e.campus!==n.campus)throw new Error("Academic associate can only reject requests for students on their campus")}else if("admin"!==r)throw new Error("Only academic associate or higher can reject mentor change requests");const o={status:"rejected",reviewed_at:new Date,reviewed_by:t};a&&(o.admin_notes=a),await this.update(this.MENTOR_REQUESTS_COLLECTION,e,o),await s.updateUser(i.student_id,{pending_mentor_id:""})}catch(s){throw console.error("Error rejecting mentor request:",s),s}}static async cancelMentorRequest(e,t){try{const{UserService:r}=await Promise.resolve().then(n.bind(n,2970)),a=await this.getById(this.MENTOR_REQUESTS_COLLECTION,e);if(!a)throw new Error("Request not found");if(a.student_id!==t)throw new Error("Unauthorized");if("pending"!==a.status)throw new Error("Only pending requests can be cancelled");await this.delete(this.MENTOR_REQUESTS_COLLECTION,e),await r.updateUser(t,{pending_mentor_id:void 0})}catch(r){throw console.error("Error cancelling mentor request:",r),r}}}pn.MENTOR_REQUESTS_COLLECTION="mentor_requests";class fn extends _t.B{static async getAllPhaseTimelines(){return sn.queryCache.get("phase_timelines:all",async()=>{try{return(await this.getAll("phase_timelines")).sort((e,t)=>{var n,r;const a=null===(n=e.phaseName.match(/Phase (\d+)/))||void 0===n?void 0:n[1],s=null===(r=t.phaseName.match(/Phase (\d+)/))||void 0===r?void 0:r[1];return a&&s?parseInt(a)-parseInt(s):e.phaseName.localeCompare(t.phaseName)})}catch(e){throw console.error("Error fetching phase timelines:",e),e}},sn.CACHE_TTL.LONG)}static async getPhaseTimelineByPhaseId(e){try{return(await this.getWhere("phase_timelines","phaseId","==",e))[0]||null}catch(t){throw console.error("Error fetching phase timeline by phase ID:",t),t}}static async savePhaseTimelines(e,t){try{const n=await this.getAll("phase_timelines");for(const e of n)await this.delete("phase_timelines",e.id);for(const r of e)await this.create("phase_timelines",(0,o.A)((0,o.A)({},r),{},{updatedAt:new Date,updatedBy:t}))}catch(n){throw console.error("Error saving phase timelines:",n),n}}static async updatePhaseTimeline(e,t,n){try{const r=await this.getPhaseTimelineByPhaseId(e);if(r)await this.update("phase_timelines",r.id,(0,o.A)((0,o.A)({},t),{},{updatedAt:new Date,updatedBy:n}));else{const r=await on.getPhaseById(e);r&&await this.create("phase_timelines",{phaseId:e,phaseName:r.name,expectedDays:t.expectedDays||null,isStandalone:t.isStandalone||!1,updatedAt:new Date,updatedBy:n})}sn.queryCache.invalidatePattern("phase_timelines")}catch(r){throw console.error("Error updating phase timeline:",r),r}}}class gn extends _t.B{static async createReview(e){try{console.log("\ud83d\udcbe [MenteeReviewService] Creating review with data:",e);const t=await this.create(_t.I.MENTEE_REVIEWS,e);console.log("\ud83d\udcbe [MenteeReviewService] Review created with ID:",t);const n=await this.getById(_t.I.MENTEE_REVIEWS,t);if(!n)throw new Error("Failed to retrieve created review");return n}catch(t){throw console.error("Error creating mentee review:",t),t}}static async getReviewsByStudent(e){try{return await this.getWhere(_t.I.MENTEE_REVIEWS,"student_id","==",e)}catch(t){throw console.error("Error fetching mentee reviews by student:",t),t}}static async getReviewsByMentor(e){try{return await this.getWhere(_t.I.MENTEE_REVIEWS,"mentor_id","==",e)}catch(t){throw console.error("Error fetching mentee reviews by mentor:",t),t}}static async getLatestReview(e){try{console.log("\ud83d\udd0d [MenteeReviewService] Fetching reviews for student:",e);const t=await this.getWhere(_t.I.MENTEE_REVIEWS,"student_id","==",e);if(console.log("\ud83d\udd0d [MenteeReviewService] Found reviews:",t.length,t),0===t.length)return null;const n=t.sort((e,t)=>t.created_at.getTime()-e.created_at.getTime());return console.log("\ud83d\udd0d [MenteeReviewService] Latest review:",n[0]),n[0]}catch(t){throw console.error("Error fetching latest mentee review:",t),t}}static async getWeeklyReviews(e){try{const t=new Date(e);return t.setDate(e.getDate()+7),await this.getWhereCompound(_t.I.MENTEE_REVIEWS,[{field:"week_start",operator:">=",value:e},{field:"week_start",operator:"<",value:t}],"created_at","desc")}catch(t){throw console.error("Error fetching weekly mentee reviews:",t),t}}static async hasSubmittedThisWeek(e,t,n){try{console.log("\ud83d\udd0d [MenteeReviewService] Checking for existing review:",{studentId:e,mentorId:t,weekStart:n.toISOString()});const r=await this.getWhereCompound(_t.I.MENTEE_REVIEWS,[{field:"student_id",operator:"==",value:e},{field:"mentor_id",operator:"==",value:t},{field:"week_start",operator:"==",value:n}]);return console.log("\ud83d\udd0d [MenteeReviewService] Found existing reviews:",r.length),r.length>0}catch(r){throw console.error("Error checking for existing mentee review:",r),r}}}class yn extends _t.B{static async createReview(e){try{console.log("\ud83d\udcbe [MentorReviewService] Creating review with data:",e);const t=await this.create(_t.I.MENTOR_REVIEWS,e);console.log("\ud83d\udcbe [MentorReviewService] Review created with ID:",t);const n=await this.getById(_t.I.MENTOR_REVIEWS,t);if(!n)throw new Error("Failed to retrieve created review");return n}catch(t){throw console.error("Error creating mentor review:",t),t}}static async getReviewsByMentor(e){try{return await this.getWhere(_t.I.MENTOR_REVIEWS,"mentor_id","==",e)}catch(t){throw console.error("Error fetching mentor reviews by mentor:",t),t}}static async getReviewsByStudent(e){try{return await this.getWhere(_t.I.MENTOR_REVIEWS,"student_id","==",e)}catch(t){throw console.error("Error fetching mentor reviews by student:",t),t}}static async getLatestReview(e,t){try{let n;if(n=t?await this.getWhereCompound(_t.I.MENTOR_REVIEWS,[{field:"mentor_id",operator:"==",value:e},{field:"student_id",operator:"==",value:t}]):await this.getReviewsByMentor(e),0===n.length)return null;const r=n.sort((e,t)=>t.created_at.getTime()-e.created_at.getTime());return r[0]}catch(n){throw console.error("Error fetching latest mentor review:",n),n}}static async getWeeklyReviews(e){try{const t=new Date(e);return t.setDate(e.getDate()+7),await this.getWhereCompound(_t.I.MENTOR_REVIEWS,[{field:"week_start",operator:">=",value:e},{field:"week_start",operator:"<",value:t}],"created_at","desc")}catch(t){throw console.error("Error fetching weekly mentor reviews:",t),t}}static async hasSubmittedThisWeek(e,t,n){try{console.log("\ud83d\udd0d [MentorReviewService] Checking for existing review:",{mentorId:e,studentId:t,weekStart:n.toISOString()});const r=await this.getWhereCompound(_t.I.MENTOR_REVIEWS,[{field:"mentor_id",operator:"==",value:e},{field:"student_id",operator:"==",value:t},{field:"week_start",operator:"==",value:n}]);return console.log("\ud83d\udd0d [MentorReviewService] Found existing reviews:",r.length),r.length>0}catch(r){throw console.error("Error checking for existing mentor review:",r),r}}static async getAllReviewsByCampus(e){try{const{UserService:t}=await Promise.resolve().then(n.bind(n,2970)),r=await this.getAll(_t.I.MENTOR_REVIEWS),a=new Set(r.map(e=>e.mentor_id)),s=Array.from(a),i=await Promise.all(s.map(e=>t.getUserById(e))),o=new Map(i.map(e=>[null===e||void 0===e?void 0:e.id,null===e||void 0===e?void 0:e.campus]));return r.filter(t=>o.get(t.mentor_id)===e)}catch(t){throw console.error("Error fetching mentor reviews by campus:",t),t}}}class xn extends _t.B{static async createSession(e){try{return await this.create(_t.I.PAIR_PROGRAMMING_SESSIONS,e)}catch(t){throw console.error("Error creating pair programming session:",t),t}}static async getSessionById(e){try{return await this.getById(_t.I.PAIR_PROGRAMMING_SESSIONS,e)}catch(t){throw console.error("Error fetching session by ID:",t),t}}static async updateSession(e,t){try{await this.update(_t.I.PAIR_PROGRAMMING_SESSIONS,e,(0,o.A)((0,o.A)({},t),{},{updated_at:new Date}))}catch(n){throw console.error("Error updating session:",n),n}}static async getSessionsByUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";try{const n=await this.getWhere(_t.I.PAIR_PROGRAMMING_SESSIONS,"student_id","==",e),r=await this.getWhere(_t.I.PAIR_PROGRAMMING_SESSIONS,"mentor_id","==",e);let a=[...n,...r];return"mentee"===t?a=a.filter(t=>t.student_id===e):"mentor"===t&&(a=a.filter(t=>t.mentor_id===e)),a.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime())}catch(n){throw console.error("Error fetching sessions by user:",n),n}}static async getPendingSessions(){try{return await this.getWhere(_t.I.PAIR_PROGRAMMING_SESSIONS,"status","in",["pending","assigned"])}catch(e){throw console.error("Error fetching pending sessions:",e),e}}static async getOpenRequests(){try{return await this.getWhere(_t.I.PAIR_PROGRAMMING_SESSIONS,"mentor_id","==",null)}catch(e){throw console.error("Error fetching open requests:",e),e}}static async assignMentorToSession(e,t){try{const r=await this.getSessionById(e);if(!r)throw new Error("Session ".concat(e," not found"));const a=await _t.UserService.getUserById(t);if(!a)throw new Error("Mentor ".concat(t," not found"));await this.updateSession(e,{mentor_id:t,status:"assigned",assigned_at:new Date});try{await an.createQueueEntry(e,r.student_id,t,a.campus||"default","medium"),console.log("[Queue] Created queue entry for session ".concat(e,", mentor ").concat(t))}catch(n){console.error("[Queue] Error creating queue entry:",n)}}catch(r){throw console.error("Error assigning mentor to session:",r),r}}static async startSession(e){try{await this.updateSession(e,{status:"in_progress",started_at:new Date})}catch(t){throw console.error("Error starting session:",t),t}}static async completeSession(e){try{const n=await this.getSessionById(e);if(!n)throw new Error("Session ".concat(e," not found"));if(await this.updateSession(e,{status:"completed",completed_at:new Date}),n.mentor_id)try{await an.advanceQueue(e),console.log("[Queue] Advanced queue for session ".concat(e,", mentor ").concat(n.mentor_id))}catch(t){console.error("[Queue] Error advancing queue:",t)}}catch(n){throw console.error("Error completing session:",n),n}}static async cancelSession(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{const a=await this.getSessionById(e);if(!a)throw new Error("Session ".concat(e," not found"));if(await this.updateSession(e,{status:"cancelled",cancelled_at:new Date,cancel_reason:t}),a.mentor_id&&!n)try{const n=(await an.getQueueForAA(a.mentor_id)).find(t=>t.session_id===e);n&&(await an.removeFromQueue(n.id),console.log("[Queue] Removed cancelled session ".concat(e," from queue for auto-requeue")));const r=await _t.UserService.getUserById(a.mentor_id),s=(null===r||void 0===r?void 0:r.campus)||"default",i=a.priority||"medium";await an.requeueSession(e,a.student_id,a.mentor_id,s,{priority:i,toTop:!0}),await this.updateSession(e,{status:"assigned",assigned_at:new Date,cancel_reason:t,updated_at:new Date}),console.log("[Queue] Auto-requeued cancelled session ".concat(e," with priority ").concat(i))}catch(r){console.error("[Queue] Error auto-requeuing cancelled session:",r)}else if(a.mentor_id&&n)try{const t=(await an.getQueueForAA(a.mentor_id)).find(t=>t.session_id===e);t&&(await an.removeFromQueue(t.id),console.log("[Queue] Removed cancelled session ".concat(e," from queue (no requeue)")))}catch(r){console.error("[Queue] Error removing from queue:",r)}}catch(a){throw console.error("Error cancelling session:",a),a}}static async cancelAndRequeueSession(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=await this.getSessionById(e);if(!r)throw new Error("Session ".concat(e," not found"));if(await this.cancelSession(e,t,!0),r.mentor_id)try{var a,s,i;const o=await _t.UserService.getUserById(r.mentor_id),l=(null===o||void 0===o?void 0:o.campus)||"default";await an.requeueSession(e,r.student_id,r.mentor_id,l,{priority:null!==(a=null!==(s=n.priority)&&void 0!==s?s:r.priority)&&void 0!==a?a:"medium",toTop:null===(i=n.toTop)||void 0===i||i}),await this.updateSession(e,{status:"assigned",assigned_at:new Date,cancel_reason:t,updated_at:new Date}),console.log("[Queue] Requeued cancelled session ".concat(e," with custom options:"),n)}catch(o){console.error("[Queue] Error requeuing session after cancellation:",o)}}static async setUserGoal(e){try{return await this.updateWhere(_t.I.PAIR_PROGRAMMING_GOALS,[{field:"user_id",operator:"==",value:e.user_id}],{is_active:!1}),await this.create(_t.I.PAIR_PROGRAMMING_GOALS,(0,o.A)((0,o.A)({},e),{},{is_active:!0}))}catch(t){throw console.error("Error setting user goal:",t),t}}static async getUserGoal(e){try{return(await this.getWhere(_t.I.PAIR_PROGRAMMING_GOALS,"user_id","==",e)).find(e=>e.is_active)||null}catch(t){throw console.error("Error fetching user goal:",t),t}}static async submitMentorFeedback(e){try{const t=await this.create(_t.I.MENTOR_FEEDBACK,(0,o.A)((0,o.A)({},e),{},{submitted_at:new Date}));return await this.checkAndCompleteSession(e.session_id),t}catch(t){throw console.error("Error submitting mentor feedback:",t),t}}static async submitMenteeFeedback(e){try{const t=await this.create(_t.I.MENTEE_FEEDBACK,(0,o.A)((0,o.A)({},e),{},{submitted_at:new Date}));return await this.checkAndCompleteSession(e.session_id),t}catch(t){throw console.error("Error submitting mentee feedback:",t),t}}static async getSessionFeedback(e){try{const[t]=await this.getWhere(_t.I.MENTOR_FEEDBACK,"session_id","==",e),[n]=await this.getWhere(_t.I.MENTEE_FEEDBACK,"session_id","==",e);return{mentorFeedback:t,menteeFeedback:n}}catch(t){throw console.error("Error fetching session feedback:",t),t}}static async checkAndCompleteSession(e){try{const{mentorFeedback:t,menteeFeedback:n}=await this.getSessionFeedback(e);t&&n&&(await this.create(_t.I.SESSION_COMPLETIONS,{session_id:e,mentor_feedback_id:t.id,mentee_feedback_id:n.id,is_completed:!0,completed_at:new Date}),await this.completeSession(e))}catch(t){throw console.error("Error checking session completion:",t),t}}static async getUserStats(e,t){try{const n=await this.getSessionsByUser(e,t),r=new Date,a=new Date(r.getTime()-6048e5),s=n.filter(e=>new Date(e.created_at)>=a);return{total_sessions_all_time:n.length,sessions_last_7_days:s.length,sessions_this_week:s.length,expected_sessions_this_week:0,pending_sessions:n.filter(e=>["pending","assigned"].includes(e.status)).length,overdue_sessions:0,mentees_with_overdue_sessions:0,average_sessions_per_mentee:"mentor"===t?0:n.length,average_sessions_per_mentor:"mentee"===t?0:n.length}}catch(n){throw console.error("Error fetching user stats:",n),n}}static async getSortedPendingSessions(){try{return(await this.getPendingSessions()).sort((e,t)=>{const n={urgent:4,high:3,medium:2,low:1},r=n[t.priority]-n[e.priority];return 0!==r?r:new Date(e.created_at).getTime()-new Date(t.created_at).getTime()})}catch(e){throw console.error("Error fetching sorted pending sessions:",e),e}}static async createSessionRequest(e){try{const n={student_id:e.student_id,mentor_id:void 0,topic:e.topic,description:e.description,status:"pending",session_type:"open_request",priority:e.priority,scheduled_date:void 0,scheduled_time:void 0,duration_minutes:e.duration_minutes,meeting_link:void 0,created_at:new Date,assigned_at:void 0,started_at:void 0,completed_at:void 0,cancelled_at:void 0,cancel_reason:void 0,updated_at:new Date},r=Object.fromEntries(Object.entries(n).filter(e=>{let[t,n]=e;return void 0!==n})),a=await this.create(_t.I.PAIR_PROGRAMMING_SESSIONS,r);try{const t=await _t.UserService.getUserById(e.student_id);if(null!==t&&void 0!==t&&t.campus){await nn.autoScheduleSession(a,t.campus,e.priority)?console.log("Session ".concat(a," auto-scheduled successfully")):console.log("Session ".concat(a," could not be auto-scheduled, remains pending"))}}catch(t){console.error("Error during auto-scheduling:",t)}return a}catch(n){throw console.error("Error creating session request:",n),n}}}class vn extends _t.B{static async createLeaveRequest(e){try{const t=await this.create(_t.I.LEAVE_REQUESTS,(0,o.A)((0,o.A)({},e),{},{status:e.status||"pending"}));if("approved"===e.status){const e=await this.getById(_t.I.LEAVE_REQUESTS,t);e&&await this.handleLeaveImpact(t,e)}return t}catch(t){throw console.error("Error creating leave request:",t),t}}static async getLeaveById(e){try{return await this.getById(_t.I.LEAVE_REQUESTS,e)}catch(t){throw console.error("Error fetching leave by ID:",t),t}}static async getUserLeaves(e){try{return await this.getWhere(_t.I.LEAVE_REQUESTS,"user_id","==",e)}catch(t){throw console.error("Error fetching user leaves:",t),t}}static async getActiveLeaves(){try{const e=new Date;return await this.getWhereCompound(_t.I.LEAVE_REQUESTS,[{field:"status",operator:"==",value:"approved"},{field:"start_date",operator:"<=",value:e},{field:"end_date",operator:">=",value:e}])}catch(e){throw console.error("Error fetching active leaves:",e),e}}static async updateLeaveStatus(e,t,n){try{const r={status:t,updated_at:new Date};if(n&&(r.approved_by=n,r.approved_at=new Date),await this.update(_t.I.LEAVE_REQUESTS,e,r),"approved"===t){const t=await this.getLeaveById(e);t&&await this.handleLeaveImpact(e,t)}}catch(r){throw console.error("Error updating leave status:",r),r}}static async handleLeaveImpact(e,t){try{const n=await this.getOverlappingSessions(t);n.length>0&&await this.create(_t.I.LEAVE_IMPACTS,{leave_id:e,affected_sessions:n.map(e=>e.id),reassignment_status:"pending"})}catch(n){throw console.error("Error handling leave impact:",n),n}}static async getOverlappingSessions(e){try{return await _t.B.getWhereCompound(_t.I.PAIR_PROGRAMMING_SESSIONS,[{field:"mentor_id",operator:"==",value:e.user_id},{field:"status",operator:"in",value:["scheduled","assigned"]},{field:"scheduled_date",operator:">=",value:e.start_date},{field:"scheduled_date",operator:"<=",value:e.end_date}])}catch(t){throw console.error("Error finding overlapping sessions:",t),t}}static async getLeavesToday(){try{const e=new Date;e.setHours(0,0,0,0);const t=new Date(e);t.setDate(t.getDate()+1);const n=(await this.getWhere(_t.I.LEAVE_REQUESTS,"status","==","approved")).filter(n=>{const r=n.start_date instanceof Date?n.start_date:new Date(n.start_date),a=n.end_date instanceof Date?n.end_date:new Date(n.end_date);return r<=t&&a>=e}),r=n.filter(e=>!0).length;return{mentors_on_leave:r,mentees_on_leave:n.filter(e=>!0).length,leave_details:n}}catch(e){throw console.error("Error fetching leaves today:",e),e}}}const bn={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_DISCORD_WEBHOOK_URL,wn={pre_reminder:3900150,morning_reminder:16096779,evening_reminder:15680580,overdue_escalation:10033947};async function jn(e){const t=[],n=qt();try{if(e.isMentor){const r=(0,kt.collection)(Nt.db,"users"),a=(0,kt.query)(r,(0,kt._M)("mentor_id","==",e.id)),s=await(0,kt.getDocs)(a);for(const i of s.docs){const r=(0,o.A)({id:i.id},i.data());await gn.hasSubmittedThisWeek(r.id,e.id,n)||t.push({user_id:r.id,user_name:r.name,role:"mentee"})}}if(e.mentor_id){if(!await yn.hasSubmittedThisWeek(e.id,e.mentor_id,n)){const n=(0,kt.collection)(Nt.db,"users"),r=(0,kt.query)(n,(0,kt._M)("__name__","==",e.mentor_id)),a=await(0,kt.getDocs)(r);if(!a.empty){const n=a.docs[0].data();t.push({user_id:e.mentor_id,user_name:n.name,role:"mentor"})}}}}catch(r){console.error("Error getting pending reviews:",r)}return t}class Nn{static async sendReminder(e,t,n,r){try{const a=await async function(e,t){try{const n=new Date;n.setHours(0,0,0,0);const r=(0,kt.collection)(Nt.db,"review_reminders"),a=(0,kt.query)(r,(0,kt._M)("user_id","==",e),(0,kt._M)("reminder_type","==",t),(0,kt._M)("created_at",">=",kt.Timestamp.fromDate(n)),(0,kt.limit)(1));return!(await(0,kt.getDocs)(a)).empty}catch(n){return console.error("Error checking reminder history:",n),!1}}(e.id,t);if(a)return console.log("\u23ed\ufe0f User ".concat(e.name," already reminded today, skipping...")),!1;const s=[],i=e.notification_preferences||{};if(!1!==i.in_app&&s.push("in_app"),!1!==i.discord&&e.discord_user_id&&bn&&s.push("discord"),!1!==i.email&&e.email&&s.push("email"),0===s.length)return console.log("No notification channels enabled for ".concat(e.name)),!1;const l={user_id:e.id,user_name:e.name,reminder_type:t,channels:s,pending_reviews:n,status:"pending",created_at:new Date},c=(await Promise.allSettled([s.includes("in_app")?this.sendInAppNotification(e,t,n,r):Promise.resolve(!0),s.includes("discord")?this.sendDiscordNotification(e,t,n,r):Promise.resolve(!0),s.includes("email")?this.sendEmailNotification(e,t,n,r):Promise.resolve(!0)])).some(e=>"fulfilled"===e.status&&!0===e.value);return c?(l.status="sent",l.sent_at=new Date):(l.status="failed",l.failed_reason="All channels failed"),await(0,kt.gS)((0,kt.collection)(Nt.db,"review_reminders"),(0,o.A)((0,o.A)({},l),{},{created_at:kt.Timestamp.fromDate(l.created_at),sent_at:l.sent_at?kt.Timestamp.fromDate(l.sent_at):null})),console.log("\u2705 Reminder sent to ".concat(e.name," via ").concat(s.join(", "))),!0}catch(a){return console.error("Error sending reminder to ".concat(e.name,":"),a),!1}}static async sendInAppNotification(e,t,n,r){try{const a=function(e,t,n,r){const a=n.length,s=n.slice(0,3).map(e=>e.user_name).join(", "),i=a>3?" +".concat(a-3," more"):"";switch(t){case"pre_reminder":return"\ud83d\udd14 **Review Reminder**\n\nHi ".concat(e,"! Your weekly reviews are **due tomorrow (Monday) by 11:59 PM**.\n\n**Pending reviews (").concat(a,"):** ").concat(s).concat(i,"\n\nPlease complete them before the deadline!");case"morning_reminder":return"\u2600\ufe0f **Morning Reminder**\n\nGood morning ".concat(e,"! Your reviews are **DUE TODAY by 11:59 PM**.\n\n**Pending reviews (").concat(a,"):** ").concat(s).concat(i,"\n\nDon't forget to submit them before the deadline!");case"evening_reminder":return"\u26a0\ufe0f **Final Reminder**\n\nHi ".concat(e,", you have **3 hours left** to submit your reviews (deadline: 11:59 PM tonight).\n\n**Still pending (").concat(a,"):** ").concat(s).concat(i,"\n\nPlease complete them now to avoid being overdue!");case"overdue_escalation":return"\ud83d\udea8 **OVERDUE ALERT**\n\n".concat(e,", your reviews are now **").concat(r," day").concat(r>1?"s":""," overdue**!\n\n**Overdue reviews (").concat(a,"):** ").concat(s).concat(i,"\n\nPlease submit them immediately. Contact your mentor/admin if you need help.");default:return"You have ".concat(a," pending review").concat(a>1?"s":"",".")}}(e.name,t,n,r);return await(0,kt.gS)((0,kt.collection)(Nt.db,"notifications"),{user_id:e.id,title:"Review Reminder",message:a,type:"review_reminder",priority:"overdue_escalation"===t?"high":"normal",is_read:!1,created_at:kt.Timestamp.now()}),!0}catch(a){return console.error("Error sending in-app notification:",a),!1}}static async sendDiscordNotification(e,t,n,r){if(!bn)return console.warn("Discord webhook URL not configured"),!1;try{const a=function(e,t,n,r){const a=n.length;let s="",i="";switch(t){case"pre_reminder":s="\ud83d\udd14 Review Reminder - Due Tomorrow",i="Reviews are due **tomorrow (Monday) by 11:59 PM**";break;case"morning_reminder":s="\u2600\ufe0f Review Reminder - Due Today",i="Reviews are **DUE TODAY by 11:59 PM**";break;case"evening_reminder":s="\u26a0\ufe0f Final Reminder - 3 Hours Left",i="Only **3 hours remaining** until the deadline (11:59 PM tonight)";break;case"overdue_escalation":s="\ud83d\udea8 OVERDUE ALERT - ".concat(r," Day").concat(r>1?"s":""," Late"),i="Reviews are **".concat(r," day").concat(r>1?"s":""," overdue**. Please submit immediately!")}const o=n.slice(0,5).map((e,t)=>({name:"".concat(t+1,". ").concat("mentee"===e.role?"\ud83d\udc64 Mentee":"\ud83d\udc68\u200d\ud83c\udfeb Mentor"),value:e.user_name,inline:!0}));return a>5&&o.push({name:"Additional",value:"+".concat(a-5," more pending"),inline:!0}),{content:e.discord_user_id?"<@".concat(e.discord_user_id,">"):"**".concat(e.name,"**"),embeds:[{title:s,description:i,color:wn[t],fields:o,footer:{text:"Campus Learning Dashboard - Review System"},timestamp:(new Date).toISOString()}]}}(e,t,n,r),s=await fetch(bn,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw new Error("Discord API error: ".concat(s.status));return!0}catch(a){return console.error("Error sending Discord notification:",a),!1}}static async sendEmailNotification(e,t,n,r){return console.log("\ud83d\udce7 Email notification for ".concat(e.name," (not implemented yet)")),!1}static async sendSundayReminder(){console.log("\ud83d\udcc5 Running Sunday pre-reminder job...");try{const e=(0,kt.collection)(Nt.db,"users"),t=await(0,kt.getDocs)(e);let n=0,r=0;for(const a of t.docs){const e=(0,o.A)({id:a.id},a.data());if("active"!==e.status)continue;const t=await jn(e);if(t.length>0){await this.sendReminder(e,"pre_reminder",t)?n++:r++}}return console.log("\u2705 Sunday reminder complete: ".concat(n," sent, ").concat(r," failed")),{sent:n,failed:r}}catch(e){return console.error("Error in Sunday reminder job:",e),{sent:0,failed:0}}}static async sendMondayMorningReminder(){console.log("\u2600\ufe0f Running Monday morning reminder job...");try{const e=(0,kt.collection)(Nt.db,"users"),t=await(0,kt.getDocs)(e);let n=0,r=0;for(const a of t.docs){const e=(0,o.A)({id:a.id},a.data());if("active"!==e.status)continue;const t=await jn(e);if(t.length>0){await this.sendReminder(e,"morning_reminder",t)?n++:r++}}return console.log("\u2705 Monday morning reminder complete: ".concat(n," sent, ").concat(r," failed")),{sent:n,failed:r}}catch(e){return console.error("Error in Monday morning reminder job:",e),{sent:0,failed:0}}}static async sendMondayEveningReminder(){console.log("\ud83c\udf06 Running Monday evening reminder job...");try{const e=(0,kt.collection)(Nt.db,"users"),t=await(0,kt.getDocs)(e);let n=0,r=0;for(const a of t.docs){const e=(0,o.A)({id:a.id},a.data());if("active"!==e.status)continue;const t=await jn(e);if(t.length>0){await this.sendReminder(e,"evening_reminder",t)?n++:r++}}return console.log("\u2705 Monday evening reminder complete: ".concat(n," sent, ").concat(r," failed")),{sent:n,failed:r}}catch(e){return console.error("Error in Monday evening reminder job:",e),{sent:0,failed:0}}}static async sendOverdueReminder(){console.log("\ud83d\udea8 Running overdue escalation reminder job...");try{const e=(0,kt.collection)(Nt.db,"users"),t=await(0,kt.getDocs)(e),n=qt(),r=Wt(n);let a=0,s=0;for(const i of t.docs){const e=(0,o.A)({id:i.id},i.data());if("active"!==e.status)continue;const t=await jn(e);if(t.length>0&&r>0){await this.sendReminder(e,"overdue_escalation",t,r)?a++:s++}}return console.log("\u2705 Overdue reminder complete: ".concat(a," sent, ").concat(s," failed")),{sent:a,failed:s}}catch(e){return console.error("Error in overdue reminder job:",e),{sent:0,failed:0}}}}class _n{constructor(){this.lastCheckKey="last_reminder_check",this.checkIntervalMinutes=30}static getInstance(){return _n.instance||(_n.instance=new _n),_n.instance}start(){console.log("[ClientReminderScheduler] Starting reminder scheduler..."),this.checkAndSendReminders(),setInterval(()=>{this.checkAndSendReminders()},60*this.checkIntervalMinutes*1e3)}async checkAndSendReminders(){try{if(!this.shouldRunCheck())return void console.log("[ClientReminderScheduler] Skipping check - too soon since last check");const e=new Date,t=e.getDay(),n=e.getHours();if(console.log("[ClientReminderScheduler] Running check - Day: ".concat(t,", Hour: ").concat(n)),1===t&&n>=9&&n<11&&await this.sendIfNotSentToday("morning_reminder"),1===t&&n>=18&&n<23&&await this.sendIfNotSentToday("evening_reminder"),t>=2||0===t){const e=Ht(qt());Wt(e)>0&&n>=10&&n<12&&await this.sendIfNotSentToday("overdue_escalation")}this.updateLastCheck()}catch(e){console.error("[ClientReminderScheduler] Error in reminder check:",e)}}async sendIfNotSentToday(e){try{const t="last_".concat(e,"_sent"),n=localStorage.getItem(t),r=(new Date).toDateString();if(n===r)return void console.log("[ClientReminderScheduler] ".concat(e," already sent today"));let a;switch(console.log("[ClientReminderScheduler] Sending ".concat(e,"...")),e){case"morning_reminder":a=await Nn.sendMondayMorningReminder();break;case"evening_reminder":a=await Nn.sendMondayEveningReminder();break;case"overdue_escalation":a=await Nn.sendOverdueReminder()}localStorage.setItem(t,r),console.log("[ClientReminderScheduler] ".concat(e," sent successfully:"),a)}catch(t){console.error("[ClientReminderScheduler] Error sending ".concat(e,":"),t)}}shouldRunCheck(){const e=localStorage.getItem(this.lastCheckKey);if(!e)return!0;const t=new Date(e).getTime();return((new Date).getTime()-t)/6e4>=this.checkIntervalMinutes}updateLastCheck(){localStorage.setItem(this.lastCheckKey,(new Date).toISOString())}async manualCheck(){console.log("[ClientReminderScheduler] Manual check triggered"),await this.checkAndSendReminders()}resetTimers(){localStorage.removeItem(this.lastCheckKey),localStorage.removeItem("last_morning_reminder_sent"),localStorage.removeItem("last_evening_reminder_sent"),localStorage.removeItem("last_overdue_escalation_sent"),console.log("[ClientReminderScheduler] All timers reset")}getStatus(){return{lastCheck:localStorage.getItem(this.lastCheckKey),lastMorningReminder:localStorage.getItem("last_morning_reminder_sent"),lastEveningReminder:localStorage.getItem("last_evening_reminder_sent"),lastOverdueReminder:localStorage.getItem("last_overdue_escalation_sent")}}}_n.instance=void 0;class Sn{static async getDailyStats(e,t){try{const n=await this.getActiveStudents(t),r=n.length,a=await this.getStudentsOnLeaveWithType(n.map(e=>e.id),e),s=n.filter(e=>"kitchen_leave"===e.status||"on_leave"===e.status||"unapproved_leave"===e.status),i=new Map;a.forEach(e=>i.set(e.studentId,e.leaveType)),s.forEach(e=>{i.set(e.id,e.status)});const o=i.size,l=Array.from(i.values()).filter(e=>"kitchen_leave"===e).length,c=Array.from(i.values()).filter(e=>"on_leave"===e).length,d=Array.from(i.values()).filter(e=>"unapproved_leave"===e).length,u=await this.getApprovedGoalsForDate(n.map(e=>e.id),e),h=new Set(u.map(e=>e.student_id)).size,m=await this.getSubmittedReflectionsForDate(n.map(e=>e.id),e),p=new Set(m.map(e=>e.student_id)).size,f=r-o;return{date:e,totalActiveStudents:r,studentsWithApprovedGoals:h,studentsWithSubmittedReflections:p,studentsPresent:h,goalApprovalRate:f>0?h/f*100:0,reflectionSubmissionRate:f>0?p/f*100:0,attendanceRate:f>0?h/f*100:0,studentsOnLeave:o,studentsOnKitchenLeave:l,studentsOnRegularLeave:c,studentsOnUnapprovedLeave:d}}catch(n){return console.error("Error fetching daily attendance stats:",n),{date:e,totalActiveStudents:0,studentsWithApprovedGoals:0,studentsWithSubmittedReflections:0,studentsPresent:0,goalApprovalRate:0,reflectionSubmissionRate:0,attendanceRate:0,studentsOnLeave:0,studentsOnKitchenLeave:0,studentsOnRegularLeave:0,studentsOnUnapprovedLeave:0}}}static async getStudentDailyStatusList(e,t){const n=await this.getActiveStudents(t),r=await this.getStudentsOnLeaveWithType(n.map(e=>e.id),e),a=new Map(r.map(e=>[e.studentId,e.leaveType])),s=await this.getApprovedGoalsForDate(n.map(e=>e.id),e),i=await this.getSubmittedReflectionsForDate(n.map(e=>e.id),e),o=new Map(s.map(e=>[e.student_id,e])),l=new Map(i.map(e=>[e.student_id,e]));return n.map(e=>{const t=o.has(e.id),n=l.has(e.id);let r,s=!1;"kitchen_leave"===e.status||"on_leave"===e.status||"unapproved_leave"===e.status?(s=!0,r=e.status):a.has(e.id)&&(s=!0,r=a.get(e.id));return{student:e,hasApprovedGoal:t,hasSubmittedReflection:n,isPresent:t&&!s,isOnLeave:s,leaveType:r,goalDetails:o.get(e.id),reflectionDetails:l.get(e.id)}})}static async getMenteesList(e,t){try{const n=await this.getActiveStudents(e),r=(t?n.filter(e=>{var n,r;return(null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(t.toLowerCase()))||(null===(r=e.email)||void 0===r?void 0:r.toLowerCase().includes(t.toLowerCase()))}):n).map(async e=>{let t;if(e.mentor_id)try{const n=(0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",e.mentor_id)),r=await(0,kt.getDocs)(n);r.empty||(t=r.docs[0].data())}catch(u){console.error("Error fetching mentor:",u)}const n=At();n.setDate(n.getDate()-7);const r=(0,kt.query)((0,kt.collection)(Nt.db,"daily_goals"),(0,kt._M)("student_id","==",e.id),(0,kt._M)("created_at",">=",kt.Timestamp.fromDate(n)),(0,kt.orderBy)("created_at","desc"),(0,kt.limit)(10)),a=(await(0,kt.getDocs)(r)).docs.map(e=>e.data()),s=(0,kt.query)((0,kt.collection)(Nt.db,"daily_reflections"),(0,kt._M)("student_id","==",e.id),(0,kt._M)("created_at",">=",kt.Timestamp.fromDate(n)),(0,kt.orderBy)("created_at","desc"),(0,kt.limit)(10)),i=(await(0,kt.getDocs)(s)).docs.map(e=>e.data()),o=(0,kt.query)((0,kt.collection)(Nt.db,"attendance"),(0,kt._M)("student_id","==",e.id),(0,kt._M)("date",">=",kt.Timestamp.fromDate(n)),(0,kt.orderBy)("date","desc")),l=(await(0,kt.getDocs)(o)).docs.map(e=>e.data()),c=l.filter(e=>"present"===e.present_status).length,d=l.filter(e=>"on_leave"!==e.present_status).length;return{student:e,mentor:t,recentGoals:a,recentReflections:i,attendanceRate:d>0?c/d*100:0}});return await Promise.all(r)}catch(n){return console.error("Error fetching mentees list:",n),[]}}static async updateDailyAttendance(e,t){try{const n=await this.getStudentDailyStatusList(e,t),r=n.map(async t=>{const n={id:"".concat(t.student.id,"_").concat(e.toISOString().split("T")[0]),student_id:t.student.id,date:e,goal_reviewed:t.hasApprovedGoal,reflection_reviewed:t.hasSubmittedReflection,present_status:t.isOnLeave?"on_leave":t.isPresent?"present":"absent",created_at:At(),updated_at:At()},r=(0,kt.H9)(Nt.db,"attendance",n.id);return(0,kt.BN)(r,n,{merge:!0})});await Promise.all(r),console.log("Updated attendance for ".concat(n.length," students on ").concat(e.toLocaleDateString()))}catch(n){console.error("Error updating daily attendance:",n)}}static setupRealtimeAttendanceTracking(e,t,n){const r=new Date(e),a=new Date(r);a.setHours(0,0,0,0);const s=new Date(r);s.setHours(23,59,59,999);const i=(0,kt.query)((0,kt.collection)(Nt.db,"daily_goals"),(0,kt._M)("created_at",">=",kt.Timestamp.fromDate(a)),(0,kt._M)("created_at","<=",kt.Timestamp.fromDate(s))),o=(0,kt.aQ)(i,()=>{this.updateDailyAttendance(e,t).then(()=>{n&&this.getDailyStats(e,t).then(n)})}),l=(0,kt.query)((0,kt.collection)(Nt.db,"daily_reflections"),(0,kt._M)("created_at",">=",kt.Timestamp.fromDate(a)),(0,kt._M)("created_at","<=",kt.Timestamp.fromDate(s))),c=(0,kt.aQ)(l,()=>{this.updateDailyAttendance(e,t).then(()=>{n&&this.getDailyStats(e,t).then(n)})});return()=>{o(),c()}}static async getActiveStudents(e){try{let t=(0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("isAdmin","!=",!0));let n=(await(0,kt.getDocs)(t)).docs.map(e=>(0,o.A)({id:e.id},e.data()));return n=n.filter(t=>{const n=!t.status||"active"===t.status||"kitchen_leave"===t.status||"on_leave"===t.status||"unapproved_leave"===t.status,r=!e||t.campus===e,a="admin"!==t.role&&"academic_associate"!==t.role;return n&&r&&a}),n}catch(t){return console.error("Error fetching active students:",t),[]}}static async getStudentsOnLeave(e,t){if(0===e.length)return[];try{const n=[];for(let t=0;t<e.length;t+=10)n.push(e.slice(t,t+10));const r=n.map(async e=>{const n=(0,kt.query)((0,kt.collection)(Nt.db,"leave_requests"),(0,kt._M)("student_id","in",e),(0,kt._M)("status","==","approved"),(0,kt._M)("start_date","<=",kt.Timestamp.fromDate(t)),(0,kt._M)("end_date",">=",kt.Timestamp.fromDate(t)));return(await(0,kt.getDocs)(n)).docs.map(e=>e.data().student_id)});return(await Promise.all(r)).flat()}catch(n){return console.error("Error fetching students on leave:",n),[]}}static async getStudentsOnLeaveWithType(e,t){if(0===e.length)return[];try{const n=[];for(let t=0;t<e.length;t+=10)n.push(e.slice(t,t+10));const r=n.map(async e=>{const n=(0,kt.query)((0,kt.collection)(Nt.db,"leave_requests"),(0,kt._M)("student_id","in",e),(0,kt._M)("status","==","approved"),(0,kt._M)("start_date","<=",kt.Timestamp.fromDate(t)),(0,kt._M)("end_date",">=",kt.Timestamp.fromDate(t)));return(await(0,kt.getDocs)(n)).docs.map(e=>({studentId:e.data().student_id,leaveType:e.data().leave_type}))});return(await Promise.all(r)).flat()}catch(n){return console.error("Error fetching students on leave with type:",n),[]}}static async getApprovedGoalsForDate(e,t){if(0===e.length)return[];try{const n=new Date(t);n.setHours(0,0,0,0);const r=new Date(t);r.setHours(23,59,59,999);const a=[];for(let t=0;t<e.length;t+=10)a.push(e.slice(t,t+10));const s=a.map(async e=>{const t=(0,kt.query)((0,kt.collection)(Nt.db,"daily_goals"),(0,kt._M)("student_id","in",e),(0,kt._M)("status","==","approved"),(0,kt._M)("created_at",">=",kt.Timestamp.fromDate(n)),(0,kt._M)("created_at","<=",kt.Timestamp.fromDate(r)));return(await(0,kt.getDocs)(t)).docs.map(e=>(0,o.A)({id:e.id},e.data()))});return(await Promise.all(s)).flat()}catch(n){return console.error("Error fetching approved goals:",n),[]}}static async getSubmittedReflectionsForDate(e,t){if(0===e.length)return[];try{const n=new Date(t);n.setHours(0,0,0,0);const r=new Date(t);r.setHours(23,59,59,999);const a=[];for(let t=0;t<e.length;t+=10)a.push(e.slice(t,t+10));const s=a.map(async e=>{const t=(0,kt.query)((0,kt.collection)(Nt.db,"daily_reflections"),(0,kt._M)("student_id","in",e),(0,kt._M)("created_at",">=",kt.Timestamp.fromDate(n)),(0,kt._M)("created_at","<=",kt.Timestamp.fromDate(r)));return(await(0,kt.getDocs)(t)).docs.map(e=>(0,o.A)({id:e.id},e.data())).filter(e=>{var t,n,r,a;return e.reflection_answers&&((null===(t=e.reflection_answers.workedWell)||void 0===t?void 0:t.trim().length)>0||(null===(n=e.reflection_answers.howAchieved)||void 0===n?void 0:n.trim().length)>0||(null===(r=e.reflection_answers.keyLearning)||void 0===r?void 0:r.trim().length)>0||(null===(a=e.reflection_answers.challenges)||void 0===a?void 0:a.trim().length)>0)})});return(await Promise.all(s)).flat()}catch(n){return console.error("Error fetching submitted reflections:",n),[]}}}class kn{static startScheduler(){this.isRunning?console.log("\u26a0\ufe0f Attendance scheduler is already running - skipping duplicate start"):(this.schedulerInterval&&(console.log("\u26a0\ufe0f Clearing existing scheduler interval"),clearInterval(this.schedulerInterval),this.schedulerInterval=null),console.log("\ud83d\ude80 Starting attendance scheduler..."),this.isRunning=!0,this.checkAndSendReport(),this.schedulerInterval=setInterval(()=>{this.checkAndSendReport()},6e4),console.log("\u2705 Attendance scheduler started successfully - reports will be sent at 10:00 AM daily"))}static stopScheduler(){this.schedulerInterval&&(clearInterval(this.schedulerInterval),this.schedulerInterval=null,this.isRunning=!1,console.log("\ud83d\uded1 Attendance scheduler stopped"))}static async checkAndSendReport(){const e=At(),t=At().getHours(),n=At().getMinutes(),r=e.getSeconds(),a=e.toISOString().split("T")[0];if(0===r&&console.log("\u23f0 Scheduler check (IST): ".concat(t,":").concat(n.toString().padStart(2,"0"))),10===t&&0===n&&this.lastReportDate!==a&&!this.isSendingReport){console.log("\u23f0 It's 10:00 AM IST - Sending morning attendance reports..."),this.isSendingReport=!0,this.lastReportDate=a;try{await this.sendAllCampusReports(),console.log("\u2705 Morning attendance reports sent successfully")}catch(s){console.error("\u274c Error sending morning reports:",s)}finally{this.isSendingReport=!1}}}static async sendAllCampusReports(){const e=At(),t=["Dharamshala","Dantewada","Jashpur","Raigarh","Pune","Sarjapur","Kishanganj","Eternal"];try{for(const r of t)try{await this.sendCampusReport(e,r),console.log("\u2705 Sent attendance report for ".concat(r)),await new Promise(e=>setTimeout(e,2e3))}catch(n){console.error("\u274c Failed to send report for ".concat(r,":"),n)}try{await this.sendCampusReport(e),console.log("\u2705 Sent overall attendance report")}catch(n){console.error("\u274c Failed to send overall report:",n)}}catch(n){console.error("\u274c Error sending attendance reports:",n)}}static async sendCampusReport(e,t){try{const n=await Sn.getDailyStats(e,t),r=await Sn.getStudentDailyStatusList(e,t),a=r.filter(e=>!e.isPresent&&!e.isOnLeave).map(e=>e.student.name||e.student.email||"Unknown"),s=r.filter(e=>e.isOnLeave&&"kitchen_leave"===e.leaveType).map(e=>e.student.name||e.student.email||"Unknown"),i=r.filter(e=>e.isOnLeave&&"on_leave"===e.leaveType).map(e=>e.student.name||e.student.email||"Unknown"),o=r.filter(e=>e.isOnLeave&&"unapproved_leave"===e.leaveType).map(e=>e.student.name||e.student.email||"Unknown"),l=r.filter(e=>e.isOnLeave&&"unapproved_leave"===e.leaveType).map(e=>{let t="Unknown";if(e.student.unapproved_leave_start)try{t=(e.student.unapproved_leave_start instanceof Date?e.student.unapproved_leave_start:e.student.unapproved_leave_start.toDate?e.student.unapproved_leave_start.toDate():new Date(e.student.unapproved_leave_start)).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch(n){console.error("Error parsing unapproved_leave_start date:",n),t="Unknown"}return{name:e.student.name||e.student.email||"Unknown",startDate:t}}),c=n.totalActiveStudents,d=n.studentsPresent,u=c-d-n.studentsOnLeave;t?await Tt.sendCampusAttendanceReport(t,e,c,d,u,n.attendanceRate,n.studentsOnKitchenLeave,n.studentsOnRegularLeave,n.studentsOnUnapprovedLeave,a,s,i,o,l):await Tt.sendAttendanceReport(e,c,d,u,n.attendanceRate,n.studentsOnKitchenLeave,n.studentsOnRegularLeave,n.studentsOnUnapprovedLeave,a,s,i,o,l),console.log("\ud83d\udcca Attendance report sent for ".concat(t||"All Campuses"," - ").concat(n.attendanceRate.toFixed(1),"% present"))}catch(n){throw console.error("Error sending attendance report for ".concat(t||"All",":"),n),n}}static async triggerManualReport(e){const t=At();console.log("\ud83d\udce4 Manually sending attendance report for ".concat(e||"All Campuses","...")),await this.sendCampusReport(t,e)}static isSchedulerRunning(){return this.isRunning}}kn.schedulerInterval=null,kn.isRunning=!1,kn.lastReportDate=null,kn.isSendingReport=!1;const En="leaves",An="users",Cn="notifications";class Dn{static async checkLeaveConflict(e,t,n){try{const r=await this.getUserLeaves(e),a=new Date(t),s=new Date(n);a.setHours(0,0,0,0),s.setHours(0,0,0,0);for(const e of r){if("rejected"===e.status||"expired"===e.status)continue;const t=new Date(e.start_date),n=new Date(e.end_date);if(t.setHours(0,0,0,0),n.setHours(0,0,0,0),a<=n&&s>=t)return e}return null}catch(r){throw console.error("Error checking leave conflict:",r),r}}static async createLeaveRequest(e,t,n,r,a){try{const s=await _t.UserService.getUserById(e);if(!s)throw new Error("User not found");if("kitchen_leave"===t){const e=new Date(n),t=new Date(r);if(e.setHours(0,0,0,0),t.setHours(0,0,0,0),e.getTime()!==t.getTime())throw new Error("Kitchen leave can only be applied for a single day")}if("on_leave"===t&&!a)throw new Error("Reason is mandatory for on leave");const i=await this.checkLeaveConflict(e,n,r);if(i){const e=new Date(i.start_date).toLocaleDateString("en-IN"),t=new Date(i.end_date).toLocaleDateString("en-IN");throw new Error("You already have a ".concat("kitchen_leave"===i.leave_type?"kitchen leave":"leave"," request from ").concat(e," to ").concat(t," with status: ").concat(i.status))}const o={user_id:e,user_name:s.name,user_email:s.email,leave_type:t,start_date:kt.Timestamp.fromDate(n),end_date:kt.Timestamp.fromDate(r),status:"pending",created_at:(0,kt.O5)(),updated_at:(0,kt.O5)()};a&&(o.reason=a);const l=await(0,kt.gS)((0,kt.collection)(Nt.db,En),o);await this.createNotification(e,"leave_requested","Leave Request Submitted","".concat(s.name," has requested ").concat("kitchen_leave"===t?"kitchen leave":"leave"," from ").concat(n.toLocaleDateString("en-IN")," to ").concat(r.toLocaleDateString("en-IN")),l.id);return await this.getLeaveById(l.id)}catch(s){throw console.error("Error creating leave request:",s),s}}static async getLeaveById(e){try{var t,n,r,a,s,i;const l=await(0,kt.x7)((0,kt.H9)(Nt.db,En,e));if(!l.exists())return null;const c=l.data();return(0,o.A)((0,o.A)({id:l.id},c),{},{start_date:null===(t=c.start_date)||void 0===t?void 0:t.toDate(),end_date:null===(n=c.end_date)||void 0===n?void 0:n.toDate(),created_at:null===(r=c.created_at)||void 0===r?void 0:r.toDate(),updated_at:null===(a=c.updated_at)||void 0===a?void 0:a.toDate(),approved_at:null===(s=c.approved_at)||void 0===s?void 0:s.toDate(),rejected_at:null===(i=c.rejected_at)||void 0===i?void 0:i.toDate()})}catch(l){throw console.error("Error getting leave by ID:",l),l}}static async getUserLeaves(e){try{console.log("[LeaveManagementService] Getting leaves for user:",e);const t=(0,kt.collection)(Nt.db,En),n=(0,kt.query)(t,(0,kt._M)("user_id","==",e)),r=(await(0,kt.getDocs)(n)).docs.map(e=>{var t,n,r,a,s,i;const l=e.data();return(0,o.A)((0,o.A)({id:e.id},l),{},{start_date:null===(t=l.start_date)||void 0===t?void 0:t.toDate(),end_date:null===(n=l.end_date)||void 0===n?void 0:n.toDate(),created_at:null===(r=l.created_at)||void 0===r?void 0:r.toDate(),updated_at:null===(a=l.updated_at)||void 0===a?void 0:a.toDate(),approved_at:null===(s=l.approved_at)||void 0===s?void 0:s.toDate(),rejected_at:null===(i=l.rejected_at)||void 0===i?void 0:i.toDate()})});return r.sort((e,t)=>t.created_at.getTime()-e.created_at.getTime())}catch(t){throw console.error("Error getting user leaves:",t),t}}static async getPendingLeaves(){try{const e=(0,kt.collection)(Nt.db,En),t=(0,kt.query)(e,(0,kt._M)("status","==","pending")),n=(await(0,kt.getDocs)(t)).docs.map(e=>{var t,n,r,a,s,i;const l=e.data();return(0,o.A)((0,o.A)({id:e.id},l),{},{start_date:null===(t=l.start_date)||void 0===t?void 0:t.toDate(),end_date:null===(n=l.end_date)||void 0===n?void 0:n.toDate(),created_at:null===(r=l.created_at)||void 0===r?void 0:r.toDate(),updated_at:null===(a=l.updated_at)||void 0===a?void 0:a.toDate(),approved_at:null===(s=l.approved_at)||void 0===s?void 0:s.toDate(),rejected_at:null===(i=l.rejected_at)||void 0===i?void 0:i.toDate()})});return n.sort((e,t)=>t.created_at.getTime()-e.created_at.getTime())}catch(t){var e;if(null!==t&&void 0!==t&&null!==(e=t.message)&&void 0!==e&&e.includes("index is currently building"))return console.log("[getPendingLeaves] Index is building, returning empty array temporarily"),[];throw console.error("Error getting pending leaves:",t),t}}static async getAllLeaves(){try{const e=(0,kt.collection)(Nt.db,En),t=(0,kt.query)(e),n=(await(0,kt.getDocs)(t)).docs.map(e=>{var t,n,r,a,s,i;const l=e.data();return(0,o.A)((0,o.A)({id:e.id},l),{},{start_date:null===(t=l.start_date)||void 0===t?void 0:t.toDate(),end_date:null===(n=l.end_date)||void 0===n?void 0:n.toDate(),created_at:null===(r=l.created_at)||void 0===r?void 0:r.toDate(),updated_at:null===(a=l.updated_at)||void 0===a?void 0:a.toDate(),approved_at:null===(s=l.approved_at)||void 0===s?void 0:s.toDate(),rejected_at:null===(i=l.rejected_at)||void 0===i?void 0:i.toDate()})});return n.sort((e,t)=>t.created_at.getTime()-e.created_at.getTime())}catch(e){throw console.error("Error getting all leaves:",e),e}}static async approveLeave(e,t,n){try{const r=await this.getLeaveById(e);if(!r)throw new Error("Leave request not found");if("pending"!==r.status)throw new Error("Leave request is not pending");const a=await this.getUserLeaves(r.user_id),s=new Date(r.start_date),i=new Date(r.end_date);s.setHours(0,0,0,0),i.setHours(0,0,0,0);for(const t of a)if(t.id!==e&&"rejected"!==t.status&&"expired"!==t.status&&"approved"===t.status){const e=new Date(t.start_date),n=new Date(t.end_date);if(e.setHours(0,0,0,0),n.setHours(0,0,0,0),s<=n&&i>=e)throw new Error("Cannot approve this leave as there is already an approved ".concat("kitchen_leave"===t.leave_type?"kitchen leave":"leave"," from ").concat(e.toLocaleDateString("en-IN")," to ").concat(n.toLocaleDateString("en-IN")))}const o=(0,kt.H9)(Nt.db,En,e);await(0,kt.mZ)(o,{status:"approved",approved_by:t,approved_by_name:n,approved_at:(0,kt.O5)(),updated_at:(0,kt.O5)()});const l=new Date,c=new Date(r.start_date);c.setHours(0,0,0,0),l.setHours(0,0,0,0),c<=l?await this.updateUserStatusFromActiveLeaves(r.user_id):console.log("[ApproveLeave] Leave starts in future (".concat(c.toLocaleDateString(),"), not updating user status yet")),console.log("[ApproveLeave] User status updated successfully"),await this.createNotification(r.user_id,"leave_approved","Leave Approved","Your leave request from ".concat(r.start_date.toLocaleDateString()," to ").concat(r.end_date.toLocaleDateString()," has been approved."),e)}catch(r){throw console.error("Error approving leave:",r),r}}static async rejectLeave(e,t,n,r){try{const a=await this.getLeaveById(e);if(!a)throw new Error("Leave request not found");if("pending"!==a.status)throw new Error("Leave request is not pending");const s=(0,kt.H9)(Nt.db,En,e);await(0,kt.mZ)(s,{status:"rejected",rejected_by:t,rejected_by_name:n,rejection_reason:r||"No reason provided",rejected_at:(0,kt.O5)(),updated_at:(0,kt.O5)()}),await this.createNotification(a.user_id,"leave_rejected","Leave Rejected","Your leave request from ".concat(a.start_date.toLocaleDateString()," to ").concat(a.end_date.toLocaleDateString()," has been rejected. Reason: ").concat(r||"No reason provided"),e)}catch(a){throw console.error("Error rejecting leave:",a),a}}static async updateUserStatusFromActiveLeaves(e){try{const t=new Date;t.setHours(0,0,0,0);const r=await this.getUserLeaves(e),a=r.find(e=>{const n=new Date(e.start_date);n.setHours(0,0,0,0);const r=new Date(e.end_date);return r.setHours(0,0,0,0),"approved"===e.status&&"on_leave"===e.leave_type&&n<=t&&r>=t}),s=r.find(e=>{const n=new Date(e.start_date);n.setHours(0,0,0,0);const r=new Date(e.end_date);return r.setHours(0,0,0,0),"approved"===e.status&&"kitchen_leave"===e.leave_type&&n<=t&&r>=t}),i=a||s;if(i){const t="kitchen_leave"===i.leave_type?"kitchen_leave":"on_leave";console.log("[UpdateUserStatus] Setting user ".concat(e," status to ").concat(t," based on active ").concat(i.leave_type)),await _t.UserService.updateUser(e,{status:t,leave_from:i.start_date,leave_to:i.end_date,updated_at:new Date});const{queryCache:r}=await Promise.resolve().then(n.bind(n,9390));r.invalidatePattern("users"),r.invalidate("users:id:".concat(e))}else{console.log("[UpdateUserStatus] No active leaves for user ".concat(e,", setting status to active")),await _t.UserService.updateUser(e,{status:"active",leave_from:(0,kt.CL)(),leave_to:(0,kt.CL)(),updated_at:new Date});const{queryCache:t}=await Promise.resolve().then(n.bind(n,9390));t.invalidatePattern("users"),t.invalidate("users:id:".concat(e))}}catch(t){throw console.error("[UpdateUserStatus] Error updating user status from active leaves:",t),t}}static async expireKitchenLeaves(){try{const e=new Date,t=(0,kt.collection)(Nt.db,En),n=(0,kt.query)(t,(0,kt._M)("leave_type","==","kitchen_leave"),(0,kt._M)("status","==","approved")),r=await(0,kt.getDocs)(n),a=[];r.docs.forEach(t=>{var n,r,s,i;const l=t.data(),c=(0,o.A)((0,o.A)({id:t.id},l),{},{start_date:null===(n=l.start_date)||void 0===n?void 0:n.toDate(),end_date:null===(r=l.end_date)||void 0===r?void 0:r.toDate(),created_at:null===(s=l.created_at)||void 0===s?void 0:s.toDate(),updated_at:null===(i=l.updated_at)||void 0===i?void 0:i.toDate()}),d=new Date(c.end_date);d.setHours(23,59,59,999),e>d&&a.push(c)});for(const s of a){const e=(0,kt.H9)(Nt.db,En,s.id);await(0,kt.mZ)(e,{status:"expired",updated_at:(0,kt.O5)()}),await this.updateUserStatusFromActiveLeaves(s.user_id)}console.log("Expired ".concat(a.length," kitchen leaves"))}catch(e){throw console.error("Error expiring kitchen leaves:",e),e}}static async checkExpiredOnLeaves(){try{const e=new Date;e.setHours(0,0,0,0);const t=(0,kt.collection)(Nt.db,En),n=(0,kt.query)(t,(0,kt._M)("leave_type","==","on_leave"),(0,kt._M)("status","==","approved")),r=await(0,kt.getDocs)(n),a=[];r.docs.forEach(t=>{var n,r,s,i;const l=t.data(),c=(0,o.A)((0,o.A)({id:t.id},l),{},{start_date:null===(n=l.start_date)||void 0===n?void 0:n.toDate(),end_date:null===(r=l.end_date)||void 0===r?void 0:r.toDate(),created_at:null===(s=l.created_at)||void 0===s?void 0:s.toDate(),updated_at:null===(i=l.updated_at)||void 0===i?void 0:i.toDate()});c.end_date<e&&a.push(c)});for(const s of a){const e=(0,kt.H9)(Nt.db,En,s.id);await(0,kt.mZ)(e,{status:"expired",updated_at:(0,kt.O5)()}),console.log("[ExpiredOnLeave] Setting user ".concat(s.user_id," status to unapproved_leave")),await _t.UserService.updateUser(s.user_id,{status:"unapproved_leave",unapproved_leave_start:new Date,leave_from:(0,kt.CL)(),leave_to:(0,kt.CL)(),updated_at:new Date}),await this.createNotification(s.user_id,"leave_expired","Leave Expired - Status Changed to Unapproved Leave","Your leave period has ended. Your status has been changed to unapproved leave. Please contact admin/academic associate to update your status.",s.id),await this.notifyAdminsAboutExpiredLeave(s)}console.log("Notified about ".concat(a.length," expired on leaves"))}catch(e){throw console.error("Error checking expired on leaves:",e),e}}static async notifyAdminsAboutExpiredLeave(e){try{const t=(0,kt.collection)(Nt.db,An),n=(0,kt.query)(t,(0,kt._M)("role","in",["admin","academic_associate"])),r=(await(0,kt.getDocs)(n)).docs.map(t=>this.createNotification(t.id,"leave_expired_admin","User Leave Expired","".concat(e.user_name,"'s leave period has ended. Their status needs to be changed manually."),e.id));await Promise.all(r)}catch(t){throw console.error("Error notifying admins about expired leave:",t),t}}static async activateFutureLeaves(){try{const e=new Date;e.setHours(0,0,0,0);const t=(0,kt.collection)(Nt.db,En),n=(0,kt.query)(t,(0,kt._M)("status","==","approved")),r=await(0,kt.getDocs)(n),a=[];r.docs.forEach(t=>{var n,r,s,i;const l=t.data(),c=(0,o.A)((0,o.A)({id:t.id},l),{},{start_date:null===(n=l.start_date)||void 0===n?void 0:n.toDate(),end_date:null===(r=l.end_date)||void 0===r?void 0:r.toDate(),created_at:null===(s=l.created_at)||void 0===s?void 0:s.toDate(),updated_at:null===(i=l.updated_at)||void 0===i?void 0:i.toDate()}),d=new Date(c.start_date);d.setHours(0,0,0,0);const u=new Date(c.end_date);u.setHours(0,0,0,0),d<=e&&u>=e&&a.push({leave:c,userId:c.user_id})});const s=Array.from(new Set(a.map(e=>e.userId)));for(const i of s)console.log("[ActivateFutureLeaves] Updating status for user ".concat(i)),await this.updateUserStatusFromActiveLeaves(i);console.log("Activated status for ".concat(s.length," users with newly started leaves"))}catch(e){throw console.error("Error activating future leaves:",e),e}}static async getPendingLeaveCount(){try{return(await this.getPendingLeaves()).length}catch(t){var e;return null!==t&&void 0!==t&&null!==(e=t.message)&&void 0!==e&&e.includes("index is currently building")?(console.log("[getPendingLeaveCount] Index is building, returning 0 temporarily"),0):(console.error("Error getting pending leave count:",t),0)}}static async createNotification(e,t,n,r,a){try{const s={user_id:e,type:t,title:n,message:r,read_by:[],created_at:(0,kt.O5)()};a&&(s.related_leave_id=a),await(0,kt.gS)((0,kt.collection)(Nt.db,Cn),s)}catch(s){throw console.error("Error creating notification:",s),s}}static async getUserActiveLeave(e){try{const t=(0,kt.collection)(Nt.db,En),n=(0,kt.query)(t,(0,kt._M)("user_id","==",e)),r=(await(0,kt.getDocs)(n)).docs.map(e=>{var t,n,r,a,s,i;const l=e.data();return(0,o.A)((0,o.A)({id:e.id},l),{},{start_date:null===(t=l.start_date)||void 0===t?void 0:t.toDate(),end_date:null===(n=l.end_date)||void 0===n?void 0:n.toDate(),created_at:null===(r=l.created_at)||void 0===r?void 0:r.toDate(),updated_at:null===(a=l.updated_at)||void 0===a?void 0:a.toDate(),approved_at:null===(s=l.approved_at)||void 0===s?void 0:s.toDate(),rejected_at:null===(i=l.rejected_at)||void 0===i?void 0:i.toDate()})}),a=r.filter(e=>["approved","pending"].includes(e.status));return 0===a.length?null:(a.sort((e,t)=>t.created_at.getTime()-e.created_at.getTime()),a[0])}catch(t){throw console.error("Error getting user active leave:",t),t}}}class Tn{static start(){this.intervalId?console.log("Leave scheduler is already running"):(console.log("Starting leave scheduler..."),this.checkAndExpireLeaves(),this.intervalId=setInterval(()=>{this.checkAndExpireLeaves()},36e5),this.scheduleMidnightCheck())}static stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,console.log("Leave scheduler stopped"))}static async checkAndExpireLeaves(){try{console.log("Checking for expired leaves..."),await Dn.activateFutureLeaves(),await Dn.expireKitchenLeaves(),await Dn.checkExpiredOnLeaves(),console.log("Leave expiration check completed")}catch(e){console.error("Error checking expired leaves:",e)}}static scheduleMidnightCheck(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,0,0,0).getTime()-e.getTime();setTimeout(()=>{this.checkAndExpireLeaves(),this.scheduleMidnightCheck()},t),console.log("Scheduled midnight check in ".concat(Math.round(t/1e3/60)," minutes"))}static async manualCheck(){console.log("Manual leave expiration check triggered"),await this.checkAndExpireLeaves()}}Tn.intervalId=null;const On=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Pn=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},In=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var Rn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Mn=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],Ln=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u}=e,h=(0,i.A)(e,Mn);return(0,r.createElement)("svg",(0,o.A)((0,o.A)((0,o.A)({ref:t},Rn),{},{width:a,height:a,stroke:n,strokeWidth:l?24*Number(s)/Number(a):s,className:In("lucide",c)},!d&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"}),h),[...u.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(d)?d:[d]])}),Fn=["className"],Un=(e,t)=>{const n=(0,r.forwardRef)((n,a)=>{let{className:s}=n,l=(0,i.A)(n,Fn);return(0,r.createElement)(Ln,(0,o.A)({ref:a,iconNode:t,className:In("lucide-".concat(On(Pn(e))),"lucide-".concat(e),s)},l))});return n.displayName=Pn(e),n},Bn=Un("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),zn=Un("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),qn=Un("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);function Vn(e){let{isOpen:t,onClose:n,user:a,onDateUpdated:s,requireFill:i=!1}=e;const[l,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(!1),[h,m]=(0,r.useState)("");return t?(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(Bn,{className:"h-6 w-6 text-blue-600"}),(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Welcome to Campus!"})]}),!i&&(0,Pt.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!l)return void m("Please select your campus joining date");const t=new Date(l),r=new Date;if(t>r)return void m("Joining date cannot be in the future");const i=new Date;if(i.setFullYear(r.getFullYear()-5),t<i)m("Please enter a valid joining date");else{u(!0),m("");try{await _t.UserService.updateUser(a.id,{campus_joining_date:t});const e=(0,o.A)((0,o.A)({},a),{},{campus_joining_date:t});s(e),Ot.checkAndSendPostponedNotification(e).catch(e=>{console.error("Error checking postponed notification:",e)}),n()}catch(h){console.error("Error updating joining date:",h),m("Failed to save joining date. Please try again.")}finally{u(!1)}}},className:"p-6 space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-gray-600 mb-4",children:"To help us track your learning journey accurately, please tell us when you joined the campus."}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{htmlFor:"joiningDate",className:"block text-sm font-medium text-gray-700 mb-2",children:"Campus Joining Date"}),(0,Pt.jsx)("input",{type:"date",id:"joiningDate",value:l,onChange:e=>c(e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This date will be used to calculate your time spent in the program"})]})]}),h&&(0,Pt.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:h}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3",children:[!i&&(0,Pt.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",disabled:d,children:"Skip for Now"}),(0,Pt.jsx)("button",{type:"submit",disabled:d||!l,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-600 flex items-center space-x-2",children:d?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,Pt.jsx)("span",{children:"Saving..."})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(qn,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Save Date"})]})})]})]})]})}):null}const Hn=Un("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Wn=Un("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),Gn=e=>{let{children:t,requireAdmin:n=!1,redirectTo:r="/login"}=e;const{currentUser:a,userData:s,loading:i,loadingError:o,setUserData:l,signOut:c}=Rt(),d=ce();return i?(0,Pt.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):o?(0,Pt.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,Pt.jsx)(Hn,{className:"h-8 w-8 text-red-600"}),(0,Pt.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Authentication Error"})]}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:o}),(0,Pt.jsxs)("button",{onClick:async()=>{try{await c()}catch(e){console.error("Error signing out:",e)}},className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 font-medium",children:[(0,Pt.jsx)(Wn,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Sign In Again"})]})]})}):a&&s?n&&!s.isAdmin&&"academic_associate"!==s.role?(0,Pt.jsx)(De,{to:"/unauthorized",replace:!0}):s.campus_joining_date||s.isAdmin?(0,Pt.jsx)(Pt.Fragment,{children:t}):(0,Pt.jsx)(Pt.Fragment,{children:(0,Pt.jsx)(Vn,{isOpen:!0,user:s,requireFill:!0,onClose:()=>{},onDateUpdated:e=>{l(e)}})}):(0,Pt.jsx)(De,{to:r,state:{from:d},replace:!0})},Kn=async e=>{try{let t=0,n=0;return await Promise.all(e.map(async e=>{const n=await cn.getGoalsByStudent(e);t+=n.filter(e=>"pending"===e.status).length})),await Promise.all(e.map(async e=>{const t=await dn.getReflectionsByStudent(e);n+=t.filter(e=>!e.reviewed_at).length})),t+n}catch(t){return console.error("Error fetching pending actions:",t),0}},Qn=Un("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]),Yn=Un("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),$n=Un("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),Jn=Un("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),Xn=Un("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]),Zn=Un("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]),er=Un("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),tr=Un("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]),nr=Un("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),rr=Un("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ar=Un("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),sr=Un("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),ir=Un("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),or=Un("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]);const lr=new class{constructor(){this.collectionName="bug_reports"}async submitReport(e,t,n,r,a){try{await(0,kt.gS)((0,kt.collection)(Nt.db,this.collectionName),{description:e,consoleLogs:t||"",userId:n||"anonymous",userName:r||"Anonymous User",userEmail:a||"",reviewed:!1,submittedAt:kt.Timestamp.now()}),console.log("Bug report submitted successfully")}catch(s){throw console.error("Error submitting bug report:",s),new Error("Failed to submit bug report")}}async getAllReports(){try{const e=(0,kt.query)((0,kt.collection)(Nt.db,this.collectionName),(0,kt.orderBy)("submittedAt","desc"));return(await(0,kt.getDocs)(e)).docs.map(e=>{var t;return(0,o.A)((0,o.A)({id:e.id},e.data()),{},{submittedAt:(null===(t=e.data().submittedAt)||void 0===t?void 0:t.toDate())||new Date})})}catch(e){throw console.error("Error fetching bug reports:",e),new Error("Failed to fetch bug reports")}}async markAsReviewed(e){try{const t=(0,kt.H9)(Nt.db,this.collectionName,e);await(0,kt.mZ)(t,{reviewed:!0}),console.log("Report marked as reviewed")}catch(t){throw console.error("Error marking report as reviewed:",t),new Error("Failed to update report status")}}async getUnreviewedCount(){try{return(await this.getAllReports()).filter(e=>!e.reviewed).length}catch(e){return console.error("Error getting unreviewed count:",e),0}}},cr=e=>{let{onClose:t}=e;const{userData:n}=Rt(),[a,s]=(0,r.useState)(""),[i,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(!1),[h,m]=(0,r.useState)(!1),[p,f]=(0,r.useState)("");(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t]);return(0,Pt.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:t,children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto p-6 relative",onClick:e=>e.stopPropagation(),children:[(0,Pt.jsx)("button",{onClick:t,className:"absolute top-4 right-4 p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors",children:(0,Pt.jsx)(zn,{size:20})}),(0,Pt.jsx)("h2",{className:"text-xl font-semibold mb-6 pr-8",children:"Report a Bug / Feature"}),d?(0,Pt.jsxs)("div",{className:"text-green-600 text-center py-8",children:[(0,Pt.jsx)("div",{className:"text-4xl mb-4",children:"\u2713"}),(0,Pt.jsx)("p",{className:"text-lg font-medium",children:"Thank you for your feedback!"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"We'll review your report and get back to you if needed."})]}):(0,Pt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m(!0),f("");try{const e=i?l:"";await lr.submitReport(a,e,null===n||void 0===n?void 0:n.id,null===n||void 0===n?void 0:n.name,null===n||void 0===n?void 0:n.email),u(!0),setTimeout(()=>{t()},2e3)}catch(r){console.error("Error submitting report:",r),f("Failed to submit report. Please try again.")}finally{m(!1)}},className:"space-y-6",children:[p&&(0,Pt.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:p}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,Pt.jsx)("textarea",{value:a,onChange:e=>s(e.target.value),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none",rows:4,placeholder:"Describe the bug or feature request in detail...",required:!0})]}),(0,Pt.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Pt.jsx)("input",{type:"checkbox",checked:i,onChange:e=>o(e.target.checked),id:"includeConsole",className:"mt-1 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{htmlFor:"includeConsole",className:"text-sm font-medium text-gray-700",children:"Include console logs (optional)"}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Console logs can help us debug technical issues faster"})]})]}),i&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Console Logs"}),(0,Pt.jsx)("textarea",{value:l,onChange:e=>c(e.target.value),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-mono text-sm resize-none",rows:4,placeholder:"Paste relevant console logs here (press F12 \u2192 Console tab)..."})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,Pt.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,Pt.jsx)("button",{type:"submit",disabled:h,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:h?"Submitting...":"Submit Report"})]})]})]})})},dr=e=>{let{onClose:t}=e;(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t]);return(0,Pt.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:t,children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,Pt.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(sr,{className:"h-6 w-6 text-yellow-500"}),(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"What's New!"})]}),(0,Pt.jsx)("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:(0,Pt.jsx)(zn,{size:20,className:"text-gray-500"})})]})}),(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsx)("p",{className:"text-gray-600 mb-6 text-sm",children:"Check out the latest features and improvements we've added to Campus Learning!"}),(0,Pt.jsx)("div",{className:"space-y-4",children:[{date:"October 5, 2025",feature:"\ud83c\udfaf Real-time Attendance Tracking System - Admin can now track student attendance with live statistics, date/campus filtering, and mentee management"},{date:"October 5, 2025",feature:"\ud83d\udcca Interactive Attendance Dashboard - Visual progress bars, percentage indicators, and automatic recalculation when data changes"},{date:"October 5, 2025",feature:"\ud83d\udc65 My Mentees Section - Admin can search, view individual attendance rates, and override mentor functions"},{date:"October 5, 2025",feature:"\ud83d\udd04 Live Firebase Integration - Real-time updates when goals are approved or reflections are submitted"},{date:"October 5, 2025",feature:"\ud83d\udcf1 Mobile-Responsive Attendance System - Fully optimized for desktop, tablet, and mobile devices"},{date:"October 5, 2025",feature:"\ud83d\udc1b Bug/Feature reporting system with admin review panel"},{date:"October 5, 2025",feature:"\ud83c\udfa8 Enhanced responsive design for mobile and tablet devices"},{date:"October 4, 2025",feature:"\ud83d\uddbc\ufe0f New logo and favicon updates across the platform"}].map((e,t)=>(0,Pt.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border-l-4 border-blue-400",children:[(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-1",children:e.feature}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:e.date})]}),(0,Pt.jsx)("div",{className:"text-blue-500",children:(0,Pt.jsx)(sr,{size:16})})]},t))}),(0,Pt.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:(0,Pt.jsx)("p",{className:"text-xs text-gray-500 text-center",children:'Have feedback or suggestions? Use the "Report a bug/Feature" option!'})})]})]})})};function ur(){var e,t,n,a,s,i;const{userData:l,setUserData:c,signOut:d}=Rt(),u=he(),h=ce(),[m,p]=(0,r.useState)(!1),[f,g]=(0,r.useState)(!1),[y,x]=(0,r.useState)(!1),[v,b]=(0,r.useState)(0),[w,j]=(0,r.useState)(!1),[N,_]=(0,r.useState)(!1),[S,k]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&(w&&j(!1),S&&k(!1),f&&g(!1),y&&x(!1),N&&_(!1))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[w,S,f,y,N]),(0,r.useEffect)(()=>{const e=async()=>{if(null!==l&&void 0!==l&&l.id&&l.isMentor){const e=await Kn([l.id]);b(e)}};e();const t=setInterval(e,6e4);return()=>clearInterval(t)},[null===l||void 0===l?void 0:l.id,null===l||void 0===l?void 0:l.isMentor]);const E=[{label:"Dashboard",mobileLabel:"Home",path:"/student/dashboard",icon:Qn},{label:"Goals & Reflections",mobileLabel:"Goals",path:"/goals",icon:Yn},{label:"Journey",mobileLabel:"Journey",path:"/journey",icon:$n},{label:"Reviews",mobileLabel:"Reviews",path:"/reviews",icon:Jn},{label:"Leave",mobileLabel:"Leave",path:"/leave",icon:Xn},{label:"Pair Programming",mobileLabel:"Pair Prog",path:"/pair-programming/dashboard",icon:Zn},{label:"Mentor",mobileLabel:"Mentor",path:"/mentor/dashboard",icon:er,notificationCount:null!==l&&void 0!==l&&l.isMentor&&v>0?v:void 0}],A=async()=>{try{await d(),u("/login")}catch(e){console.error("Error signing out:",e)}},C=h.pathname.startsWith("/admin"),D=E,T=e=>h.pathname===e||h.pathname.startsWith(e+"/"),O=()=>{if(null===l||void 0===l||!l.house)return"bg-white";switch(l.house){case"Bageshree":return"bg-blue-50 border-blue-200";case"Bhairav":return"bg-orange-50 border-orange-200";case"Malhar":return"bg-green-50 border-green-200";default:return"bg-white border-gray-200"}};return(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("nav",{className:"".concat(O()," shadow-sm border-b sticky top-0 z-30"),children:[(0,Pt.jsx)("div",{className:"w-full px-2 sm:px-3 md:px-4 lg:px-6",children:(0,Pt.jsxs)("div",{className:"flex justify-between items-center h-14 sm:h-16 gap-2 sm:gap-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 md:gap-4 min-w-0",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsxs)(pt,{to:"/dashboard",className:"flex items-center gap-1.5 sm:gap-2",children:[(0,Pt.jsx)("div",{className:"w-8 h-8 sm:w-9 sm:h-9 flex items-center justify-center flex-shrink-0",children:(0,Pt.jsx)("img",{src:"/Logomini.png",alt:"CL",className:"w-full h-full object-contain"})}),(0,Pt.jsx)("span",{className:"hidden xs:inline sm:block text-sm sm:text-base lg:text-lg font-semibold text-gray-900 truncate max-w-xs",children:"Campus Learning"})]})}),(0,Pt.jsxs)("div",{className:"hidden md:flex items-center gap-0.5 flex-wrap",children:[D.slice(0,4).map(e=>{const t=e.icon;return(0,Pt.jsxs)(pt,{to:e.path,title:e.label,className:"flex items-center gap-1 px-2 py-2 rounded text-xs font-medium transition-colors relative flex-shrink-0 ".concat(T(e.path)?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"),children:[(0,Pt.jsx)(t,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{className:"hidden lg:inline",children:e.label}),void 0!==e.notificationCount&&(0,Pt.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold px-1.5 py-0.5 rounded-full min-w-max",children:e.notificationCount})]},e.path)}),D.length>4&&(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsxs)("button",{onClick:()=>x(!y),className:"flex items-center gap-1 px-2 py-2 rounded text-xs font-medium text-gray-700 hover:bg-gray-100 transition-colors flex-shrink-0",title:"More",children:[(0,Pt.jsx)(tr,{size:16}),(0,Pt.jsx)("span",{className:"hidden lg:inline",children:"More"})]}),y&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>x(!1)}),(0,Pt.jsx)("div",{className:"absolute right-0 top-full mt-1 bg-white rounded shadow-lg border border-gray-200 z-40 min-w-max",children:D.slice(4).map(e=>{const t=e.icon;return(0,Pt.jsxs)(pt,{to:e.path,onClick:()=>x(!1),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium transition-colors ".concat(T(e.path)?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),children:[(0,Pt.jsx)(t,{className:"h-4 w-4"}),e.label]},e.path)})})]})]})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[(null===l||void 0===l?void 0:l.isAdmin)&&(0,Pt.jsx)("button",{onClick:()=>u(C?"/student/dashboard":"/admin/dashboard"),className:"hidden lg:flex items-center gap-1.5 px-3 py-1.5 lg:py-2 lg:px-4 bg-primary-600 text-white rounded text-xs lg:text-sm font-medium hover:bg-primary-700 transition-colors shadow-sm",title:C?"Switch to Student View":"Switch to Admin View",children:C?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Jn,{size:16}),(0,Pt.jsx)("span",{className:"hidden xl:inline",children:"Student"})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(nr,{size:16}),(0,Pt.jsx)("span",{className:"hidden xl:inline",children:"Admin"})]})}),(0,Pt.jsxs)("div",{className:"hidden md:flex items-center gap-1.5 lg:gap-2 relative",children:[(0,Pt.jsxs)("button",{onClick:()=>g(!f),className:"flex items-center gap-1 md:gap-1.5 px-2 lg:px-2.5 py-1.5 lg:py-2 rounded hover:bg-gray-100 transition-colors",children:[(0,Pt.jsx)("div",{className:"w-8 h-8 lg:w-9 lg:h-9 rounded-full overflow-hidden flex items-center justify-center border border-gray-200 flex-shrink-0",children:null!==l&&void 0!==l&&l.email?(0,Pt.jsx)("img",{src:"https://www.google.com/s2/photos/profile/".concat(l.email.split("@")[0]),alt:l.name,className:"w-full h-full object-cover",onError:e=>{var t,n;e.target.parentElement.innerHTML='\n                            <div class="w-full h-full flex items-center justify-center '.concat("Bageshree"===(null===l||void 0===l?void 0:l.house)?"bg-blue-100":"Bhairav"===(null===l||void 0===l?void 0:l.house)?"bg-orange-100":"Malhar"===(null===l||void 0===l?void 0:l.house)?"bg-green-100":"bg-primary-100",'">\n                              <span class="text-sm font-medium ').concat("Bageshree"===(null===l||void 0===l?void 0:l.house)?"text-blue-700":"Bhairav"===(null===l||void 0===l?void 0:l.house)?"text-orange-700":"Malhar"===(null===l||void 0===l?void 0:l.house)?"text-green-700":"text-primary-700",'">\n                                ').concat((null===l||void 0===l||null===(t=l.name)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase())||"U","\n                              </span>\n                            </div>\n                          ")}}):(0,Pt.jsx)("div",{className:"w-full h-full flex items-center justify-center ".concat("Bageshree"===(null===l||void 0===l?void 0:l.house)?"bg-blue-100":"Bhairav"===(null===l||void 0===l?void 0:l.house)?"bg-orange-100":"Malhar"===(null===l||void 0===l?void 0:l.house)?"bg-green-100":"bg-primary-100"),children:(0,Pt.jsx)("span",{className:"text-sm font-medium ".concat("Bageshree"===(null===l||void 0===l?void 0:l.house)?"text-blue-700":"Bhairav"===(null===l||void 0===l?void 0:l.house)?"text-orange-700":"Malhar"===(null===l||void 0===l?void 0:l.house)?"text-green-700":"text-primary-700"),children:(null===l||void 0===l||null===(e=l.name)||void 0===e||null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase())||"U"})})}),(0,Pt.jsxs)("div",{className:"text-xs lg:text-sm text-left hidden lg:block",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-700 truncate max-w-32",children:null===l||void 0===l?void 0:l.name}),(null===l||void 0===l?void 0:l.isAdmin)&&(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"Admin"})]}),(0,Pt.jsx)(rr,{size:14,className:"text-gray-500 flex-shrink-0"})]}),f&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>g(!1)}),(0,Pt.jsxs)("div",{className:"absolute right-0 top-12 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-20",children:[(0,Pt.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-900",children:null===l||void 0===l?void 0:l.name}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:null===l||void 0===l?void 0:l.email}),(null===l||void 0===l?void 0:l.isAdmin)&&(0,Pt.jsx)("span",{className:"inline-block mt-2 px-2 py-1 text-xs font-medium bg-primary-100 text-primary-700 rounded",children:"Admin"})]}),(0,Pt.jsxs)("button",{onClick:()=>{g(!1),j(!0)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-3",children:[(0,Pt.jsx)(ar,{size:16}),(0,Pt.jsx)("span",{children:"View Profile"})]}),(0,Pt.jsxs)("button",{onClick:()=>{g(!1),_(!0)},className:"w-full px-4 py-2 text-left text-sm text-purple-700 hover:bg-purple-50 flex items-center space-x-3",children:[(0,Pt.jsx)(sr,{size:16}),(0,Pt.jsx)("span",{children:"What's New!"})]}),(0,Pt.jsxs)("button",{onClick:()=>{g(!1),k(!0)},className:"w-full px-4 py-2 text-left text-sm text-blue-700 hover:bg-blue-50 flex items-center space-x-3",children:[(0,Pt.jsx)(Hn,{size:16}),(0,Pt.jsx)("span",{children:"Report a bug/Feature"})]}),S&&(0,Pt.jsx)(cr,{onClose:()=>k(!1)}),N&&(0,Pt.jsx)(dr,{onClose:()=>_(!1)}),(0,Pt.jsxs)("button",{onClick:()=>{g(!1),A()},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-3",children:[(0,Pt.jsx)(Wn,{size:16}),(0,Pt.jsx)("span",{children:"Sign Out"})]})]})]})]}),(0,Pt.jsx)("button",{onClick:()=>p(!m),className:"md:hidden p-1.5 sm:p-2 rounded text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors flex-shrink-0","aria-label":"Toggle menu",children:m?(0,Pt.jsx)(zn,{size:20,className:"sm:size-6"}):(0,Pt.jsx)(tr,{size:20,className:"sm:size-6"})})]})]})}),m&&(0,Pt.jsx)("div",{className:"md:hidden border-t ".concat(O()," shadow-lg max-h-[calc(100vh-56px)] overflow-y-auto"),children:(0,Pt.jsxs)("div",{className:"px-2 py-2 space-y-1",children:[D.map(e=>{const t=e.icon;return(0,Pt.jsxs)(pt,{to:e.path,onClick:()=>p(!1),className:"flex items-center gap-2.5 px-2.5 py-2 rounded text-sm sm:text-base font-medium relative ".concat(T(e.path)?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"),children:[(0,Pt.jsx)(t,{className:"h-5 w-5 flex-shrink-0"}),(0,Pt.jsx)("span",{className:"truncate",children:e.label}),void 0!==e.notificationCount&&(0,Pt.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full min-w-[20px] text-center",children:e.notificationCount})]},e.path)}),(null===l||void 0===l?void 0:l.isAdmin)&&(0,Pt.jsx)("button",{onClick:()=>{u(C?"/student/dashboard":"/admin/dashboard"),p(!1)},className:"w-full flex items-center gap-2.5 px-2.5 py-2 text-sm sm:text-base font-medium bg-primary-600 text-white hover:bg-primary-700 rounded mb-2",children:C?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Jn,{className:"h-5 w-5 flex-shrink-0"}),(0,Pt.jsx)("span",{children:"Student View"})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(nr,{className:"h-5 w-5 flex-shrink-0"}),(0,Pt.jsx)("span",{children:"Admin View"})]})}),(0,Pt.jsxs)("div",{className:"border-t border-gray-200 pt-2 mt-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2.5 px-2.5 py-2",children:[(0,Pt.jsx)("div",{className:"w-9 h-9 sm:w-10 sm:h-10 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,Pt.jsx)("span",{className:"text-xs sm:text-sm font-medium text-primary-700",children:(null===l||void 0===l||null===(n=l.name)||void 0===n||null===(a=n.charAt(0))||void 0===a?void 0:a.toUpperCase())||"U"})}),(0,Pt.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,Pt.jsx)("p",{className:"text-sm sm:text-base font-medium text-gray-700 truncate",children:null===l||void 0===l?void 0:l.name}),(0,Pt.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 truncate",children:null===l||void 0===l?void 0:l.email}),(null===l||void 0===l?void 0:l.isAdmin)&&(0,Pt.jsx)("p",{className:"text-xs text-primary-600 font-medium",children:"Admin"})]})]}),(0,Pt.jsxs)("button",{onClick:()=>{p(!1),j(!0)},className:"w-full flex items-center gap-2.5 px-2.5 py-2 text-sm sm:text-base font-medium text-gray-700 hover:bg-gray-100 rounded mt-1",children:[(0,Pt.jsx)(ar,{className:"h-5 w-5 flex-shrink-0"}),(0,Pt.jsx)("span",{children:"View Profile"})]}),(0,Pt.jsxs)("button",{onClick:()=>{A(),p(!1)},className:"w-full flex items-center gap-2.5 px-2.5 py-2 text-sm sm:text-base font-medium text-red-600 hover:bg-red-50 rounded mt-1",children:[(0,Pt.jsx)(Wn,{className:"h-5 w-5 flex-shrink-0"}),(0,Pt.jsx)("span",{children:"Sign Out"})]})]})]})})]}),(0,Pt.jsx)("div",{className:"md:hidden fixed bottom-0 left-0 right-0 ".concat(O()," border-t shadow-lg z-30"),children:(0,Pt.jsx)("div",{className:"flex justify-around items-center h-14 sm:h-16 gap-1",children:D.slice(0,5).map(e=>{const t=e.icon,n=T(e.path);return(0,Pt.jsxs)(pt,{to:e.path,className:"flex flex-col items-center justify-center flex-1 h-full gap-0.5 sm:gap-1 relative py-1 ".concat(n?"text-primary-600":"text-gray-600"),children:[(0,Pt.jsx)(t,{className:"h-5 sm:h-6 w-5 sm:w-6 ".concat(n?"stroke-2":"stroke-1")}),(0,Pt.jsx)("span",{className:"text-[10px] sm:text-xs text-center leading-tight ".concat(n?"font-semibold":"font-normal"),children:e.mobileLabel||e.label}),void 0!==e.notificationCount&&(0,Pt.jsx)("span",{className:"absolute -top-1 right-1/4 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full min-w-[20px] text-center",children:e.notificationCount})]},e.path)})})}),w&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>j(!1),children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,Pt.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Profile"}),(0,Pt.jsx)("button",{onClick:()=>j(!1),className:"p-1 hover:bg-gray-100 rounded-md transition-colors",children:(0,Pt.jsx)(zn,{size:20,className:"text-gray-500"})})]})}),(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsxs)("div",{className:"flex flex-col items-center mb-6",children:[(0,Pt.jsx)("div",{className:"w-20 h-20 rounded-full flex items-center justify-center mb-3 overflow-hidden border-4 border-gray-200",children:null!==l&&void 0!==l&&l.email?(0,Pt.jsx)("img",{src:"https://www.google.com/s2/photos/profile/".concat(l.email.split("@")[0]),alt:l.name,className:"w-full h-full object-cover",onError:e=>{var t,n;e.target.parentElement.innerHTML='\n                          <div class="w-full h-full flex items-center justify-center text-3xl font-medium text-white '.concat("Bageshree"===(null===l||void 0===l?void 0:l.house)?"bg-blue-300":"Bhairav"===(null===l||void 0===l?void 0:l.house)?"bg-orange-300":"Malhar"===(null===l||void 0===l?void 0:l.house)?"bg-green-300":"bg-primary-300",'">\n                            ').concat((null===l||void 0===l||null===(t=l.name)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase())||"U","\n                          </div>\n                        ")}}):(0,Pt.jsx)("div",{className:"w-full h-full flex items-center justify-center text-3xl font-medium text-white ".concat("Bageshree"===(null===l||void 0===l?void 0:l.house)?"bg-blue-300":"Bhairav"===(null===l||void 0===l?void 0:l.house)?"bg-orange-300":"Malhar"===(null===l||void 0===l?void 0:l.house)?"bg-green-300":"bg-primary-300"),children:(null===l||void 0===l||null===(s=l.name)||void 0===s||null===(i=s.charAt(0))||void 0===i?void 0:i.toUpperCase())||"U"})}),(0,Pt.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:null===l||void 0===l?void 0:l.name}),(null===l||void 0===l?void 0:l.isAdmin)&&(0,Pt.jsx)("span",{className:"mt-2 px-3 py-1 text-sm font-medium bg-primary-100 text-primary-700 rounded-full",children:"Administrator"})]}),(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)(ir,{size:20,className:"text-gray-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Email"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:null===l||void 0===l?void 0:l.email})]})]}),(0,Pt.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)(Bn,{size:20,className:"text-gray-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Date Joined"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:null!==l&&void 0!==l&&l.created_at?new Date(l.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"})]})]}),(0,Pt.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)(or,{size:20,className:"text-gray-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Campus"}),(0,Pt.jsxs)("select",{value:(null===l||void 0===l?void 0:l.campus)||"",onChange:async e=>{const t=e.target.value;if(l&&!l.campus)try{await _t.UserService.updateUser(l.id,{campus:t||void 0}),c((0,o.A)((0,o.A)({},l),{},{campus:t||void 0}))}catch(n){console.error("Error updating campus:",n),alert("Failed to update campus. Please contact an admin for changes.")}},disabled:!(null===l||void 0===l||!l.campus),className:"mt-1 block w-full pl-3 pr-10 py-2 text-sm border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 rounded-md disabled:bg-gray-100 disabled:cursor-not-allowed",children:[(0,Pt.jsx)("option",{value:"",children:"Select Campus"}),["Dantewada","Dharamshala","Eternal","Jashpur","Kishanganj","Pune","Raigarh","Sarjapura"].map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]}),(null===l||void 0===l?void 0:l.campus)&&(0,Pt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Contact admin to change campus"})]})]}),(0,Pt.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)(or,{size:20,className:"text-gray-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"House"}),(0,Pt.jsxs)("select",{value:(null===l||void 0===l?void 0:l.house)||"",onChange:async e=>{const t=e.target.value;if(l)try{await _t.UserService.updateUser(l.id,{house:t||void 0}),c((0,o.A)((0,o.A)({},l),{},{house:t||void 0}))}catch(n){console.error("Error updating house:",n),alert("Failed to update house. Please try again.")}},className:"mt-1 block w-full pl-3 pr-10 py-2 text-sm border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 rounded-md",children:[(0,Pt.jsx)("option",{value:"",children:"Select House"}),["Bageshree","Malhar","Bhairav"].map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]})]})]}),(null===l||void 0===l?void 0:l.isAdmin)&&(0,Pt.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)(nr,{size:20,className:"text-gray-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Role"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:"Administrator"})]})]}),(null===l||void 0===l?void 0:l.mentor_id)&&(0,Pt.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)(er,{size:20,className:"text-gray-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Mentor"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:l.mentor_id})]})]}),(0,Pt.jsxs)("div",{className:"flex items-start space-x-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,Pt.jsx)(sr,{size:20,className:"text-purple-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Gemini API Key ",(0,Pt.jsx)("span",{className:"text-xs text-gray-500",children:"(Optional)"})]}),(0,Pt.jsx)("input",{type:"text",value:(null===l||void 0===l?void 0:l.gemini_api_key)||"",onChange:async e=>{const t=e.target.value;if(l)try{await _t.UserService.updateUser(l.id,{gemini_api_key:t}),c((0,o.A)((0,o.A)({},l),{},{gemini_api_key:t}))}catch(n){alert("Failed to update API key.")}},placeholder:"Paste your Gemini API key here",className:"block w-full px-3 py-2 text-sm border border-gray-300 rounded focus:outline-none focus:ring-purple-500 focus:border-purple-500"}),(0,Pt.jsxs)("div",{className:"mt-3 p-3 bg-white border border-blue-200 rounded-lg",children:[(0,Pt.jsx)("p",{className:"text-sm text-blue-800 mb-2",children:(0,Pt.jsx)("strong",{children:"Get your free Gemini API key:"})}),(0,Pt.jsxs)("ol",{className:"text-sm text-blue-800 list-decimal list-inside space-y-1",children:[(0,Pt.jsxs)("li",{children:["Go to ",(0,Pt.jsx)("a",{href:"https://aistudio.google.com/app/api-keys",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-blue-600 font-medium",children:"Google AI Studio API Keys"})]}),(0,Pt.jsx)("li",{children:"Sign in with your Google account"}),(0,Pt.jsx)("li",{children:'Click "Create API key"'}),(0,Pt.jsx)("li",{children:"Copy the generated key"}),(0,Pt.jsx)("li",{children:"Paste it here (saves automatically)"})]}),(0,Pt.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This is different from your Firebase API key. Use the key from Google AI Studio."})]})]})]})]})]}),(0,Pt.jsx)("div",{className:"p-6 bg-gray-50 border-t border-gray-200 rounded-b-lg",children:(0,Pt.jsx)("button",{onClick:()=>j(!1),className:"w-full px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors font-medium",children:"Done"})})]})})]})}function hr(e){let{message:t,type:n="info",visible:a,onClose:s,duration:i=3e3}=e;if((0,r.useEffect)(()=>{if(!a)return;const e=setTimeout(()=>s(),i);return()=>clearTimeout(e)},[a,i,s]),!a)return null;const o="success"===n?"bg-green-600":"error"===n?"bg-red-600":"bg-gray-800";return(0,Pt.jsx)("div",{className:"fixed right-6 bottom-6 z-[100] ".concat(o," text-white px-4 py-3 rounded-lg shadow-lg max-w-xs"),role:"status",children:(0,Pt.jsx)("div",{className:"text-sm",children:t})})}const mr=["Dantewada","Dharamshala","Eternal","Jashpur","Kishanganj","Pune","Raigarh","Sarjapura"],pr=["Bageshree","Malhar","Bhairav"],fr=["HTML","CSS","JavaScript","React","Node.js","Python","Java","C++","SQL","MongoDB","Express.js","TypeScript","Git","Problem Solving","Communication","Teamwork"];function gr(e){var t;let{isOpen:n,onClose:a,user:s,onProfileUpdated:i}=e;const[l,c]=(0,r.useState)(1),[d,u]=(0,r.useState)(!1),[h,m]=(0,r.useState)({name:s.name||"",campus:s.campus||"",house:s.house||"",skills:s.skills||[],gemini_api_key:s.gemini_api_key||""}),[p,f]=(0,r.useState)(""),g=[];null!==(t=s.name)&&void 0!==t&&t.trim()||g.push("name"),s.campus||g.push("campus"),s.house||g.push("house");const y=!s.skills||0===s.skills.length,x=[];y&&x.push("skills"),x.push("gemini_api_key");const v=Math.max(1,g.length+x.length),b=()=>l<=g.length?g[l-1]:l===g.length+1&&y?"skills":l===g.length+(y?2:1)?"gemini_api_key":"complete",w=()=>{p.trim()&&!h.skills.includes(p.trim())&&(m(e=>(0,o.A)((0,o.A)({},e),{},{skills:[...e.skills,p.trim()]})),f(""))},j=async()=>{u(!0);try{const e={};g.includes("name")&&(e.name=h.name),g.includes("campus")&&(e.campus=h.campus),g.includes("house")&&(e.house=h.house),h.skills.length>0&&(e.skills=h.skills),h.gemini_api_key&&h.gemini_api_key.trim().length>0&&(e.gemini_api_key=h.gemini_api_key.trim()),await _t.UserService.updateUser(s.id,e);const t=(0,o.A)((0,o.A)({},s),e);i(t),Ot.checkAndSendPostponedNotification(t).catch(e=>{console.error("Error checking postponed notification:",e)}),_({visible:!0,message:"Profile saved",type:"success"}),setTimeout(()=>{a()},800)}catch(e){console.error("Error updating profile:",e),_({visible:!0,message:"Failed to update profile",type:"error"})}finally{u(!1)}},[N,_]=(0,r.useState)({visible:!1,message:"",type:"info"});return n&&0!==g.length?(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-4 sm:p-6 my-8 mx-auto max-h-[90vh] overflow-y-auto",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-4",children:[(0,Pt.jsx)("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Complete Your Profile"}),(0,Pt.jsx)("button",{onClick:j,className:"px-2 sm:px-3 py-1 text-sm bg-primary-600 text-white rounded-md hover:bg-primary-700 whitespace-nowrap",disabled:d,children:d?"Saving...":"Save"})]}),(0,Pt.jsxs)("div",{className:"mb-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Complete Your Profile"}),(0,Pt.jsxs)("span",{className:"text-sm text-gray-500",children:[l," of ",v]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(l/v*100,"%")}})})]}),(0,Pt.jsx)("div",{className:"mb-8",children:(()=>{switch(b()){case"name":return(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)(ar,{className:"w-12 h-12 text-primary-600 mx-auto mb-4"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"What's your name?"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:"Help us personalize your experience by providing your full name."}),(0,Pt.jsx)("input",{type:"text",value:h.name,onChange:e=>m(t=>(0,o.A)((0,o.A)({},t),{},{name:e.target.value})),placeholder:"Enter your full name",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-center text-lg",autoFocus:!0})]});case"campus":return(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)(or,{className:"w-12 h-12 text-primary-600 mx-auto mb-4"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Which campus are you from?"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:"Select your campus to connect with your local community."}),(0,Pt.jsxs)("select",{value:h.campus,onChange:e=>m(t=>(0,o.A)((0,o.A)({},t),{},{campus:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-lg",children:[(0,Pt.jsx)("option",{value:"",children:"Select your campus"}),mr.map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]})]});case"house":return(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)(Qn,{className:"w-12 h-12 text-primary-600 mx-auto mb-4"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Which house do you belong to?"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:"Join your house community for team activities and events."}),(0,Pt.jsx)("div",{className:"grid grid-cols-1 gap-3",children:pr.map(e=>{const t=h.house===e,n=(e=>{switch(e){case"Bageshree":return"border-blue-300 bg-blue-50 text-blue-700";case"Malhar":return"border-green-300 bg-green-50 text-green-700";case"Bhairav":return"border-orange-300 bg-orange-50 text-orange-700";default:return"border-gray-300 bg-gray-50 text-gray-700"}})(e||"");return(0,Pt.jsx)("button",{onClick:()=>m(t=>(0,o.A)((0,o.A)({},t),{},{house:e})),className:"p-4 border-2 rounded-lg transition-all ".concat(t?n:"border-gray-200 hover:border-gray-300"),children:(0,Pt.jsx)("span",{className:"font-semibold",children:e})},e)})})]});case"skills":return(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)(Zn,{className:"w-12 h-12 text-primary-600 mx-auto mb-4"}),(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["What are your skills? ",(0,Pt.jsx)("span",{className:"text-sm font-normal text-gray-500",children:"(Optional)"})]}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:"Add your technical and soft skills to help mentors guide you better. You can skip this step and add skills later from your profile."}),(0,Pt.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,Pt.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),onKeyPress:e=>"Enter"===e.key&&w(),placeholder:"Add a skill",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,Pt.jsx)("button",{onClick:w,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Add"})]}),(0,Pt.jsxs)("div",{className:"mb-4",children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Or select from common skills:"}),(0,Pt.jsx)("div",{className:"flex flex-wrap gap-2 max-h-24 overflow-y-auto",children:fr.map(e=>(0,Pt.jsx)("button",{onClick:()=>(e=>{h.skills.includes(e)||m(t=>(0,o.A)((0,o.A)({},t),{},{skills:[...t.skills,e]}))})(e),disabled:h.skills.includes(e),className:"px-3 py-1 text-xs rounded-full border transition-colors ".concat(h.skills.includes(e)?"bg-gray-100 text-gray-400 border-gray-200":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:e},e))})]}),h.skills.length>0&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Selected Skills:"}),(0,Pt.jsx)("div",{className:"flex flex-wrap gap-2",children:h.skills.map(e=>(0,Pt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary-100 text-primary-800",children:[e,(0,Pt.jsx)("button",{onClick:()=>{return t=e,void m(e=>(0,o.A)((0,o.A)({},e),{},{skills:e.skills.filter(e=>e!==t)}));var t},className:"ml-2 text-primary-600 hover:text-primary-800",children:"\xd7"})]},e))})]}),0===h.skills.length&&(0,Pt.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,Pt.jsx)("p",{className:"text-sm text-blue-800",children:"You can skip this step and focus on learning. You can always add skills later from your profile page."})})]});case"gemini_api_key":return(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)(ar,{className:"w-12 h-12 text-purple-600 mx-auto mb-4"}),(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Gemini API Key ",(0,Pt.jsx)("span",{className:"text-sm font-normal text-gray-500",children:"(Optional)"})]}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:"Add your Gemini API key to enable AI-powered SMART goal feedback. Get your free API key from Google AI Studio."}),(0,Pt.jsx)("input",{type:"text",value:h.gemini_api_key||"",onChange:e=>m(t=>(0,o.A)((0,o.A)({},t),{},{gemini_api_key:e.target.value})),placeholder:"Paste your Gemini API key here",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-center text-lg"}),(0,Pt.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,Pt.jsx)("p",{className:"text-sm text-blue-800 mb-2",children:(0,Pt.jsx)("strong",{children:"How to get your Gemini API key:"})}),(0,Pt.jsxs)("ol",{className:"text-sm text-blue-800 list-decimal list-inside space-y-1",children:[(0,Pt.jsxs)("li",{children:["Go to ",(0,Pt.jsx)("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-blue-600",children:"Google AI Studio"})]}),(0,Pt.jsx)("li",{children:"Sign in with your Google account"}),(0,Pt.jsx)("li",{children:'Click "Create API key"'}),(0,Pt.jsx)("li",{children:'Copy the generated key (starts with "AIza...")'}),(0,Pt.jsx)("li",{children:"Paste it here"})]}),(0,Pt.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"Note: This is different from your Firebase API key. Make sure to get it from Google AI Studio."})]})]});case"complete":return(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)(qn,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),(0,Pt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Profile Complete!"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:"Great! Your profile is now complete. You can always update it later from your profile page."}),(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-left",children:[(0,Pt.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Profile Updates:"}),(0,Pt.jsxs)("ul",{className:"space-y-1 text-sm text-gray-700",children:[g.includes("name")&&(0,Pt.jsxs)("li",{children:["\u2022 Name: ",h.name]}),g.includes("campus")&&(0,Pt.jsxs)("li",{children:["\u2022 Campus: ",h.campus]}),g.includes("house")&&(0,Pt.jsxs)("li",{children:["\u2022 House: ",h.house]}),h.skills.length>0&&(0,Pt.jsxs)("li",{children:["\u2022 Skills: ",h.skills.join(", ")]}),h.gemini_api_key&&(0,Pt.jsxs)("li",{children:["\u2022 Gemini API Key: ",(0,Pt.jsx)("span",{className:"text-xs text-gray-500",children:"(Saved)"})]}),0===g.length&&0===h.skills.length&&!h.gemini_api_key&&(0,Pt.jsx)("li",{className:"text-gray-500 italic",children:"No updates needed - profile is complete!"})]})]})]});default:return null}})()}),(0,Pt.jsxs)("div",{className:"flex justify-between gap-2 flex-wrap sm:flex-nowrap",children:[(0,Pt.jsx)("button",{onClick:()=>{l>1&&c(l-1)},disabled:1===l,className:"px-3 sm:px-4 py-2 text-sm sm:text-base text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),"complete"===b()?(0,Pt.jsx)("button",{onClick:j,disabled:d,className:"px-4 sm:px-6 py-2 text-sm sm:text-base bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50",children:d?"Saving...":"Complete Profile"}):l===v?(0,Pt.jsx)("button",{onClick:j,disabled:d,className:"px-4 sm:px-6 py-2 text-sm sm:text-base bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50",children:d?"Saving...":"Complete"}):(0,Pt.jsxs)("div",{className:"flex gap-2",children:["skills"===b()&&(0,Pt.jsx)("button",{onClick:j,disabled:d,className:"px-2 sm:px-4 py-2 text-xs sm:text-base text-primary-600 bg-white border border-primary-600 rounded-md hover:bg-primary-50 disabled:opacity-50 whitespace-nowrap",children:"Skip"}),(0,Pt.jsx)("button",{onClick:()=>{l<v&&c(l+1)},disabled:!(()=>{switch(b()){case"name":return h.name.trim().length>0;case"campus":return""!==h.campus;case"house":return""!==h.house;case"skills":case"gemini_api_key":case"complete":return!0;default:return!1}})(),className:"px-3 sm:px-4 py-2 text-sm sm:text-base bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),(0,Pt.jsx)(hr,{visible:N.visible,message:N.message,type:N.type,onClose:()=>_({visible:!1,message:"",type:"info"})})]})}):null}function yr(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[n,a]=(0,r.useState)(!1),s=e=>{var n;const r=[];null!==(n=e.name)&&void 0!==n&&n.trim()||r.push("name"),e.campus||r.push("campus"),e.house||r.push("house");const a=r.length>0,s=3-r.length,i=Math.round(s/3*100);return{isProfileIncomplete:a,missingFields:r,shouldShowModal:a&&!t,completionPercentage:i}};(0,r.useEffect)(()=>{if(e&&!t){const t=s(e);a(t.shouldShowModal)}else a(!1)},[e,t]);const i=()=>e?s(e):{isProfileIncomplete:!1,missingFields:[],shouldShowModal:!1,completionPercentage:0},o=e=>({name:"Full Name",campus:"Campus",house:"House"}[e]||e);return{shouldShowModal:n,showModal:()=>a(!0),hideModal:()=>a(!1),getProfileStatus:i,getMissingFieldsDisplay:()=>i().missingFields.map(o),getFriendlyFieldName:o,get isProfileIncomplete(){return i().isProfileIncomplete},get missingFields(){return i().missingFields},get completionPercentage(){return i().completionPercentage}}}const xr=e=>{let{children:t}=e;const{userData:n,setUserData:a}=Rt(),[s,i]=(0,r.useState)(!1),{shouldShowModal:o,hideModal:l}=yr(n,s);return(0,r.useEffect)(()=>{n||i(!1)},[n]),(0,Pt.jsxs)("div",{className:"min-h-screen bg-gray-50 overflow-x-hidden",children:[(0,Pt.jsx)(ur,{}),(0,Pt.jsx)("main",{className:"pb-20 md:pb-6 pt-16 md:pt-0",children:(0,Pt.jsx)("div",{className:"py-4 sm:py-6",children:(0,Pt.jsx)("div",{className:"table-container",children:(0,Pt.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:t})})})}),n&&o&&(0,Pt.jsx)(gr,{isOpen:o,onClose:()=>{i(!0),l()},user:n,onProfileUpdated:e=>{a(e),i(!0)}})]})},vr=()=>{var e,t;const[n,a]=(0,r.useState)(!1),[s,i]=(0,r.useState)(""),{signInWithGoogle:o,currentUser:l,userData:c,impersonateUser:d}=Rt(),u=he(),h=(null===(e=ce().state)||void 0===e||null===(t=e.from)||void 0===t?void 0:t.pathname)||"/dashboard";(0,r.useEffect)(()=>{l&&c&&(console.log("\u2705 User logged in, redirecting to:",h),u(h,{replace:!0}))},[l,c,u,h]);return n||l&&!c?(0,Pt.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,Pt.jsx)("p",{className:"mt-4 text-gray-600",children:l?"Loading your profile...":"Signing in..."})]})}):(0,Pt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,Pt.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"mx-auto h-24 w-24 flex items-center justify-center",children:(0,Pt.jsx)("img",{src:"/logo.png",alt:"Campus Learning",className:"h-24 w-24 object-contain"})}),(0,Pt.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Campus Learning Dashboard"}),(0,Pt.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to access your learning journey"})]}),(0,Pt.jsx)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-start",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Pt.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,Pt.jsxs)("div",{className:"ml-3",children:[(0,Pt.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Navgurukul Access Only"}),(0,Pt.jsx)("div",{className:"mt-1 text-sm text-blue-700",children:(0,Pt.jsxs)("p",{children:["Only users with ",(0,Pt.jsx)("strong",{children:"@navgurukul.org"})," email addresses can access this platform."]})})]})]})}),(0,Pt.jsxs)("div",{className:"mt-8",children:[s&&(0,Pt.jsx)("div",{className:"rounded-md bg-red-50 p-4 mb-4",children:(0,Pt.jsx)("div",{className:"text-sm text-red-700",children:s})}),(0,Pt.jsxs)("button",{onClick:async()=>{try{i(""),a(!0),await o()}catch(s){var e;console.error("Sign in error:",s),a(!1),null!==(e=s.message)&&void 0!==e&&e.includes("Access denied")?i(s.message):"auth/popup-closed-by-user"===s.code?i("Sign-in cancelled. Please try again."):"auth/network-request-failed"===s.code?i("Network error. Please check your connection."):"Redirect initiated"===s.message?i("Redirecting to Google..."):i("Failed to sign in. Please try again.")}},disabled:n,className:"group relative w-full flex justify-center items-center py-3 px-4 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm transition-colors",children:[(0,Pt.jsxs)("svg",{className:"w-5 h-5 mr-3",viewBox:"0 0 24 24",children:[(0,Pt.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,Pt.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,Pt.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,Pt.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),n?(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600 mr-2"}),"Signing in..."]}):"Continue with Google"]}),(0,Pt.jsx)("div",{className:"mt-6 text-center",children:(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"By signing in, you agree to our Terms of Service and Privacy Policy"})})]}),("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)&&(0,Pt.jsxs)("div",{className:"hidden lg:block ml-8 w-80 bg-white p-6 rounded-lg shadow-lg border border-gray-200 overflow-y-auto max-h-[80vh]",children:[(0,Pt.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4 border-b pb-2",children:"Demo Accounts"}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Click any account to quick login (Dev only)"}),(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"Admin"}),(0,Pt.jsxs)("button",{onClick:()=>null===d||void 0===d?void 0:d("admin@navgurukul.org"),className:"w-full text-left bg-purple-50 hover:bg-purple-100 p-3 rounded-md transition-colors border border-purple-100 group",children:[(0,Pt.jsx)("div",{className:"font-medium text-purple-900",children:"System Admin"}),(0,Pt.jsx)("div",{className:"text-xs text-purple-600",children:"admin@navgurukul.org"})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"Mentors"}),(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsxs)("button",{onClick:()=>null===d||void 0===d?void 0:d("rahul.mentor@navgurukul.org"),className:"w-full text-left bg-blue-50 hover:bg-blue-100 p-3 rounded-md transition-colors border border-blue-100",children:[(0,Pt.jsx)("div",{className:"font-medium text-blue-900",children:"Rahul Mentor"}),(0,Pt.jsx)("div",{className:"text-xs text-blue-600",children:"rahul.mentor@navgurukul.org"})]}),(0,Pt.jsxs)("button",{onClick:()=>null===d||void 0===d?void 0:d("priya.mentor@navgurukul.org"),className:"w-full text-left bg-blue-50 hover:bg-blue-100 p-3 rounded-md transition-colors border border-blue-100",children:[(0,Pt.jsx)("div",{className:"font-medium text-blue-900",children:"Priya Mentor"}),(0,Pt.jsx)("div",{className:"text-xs text-blue-600",children:"priya.mentor@navgurukul.org"})]})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"Students"}),(0,Pt.jsx)("div",{className:"space-y-2",children:[{name:"Amit Student",email:"amit.student@navgurukul.org"},{name:"Neha Student",email:"neha.student@navgurukul.org"},{name:"Rohan Student",email:"rohan.student@navgurukul.org"},{name:"Sneha Student",email:"sneha.student@navgurukul.org"},{name:"Vikram Student",email:"vikram.student@navgurukul.org"}].map(e=>(0,Pt.jsxs)("button",{onClick:()=>null===d||void 0===d?void 0:d(e.email),className:"w-full text-left bg-green-50 hover:bg-green-100 p-3 rounded-md transition-colors border border-green-100",children:[(0,Pt.jsx)("div",{className:"font-medium text-green-900",children:e.name}),(0,Pt.jsx)("div",{className:"text-xs text-green-600",children:e.email})]},e.email))})]})]}),(0,Pt.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-100",children:(0,Pt.jsx)("p",{className:"text-xs text-gray-400 text-center",children:"These accounts are generated by the user seeding service."})})]})]})})},br=()=>(0,Pt.jsx)("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:(0,Pt.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-200 border-t-indigo-600"}),(0,Pt.jsx)("p",{className:"text-indigo-600 font-medium text-sm",children:"Loading..."})]})}),wr=()=>{const{userData:e,loading:t}=Rt();return t?(0,Pt.jsx)(br,{}):e?(0,Pt.jsx)(De,{to:"/mentor/dashboard",replace:!0}):(0,Pt.jsx)(De,{to:"/login",replace:!0})},jr=(e,t)=>{const n=(0,r.useRef)(null),a=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!e)return;const n=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[e,t]);return{modalRef:n,contentRef:a,handleOutsideClick:e=>{e.target===n.current&&t()},handleContentClick:e=>{e.stopPropagation()}}};var Nr=n(5173),_r=n.n(Nr);function Sr(){return Sr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sr.apply(this,arguments)}function kr(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Er=(0,r.forwardRef)(function(e,t){var n=e.color,a=void 0===n?"currentColor":n,s=e.size,i=void 0===s?24:s,o=kr(e,["color","size"]);return r.createElement("svg",Sr({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o),r.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))});Er.propTypes={color:_r().string,size:_r().oneOfType([_r().string,_r().number])},Er.displayName="X";const Ar=Er;function Cr(){return Cr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cr.apply(this,arguments)}function Dr(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Tr=(0,r.forwardRef)(function(e,t){var n=e.color,a=void 0===n?"currentColor":n,s=e.size,i=void 0===s?24:s,o=Dr(e,["color","size"]);return r.createElement("svg",Cr({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o),r.createElement("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),r.createElement("circle",{cx:"8.5",cy:"7",r:"4"}),r.createElement("polyline",{points:"17 11 19 13 23 9"}))});Tr.propTypes={color:_r().string,size:_r().oneOfType([_r().string,_r().number])},Tr.displayName="UserCheck";const Or=Tr;function Pr(){return Pr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pr.apply(this,arguments)}function Ir(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Rr=(0,r.forwardRef)(function(e,t){var n=e.color,a=void 0===n?"currentColor":n,s=e.size,i=void 0===s?24:s,o=Ir(e,["color","size"]);return r.createElement("svg",Pr({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o),r.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.createElement("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.createElement("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"}))});Rr.propTypes={color:_r().string,size:_r().oneOfType([_r().string,_r().number])},Rr.displayName="AlertCircle";const Mr=Rr;function Lr(){return Lr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lr.apply(this,arguments)}function Fr(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Ur=(0,r.forwardRef)(function(e,t){var n=e.color,a=void 0===n?"currentColor":n,s=e.size,i=void 0===s?24:s,o=Fr(e,["color","size"]);return r.createElement("svg",Lr({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o),r.createElement("circle",{cx:"11",cy:"11",r:"8"}),r.createElement("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}))});Ur.propTypes={color:_r().string,size:_r().oneOfType([_r().string,_r().number])},Ur.displayName="Search";const Br=Ur;function zr(){return zr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zr.apply(this,arguments)}function qr(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Vr=(0,r.forwardRef)(function(e,t){var n=e.color,a=void 0===n?"currentColor":n,s=e.size,i=void 0===s?24:s,o=qr(e,["color","size"]);return r.createElement("svg",zr({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o),r.createElement("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"}))});Vr.propTypes={color:_r().string,size:_r().oneOfType([_r().string,_r().number])},Vr.displayName="Filter";const Hr=Vr;function Wr(){return Wr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wr.apply(this,arguments)}function Gr(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Kr=(0,r.forwardRef)(function(e,t){var n=e.color,a=void 0===n?"currentColor":n,s=e.size,i=void 0===s?24:s,o=Gr(e,["color","size"]);return r.createElement("svg",Wr({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o),r.createElement("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),r.createElement("circle",{cx:"9",cy:"7",r:"4"}),r.createElement("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),r.createElement("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}))});Kr.propTypes={color:_r().string,size:_r().oneOfType([_r().string,_r().number])},Kr.displayName="Users";const Qr=Kr;function Yr(){return Yr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yr.apply(this,arguments)}function $r(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Jr=(0,r.forwardRef)(function(e,t){var n=e.color,a=void 0===n?"currentColor":n,s=e.size,i=void 0===s?24:s,o=$r(e,["color","size"]);return r.createElement("svg",Yr({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o),r.createElement("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}))});Jr.propTypes={color:_r().string,size:_r().oneOfType([_r().string,_r().number])},Jr.displayName="Star";const Xr=Jr;function Zr(){return Zr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zr.apply(this,arguments)}function ea(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var ta=(0,r.forwardRef)(function(e,t){var n=e.color,a=void 0===n?"currentColor":n,s=e.size,i=void 0===s?24:s,o=ea(e,["color","size"]);return r.createElement("svg",Zr({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o),r.createElement("line",{x1:"12",y1:"2",x2:"12",y2:"6"}),r.createElement("line",{x1:"12",y1:"18",x2:"12",y2:"22"}),r.createElement("line",{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"}),r.createElement("line",{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"}),r.createElement("line",{x1:"2",y1:"12",x2:"6",y2:"12"}),r.createElement("line",{x1:"18",y1:"12",x2:"22",y2:"12"}),r.createElement("line",{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"}),r.createElement("line",{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"}))});ta.propTypes={color:_r().string,size:_r().oneOfType([_r().string,_r().number])},ta.displayName="Loader";const na=ta,ra=e=>{let{className:t="",width:n="w-full",height:r="h-4"}=e;return(0,Pt.jsx)("div",{className:"animate-pulse bg-gray-200 rounded ".concat(n," ").concat(r," ").concat(t)})},aa=()=>(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(ra,{className:"w-12 h-12 rounded-full"}),(0,Pt.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,Pt.jsx)(ra,{width:"w-1/2",height:"h-4"}),(0,Pt.jsx)(ra,{width:"w-1/3",height:"h-3"})]})]}),(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsx)(ra,{width:"w-full",height:"h-3"}),(0,Pt.jsx)(ra,{width:"w-3/4",height:"h-3"}),(0,Pt.jsx)(ra,{width:"w-1/2",height:"h-3"})]}),(0,Pt.jsxs)("div",{className:"flex space-x-2",children:[(0,Pt.jsx)(ra,{width:"w-20",height:"h-8",className:"rounded-md"}),(0,Pt.jsx)(ra,{width:"w-24",height:"h-8",className:"rounded-md"})]})]}),sa=()=>(0,Pt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((e,t)=>(0,Pt.jsx)(aa,{},t))}),ia=e=>{let{currentStudentId:t,currentMentorId:n,onClose:a,onRequestSubmitted:s}=e;const{userData:i}=Rt(),[o,l]=(0,r.useState)([]),[c,d]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[m,p]=(0,r.useState)(!1),[f,g]=(0,r.useState)(null),[y,x]=(0,r.useState)(""),[v,b]=(0,r.useState)(!1),[w,j]=(0,r.useState)(""),[N,_]=(0,r.useState)(""),[S,k]=(0,r.useState)(""),[E,A]=(0,r.useState)(!0),[C,D]=(0,r.useState)(null),T=(0,r.useRef)(null),[O,P]=(0,r.useState)((null===i||void 0===i?void 0:i.campus)||"all"),[I,R]=(0,r.useState)((null===i||void 0===i?void 0:i.house)||"all"),[M,L]=(0,r.useState)(!1),[F,U]=(0,r.useState)(!1),{modalRef:B,contentRef:z,handleOutsideClick:q,handleContentClick:V}=jr(!0,a);(0,r.useEffect)(()=>{(async()=>{try{const e=(await pn.getStudentMentorRequests(t)).some(e=>"pending"===e.status);L(e)}catch(N){console.error("Error checking pending requests:",N)}})()},[t]),(0,r.useEffect)(()=>{(async()=>{h(!0),_(""),j(""),g(null),x("");try{console.log("\ud83d\udd0d [MentorBrowser] Loading initial page of mentors...");const e=await pn.getMentorsWithCapacityPaginated(10);console.log("\u2705 [MentorBrowser] Received ".concat(e.mentors.length," mentors, hasMore: ").concat(e.hasMore));const n=e.mentors.filter(e=>e.mentor.id!==t);console.log("\u2705 [MentorBrowser] Filtered mentors (excluding self): ".concat(n.length)),l(n),D(e.lastDoc),A(e.hasMore),0===n.length&&_("No mentors available at the moment.")}catch(N){console.error("\u274c [MentorBrowser] Error loading mentors:",N),_("Failed to load mentors. Please try again.")}finally{h(!1)}})()},[t]);(0,r.useEffect)(()=>{let e=[...o];if(null!==i&&void 0!==i&&i.current_phase_id&&Number(i.current_phase_id)>0){const t=Number(i.current_phase_id);e=e.filter(e=>Number(e.mentor.current_phase_id)>t)}if(S){const t=S.toLowerCase();e=e.filter(e=>e.mentor.name.toLowerCase().includes(t)||e.mentor.email.toLowerCase().includes(t))}"all"!==O&&(e=e.filter(e=>e.mentor.campus===O)),"all"!==I&&(e=e.filter(e=>e.mentor.house===I)),d(e)},[o,i,S,O,I]),(0,r.useEffect)(()=>{const e=()=>{if(!T.current||u||m||!E)return;const{scrollTop:e,scrollHeight:n,clientHeight:r}=T.current;e+r>=n-50&&(async()=>{if(!m&&E&&C){p(!0);try{console.log("\ud83d\udd0d [MentorBrowser] Loading more mentors...");const e=await pn.getMentorsWithCapacityPaginated(10,C);console.log("\u2705 [MentorBrowser] Received ".concat(e.mentors.length," more mentors, hasMore: ").concat(e.hasMore));const n=e.mentors.filter(e=>e.mentor.id!==t);l(e=>{const t=new Set(e.map(e=>e.mentor.id)),r=n.filter(e=>!t.has(e.mentor.id));return console.log("\ud83d\udcdd [MentorBrowser] Adding ".concat(r.length," new mentors (").concat(n.length-r.length," duplicates skipped)")),[...e,...r]}),D(e.lastDoc),A(e.hasMore)}catch(N){console.error("\u274c [MentorBrowser] Error loading more mentors:",N),_("Failed to load more mentors.")}finally{p(!1)}}})()},n=T.current;return n&&n.addEventListener("scroll",e),()=>{n&&n.removeEventListener("scroll",e)}},[u,m,E,C]);return(0,Pt.jsx)("div",{ref:B,className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",onClick:q,children:(0,Pt.jsxs)("div",{ref:z,className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-hidden flex flex-col",onClick:V,children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between px-3 sm:px-6 py-3 sm:py-4 border-b",children:[(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 flex-1 min-w-0",children:[(0,Pt.jsx)("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 truncate",children:"Browse Mentors"}),M&&(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full whitespace-nowrap w-fit",children:"Change request pending"})]}),(0,Pt.jsx)("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors flex-shrink-0","aria-label":"Close",children:(0,Pt.jsx)(Ar,{className:"h-5 w-5"})})]}),w&&(0,Pt.jsxs)("div",{className:"mx-3 sm:mx-6 mt-3 sm:mt-4 p-3 sm:p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-2 sm:gap-3",children:[(0,Pt.jsx)(Or,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-600 flex-shrink-0 mt-0.5"}),(0,Pt.jsx)("p",{className:"text-xs sm:text-sm text-green-800",children:w})]}),N&&(0,Pt.jsxs)("div",{className:"mx-3 sm:mx-6 mt-3 sm:mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2 sm:gap-3",children:[(0,Pt.jsx)(Mr,{className:"h-4 w-4 sm:h-5 sm:w-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,Pt.jsx)("p",{className:"text-xs sm:text-sm text-red-800",children:N})]}),(0,Pt.jsxs)("div",{ref:T,className:"flex-1 overflow-y-auto scroll-smooth",style:{scrollBehavior:"smooth"},children:[(0,Pt.jsxs)("div",{className:"px-3 sm:px-6 pt-3 sm:pt-6 space-y-3 sm:space-y-4",children:[(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)(Br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 sm:h-5 sm:w-5 text-gray-400"}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search mentors...",value:S,onChange:e=>k(e.target.value),className:"w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,Pt.jsxs)("button",{onClick:()=>U(!F),className:"flex items-center gap-2 px-3 sm:px-4 py-2 text-sm sm:text-base border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",title:"Toggle filter options",children:[(0,Pt.jsx)(Hr,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Filters"})]}),F&&(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4 space-y-3 sm:space-y-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:"Campus"}),(0,Pt.jsxs)("select",{value:O,onChange:e=>P(e.target.value),className:"w-full px-2 sm:px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,Pt.jsx)("option",{value:"all",children:"All Campuses"}),(0,Pt.jsx)("option",{value:"Dantewada",children:"Dantewada"}),(0,Pt.jsx)("option",{value:"Dharamshala",children:"Dharamshala"}),(0,Pt.jsx)("option",{value:"Eternal",children:"Eternal"}),(0,Pt.jsx)("option",{value:"Jashpur",children:"Jashpur"}),(0,Pt.jsx)("option",{value:"Kishanganj",children:"Kishanganj"}),(0,Pt.jsx)("option",{value:"Pune",children:"Pune"}),(0,Pt.jsx)("option",{value:"Raigarh",children:"Raigarh"}),(0,Pt.jsx)("option",{value:"Sarjapura",children:"Sarjapura"})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:"House"}),(0,Pt.jsxs)("select",{value:I,onChange:e=>R(e.target.value),className:"w-full px-2 sm:px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,Pt.jsx)("option",{value:"all",children:"All Houses"}),(0,Pt.jsx)("option",{value:"Bageshree",children:"Bageshree"}),(0,Pt.jsx)("option",{value:"Malhar",children:"Malhar"}),(0,Pt.jsx)("option",{value:"Bhairav",children:"Bhairav"})]})]})]})]}),(0,Pt.jsx)("div",{className:"px-3 sm:px-6 py-3 sm:py-6",children:u?(0,Pt.jsx)(sa,{}):N?(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(Mr,{className:"h-16 w-16 text-red-300 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:N})]}):0===c.length?(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(Qr,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"No mentors found matching your criteria."}),(0,Pt.jsx)("p",{className:"text-gray-500 text-sm mt-2",children:"Try adjusting your filters or search term."})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:c.map(e=>{const t=e.mentor.id===n,r=e.available_slots>0,a=f===e.mentor.id,s=e.mentor.leave_from&&e.mentor.leave_to&&new Date(e.mentor.leave_from)<=new Date&&new Date(e.mentor.leave_to)>=new Date;return(0,Pt.jsx)("div",{className:"border rounded-lg p-3 sm:p-4 transition-all ".concat(a?"border-primary-500 bg-primary-50 shadow-md":t?"border-blue-200 bg-blue-50":r&&!s?"border-gray-200 hover:border-gray-300 hover:bg-gray-50 cursor-pointer":"border-gray-200 bg-gray-50 opacity-60"),onClick:()=>{!r||t||s||g(e.mentor.id)},title:!r||t||s?t?"This is your current mentor":r?"Mentor is on leave":"No slots available":"Click to select this mentor",children:(0,Pt.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,Pt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Pt.jsx)("h3",{className:"font-semibold text-sm sm:text-base text-gray-900 truncate",children:e.mentor.name}),(0,Pt.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 truncate",children:e.mentor.email})]}),t&&(0,Pt.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full flex-shrink-0",children:"Current"})]}),(0,Pt.jsxs)("div",{className:"space-y-1 text-xs sm:text-sm text-gray-600",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)("span",{className:"font-medium",children:"Phase:"}),(0,Pt.jsx)("span",{className:"truncate",children:e.mentor.current_phase_id||"N/A"})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)("span",{className:"font-medium",children:"Campus:"}),(0,Pt.jsx)("span",{className:"truncate",children:e.mentor.campus})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)("span",{className:"font-medium",children:"House:"}),(0,Pt.jsx)("span",{className:"truncate",children:e.mentor.house})]})]}),(0,Pt.jsx)("div",{className:"flex items-center gap-2 text-xs sm:text-sm ".concat(s?"text-orange-600":r?"text-green-600":"text-red-600"),children:s?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Mr,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"On Leave"})]}):r?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Xr,{className:"h-4 w-4"}),(0,Pt.jsxs)("span",{children:[e.available_slots," slot(s) available"]})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Mr,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"No slots available"})]})})]})},e.mentor.id)})}),m&&(0,Pt.jsxs)("div",{className:"flex justify-center items-center py-3 sm:py-4 mt-3 sm:mt-4",children:[(0,Pt.jsx)(na,{className:"h-5 w-5 sm:h-6 sm:w-6 animate-spin text-primary-500"}),(0,Pt.jsx)("span",{className:"ml-2 text-gray-500 text-xs sm:text-sm",children:"Loading more..."})]})]})})]}),f&&(0,Pt.jsxs)("div",{className:"flex-shrink-0 border-t px-3 sm:px-6 py-3 sm:py-4 space-y-3 sm:space-y-4 bg-gray-50",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:"Reason for mentor change request"}),(0,Pt.jsx)("textarea",{value:y,onChange:e=>x(e.target.value),placeholder:"Please explain why you want to change your mentor...",rows:3,className:"w-full px-2 sm:px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,Pt.jsxs)("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-2 sm:gap-3",children:[(0,Pt.jsx)("button",{onClick:a,className:"px-4 py-2 text-sm sm:text-base border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",title:"Close mentor request dialog",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{if(f)if(y.trim()){b(!0),_(""),j(""),console.log("\ud83d\ude80 MentorBrowser: Starting mentor request submission",{currentStudentId:t,selectedMentor:f,currentMentorId:n,reason:y.substring(0,50)+"..."});try{const e=await pn.requestMentorChange(t,f,n,y);console.log("\u2705 MentorBrowser: Request submitted successfully",{requestId:e}),j("Mentor change request submitted successfully"),g(null),x(""),setTimeout(()=>{s()},1500)}catch(e){console.error("\u274c MentorBrowser: Error submitting mentor request:",e),_("Failed to submit mentor change request. Please try again.")}finally{b(!1)}}else _("Please provide a reason for the mentor change request");else _("Please select a mentor")},disabled:v||!y.trim(),className:"px-4 py-2 text-sm sm:text-base bg-primary-500 text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Send mentor request to selected mentor",children:v?"Submitting...":"Submit Request"})]})]})]})})},oa=Un("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),la=Un("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ca=e=>{let{hasSubmitted:t,onReviewClick:n,reviewType:a,revieweeName:s}=e;const[i,o]=(0,r.useState)(""),[l,c]=(0,r.useState)("safe");(0,r.useEffect)(()=>{const e=()=>{const e=qt(),n=Ht(e),r=new Date;if(t)return c("safe"),void o("Submitted");if(r>n){const e=Wt(n);return c("overdue"),void o("".concat(e," day").concat(e>1?"s":""," overdue"))}const a=n.getTime()-r.getTime(),s=Gt(n),i=Math.floor(a/36e5),l=Math.floor(a%36e5/6e4);i<3||0===s?(c("urgent"),o("".concat(i,"h ").concat(l,"m"))):1===s?(c("warning"),o("Due tomorrow")):(c("safe"),o("".concat(s," days left")))};e();const n=setInterval(e,6e4);return()=>clearInterval(n)},[t]);const d=(()=>{switch(l){case"overdue":return{bg:"bg-red-100 border-red-400",text:"text-red-800",icon:"text-red-600",button:"bg-red-600 hover:bg-red-700"};case"urgent":return{bg:"bg-orange-100 border-orange-400",text:"text-orange-800",icon:"text-orange-600",button:"bg-orange-600 hover:bg-orange-700"};case"warning":return{bg:"bg-yellow-100 border-yellow-400",text:"text-yellow-800",icon:"text-yellow-600",button:"bg-yellow-600 hover:bg-yellow-700"};case"safe":return{bg:"bg-green-100 border-green-400",text:"text-green-800",icon:"text-green-600",button:"bg-green-600 hover:bg-green-700"}}})();return t?(0,Pt.jsx)("div",{className:"border-l-4 p-4 rounded-lg ".concat(d.bg),children:(0,Pt.jsx)("div",{className:"flex items-center justify-between",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(qn,{className:"h-5 w-5 ".concat(d.icon," mr-3")}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("p",{className:"text-sm font-semibold ".concat(d.text),children:["\u2705 ","mentor"===a?"Mentor":"Mentee"," Review Submitted"]}),(0,Pt.jsxs)("p",{className:"text-xs ".concat(d.text," mt-1"),children:["Week of ",qt().toLocaleDateString()]})]})]})})}):(0,Pt.jsxs)("div",{className:"border-l-4 p-4 rounded-lg ".concat(d.bg),children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center flex-1",children:["overdue"===l?(0,Pt.jsx)(oa,{className:"h-5 w-5 ".concat(d.icon," mr-3 animate-pulse")}):(0,Pt.jsx)(la,{className:"h-5 w-5 ".concat(d.icon," mr-3")}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("p",{className:"text-sm font-semibold ".concat(d.text),children:["overdue"===l&&"\ud83d\udea8 OVERDUE: ","mentor"===a?"Mentor":"Mentee"," Review Pending",s&&" - ".concat(s)]}),(0,Pt.jsxs)("p",{className:"text-xs ".concat(d.text," mt-1 flex items-center"),children:[(0,Pt.jsx)(Bn,{className:"h-3 w-3 mr-1"}),(0,Pt.jsx)("span",{className:"font-medium",children:i}),(0,Pt.jsx)("span",{className:"mx-2",children:"\u2022"}),(0,Pt.jsx)("span",{children:"Deadline: Monday 11:59 PM"})]})]})]}),(0,Pt.jsx)("button",{onClick:n,className:"px-4 py-2 text-white text-sm font-medium rounded-lg transition-colors ".concat(d.button," ").concat("urgent"===l||"overdue"===l?"animate-pulse":""),children:"overdue"===l?"Submit Now!":"Complete Review"})]}),"overdue"!==l&&(0,Pt.jsx)("div",{className:"mt-3",children:(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"h-2 rounded-full transition-all duration-500 ".concat("urgent"===l?"bg-orange-600":"warning"===l?"bg-yellow-600":"bg-green-600"),style:{width:"".concat(Math.max(5,Math.min(100,100-Gt(Ht(qt()))/7*100)),"%")}})})})]})},da=e=>{const t=[e.morning_exercise,e.communication,e.academic_effort,e.campus_contribution,e.behavioural];"mentorship_level"in e&&t.push(e.mentorship_level);const n=t.reduce((e,t)=>e+t,0)/t.length;return Math.round(10*n)/10},ua=function(e){const t=((e,t)=>{if("all_time"===t)return e;const n=qt();if("current_week"===t)return e.filter(e=>Kt(new Date(e.week_start),n));if("last_4_weeks"===t){const t=new Date(n);return t.setDate(t.getDate()-28),e.filter(e=>{const r=new Date(e.week_start);return r>=t&&r<=n})}return e})(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all_time");if(0===t.length)return 0;const n=t.reduce((e,t)=>e+da(t),0);return Math.round(n/t.length*10)/10},ha=Un("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),ma=Un("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),pa=Un("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),fa=Un("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ga=()=>{var e,t,n,a,s,i,l,c,d,u,h,m,p,f,g,y,x,v,b;const w=he(),{userData:j}=Rt(),[N,_]=(0,r.useState)({todayGoal:null,todayReflection:null,weeklyAttendance:0,monthlyAttendance:0,pairProgrammingSessions:0,leavesRemaining:12,recentGoals:[],averageAchievement:0,latestReview:null,reviewScore:0,reviewHistory:[],reviewTrend:"stable",weeklyAvg:0,monthlyAvg:0}),[S,k]=(0,r.useState)(!0),[E,A]=(0,r.useState)(!1),[C,D]=(0,r.useState)(null),[T,O]=(0,r.useState)(null),[P,I]=(0,r.useState)(!0),[R,M]=(0,r.useState)(!1),[L,F]=(0,r.useState)(!1),[U,B]=(0,r.useState)(!1),[z,q]=(0,r.useState)(!1),[V,H]=(0,r.useState)({morningExercise:0,communication:0,academicEffort:0,campusContribution:0,behavioural:0,mentorshipLevel:0,notes:""}),[W,G]=(0,r.useState)(!1),[K,Q]=(0,r.useState)(!1),[Y,$]=(0,r.useState)([]),{modalRef:J,contentRef:X,handleOutsideClick:Z,handleContentClick:ee}=jr(U,()=>B(!1)),{modalRef:te,contentRef:ne,handleOutsideClick:re,handleContentClick:ae}=jr(z,()=>q(!1)),se=(0,r.useRef)(!1),ie=(0,r.useRef)(null),oe=(0,r.useCallback)(async()=>{if(j&&!se.current){se.current=!0;try{k(!0),console.log("\ud83d\udcca [StudentDashboard] Loading dashboard data for user:",j.id);const[t,n,r,a,s,i]=await Promise.all([cn.getGoalsByStudent(j.id,10),dn.getReflectionsByStudent(j.id),un.getStudentAttendance(j.id),hn.getStudentLeaves(j.id),xn.getSessionsByUser(j.id,"mentee").catch(()=>[]),gn.getLatestReview(j.id).catch(()=>null)]);console.log("\ud83c\udfaf [StudentDashboard] Computing today's goal from cached goals...");const o=await cn.getTodaysGoal(j.id),l=o&&n.find(e=>e.goal_id===o.id)||null,c=new Set(t.map(e=>e.id)),d=n.filter(e=>c.has(e.goal_id)),u=d.length>0?d.reduce((e,t)=>e+t.achieved_percentage,0)/d.length:0,h=Array.isArray(s)?s.filter(e=>"completed"===e.status).length:0;let m=0;try{const e=new Date;e.setDate(e.getDate()-30);const t=r.filter(t=>new Date(t.date)>=e),n=t.filter(e=>"present"===e.present_status).length;m=t.length>0?n/t.length*100:0,console.log("\ud83d\udcc5 [StudentDashboard] Attendance loaded:",m+"%")}catch(e){console.warn("\u26a0\ufe0f [StudentDashboard] Failed to compute attendance:",e)}let p=0;try{const e=(new Date).getFullYear();p=a.filter(t=>new Date(t.start_date).getFullYear()===e).reduce((e,t)=>{const n=new Date(t.start_date),r=new Date(t.end_date),a=Math.abs(r.getTime()-n.getTime());return e+(Math.ceil(a/864e5)+1)},0),console.log("\ud83c\udfd6\ufe0f [StudentDashboard] Leaves loaded, days taken:",p)}catch(e){console.warn("\u26a0\ufe0f [StudentDashboard] Failed to compute leaves:",e)}let f=i,g=0,y=[],x="stable",v=0,b=0;try{if(console.log("\ud83d\udcca [StudentDashboard] Loading review for user:",j.id),f){y=await gn.getReviewsByStudent(j.id),console.log("\ud83d\udcca [StudentDashboard] Review history:",y.length,"reviews"),g=da(f);const e=new Date,t=new Date(e.getTime()-6048e5),n=new Date(e.getTime()-2592e6),r=y.filter(e=>new Date(e.created_at)>=t),a=y.filter(e=>new Date(e.created_at)>=n);if(r.length>0){const e=r.reduce((e,t)=>e+da(t),0);v=Math.round(e/r.length*10)/10}if(a.length>0){const e=a.reduce((e,t)=>e+da(t),0);b=Math.round(e/a.length*10)/10}if(y.length>=2){const e=y.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).slice(0,3),t=e.slice(0,2).map(e=>da(e));if(2===t.length){const e=t[0]-t[1];x=e>.3?"improving":e<-.3?"declining":"stable"}}}if(f&&f.mentor_id)try{const e=await _t.UserService.getUserById(f.mentor_id);O(e),console.log("\ud83d\udc64 [StudentDashboard] Loaded reviewer:",null===e||void 0===e?void 0:e.name)}catch(e){console.warn("\u26a0\ufe0f [StudentDashboard] Failed to load reviewer data:",e)}}catch(e){console.warn("\u26a0\ufe0f [StudentDashboard] Failed to load review data:",e)}const w={todayGoal:o,todayReflection:l,weeklyAttendance:m,monthlyAttendance:Math.round(m),pairProgrammingSessions:h,leavesRemaining:Math.max(0,12-p),recentGoals:t,averageAchievement:Math.round(u),latestReview:f,reviewScore:g,reviewHistory:y,reviewTrend:x,weeklyAvg:v,monthlyAvg:b};console.log("\u2705 [StudentDashboard] Final stats:",w),_(w),ie.current=j.id}catch(e){console.error("Error loading dashboard data:",e)}finally{k(!1),se.current=!1}}},[j]);(0,r.useEffect)(()=>{j&&(ie.current===j.id&&se.current||oe())},[j,oe]),(0,r.useEffect)(()=>{(async()=>{if(null!==j&&void 0!==j&&j.mentor_id)try{const e=await _t.UserService.getUserById(j.mentor_id);if(D(e),e&&null!==j&&void 0!==j&&j.id){const t=qt(),n=await yn.hasSubmittedThisWeek(e.id,j.id,t);Q(n),console.log("\u2705 [StudentDashboard] Mentor review submitted this week: ".concat(n))}}catch(e){console.error("Error loading mentor data:",e)}finally{I(!1)}else I(!1)})()},[null===j||void 0===j?void 0:j.mentor_id,null===j||void 0===j?void 0:j.id]),(0,r.useEffect)(()=>{(async()=>{if(null!==j&&void 0!==j&&j.id&&null!==j&&void 0!==j&&j.isMentor)try{console.log("\ud83d\udc65 [StudentDashboard] User is also a mentor, loading mentees...");const e=await _t.UserService.getStudentsByMentor(j.id);$(e)}catch(e){console.error("Error loading mentees:",e)}})()},[null===j||void 0===j?void 0:j.id,null===j||void 0===j?void 0:j.isMentor]),(0,r.useEffect)(()=>{(async()=>{if(null!==j&&void 0!==j&&j.id)try{const e=(await pn.getStudentMentorRequests(j.id)).some(e=>"pending"===e.status);F(e)}catch(e){console.error("Error checking pending requests:",e)}})()},[null===j||void 0===j?void 0:j.id]);const le=e=>{switch(e){case"approved":return"text-green-600 bg-green-100";case"reviewed":return"text-blue-600 bg-blue-100";case"pending":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}};return S?(0,Pt.jsx)("div",{className:"flex items-center justify-center min-h-64",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome back, ",null===j||void 0===j?void 0:j.name,"!"]}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Here's your learning progress overview"})]}),(0,Pt.jsxs)("button",{onClick:()=>{k(!0),oe()},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Refresh dashboard data",children:[(0,Pt.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,Pt.jsx)("span",{children:"Refresh"})]})]}),C&&(0,Pt.jsx)(ca,{hasSubmitted:K,onReviewClick:()=>w("/mentor/mentee/".concat(C.id)),reviewType:"mentor",revieweeName:C.name}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[(0,Pt.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 bg-primary-100 rounded-lg",children:(0,Pt.jsx)($n,{className:"h-6 w-6 text-primary-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Achievement"}),(0,Pt.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[N.averageAchievement,"%"]})]})]})}),(0,Pt.jsx)("div",{className:"p-6 rounded-lg shadow-sm border border-gray-200 ".concat(N.latestReview?(null!==(e=N.reviewScore)&&void 0!==e?e:0)>=1.5?"bg-green-50 border-green-300":(null!==(t=N.reviewScore)&&void 0!==t?t:0)>=.5?"bg-blue-50 border-blue-300":(null!==(n=N.reviewScore)&&void 0!==n?n:0)>=-.5?"bg-yellow-50 border-yellow-300":"bg-red-50 border-red-300":"bg-yellow-50 border-yellow-300"),children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 rounded-lg ".concat(N.latestReview?(null!==(a=N.reviewScore)&&void 0!==a?a:0)>=1.5?"bg-green-100":(null!==(s=N.reviewScore)&&void 0!==s?s:0)>=.5?"bg-blue-100":(null!==(i=N.reviewScore)&&void 0!==i?i:0)>=-.5?"bg-yellow-100":"bg-red-100":"bg-yellow-100"),children:(0,Pt.jsx)(ha,{className:"h-6 w-6 ".concat(N.latestReview?(null!==(l=N.reviewScore)&&void 0!==l?l:0)>=1.5?"text-green-600":(null!==(c=N.reviewScore)&&void 0!==c?c:0)>=.5?"text-blue-600":(null!==(d=N.reviewScore)&&void 0!==d?d:0)>=-.5?"text-yellow-600":"text-red-600":"text-yellow-600")})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Performance Review"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:N.latestReview?(null!==(u=N.reviewScore)&&void 0!==u?u:0).toFixed(1):"N/A"})]})]})}),(0,Pt.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,Pt.jsx)(Bn,{className:"h-6 w-6 text-green-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Attendance"}),(0,Pt.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[N.monthlyAttendance,"%"]})]})]})}),(0,Pt.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,Pt.jsx)(er,{className:"h-6 w-6 text-blue-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pair Sessions"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:N.pairProgrammingSessions})]})]})}),(0,Pt.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,Pt.jsx)(ma,{className:"h-6 w-6 text-yellow-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Leaves Left"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:N.leavesRemaining})]})]})})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,Pt.jsxs)("div",{onClick:()=>w("/reviews"),className:"bg-gradient-to-br from-purple-500 to-indigo-600 text-white p-6 rounded-lg shadow-md cursor-pointer hover:shadow-xl transition-all transform hover:-translate-y-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(ha,{className:"h-6 w-6 mr-2"}),(0,Pt.jsx)("h3",{className:"text-lg font-bold",children:"Reviews"})]}),(0,Pt.jsx)(rr,{className:"h-5 w-5 rotate-[-90deg]"})]}),(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 backdrop-blur-sm",children:[(0,Pt.jsx)("p",{className:"text-xs opacity-90 mb-1",children:"Your Performance"}),(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("span",{className:"text-2xl font-bold",children:N.reviewScore?N.reviewScore.toFixed(1):"N/A"}),(0,Pt.jsx)("span",{className:"text-xs opacity-75",children:"Average Score"})]})]}),(0,Pt.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 backdrop-blur-sm",children:[(0,Pt.jsx)("p",{className:"text-xs opacity-90 mb-1",children:"People to Review"}),(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("span",{className:"text-2xl font-bold",children:(C?1:0)+Y.length}),(0,Pt.jsx)("span",{className:"text-xs opacity-75",children:C&&!K&&(0,Pt.jsx)("span",{className:"bg-red-500 px-2 py-1 rounded-full animate-pulse",children:"Due"})})]})]}),(0,Pt.jsx)("p",{className:"text-xs text-center opacity-75 mt-2",children:"Click to view detailed reviews \u2192"})]})]}),(0,Pt.jsxs)("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Pt.jsxs)("div",{onClick:()=>w("/student/book-session"),className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white p-6 rounded-lg shadow-md cursor-pointer hover:shadow-lg transition-all",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,Pt.jsx)("div",{className:"p-2 bg-white bg-opacity-20 rounded-lg",children:(0,Pt.jsx)(Bn,{className:"h-6 w-6"})}),(0,Pt.jsx)("h3",{className:"text-lg font-bold",children:"Book Pair Session"})]}),(0,Pt.jsx)("p",{className:"text-green-100 text-sm mb-2",children:"Schedule time with your mentor"}),(0,Pt.jsx)("div",{className:"text-right text-2xl",children:"\u2192"})]}),(0,Pt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,Pt.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,Pt.jsx)(Jn,{className:"h-6 w-6 text-purple-600"})}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"My Mentor"})]}),P?(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"Loading..."}):C?(0,Pt.jsxs)("div",{className:"mb-3",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:C.name}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:C.email}),L&&(0,Pt.jsx)("span",{className:"inline-block mt-2 px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded",children:"Change pending"})]}):(0,Pt.jsx)("p",{className:"text-sm text-gray-500 italic mb-3",children:"No mentor assigned"}),!P&&(0,Pt.jsx)("button",{onClick:()=>M(!0),disabled:L,className:"w-full py-2 px-3 text-sm font-medium rounded transition-colors ".concat(L?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-primary-600 text-white hover:bg-primary-700"),children:C?"Change Mentor":"Find Mentor"})]})]})]}),R&&j&&(0,Pt.jsx)(ia,{currentStudentId:j.id,currentMentorId:j.mentor_id,onClose:()=>M(!1),onRequestSubmitted:()=>{M(!1),F(!0)}},Date.now()),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(Yn,{className:"h-5 w-5 text-primary-600"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Today's Goal"})]}),N.todayGoal&&(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(le(N.todayGoal.status)),children:N.todayGoal.status})]}),N.todayGoal?(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsx)("p",{className:"text-gray-700",children:N.todayGoal.goal_text}),N.todayGoal.mentor_comment&&(0,Pt.jsx)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,Pt.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,Pt.jsx)("div",{className:"p-1 bg-blue-100 rounded-full mt-0.5",children:(0,Pt.jsx)(pa,{className:"h-4 w-4 text-blue-600"})}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-sm font-semibold text-blue-900 mb-1",children:"Mentor Comment"}),(0,Pt.jsx)("p",{className:"text-sm text-blue-800",children:N.todayGoal.mentor_comment})]})]})}),(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("span",{className:"text-sm text-gray-500",children:["Target: ",N.todayGoal.target_percentage,"%"]}),(0,Pt.jsx)("span",{className:"text-sm text-gray-500",children:new Date(N.todayGoal.created_at).toLocaleTimeString()})]})]}):(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)(Yn,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pt.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"No goal set for today"}),(0,Pt.jsx)("button",{onClick:()=>w("/goal-setting"),className:"mt-2 text-primary-600 hover:text-primary-700 text-sm font-medium",children:"Set a goal"})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(pa,{className:"h-5 w-5 text-primary-600"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Today's Reflection"})]}),N.todayReflection&&(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(le(N.todayReflection.status)),children:N.todayReflection.status})]}),N.todayReflection?(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("div",{className:"mb-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Achievement"}),(0,Pt.jsxs)("span",{className:"text-lg font-bold text-primary-600",children:[N.todayReflection.achieved_percentage,"%"]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(N.todayReflection.achieved_percentage,"%")}})})]}),(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"\u2b50 What worked well"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900 ".concat(E?"":"line-clamp-2"),children:N.todayReflection.reflection_answers.workedWell})]}),E&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"\ud83e\udd1d How I achieved this"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900",children:N.todayReflection.reflection_answers.howAchieved})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"\ud83d\udca1 Key learning"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900",children:N.todayReflection.reflection_answers.keyLearning})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"\ud83d\ude80 Challenges & improvements"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900",children:N.todayReflection.reflection_answers.challenges})]})]})]}),(0,Pt.jsxs)("button",{onClick:()=>A(!E),className:"flex items-center space-x-2 text-sm text-primary-600 hover:text-primary-700 font-medium",children:[(0,Pt.jsx)("span",{children:E?"Show Less":"Show More"}),E?(0,Pt.jsx)(fa,{className:"h-4 w-4"}):(0,Pt.jsx)(rr,{className:"h-4 w-4"})]}),(0,Pt.jsx)("div",{className:"pt-3 border-t border-gray-200",children:(0,Pt.jsxs)("span",{className:"text-xs text-gray-500",children:["Submitted at ",new Date(N.todayReflection.created_at).toLocaleTimeString()]})}),N.todayReflection.mentor_notes&&(0,Pt.jsx)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,Pt.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Pt.jsx)("div",{className:"p-1.5 bg-blue-100 rounded-full",children:(0,Pt.jsx)(pa,{className:"h-4 w-4 text-blue-600"})}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pt.jsx)("p",{className:"text-sm font-semibold text-blue-900",children:"Mentor Feedback"}),N.todayReflection.mentor_assessment&&(0,Pt.jsxs)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full ".concat("exceeds_expectations"===N.todayReflection.mentor_assessment?"bg-green-100 text-green-700":"on_track"===N.todayReflection.mentor_assessment?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"),children:["exceeds_expectations"===N.todayReflection.mentor_assessment&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(ha,{className:"h-3 w-3 inline mr-1"}),"Exceeds Expectations"]}),"on_track"===N.todayReflection.mentor_assessment&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(qn,{className:"h-3 w-3 inline mr-1"}),"On Track"]}),"needs_improvement"===N.todayReflection.mentor_assessment&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Hn,{className:"h-3 w-3 inline mr-1"}),"Needs Improvement"]})]})]}),(0,Pt.jsx)("p",{className:"text-sm text-blue-800",children:N.todayReflection.mentor_notes}),N.todayReflection.feedback_given_at&&(0,Pt.jsxs)("p",{className:"text-xs text-blue-600 mt-2",children:["Reviewed on ",new Date(N.todayReflection.feedback_given_at).toLocaleString()]})]})]})}),!N.todayReflection.mentor_notes&&"pending"===N.todayReflection.status&&(0,Pt.jsxs)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center space-x-2",children:[(0,Pt.jsx)(la,{className:"h-4 w-4 text-yellow-600"}),(0,Pt.jsx)("p",{className:"text-sm text-yellow-800",children:"Waiting for mentor review..."})]})]}):"approved"===(null===(h=N.todayGoal)||void 0===h?void 0:h.status)?(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)(pa,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pt.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"No reflection submitted yet"}),(0,Pt.jsx)("button",{onClick:()=>w("/goal-setting"),className:"mt-2 text-primary-600 hover:text-primary-700 text-sm font-medium",children:"Submit reflection"})]}):(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)(la,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pt.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:N.todayGoal?"Waiting for goal approval":"Set a goal first"})]})]})})]}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Goals Progress"}),N.recentGoals.length>0?(0,Pt.jsx)("div",{className:"space-y-4",children:N.recentGoals.slice(0,3).map(e=>(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 p-4 bg-gray-50 rounded-lg",children:[(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-900 line-clamp-2",children:e.goal_text}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(e.created_at).toLocaleDateString()," \u2022 Target: ",e.target_percentage,"%"]})]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(le(e.status)),children:e.status}),"approved"===e.status?(0,Pt.jsx)(qn,{className:"h-5 w-5 text-green-500"}):"reviewed"===e.status?(0,Pt.jsx)(la,{className:"h-5 w-5 text-blue-500"}):(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-yellow-500"})]})]},e.id))}):(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)(Yn,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pt.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"No goals set yet"}),(0,Pt.jsx)("p",{className:"text-xs text-gray-400",children:"Start setting daily goals to track your progress"})]})]})}),U&&(0,Pt.jsx)("div",{ref:J,className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:Z,children:(0,Pt.jsx)("div",{ref:X,className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:ee,children:(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Performance Review"}),N.latestReview&&(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Reviewed by: ",(0,Pt.jsx)("span",{className:"font-medium text-blue-600",children:(null===T||void 0===T?void 0:T.name)||(null===C||void 0===C?void 0:C.name)||"Your Mentor"})]})]}),(0,Pt.jsx)("button",{onClick:()=>B(!1),className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Pt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),N.latestReview?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"mb-6 p-3 bg-purple-50 rounded-lg",children:(0,Pt.jsxs)("p",{className:"text-sm text-purple-800",children:[(0,Pt.jsx)("span",{className:"font-medium",children:"Latest Review:"})," ",new Date(N.latestReview.created_at).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})}),(0,Pt.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,Pt.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Category Ratings"}),[{key:"morning_exercise",label:"Morning Exercise",value:N.latestReview.morning_exercise,icon:"\ud83c\udfc3"},{key:"communication",label:"Communication",value:N.latestReview.communication,icon:"\ud83d\udcac"},{key:"academic_effort",label:"Academic Effort",value:N.latestReview.academic_effort,icon:"\ud83d\udcda"},{key:"campus_contribution",label:"Campus Contribution",value:N.latestReview.campus_contribution,icon:"\ud83e\udd1d"},{key:"behavioural",label:"Behavioral",value:N.latestReview.behavioural,icon:"\u2b50"},...void 0!==N.latestReview.mentorship_level?[{key:"mentorship_level",label:"Mentorship Level",value:N.latestReview.mentorship_level,icon:"\ud83c\udf93"}]:[]].map(e=>{const t=2===e.value?"Showing great growth":1===e.value?"Improving consistently":0===e.value?"Has scope for improvement":-1===e.value?"Needs consistent effort":"Needs to put in serious effort",n=e.value<=-1;return(0,Pt.jsxs)("div",{className:"p-4 rounded-lg border-2 transition-all ".concat(n?"bg-red-50 border-red-200":"bg-gray-50 border-transparent"),children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("span",{className:"text-xl",children:e.icon}),(0,Pt.jsx)("span",{className:"font-medium text-gray-900",children:e.label}),n&&(0,Pt.jsx)("span",{className:"text-xs bg-red-500 text-white px-2 py-0.5 rounded-full font-medium",children:"Focus Area"})]}),(0,Pt.jsxs)("span",{className:"px-2 py-1 rounded text-sm font-bold ".concat(e.value>=1?"bg-green-100 text-green-800":e.value>=0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[e.value>0?"+":"",e.value]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:(0,Pt.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(e.value>=1?"bg-green-500":e.value>=0?"bg-yellow-500":"bg-red-500"),style:{width:"".concat((e.value+2)/4*100,"%")}})}),(0,Pt.jsx)("p",{className:"text-xs font-medium ".concat(e.value>=1?"text-green-700":e.value>=0?"text-yellow-700":"text-red-700"),children:t})]},e.key)})]}),(0,Pt.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-4 rounded-lg mb-6 border-2 border-purple-200",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Overall Average Score"}),(0,Pt.jsxs)("p",{className:"text-3xl font-bold text-gray-900",children:[(null!==(m=N.reviewScore)&&void 0!==m?m:0).toFixed(1),"/2"]}),(0,Pt.jsx)("div",{className:"inline-flex items-center space-x-1 text-sm px-3 py-1.5 rounded-full font-medium mt-2 ".concat((null!==(p=N.reviewScore)&&void 0!==p?p:0)>=1.5?"bg-green-100 text-green-800":(null!==(f=N.reviewScore)&&void 0!==f?f:0)>=.5?"bg-blue-100 text-blue-800":(null!==(g=N.reviewScore)&&void 0!==g?g:0)>=-.5?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:void 0!==N.reviewScore?(null!==(y=N.reviewScore)&&void 0!==y?y:0)>=1.5?"\ud83c\udf1f Showing great growth!":(null!==(x=N.reviewScore)&&void 0!==x?x:0)>=.5?"\ud83d\udcc8 Improving consistently":(null!==(v=N.reviewScore)&&void 0!==v?v:0)>=-.5?"\u26a0\ufe0f Has scope for improvement":(null!==(b=N.reviewScore)&&void 0!==b?b:0)>=-1.5?"\ud83d\udd14 Needs consistent effort":"\u26a1 Needs to put in serious effort":"Loading..."})]})}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"7-Day Average"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(N.weeklyAvg||N.reviewScore||0).toFixed(1)}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"Scale: -2 to +2"})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"30-Day Average"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(N.monthlyAvg||N.reviewScore||0).toFixed(1)}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"Scale: -2 to +2"})]})]}),(()=>{const e=[{key:"morning_exercise",label:"Morning Exercise",value:N.latestReview.morning_exercise,icon:"\ud83c\udfc3"},{key:"communication",label:"Communication",value:N.latestReview.communication,icon:"\ud83d\udcac"},{key:"academic_effort",label:"Academic Effort",value:N.latestReview.academic_effort,icon:"\ud83d\udcda"},{key:"campus_contribution",label:"Campus Contribution",value:N.latestReview.campus_contribution,icon:"\ud83e\udd1d"},{key:"behavioural",label:"Behavioral",value:N.latestReview.behavioural,icon:"\u2b50"}].filter(e=>e.value<=-1);return e.length>0?(0,Pt.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg border-l-4 border-red-400 mb-6",children:[(0,Pt.jsxs)("p",{className:"text-sm font-medium text-red-800 mb-3 flex items-center",children:[(0,Pt.jsx)("span",{className:"text-lg mr-2",children:"\ud83c\udfaf"}),"Priority Areas to Focus (",e.length,")"]}),(0,Pt.jsx)("ul",{className:"space-y-2",children:e.map(e=>(0,Pt.jsxs)("li",{className:"text-sm text-red-700 flex items-center",children:[(0,Pt.jsx)("span",{className:"mr-2",children:e.icon}),(0,Pt.jsx)("span",{className:"font-medium",children:e.label}),(0,Pt.jsx)("span",{className:"ml-auto text-xs bg-red-200 text-red-800 px-2 py-0.5 rounded",children:-2===e.value?"Needs serious effort":"Needs consistent effort"})]},e.key))})]}):(0,Pt.jsx)("div",{className:"bg-green-50 p-4 rounded-lg border-l-4 border-green-400 mb-6",children:(0,Pt.jsxs)("p",{className:"text-sm font-medium text-green-800 flex items-center",children:[(0,Pt.jsx)("span",{className:"text-lg mr-2",children:"\u2728"}),"Great job! No critical areas. Keep up the good work!"]})})})(),N.latestReview.notes&&(0,Pt.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border-l-4 border-blue-400",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"\ud83d\udcac Mentor Notes"}),(0,Pt.jsx)("p",{className:"text-sm text-blue-700 leading-relaxed",children:N.latestReview.notes})]})]}):(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udcdd"}),(0,Pt.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No Review Yet"}),(0,Pt.jsx)("p",{className:"text-gray-500 mb-4",children:"Your mentor hasn't submitted a performance review yet."}),(0,Pt.jsx)("p",{className:"text-sm text-gray-400",children:"Check back later for feedback and guidance."})]})]})})}),z&&C&&(0,Pt.jsx)("div",{ref:te,className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:re,children:(0,Pt.jsxs)("div",{ref:ne,className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:ae,children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(ha,{className:"h-6 w-6 text-purple-600 mr-2"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Review Your Mentor"})]}),(0,Pt.jsx)("button",{onClick:()=>q(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Close review modal",children:(0,Pt.jsx)(Hn,{className:"h-5 w-5 rotate-45"})})]}),(0,Pt.jsx)("div",{className:"mb-4 p-3 bg-purple-50 rounded-lg",children:(0,Pt.jsxs)("p",{className:"text-sm text-purple-800",children:[(0,Pt.jsx)("span",{className:"font-medium",children:"Reviewing:"})," ",C.name]})}),(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\ud83c\udfc3 Morning Exercise"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:V.morningExercise,onChange:e=>H(t=>(0,o.A)((0,o.A)({},t),{},{morningExercise:parseInt(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{children:"-2"}),(0,Pt.jsx)("span",{children:"0"}),(0,Pt.jsx)("span",{children:"+2"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat(V.morningExercise>=1?"bg-green-100 text-green-800":V.morningExercise<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:V.morningExercise})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\ud83d\udcac Communication"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:V.communication,onChange:e=>H(t=>(0,o.A)((0,o.A)({},t),{},{communication:parseInt(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{children:"-2"}),(0,Pt.jsx)("span",{children:"0"}),(0,Pt.jsx)("span",{children:"+2"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat(V.communication>=1?"bg-green-100 text-green-800":V.communication<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:V.communication})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\ud83d\udcda Academic Effort"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:V.academicEffort,onChange:e=>H(t=>(0,o.A)((0,o.A)({},t),{},{academicEffort:parseInt(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{children:"-2"}),(0,Pt.jsx)("span",{children:"0"}),(0,Pt.jsx)("span",{children:"+2"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat(V.academicEffort>=1?"bg-green-100 text-green-800":V.academicEffort<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:V.academicEffort})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\ud83e\udd1d Campus Contribution"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:V.campusContribution,onChange:e=>H(t=>(0,o.A)((0,o.A)({},t),{},{campusContribution:parseInt(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{children:"-2"}),(0,Pt.jsx)("span",{children:"0"}),(0,Pt.jsx)("span",{children:"+2"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat(V.campusContribution>=1?"bg-green-100 text-green-800":V.campusContribution<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:V.campusContribution})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"\u2b50 Behavioral"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:V.behavioural,onChange:e=>H(t=>(0,o.A)((0,o.A)({},t),{},{behavioural:parseInt(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{children:"-2"}),(0,Pt.jsx)("span",{children:"0"}),(0,Pt.jsx)("span",{children:"+2"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat(V.behavioural>=1?"bg-green-100 text-green-800":V.behavioural<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:V.behavioural})]}),(0,Pt.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg border-2 border-purple-200",children:[(0,Pt.jsx)("label",{className:"block text-sm font-semibold text-purple-700 mb-2",children:"\ud83c\udfaf Mentorship Quality (Additional Scale)"}),(0,Pt.jsx)("p",{className:"text-xs text-purple-600 mb-3",children:"Rate the quality of mentoring you received"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:V.mentorshipLevel,onChange:e=>H(t=>(0,o.A)((0,o.A)({},t),{},{mentorshipLevel:parseInt(e.target.value)})),className:"w-full h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-purple-600 mt-1",children:[(0,Pt.jsx)("span",{children:"-2: Poor"}),(0,Pt.jsx)("span",{children:"0: Average"}),(0,Pt.jsx)("span",{children:"+2: Excellent"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat(V.mentorshipLevel>=1?"bg-green-100 text-green-800":V.mentorshipLevel<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:V.mentorshipLevel})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Additional Notes (Optional)"}),(0,Pt.jsx)("textarea",{value:V.notes,onChange:e=>H(t=>(0,o.A)((0,o.A)({},t),{},{notes:e.target.value})),placeholder:"Share any additional feedback or comments...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3})]})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,Pt.jsx)("button",{onClick:()=>q(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{if(j&&C)try{G(!0);const e=qt();await yn.createReview({mentor_id:C.id,student_id:j.id,morning_exercise:V.morningExercise,communication:V.communication,academic_effort:V.academicEffort,campus_contribution:V.campusContribution,behavioural:V.behavioural,mentorship_level:V.mentorshipLevel,notes:V.notes,week_start:e}),H({morningExercise:0,communication:0,academicEffort:0,campusContribution:0,behavioural:0,mentorshipLevel:0,notes:""}),q(!1),alert("Mentor review submitted successfully!")}catch(e){console.error("Error submitting mentor review:",e),alert("Failed to submit mentor review. Please try again.")}finally{G(!1)}},disabled:W,className:"px-4 py-2 text-white bg-purple-600 rounded-lg hover:bg-purple-700 disabled:opacity-50 transition-colors",children:W?"Submitting...":"Submit Review"})]})]})})]})};function ya(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function xa(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var va=n(4705);function ba(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let wa={async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};function ja(e){wa=e}const Na=/[&<>"']/,_a=new RegExp(Na.source,"g"),Sa=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,ka=new RegExp(Sa.source,"g"),Ea={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Aa=e=>Ea[e];function Ca(e,t){if(t){if(Na.test(e))return e.replace(_a,Aa)}else if(Sa.test(e))return e.replace(ka,Aa);return e}const Da=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function Ta(e){return e.replace(Da,(e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"")}const Oa=/(^|[^\[])\^/g;function Pa(e,t){e="string"===typeof e?e:e.source,t=t||"";const n={replace:(t,r)=>(r=(r=r.source||r).replace(Oa,"$1"),e=e.replace(t,r),n),getRegex:()=>new RegExp(e,t)};return n}const Ia=/[^\w:]/g,Ra=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Ma(e,t,n){if(e){let e;try{e=decodeURIComponent(Ta(n)).replace(Ia,"").toLowerCase()}catch(BM){return null}if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:")||0===e.indexOf("data:"))return null}t&&!Ra.test(n)&&(n=function(e,t){La[" "+e]||(Fa.test(e)?La[" "+e]=e+"/":La[" "+e]=Va(e,"/",!0));e=La[" "+e];const n=-1===e.indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(Ua,"$1")+t:"/"===t.charAt(0)?n?t:e.replace(Ba,"$1")+t:e+t}(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(BM){return null}return n}const La={},Fa=/^[^:]+:\/*[^/]*$/,Ua=/^([^:]+:)[\s\S]*$/,Ba=/^([^:]+:\/*[^/]*)[\s\S]*$/;const za={exec:function(){}};function qa(e,t){const n=e.replace(/\|/g,(e,t,n)=>{let r=!1,a=t;for(;--a>=0&&"\\"===n[a];)r=!r;return r?"|":" |"}).split(/ \|/);let r=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function Va(e,t,n){const r=e.length;if(0===r)return"";let a=0;for(;a<r;){const s=e.charAt(r-a-1);if(s!==t||n){if(s===t||!n)break;a++}else a++}return e.slice(0,r-a)}function Ha(e,t,n,r){const a=t.href,s=t.title?Ca(t.title):null,i=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;const e={type:"link",raw:n,href:a,title:s,text:i,tokens:r.inlineTokens(i)};return r.state.inLink=!1,e}return{type:"image",raw:n,href:a,title:s,text:Ca(i)}}class Wa{constructor(e){this.options=e||wa}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:Va(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t){const n=e.match(/^(\s+)(?:```)/);if(null===n)return t;const r=n[1];return t.split("\n").map(e=>{const t=e.match(/^\s+/);if(null===t)return e;const[n]=t;return n.length>=r.length?e.slice(r.length):e}).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){const t=Va(e,"#");this.options.pedantic?e=t.trim():t&&!/ $/.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const e=t[0].replace(/^ *>[ \t]?/gm,""),n=this.lexer.state.top;this.lexer.state.top=!0;const r=this.lexer.blockTokens(e);return this.lexer.state.top=n,{type:"blockquote",raw:t[0],tokens:r,text:e}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,r,a,s,i,o,l,c,d,u,h,m,p=t[1].trim();const f=p.length>1,g={type:"list",raw:"",ordered:f,start:f?+p.slice(0,-1):"",loose:!1,items:[]};p=f?"\\d{1,9}\\".concat(p.slice(-1)):"\\".concat(p),this.options.pedantic&&(p=f?p:"[*+-]");const y=new RegExp("^( {0,3}".concat(p,")((?:[\t ][^\\n]*)?(?:\\n|$))"));for(;e&&(m=!1,t=y.exec(e))&&!this.rules.block.hr.test(e);){if(n=t[0],e=e.substring(n.length),c=t[2].split("\n",1)[0].replace(/^\t+/,e=>" ".repeat(3*e.length)),d=e.split("\n",1)[0],this.options.pedantic?(s=2,h=c.trimLeft()):(s=t[2].search(/[^ ]/),s=s>4?1:s,h=c.slice(s),s+=t[1].length),o=!1,!c&&/^ *$/.test(d)&&(n+=d+"\n",e=e.substring(d.length+1),m=!0),!m){const t=new RegExp("^ {0,".concat(Math.min(3,s-1),"}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))")),r=new RegExp("^ {0,".concat(Math.min(3,s-1),"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)")),a=new RegExp("^ {0,".concat(Math.min(3,s-1),"}(?:```|~~~)")),i=new RegExp("^ {0,".concat(Math.min(3,s-1),"}#"));for(;e&&(u=e.split("\n",1)[0],d=u,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!a.test(d))&&!i.test(d)&&!t.test(d)&&!r.test(e);){if(d.search(/[^ ]/)>=s||!d.trim())h+="\n"+d.slice(s);else{if(o)break;if(c.search(/[^ ]/)>=4)break;if(a.test(c))break;if(i.test(c))break;if(r.test(c))break;h+="\n"+d}o||d.trim()||(o=!0),n+=u+"\n",e=e.substring(u.length+1),c=d.slice(s)}}g.loose||(l?g.loose=!0:/\n *\n *$/.test(n)&&(l=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(h),r&&(a="[ ] "!==r[0],h=h.replace(/^\[[ xX]\] +/,""))),g.items.push({type:"list_item",raw:n,task:!!r,checked:a,loose:!1,text:h}),g.raw+=n}g.items[g.items.length-1].raw=n.trimRight(),g.items[g.items.length-1].text=h.trimRight(),g.raw=g.raw.trimRight();const x=g.items.length;for(i=0;i<x;i++)if(this.lexer.state.top=!1,g.items[i].tokens=this.lexer.blockTokens(g.items[i].text,[]),!g.loose){const e=g.items[i].tokens.filter(e=>"space"===e.type),t=e.length>0&&e.some(e=>/\n.*\n/.test(e.raw));g.loose=t}if(g.loose)for(i=0;i<x;i++)g.items[i].loose=!0;return g}}html(e){const t=this.rules.block.html.exec(e);if(t){const e={type:"html",block:!0,raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};if(this.options.sanitize){const n=this.options.sanitizer?this.options.sanitizer(t[0]):Ca(t[0]);e.type="paragraph",e.text=n,e.tokens=this.lexer.inline(n)}return e}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(/\s+/g," "),n=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(t){const e={type:"table",header:qa(t[1]).map(e=>({text:e})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(e.header.length===e.align.length){e.raw=t[0];let n,r,a,s,i=e.align.length;for(n=0;n<i;n++)/^ *-+: *$/.test(e.align[n])?e.align[n]="right":/^ *:-+: *$/.test(e.align[n])?e.align[n]="center":/^ *:-+ *$/.test(e.align[n])?e.align[n]="left":e.align[n]=null;for(i=e.rows.length,n=0;n<i;n++)e.rows[n]=qa(e.rows[n],e.header.length).map(e=>({text:e}));for(i=e.header.length,r=0;r<i;r++)e.header[r].tokens=this.lexer.inline(e.header[r].text);for(i=e.rows.length,r=0;r<i;r++)for(s=e.rows[r],a=0;a<s.length;a++)s[a].tokens=this.lexer.inline(s[a].text);return e}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Ca(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):Ca(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;const t=Va(e.slice(0,-1),"\\");if((e.length-t.length)%2===0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;const n=e.length;let r=0,a=0;for(;a<n;a++)if("\\"===e[a])a++;else if(e[a]===t[0])r++;else if(e[a]===t[1]&&(r--,r<0))return a;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){const e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(n=this.options.pedantic&&!/>$/.test(e)?n.slice(1):n.slice(1,-1)),Ha(t,{href:n?n.replace(this.rules.inline._escapes,"$1"):n,title:r?r.replace(this.rules.inline._escapes,"$1"):r},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let e=(n[2]||n[1]).replace(/\s+/g," ");if(e=t[e.toLowerCase()],!e){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return Ha(n,e,n[0],this.lexer)}}emStrong(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=this.rules.inline.emStrong.lDelim.exec(e);if(!r)return;if(r[3]&&n.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDD40-\uDD65\uDD6F-\uDD85\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDDB0-\uDDDB\uDDE0-\uDDE9\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDF50-\uDF59\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D\uDD30-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE96\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD833[\uDCF0-\uDCF9]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDCD0-\uDCEB\uDCF0-\uDCF9\uDDD0-\uDDED\uDDF0-\uDDFA\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])/))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const n=r[0].length-1;let a,s,i=n,o=0;const l="*"===r[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+n);null!=(r=l.exec(t));){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(s=a.length,r[3]||r[4]){i+=s;continue}if((r[5]||r[6])&&n%3&&!((n+s)%3)){o+=s;continue}if(i-=s,i>0)continue;s=Math.min(s,s+i+o);const t=e.slice(0,n+r.index+s+1);if(Math.min(n,s)%2){const e=t.slice(1,-1);return{type:"em",raw:t,text:e,tokens:this.lexer.inlineTokens(e)}}const l=t.slice(2,-2);return{type:"strong",raw:t,text:l,tokens:this.lexer.inlineTokens(l)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," ");const n=/[^ ]/.test(e),r=/^ /.test(e)&&/ $/.test(e);return n&&r&&(e=e.substring(1,e.length-1)),e=Ca(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e,t){const n=this.rules.inline.autolink.exec(e);if(n){let e,r;return"@"===n[2]?(e=Ca(this.options.mangle?t(n[1]):n[1]),r="mailto:"+e):(e=Ca(n[1]),r=e),{type:"link",raw:n[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let e,r;if("@"===n[2])e=Ca(this.options.mangle?t(n[0]):n[0]),r="mailto:"+e;else{let t;do{t=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(t!==n[0]);e=Ca(n[0]),r="www."===n[1]?"http://"+n[0]:n[0]}return{type:"link",raw:n[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e,t){const n=this.rules.inline.text.exec(e);if(n){let e;return e=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):Ca(n[0]):n[0]:Ca(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:e}}}}const Ga={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:za,lheading:/^((?:(?!^bull ).|\n(?!\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Ga.def=Pa(Ga.def).replace("label",Ga._label).replace("title",Ga._title).getRegex(),Ga.bullet=/(?:[*+-]|\d{1,9}[.)])/,Ga.listItemStart=Pa(/^( *)(bull) */).replace("bull",Ga.bullet).getRegex(),Ga.list=Pa(Ga.list).replace(/bull/g,Ga.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ga.def.source+")").getRegex(),Ga._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ga._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Ga.html=Pa(Ga.html,"i").replace("comment",Ga._comment).replace("tag",Ga._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ga.lheading=Pa(Ga.lheading).replace(/bull/g,Ga.bullet).getRegex(),Ga.paragraph=Pa(Ga._paragraph).replace("hr",Ga.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ga._tag).getRegex(),Ga.blockquote=Pa(Ga.blockquote).replace("paragraph",Ga.paragraph).getRegex(),Ga.normal=(0,o.A)({},Ga),Ga.gfm=(0,o.A)((0,o.A)({},Ga.normal),{},{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Ga.gfm.table=Pa(Ga.gfm.table).replace("hr",Ga.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ga._tag).getRegex(),Ga.gfm.paragraph=Pa(Ga._paragraph).replace("hr",Ga.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Ga.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ga._tag).getRegex(),Ga.pedantic=(0,o.A)((0,o.A)({},Ga.normal),{},{html:Pa("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Ga._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:za,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Pa(Ga.normal._paragraph).replace("hr",Ga.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Ga.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const Ka={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:za,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:za,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};function Qa(e){return e.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function Ya(e){let t,n,r="";const a=e.length;for(t=0;t<a;t++)n=e.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),r+="&#"+n+";";return r}Ka._punctuation="\\p{P}$+<=>`^|~",Ka.punctuation=Pa(Ka.punctuation,"u").replace(/punctuation/g,Ka._punctuation).getRegex(),Ka.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Ka.anyPunctuation=/\\[punct]/g,Ka._escapes=/\\([punct])/g,Ka._comment=Pa(Ga._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ka.emStrong.lDelim=Pa(Ka.emStrong.lDelim,"u").replace(/punct/g,Ka._punctuation).getRegex(),Ka.emStrong.rDelimAst=Pa(Ka.emStrong.rDelimAst,"gu").replace(/punct/g,Ka._punctuation).getRegex(),Ka.emStrong.rDelimUnd=Pa(Ka.emStrong.rDelimUnd,"gu").replace(/punct/g,Ka._punctuation).getRegex(),Ka.anyPunctuation=Pa(Ka.anyPunctuation,"gu").replace(/punct/g,Ka._punctuation).getRegex(),Ka._escapes=Pa(Ka._escapes,"gu").replace(/punct/g,Ka._punctuation).getRegex(),Ka._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Ka._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Ka.autolink=Pa(Ka.autolink).replace("scheme",Ka._scheme).replace("email",Ka._email).getRegex(),Ka._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Ka.tag=Pa(Ka.tag).replace("comment",Ka._comment).replace("attribute",Ka._attribute).getRegex(),Ka._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ka._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Ka._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Ka.link=Pa(Ka.link).replace("label",Ka._label).replace("href",Ka._href).replace("title",Ka._title).getRegex(),Ka.reflink=Pa(Ka.reflink).replace("label",Ka._label).replace("ref",Ga._label).getRegex(),Ka.nolink=Pa(Ka.nolink).replace("ref",Ga._label).getRegex(),Ka.reflinkSearch=Pa(Ka.reflinkSearch,"g").replace("reflink",Ka.reflink).replace("nolink",Ka.nolink).getRegex(),Ka.normal=(0,o.A)({},Ka),Ka.pedantic=(0,o.A)((0,o.A)({},Ka.normal),{},{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Pa(/^!?\[(label)\]\((.*?)\)/).replace("label",Ka._label).getRegex(),reflink:Pa(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ka._label).getRegex()}),Ka.gfm=(0,o.A)((0,o.A)({},Ka.normal),{},{escape:Pa(Ka.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Ka.gfm.url=Pa(Ka.gfm.url,"i").replace("email",Ka.gfm._extended_email).getRegex(),Ka.breaks=(0,o.A)((0,o.A)({},Ka.gfm),{},{br:Pa(Ka.br).replace("{2,}","*").getRegex(),text:Pa(Ka.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});class $a{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||wa,this.options.tokenizer=this.options.tokenizer||new Wa,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Ga.normal,inline:Ka.normal};this.options.pedantic?(t.block=Ga.pedantic,t.inline=Ka.pedantic):this.options.gfm&&(t.block=Ga.gfm,this.options.breaks?t.inline=Ka.breaks:t.inline=Ka.gfm),this.tokenizer.rules=t}static get rules(){return{block:Ga,inline:Ka}}static lex(e,t){return new $a(t).lex(e)}static lexInline(e,t){return new $a(t).inlineTokens(e)}lex(e){let t;for(e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e){let t,n,r,a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(e,t,n)=>t+"    ".repeat(n.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(n=>!!(t=n.call({lexer:this},e,s))&&(e=e.substring(t.raw.length),s.push(t),!0))))if(t=this.tokenizer.space(e))e=e.substring(t.raw.length),1===t.raw.length&&s.length>0?s[s.length-1].raw+="\n":s.push(t);else if(t=this.tokenizer.code(e))e=e.substring(t.raw.length),n=s[s.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?s.push(t):(n.raw+="\n"+t.raw,n.text+="\n"+t.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text);else if(t=this.tokenizer.fences(e))e=e.substring(t.raw.length),s.push(t);else if(t=this.tokenizer.heading(e))e=e.substring(t.raw.length),s.push(t);else if(t=this.tokenizer.hr(e))e=e.substring(t.raw.length),s.push(t);else if(t=this.tokenizer.blockquote(e))e=e.substring(t.raw.length),s.push(t);else if(t=this.tokenizer.list(e))e=e.substring(t.raw.length),s.push(t);else if(t=this.tokenizer.html(e))e=e.substring(t.raw.length),s.push(t);else if(t=this.tokenizer.def(e))e=e.substring(t.raw.length),n=s[s.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?this.tokens.links[t.tag]||(this.tokens.links[t.tag]={href:t.href,title:t.title}):(n.raw+="\n"+t.raw,n.text+="\n"+t.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text);else if(t=this.tokenizer.table(e))e=e.substring(t.raw.length),s.push(t);else if(t=this.tokenizer.lheading(e))e=e.substring(t.raw.length),s.push(t);else{if(r=e,this.options.extensions&&this.options.extensions.startBlock){let t=1/0;const n=e.slice(1);let a;this.options.extensions.startBlock.forEach(function(e){a=e.call({lexer:this},n),"number"===typeof a&&a>=0&&(t=Math.min(t,a))}),t<1/0&&t>=0&&(r=e.substring(0,t+1))}if(this.state.top&&(t=this.tokenizer.paragraph(r)))n=s[s.length-1],a&&"paragraph"===n.type?(n.raw+="\n"+t.raw,n.text+="\n"+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):s.push(t),a=r.length!==e.length,e=e.substring(t.raw.length);else if(t=this.tokenizer.text(e))e=e.substring(t.raw.length),n=s[s.length-1],n&&"text"===n.type?(n.raw+="\n"+t.raw,n.text+="\n"+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):s.push(t);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,s}inline(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e){let t,n,r,a,s,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],l=e;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(a=this.tokenizer.rules.inline.reflinkSearch.exec(l));)e.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(a=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(a=this.tokenizer.rules.inline.anyPunctuation.exec(l));)l=l.slice(0,a.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(s||(i=""),s=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(n=>!!(t=n.call({lexer:this},e,o))&&(e=e.substring(t.raw.length),o.push(t),!0))))if(t=this.tokenizer.escape(e))e=e.substring(t.raw.length),o.push(t);else if(t=this.tokenizer.tag(e))e=e.substring(t.raw.length),n=o[o.length-1],n&&"text"===t.type&&"text"===n.type?(n.raw+=t.raw,n.text+=t.text):o.push(t);else if(t=this.tokenizer.link(e))e=e.substring(t.raw.length),o.push(t);else if(t=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(t.raw.length),n=o[o.length-1],n&&"text"===t.type&&"text"===n.type?(n.raw+=t.raw,n.text+=t.text):o.push(t);else if(t=this.tokenizer.emStrong(e,l,i))e=e.substring(t.raw.length),o.push(t);else if(t=this.tokenizer.codespan(e))e=e.substring(t.raw.length),o.push(t);else if(t=this.tokenizer.br(e))e=e.substring(t.raw.length),o.push(t);else if(t=this.tokenizer.del(e))e=e.substring(t.raw.length),o.push(t);else if(t=this.tokenizer.autolink(e,Ya))e=e.substring(t.raw.length),o.push(t);else if(this.state.inLink||!(t=this.tokenizer.url(e,Ya))){if(r=e,this.options.extensions&&this.options.extensions.startInline){let t=1/0;const n=e.slice(1);let a;this.options.extensions.startInline.forEach(function(e){a=e.call({lexer:this},n),"number"===typeof a&&a>=0&&(t=Math.min(t,a))}),t<1/0&&t>=0&&(r=e.substring(0,t+1))}if(t=this.tokenizer.inlineText(r,Qa))e=e.substring(t.raw.length),"_"!==t.raw.slice(-1)&&(i=t.raw.slice(-1)),s=!0,n=o[o.length-1],n&&"text"===n.type?(n.raw+=t.raw,n.text+=t.text):o.push(t);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}else e=e.substring(t.raw.length),o.push(t);return o}}class Ja{constructor(e){this.options=e||wa}code(e,t,n){const r=(t||"").match(/\S*/)[0];if(this.options.highlight){const t=this.options.highlight(e,r);null!=t&&t!==e&&(n=!0,e=t)}return e=e.replace(/\n$/,"")+"\n",r?'<pre><code class="'+this.options.langPrefix+Ca(r)+'">'+(n?e:Ca(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:Ca(e,!0))+"</code></pre>\n"}blockquote(e){return"<blockquote>\n".concat(e,"</blockquote>\n")}html(e,t){return e}heading(e,t,n,r){if(this.options.headerIds){const a=this.options.headerPrefix+r.slug(n);return"<h".concat(t,' id="').concat(a,'">').concat(e,"</h").concat(t,">\n")}return"<h".concat(t,">").concat(e,"</h").concat(t,">\n")}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,n){const r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"}listitem(e){return"<li>".concat(e,"</li>\n")}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>".concat(e,"</p>\n")}table(e,t){return t&&(t="<tbody>".concat(t,"</tbody>")),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return"<tr>\n".concat(e,"</tr>\n")}tablecell(e,t){const n=t.header?"th":"td";return(t.align?"<".concat(n,' align="').concat(t.align,'">'):"<".concat(n,">"))+e+"</".concat(n,">\n")}strong(e){return"<strong>".concat(e,"</strong>")}em(e){return"<em>".concat(e,"</em>")}codespan(e){return"<code>".concat(e,"</code>")}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>".concat(e,"</del>")}link(e,t,n){if(null===(e=Ma(this.options.sanitize,this.options.baseUrl,e)))return n;let r='<a href="'+e+'"';return t&&(r+=' title="'+t+'"'),r+=">"+n+"</a>",r}image(e,t,n){if(null===(e=Ma(this.options.sanitize,this.options.baseUrl,e)))return n;let r='<img src="'.concat(e,'" alt="').concat(n,'"');return t&&(r+=' title="'.concat(t,'"')),r+=this.options.xhtml?"/>":">",r}text(e){return e}}class Xa{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class Za{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[e];do{r++,n=e+"-"+r}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=r,this.seen[n]=0),n}slug(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}}class es{constructor(e){this.options=e||wa,this.options.renderer=this.options.renderer||new Ja,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Xa,this.slugger=new Za}static parse(e,t){return new es(t).parse(e)}static parseInline(e,t){return new es(t).parseInline(e)}parse(e){let t,n,r,a,s,i,o,l,c,d,u,h,m,p,f,g,y,x,v,b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],w="";const j=e.length;for(t=0;t<j;t++)if(d=e[t],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[d.type]&&(v=this.options.extensions.renderers[d.type].call({parser:this},d),!1!==v||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(d.type)))w+=v||"";else switch(d.type){case"space":continue;case"hr":w+=this.renderer.hr();continue;case"heading":w+=this.renderer.heading(this.parseInline(d.tokens),d.depth,Ta(this.parseInline(d.tokens,this.textRenderer)),this.slugger);continue;case"code":w+=this.renderer.code(d.text,d.lang,d.escaped);continue;case"table":for(l="",o="",a=d.header.length,n=0;n<a;n++)o+=this.renderer.tablecell(this.parseInline(d.header[n].tokens),{header:!0,align:d.align[n]});for(l+=this.renderer.tablerow(o),c="",a=d.rows.length,n=0;n<a;n++){for(i=d.rows[n],o="",s=i.length,r=0;r<s;r++)o+=this.renderer.tablecell(this.parseInline(i[r].tokens),{header:!1,align:d.align[r]});c+=this.renderer.tablerow(o)}w+=this.renderer.table(l,c);continue;case"blockquote":c=this.parse(d.tokens),w+=this.renderer.blockquote(c);continue;case"list":for(u=d.ordered,h=d.start,m=d.loose,a=d.items.length,c="",n=0;n<a;n++)f=d.items[n],g=f.checked,y=f.task,p="",f.task&&(x=this.renderer.checkbox(g),m?f.tokens.length>0&&"paragraph"===f.tokens[0].type?(f.tokens[0].text=x+" "+f.tokens[0].text,f.tokens[0].tokens&&f.tokens[0].tokens.length>0&&"text"===f.tokens[0].tokens[0].type&&(f.tokens[0].tokens[0].text=x+" "+f.tokens[0].tokens[0].text)):f.tokens.unshift({type:"text",text:x}):p+=x),p+=this.parse(f.tokens,m),c+=this.renderer.listitem(p,y,g);w+=this.renderer.list(c,u,h);continue;case"html":w+=this.renderer.html(d.text,d.block);continue;case"paragraph":w+=this.renderer.paragraph(this.parseInline(d.tokens));continue;case"text":for(c=d.tokens?this.parseInline(d.tokens):d.text;t+1<j&&"text"===e[t+1].type;)d=e[++t],c+="\n"+(d.tokens?this.parseInline(d.tokens):d.text);w+=b?this.renderer.paragraph(c):c;continue;default:{const e='Token with "'+d.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return w}parseInline(e,t){t=t||this.renderer;let n,r,a,s="";const i=e.length;for(n=0;n<i;n++)if(r=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]&&(a=this.options.extensions.renderers[r.type].call({parser:this},r),!1!==a||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)))s+=a||"";else switch(r.type){case"escape":case"text":s+=t.text(r.text);break;case"html":s+=t.html(r.text);break;case"link":s+=t.link(r.href,r.title,this.parseInline(r.tokens,t));break;case"image":s+=t.image(r.href,r.title,r.text);break;case"strong":s+=t.strong(this.parseInline(r.tokens,t));break;case"em":s+=t.em(this.parseInline(r.tokens,t));break;case"codespan":s+=t.codespan(r.text);break;case"br":s+=t.br();break;case"del":s+=t.del(this.parseInline(r.tokens,t));break;default:{const e='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return s}}class ts{constructor(e){this.options=e||wa}preprocess(e){return e}postprocess(e){return e}}(0,va.A)(ts,"passThroughHooks",new Set(["preprocess","postprocess"]));var ns=new WeakSet;function rs(e,t){return(n,r,a)=>{"function"===typeof r&&(a=r,r=null);const s=(0,o.A)({},r);r=(0,o.A)((0,o.A)({},this.defaults),s);const i=xa(ns,this,as).call(this,r.silent,r.async,a);if("undefined"===typeof n||null===n)return i(new Error("marked(): input parameter is undefined or null"));if("string"!==typeof n)return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(function(e,t){e&&!e.silent&&(t&&console.warn("marked(): callback is deprecated since version 5.0.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/using_pro#async"),(e.sanitize||e.sanitizer)&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options"),(e.highlight||"language-"!==e.langPrefix)&&console.warn("marked(): highlight and langPrefix parameters are deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-highlight."),e.mangle&&console.warn("marked(): mangle parameter is enabled by default, but is deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install https://www.npmjs.com/package/marked-mangle, or disable by setting `{mangle: false}`."),e.baseUrl&&console.warn("marked(): baseUrl parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-base-url."),e.smartypants&&console.warn("marked(): smartypants parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-smartypants."),e.xhtml&&console.warn("marked(): xhtml parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-xhtml."),(e.headerIds||e.headerPrefix)&&console.warn("marked(): headerIds and headerPrefix parameters enabled by default, but are deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install  https://www.npmjs.com/package/marked-gfm-heading-id, or disable by setting `{headerIds: false}`."))}(r,a),r.hooks&&(r.hooks.options=r),a){const s=r.highlight;let o;try{r.hooks&&(n=r.hooks.preprocess(n)),o=e(n,r)}catch(BM){return i(BM)}const l=e=>{let n;if(!e)try{r.walkTokens&&this.walkTokens(o,r.walkTokens),n=t(o,r),r.hooks&&(n=r.hooks.postprocess(n))}catch(BM){e=BM}return r.highlight=s,e?i(e):a(null,n)};if(!s||s.length<3)return l();if(delete r.highlight,!o.length)return l();let c=0;return this.walkTokens(o,e=>{"code"===e.type&&(c++,setTimeout(()=>{s(e.text,e.lang,(t,n)=>{if(t)return l(t);null!=n&&n!==e.text&&(e.text=n,e.escaped=!0),c--,0===c&&l()})},0))}),void(0===c&&l())}if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(n):n).then(t=>e(t,r)).then(e=>r.walkTokens?Promise.all(this.walkTokens(e,r.walkTokens)).then(()=>e):e).then(e=>t(e,r)).then(e=>r.hooks?r.hooks.postprocess(e):e).catch(i);try{r.hooks&&(n=r.hooks.preprocess(n));const a=e(n,r);r.walkTokens&&this.walkTokens(a,r.walkTokens);let s=t(a,r);return r.hooks&&(s=r.hooks.postprocess(s)),s}catch(BM){return i(BM)}}}function as(e,t,n){return r=>{if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+Ca(r.message+"",!0)+"</pre>";return t?Promise.resolve(e):n?void n(null,e):e}if(t)return Promise.reject(r);if(!n)throw r;n(r)}}const ss=new class{constructor(){ya(this,ns),(0,va.A)(this,"defaults",{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}),(0,va.A)(this,"options",this.setOptions),(0,va.A)(this,"parse",xa(ns,this,rs).call(this,$a.lex,es.parse)),(0,va.A)(this,"parseInline",xa(ns,this,rs).call(this,$a.lexInline,es.parseInline)),(0,va.A)(this,"Parser",es),(0,va.A)(this,"parser",es.parse),(0,va.A)(this,"Renderer",Ja),(0,va.A)(this,"TextRenderer",Xa),(0,va.A)(this,"Lexer",$a),(0,va.A)(this,"lexer",$a.lex),(0,va.A)(this,"Tokenizer",Wa),(0,va.A)(this,"Slugger",Za),(0,va.A)(this,"Hooks",ts),this.use(...arguments)}walkTokens(e,t){let n=[];for(const r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":for(const e of r.header)n=n.concat(this.walkTokens(e.tokens,t));for(const e of r.rows)for(const r of e)n=n.concat(this.walkTokens(r.tokens,t));break;case"list":n=n.concat(this.walkTokens(r.items,t));break;default:this.defaults.extensions&&this.defaults.extensions.childTokens&&this.defaults.extensions.childTokens[r.type]?this.defaults.extensions.childTokens[r.type].forEach(e=>{n=n.concat(this.walkTokens(r[e],t))}):r.tokens&&(n=n.concat(this.walkTokens(r.tokens,t)))}return n}use(){const e=this.defaults.extensions||{renderers:{},childTokens:{}};for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(t=>{const n=(0,o.A)({},t);if(n.async=this.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach(t=>{if(!t.name)throw new Error("extension name required");if(t.renderer){const n=e.renderers[t.name];e.renderers[t.name]=n?function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];let s=t.renderer.apply(this,r);return!1===s&&(s=n.apply(this,r)),s}:t.renderer}if(t.tokenizer){if(!t.level||"block"!==t.level&&"inline"!==t.level)throw new Error("extension level must be 'block' or 'inline'");e[t.level]?e[t.level].unshift(t.tokenizer):e[t.level]=[t.tokenizer],t.start&&("block"===t.level?e.startBlock?e.startBlock.push(t.start):e.startBlock=[t.start]:"inline"===t.level&&(e.startInline?e.startInline.push(t.start):e.startInline=[t.start]))}t.childTokens&&(e.childTokens[t.name]=t.childTokens)}),n.extensions=e),t.renderer){const e=this.defaults.renderer||new Ja(this.defaults);for(const n in t.renderer){const r=e[n];e[n]=function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];let o=t.renderer[n].apply(e,s);return!1===o&&(o=r.apply(e,s)),o}}n.renderer=e}if(t.tokenizer){const e=this.defaults.tokenizer||new Wa(this.defaults);for(const n in t.tokenizer){const r=e[n];e[n]=function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];let o=t.tokenizer[n].apply(e,s);return!1===o&&(o=r.apply(e,s)),o}}n.tokenizer=e}if(t.hooks){const e=this.defaults.hooks||new ts;for(const n in t.hooks){const r=e[n];ts.passThroughHooks.has(n)?e[n]=a=>{if(this.defaults.async)return Promise.resolve(t.hooks[n].call(e,a)).then(t=>r.call(e,t));const s=t.hooks[n].call(e,a);return r.call(e,s)}:e[n]=function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];let o=t.hooks[n].apply(e,s);return!1===o&&(o=r.apply(e,s)),o}}n.hooks=e}if(t.walkTokens){const e=this.defaults.walkTokens;n.walkTokens=function(n){let r=[];return r.push(t.walkTokens.call(this,n)),e&&(r=r.concat(e.call(this,n))),r}}this.defaults=(0,o.A)((0,o.A)({},this.defaults),n)}),this}setOptions(e){return this.defaults=(0,o.A)((0,o.A)({},this.defaults),e),this}}(wa);function is(e,t,n){return ss.parse(e,t,n)}is.options=is.setOptions=function(e){return ss.setOptions(e),is.defaults=ss.defaults,ja(is.defaults),is},is.getDefaults=ba,is.defaults=wa,is.use=function(){return ss.use(...arguments),is.defaults=ss.defaults,ja(is.defaults),is},is.walkTokens=function(e,t){return ss.walkTokens(e,t)},is.parseInline=ss.parseInline,is.Parser=es,is.parser=es.parse,is.Renderer=Ja,is.TextRenderer=Xa,is.Lexer=$a,is.lexer=$a.lex,is.Tokenizer=Wa,is.Slugger=Za,is.Hooks=ts,is.parse=is;is.options,is.setOptions,is.use,is.walkTokens,is.parseInline;const{entries:os,setPrototypeOf:ls,isFrozen:cs,getPrototypeOf:ds,getOwnPropertyDescriptor:us}=Object;let{freeze:hs,seal:ms,create:ps}=Object,{apply:fs,construct:gs}="undefined"!==typeof Reflect&&Reflect;hs||(hs=function(e){return e}),ms||(ms=function(e){return e}),fs||(fs=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return e.apply(t,r)}),gs||(gs=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new e(...n)});const ys=Os(Array.prototype.forEach),xs=Os(Array.prototype.lastIndexOf),vs=Os(Array.prototype.pop),bs=Os(Array.prototype.push),ws=Os(Array.prototype.splice),js=Os(String.prototype.toLowerCase),Ns=Os(String.prototype.toString),_s=Os(String.prototype.match),Ss=Os(String.prototype.replace),ks=Os(String.prototype.indexOf),Es=Os(String.prototype.trim),As=Os(Object.prototype.hasOwnProperty),Cs=Os(RegExp.prototype.test),Ds=(Ts=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return gs(Ts,t)});var Ts;function Os(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return fs(e,t,r)}}function Ps(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:js;ls&&ls(e,null);let r=t.length;for(;r--;){let a=t[r];if("string"===typeof a){const e=n(a);e!==a&&(cs(t)||(t[r]=e),a=e)}e[a]=!0}return e}function Is(e){for(let t=0;t<e.length;t++){As(e,t)||(e[t]=null)}return e}function Rs(e){const t=ps(null);for(const[n,r]of os(e)){As(e,n)&&(Array.isArray(r)?t[n]=Is(r):r&&"object"===typeof r&&r.constructor===Object?t[n]=Rs(r):t[n]=r)}return t}function Ms(e,t){for(;null!==e;){const n=us(e,t);if(n){if(n.get)return Os(n.get);if("function"===typeof n.value)return Os(n.value)}e=ds(e)}return function(){return null}}const Ls=hs(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Fs=hs(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","slot","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Us=hs(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Bs=hs(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),zs=hs(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),qs=hs(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Vs=hs(["#text"]),Hs=hs(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ws=hs(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Gs=hs(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ks=hs(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Qs=ms(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ys=ms(/<%[\w\W]*|[\w\W]*%>/gm),$s=ms(/\$\{[\w\W]*/gm),Js=ms(/^data-[\-\w.\u00B7-\uFFFF]+$/),Xs=ms(/^aria-[\-\w]+$/),Zs=ms(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ei=ms(/^(?:\w+script|data):/i),ti=ms(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ni=ms(/^html$/i),ri=ms(/^[a-z][.\w]*(-[.\w]+)+$/i);var ai=Object.freeze({__proto__:null,ARIA_ATTR:Xs,ATTR_WHITESPACE:ti,CUSTOM_ELEMENT:ri,DATA_ATTR:Js,DOCTYPE_NAME:ni,ERB_EXPR:Ys,IS_ALLOWED_URI:Zs,IS_SCRIPT_OR_DATA:ei,MUSTACHE_EXPR:Qs,TMPLIT_EXPR:$s});const si=1,ii=3,oi=7,li=8,ci=9,di=function(){return"undefined"===typeof window?null:window};var ui=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:di();const n=t=>e(t);if(n.version="3.2.7",n.removed=[],!t||!t.document||t.document.nodeType!==ci||!t.Element)return n.isSupported=!1,n;let{document:r}=t;const a=r,s=a.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:l,Element:c,NodeFilter:d,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:m,trustedTypes:p}=t,f=c.prototype,g=Ms(f,"cloneNode"),y=Ms(f,"remove"),x=Ms(f,"nextSibling"),v=Ms(f,"childNodes"),b=Ms(f,"parentNode");if("function"===typeof o){const e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let w,j="";const{implementation:N,createNodeIterator:_,createDocumentFragment:S,getElementsByTagName:k}=r,{importNode:E}=a;let A={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"===typeof os&&"function"===typeof b&&N&&void 0!==N.createHTMLDocument;const{MUSTACHE_EXPR:C,ERB_EXPR:D,TMPLIT_EXPR:T,DATA_ATTR:O,ARIA_ATTR:P,IS_SCRIPT_OR_DATA:I,ATTR_WHITESPACE:R,CUSTOM_ELEMENT:M}=ai;let{IS_ALLOWED_URI:L}=ai,F=null;const U=Ps({},[...Ls,...Fs,...Us,...zs,...Vs]);let B=null;const z=Ps({},[...Hs,...Ws,...Gs,...Ks]);let q=Object.seal(ps(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),V=null,H=null,W=!0,G=!0,K=!1,Q=!0,Y=!1,$=!0,J=!1,X=!1,Z=!1,ee=!1,te=!1,ne=!1,re=!0,ae=!1,se=!0,ie=!1,oe={},le=null;const ce=Ps({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let de=null;const ue=Ps({},["audio","video","img","source","image","track"]);let he=null;const me=Ps({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pe="http://www.w3.org/1998/Math/MathML",fe="http://www.w3.org/2000/svg",ge="http://www.w3.org/1999/xhtml";let ye=ge,xe=!1,ve=null;const be=Ps({},[pe,fe,ge],Ns);let we=Ps({},["mi","mo","mn","ms","mtext"]),je=Ps({},["annotation-xml"]);const Ne=Ps({},["title","style","font","a","script"]);let _e=null;const Se=["application/xhtml+xml","text/html"];let ke=null,Ee=null;const Ae=r.createElement("form"),Ce=function(e){return e instanceof RegExp||e instanceof Function},De=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Ee||Ee!==e){if(e&&"object"===typeof e||(e={}),e=Rs(e),_e=-1===Se.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ke="application/xhtml+xml"===_e?Ns:js,F=As(e,"ALLOWED_TAGS")?Ps({},e.ALLOWED_TAGS,ke):U,B=As(e,"ALLOWED_ATTR")?Ps({},e.ALLOWED_ATTR,ke):z,ve=As(e,"ALLOWED_NAMESPACES")?Ps({},e.ALLOWED_NAMESPACES,Ns):be,he=As(e,"ADD_URI_SAFE_ATTR")?Ps(Rs(me),e.ADD_URI_SAFE_ATTR,ke):me,de=As(e,"ADD_DATA_URI_TAGS")?Ps(Rs(ue),e.ADD_DATA_URI_TAGS,ke):ue,le=As(e,"FORBID_CONTENTS")?Ps({},e.FORBID_CONTENTS,ke):ce,V=As(e,"FORBID_TAGS")?Ps({},e.FORBID_TAGS,ke):Rs({}),H=As(e,"FORBID_ATTR")?Ps({},e.FORBID_ATTR,ke):Rs({}),oe=!!As(e,"USE_PROFILES")&&e.USE_PROFILES,W=!1!==e.ALLOW_ARIA_ATTR,G=!1!==e.ALLOW_DATA_ATTR,K=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Q=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Y=e.SAFE_FOR_TEMPLATES||!1,$=!1!==e.SAFE_FOR_XML,J=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,ne=e.RETURN_TRUSTED_TYPE||!1,Z=e.FORCE_BODY||!1,re=!1!==e.SANITIZE_DOM,ae=e.SANITIZE_NAMED_PROPS||!1,se=!1!==e.KEEP_CONTENT,ie=e.IN_PLACE||!1,L=e.ALLOWED_URI_REGEXP||Zs,ye=e.NAMESPACE||ge,we=e.MATHML_TEXT_INTEGRATION_POINTS||we,je=e.HTML_INTEGRATION_POINTS||je,q=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Ce(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(q.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Ce(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(q.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(q.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Y&&(G=!1),te&&(ee=!0),oe&&(F=Ps({},Vs),B=[],!0===oe.html&&(Ps(F,Ls),Ps(B,Hs)),!0===oe.svg&&(Ps(F,Fs),Ps(B,Ws),Ps(B,Ks)),!0===oe.svgFilters&&(Ps(F,Us),Ps(B,Ws),Ps(B,Ks)),!0===oe.mathMl&&(Ps(F,zs),Ps(B,Gs),Ps(B,Ks))),e.ADD_TAGS&&(F===U&&(F=Rs(F)),Ps(F,e.ADD_TAGS,ke)),e.ADD_ATTR&&(B===z&&(B=Rs(B)),Ps(B,e.ADD_ATTR,ke)),e.ADD_URI_SAFE_ATTR&&Ps(he,e.ADD_URI_SAFE_ATTR,ke),e.FORBID_CONTENTS&&(le===ce&&(le=Rs(le)),Ps(le,e.FORBID_CONTENTS,ke)),se&&(F["#text"]=!0),J&&Ps(F,["html","head","body"]),F.table&&(Ps(F,["tbody"]),delete V.tbody),e.TRUSTED_TYPES_POLICY){if("function"!==typeof e.TRUSTED_TYPES_POLICY.createHTML)throw Ds('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!==typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw Ds('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=e.TRUSTED_TYPES_POLICY,j=w.createHTML("")}else void 0===w&&(w=function(e,t){if("object"!==typeof e||"function"!==typeof e.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const a="dompurify"+(n?"#"+n:"");try{return e.createPolicy(a,{createHTML:e=>e,createScriptURL:e=>e})}catch(s){return console.warn("TrustedTypes policy "+a+" could not be created."),null}}(p,s)),null!==w&&"string"===typeof j&&(j=w.createHTML(""));hs&&hs(e),Ee=e}},Te=Ps({},[...Fs,...Us,...Bs]),Oe=Ps({},[...zs,...qs]),Pe=function(e){bs(n.removed,{element:e});try{b(e).removeChild(e)}catch(t){y(e)}},Ie=function(e,t){try{bs(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(r){bs(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(ee||te)try{Pe(t)}catch(r){}else try{t.setAttribute(e,"")}catch(r){}},Re=function(e){let t=null,n=null;if(Z)e="<remove></remove>"+e;else{const t=_s(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===_e&&ye===ge&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const a=w?w.createHTML(e):e;if(ye===ge)try{t=(new m).parseFromString(a,_e)}catch(i){}if(!t||!t.documentElement){t=N.createDocument(ye,"template",null);try{t.documentElement.innerHTML=xe?j:a}catch(i){}}const s=t.body||t.documentElement;return e&&n&&s.insertBefore(r.createTextNode(n),s.childNodes[0]||null),ye===ge?k.call(t,J?"html":"body")[0]:J?t.documentElement:s},Me=function(e){return _.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},Le=function(e){return e instanceof h&&("string"!==typeof e.nodeName||"string"!==typeof e.textContent||"function"!==typeof e.removeChild||!(e.attributes instanceof u)||"function"!==typeof e.removeAttribute||"function"!==typeof e.setAttribute||"string"!==typeof e.namespaceURI||"function"!==typeof e.insertBefore||"function"!==typeof e.hasChildNodes)},Fe=function(e){return"function"===typeof l&&e instanceof l};function Ue(e,t,r){ys(e,e=>{e.call(n,t,r,Ee)})}const Be=function(e){let t=null;if(Ue(A.beforeSanitizeElements,e,null),Le(e))return Pe(e),!0;const r=ke(e.nodeName);if(Ue(A.uponSanitizeElement,e,{tagName:r,allowedTags:F}),$&&e.hasChildNodes()&&!Fe(e.firstElementChild)&&Cs(/<[/\w!]/g,e.innerHTML)&&Cs(/<[/\w!]/g,e.textContent))return Pe(e),!0;if(e.nodeType===oi)return Pe(e),!0;if($&&e.nodeType===li&&Cs(/<[/\w]/g,e.data))return Pe(e),!0;if(!F[r]||V[r]){if(!V[r]&&qe(r)){if(q.tagNameCheck instanceof RegExp&&Cs(q.tagNameCheck,r))return!1;if(q.tagNameCheck instanceof Function&&q.tagNameCheck(r))return!1}if(se&&!le[r]){const t=b(e)||e.parentNode,n=v(e)||e.childNodes;if(n&&t){for(let r=n.length-1;r>=0;--r){const a=g(n[r],!0);a.__removalCount=(e.__removalCount||0)+1,t.insertBefore(a,x(e))}}}return Pe(e),!0}return e instanceof c&&!function(e){let t=b(e);t&&t.tagName||(t={namespaceURI:ye,tagName:"template"});const n=js(e.tagName),r=js(t.tagName);return!!ve[e.namespaceURI]&&(e.namespaceURI===fe?t.namespaceURI===ge?"svg"===n:t.namespaceURI===pe?"svg"===n&&("annotation-xml"===r||we[r]):Boolean(Te[n]):e.namespaceURI===pe?t.namespaceURI===ge?"math"===n:t.namespaceURI===fe?"math"===n&&je[r]:Boolean(Oe[n]):e.namespaceURI===ge?!(t.namespaceURI===fe&&!je[r])&&!(t.namespaceURI===pe&&!we[r])&&!Oe[n]&&(Ne[n]||!Te[n]):!("application/xhtml+xml"!==_e||!ve[e.namespaceURI]))}(e)?(Pe(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!Cs(/<\/no(script|embed|frames)/i,e.innerHTML)?(Y&&e.nodeType===ii&&(t=e.textContent,ys([C,D,T],e=>{t=Ss(t,e," ")}),e.textContent!==t&&(bs(n.removed,{element:e.cloneNode()}),e.textContent=t)),Ue(A.afterSanitizeElements,e,null),!1):(Pe(e),!0)},ze=function(e,t,n){if(re&&("id"===t||"name"===t)&&(n in r||n in Ae))return!1;if(G&&!H[t]&&Cs(O,t));else if(W&&Cs(P,t));else if(!B[t]||H[t]){if(!(qe(e)&&(q.tagNameCheck instanceof RegExp&&Cs(q.tagNameCheck,e)||q.tagNameCheck instanceof Function&&q.tagNameCheck(e))&&(q.attributeNameCheck instanceof RegExp&&Cs(q.attributeNameCheck,t)||q.attributeNameCheck instanceof Function&&q.attributeNameCheck(t,e))||"is"===t&&q.allowCustomizedBuiltInElements&&(q.tagNameCheck instanceof RegExp&&Cs(q.tagNameCheck,n)||q.tagNameCheck instanceof Function&&q.tagNameCheck(n))))return!1}else if(he[t]);else if(Cs(L,Ss(n,R,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==ks(n,"data:")||!de[e]){if(K&&!Cs(I,Ss(n,R,"")));else if(n)return!1}else;return!0},qe=function(e){return"annotation-xml"!==e&&_s(e,M)},Ve=function(e){Ue(A.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||Le(e))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B,forceKeepAttr:void 0};let a=t.length;for(;a--;){const i=t[a],{name:o,namespaceURI:l,value:c}=i,d=ke(o),u=c;let h="value"===o?u:Es(u);if(r.attrName=d,r.attrValue=h,r.keepAttr=!0,r.forceKeepAttr=void 0,Ue(A.uponSanitizeAttribute,e,r),h=r.attrValue,!ae||"id"!==d&&"name"!==d||(Ie(o,e),h="user-content-"+h),$&&Cs(/((--!?|])>)|<\/(style|title|textarea)/i,h)){Ie(o,e);continue}if("attributename"===d&&_s(h,"href")){Ie(o,e);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr){Ie(o,e);continue}if(!Q&&Cs(/\/>/i,h)){Ie(o,e);continue}Y&&ys([C,D,T],e=>{h=Ss(h,e," ")});const m=ke(e.nodeName);if(ze(m,d,h)){if(w&&"object"===typeof p&&"function"===typeof p.getAttributeType)if(l);else switch(p.getAttributeType(m,d)){case"TrustedHTML":h=w.createHTML(h);break;case"TrustedScriptURL":h=w.createScriptURL(h)}if(h!==u)try{l?e.setAttributeNS(l,o,h):e.setAttribute(o,h),Le(e)?Pe(e):vs(n.removed)}catch(s){Ie(o,e)}}else Ie(o,e)}Ue(A.afterSanitizeAttributes,e,null)},He=function e(t){let n=null;const r=Me(t);for(Ue(A.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)Ue(A.uponSanitizeShadowNode,n,null),Be(n),Ve(n),n.content instanceof i&&e(n.content);Ue(A.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,s=null,o=null,c=null;if(xe=!e,xe&&(e="\x3c!--\x3e"),"string"!==typeof e&&!Fe(e)){if("function"!==typeof e.toString)throw Ds("toString is not a function");if("string"!==typeof(e=e.toString()))throw Ds("dirty is not a string, aborting")}if(!n.isSupported)return e;if(X||De(t),n.removed=[],"string"===typeof e&&(ie=!1),ie){if(e.nodeName){const t=ke(e.nodeName);if(!F[t]||V[t])throw Ds("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)r=Re("\x3c!----\x3e"),s=r.ownerDocument.importNode(e,!0),s.nodeType===si&&"BODY"===s.nodeName||"HTML"===s.nodeName?r=s:r.appendChild(s);else{if(!ee&&!Y&&!J&&-1===e.indexOf("<"))return w&&ne?w.createHTML(e):e;if(r=Re(e),!r)return ee?null:ne?j:""}r&&Z&&Pe(r.firstChild);const d=Me(ie?e:r);for(;o=d.nextNode();)Be(o),Ve(o),o.content instanceof i&&He(o.content);if(ie)return e;if(ee){if(te)for(c=S.call(r.ownerDocument);r.firstChild;)c.appendChild(r.firstChild);else c=r;return(B.shadowroot||B.shadowrootmode)&&(c=E.call(a,c,!0)),c}let u=J?r.outerHTML:r.innerHTML;return J&&F["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&Cs(ni,r.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+u),Y&&ys([C,D,T],e=>{u=Ss(u,e," ")}),w&&ne?w.createHTML(u):u},n.setConfig=function(){De(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),X=!0},n.clearConfig=function(){Ee=null,X=!1},n.isValidAttribute=function(e,t,n){Ee||De({});const r=ke(e),a=ke(t);return ze(r,a,n)},n.addHook=function(e,t){"function"===typeof t&&bs(A[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=xs(A[e],t);return-1===n?void 0:ws(A[e],n,1)[0]}return vs(A[e])},n.removeHooks=function(e){A[e]=[]},n.removeAllHooks=function(){A={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();class hi{static async seedInitialData(){try{console.log("Starting data seeding...");const e=await on.getAllPhases(),t=e.map(e=>e.name);console.log("Existing phases:",t);const r=[n(1267),n(763),n(4974),n(8181),n(3216),n(3215)];for(const n of r){if(n.initialPhases&&n.detailedTopics)for(const t of n.initialPhases){let r;const a=e.find(e=>e.name===t.name);a?(console.log("Phase already exists, checking topics: ".concat(t.name)),r=a.id):(r=await on.createPhase((0,o.A)((0,o.A)({},t),{},{created_at:new Date})),console.log("Created phase: ".concat(t.name)));const s=n.detailedTopics[t.name];if(s){const e=(await ln.getTopicsByPhase(r)).map(e=>e.name);for(const n of s)e.includes(n.name)||(await ln.createTopic((0,o.A)((0,o.A)({},n),{},{phase_id:r,created_at:new Date})),console.log("Created topic: ".concat(n.name," for phase: ").concat(t.name)))}}const r=[{arr:n.phase3Topics,name:"Phase 3: Interactive Quiz Master",order:4},{arr:n.phase4Topics,name:"Phase 4: AI-Powered Content Generator",order:5},{arr:n.phase5Topics,name:"Phase 5: Ask Gemini Web App",order:6},{arr:n.phase6Topics,name:"Phase 6: Student Feedback Manager",order:7},{arr:n.phase7Topics,name:"Phase 7: CollabSphere",order:8}];for(const{arr:e,name:n,order:a}of r)if(e&&e.length>0){if(t.includes(n)){console.log("Phase already exists, skipping: ".concat(n));continue}const r={name:n,order:a},s=await on.createPhase(r);console.log("Created phase: ".concat(n));for(const t of e)await ln.createTopic((0,o.A)((0,o.A)({},t),{},{phase_id:s})),console.log("Created topic: ".concat(t.name," for phase: ").concat(n))}}return console.log("Data seeding completed successfully!"),!0}catch(e){return console.error("Error seeding initial data:",e),!1}}static async resetData(){try{return console.log("Resetting data..."),console.warn("Data reset functionality should be used carefully in production"),!0}catch(e){return console.error("Error resetting data:",e),!1}}static async getDataStatus(){try{const e=await on.getAllPhases();let t=0;for(const n of e){t+=(await ln.getTopicsByPhase(n.id)).length}return{phasesCount:e.length,topicsCount:t,isSeeded:e.length>0}}catch(e){return console.error("Error checking data status:",e),{phasesCount:0,topicsCount:0,isSeeded:!1}}}static async cleanupCurriculumData(){try{console.log("\ud83e\uddf9 Starting curriculum data cleanup...");const e=await on.getAllPhases();console.log("Found ".concat(e.length," phases to clean up"));for(const t of e){console.log("Cleaning up topics for phase: ".concat(t.name));const e=await ln.getTopicsByPhase(t.id);for(const t of e)await ln.deleteTopic(t.id);console.log("Deleted ".concat(e.length," topics from ").concat(t.name))}for(const t of e)console.log("Deleting phase: ".concat(t.name)),await on.deletePhase(t.id);return console.log("\u2705 Curriculum data cleanup completed successfully"),!0}catch(e){throw console.error("\u274c Error during curriculum cleanup:",e),e}}}function mi(e,t){return function(){return e.apply(t,arguments)}}const{toString:pi}=Object.prototype,{getPrototypeOf:fi}=Object,{iterator:gi,toStringTag:yi}=Symbol,xi=(vi=Object.create(null),e=>{const t=pi.call(e);return vi[t]||(vi[t]=t.slice(8,-1).toLowerCase())});var vi;const bi=e=>(e=e.toLowerCase(),t=>xi(t)===e),wi=e=>t=>typeof t===e,{isArray:ji}=Array,Ni=wi("undefined");function _i(e){return null!==e&&!Ni(e)&&null!==e.constructor&&!Ni(e.constructor)&&Ei(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Si=bi("ArrayBuffer");const ki=wi("string"),Ei=wi("function"),Ai=wi("number"),Ci=e=>null!==e&&"object"===typeof e,Di=e=>{if("object"!==xi(e))return!1;const t=fi(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(yi in e)&&!(gi in e)},Ti=bi("Date"),Oi=bi("File"),Pi=bi("Blob"),Ii=bi("FileList"),Ri=bi("URLSearchParams"),[Mi,Li,Fi,Ui]=["ReadableStream","Request","Response","Headers"].map(bi);function Bi(e,t){let n,r,{allOwnKeys:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),ji(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{if(_i(e))return;const r=a?Object.getOwnPropertyNames(e):Object.keys(e),s=r.length;let i;for(n=0;n<s;n++)i=r[n],t.call(null,e[i],i,e)}}function zi(e,t){if(_i(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r,a=n.length;for(;a-- >0;)if(r=n[a],t===r.toLowerCase())return r;return null}const qi="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:n.g,Vi=e=>!Ni(e)&&e!==qi;const Hi=(Wi="undefined"!==typeof Uint8Array&&fi(Uint8Array),e=>Wi&&e instanceof Wi);var Wi;const Gi=bi("HTMLFormElement"),Ki=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),Qi=bi("RegExp"),Yi=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Bi(n,(n,a)=>{let s;!1!==(s=t(n,a,e))&&(r[a]=s||n)}),Object.defineProperties(e,r)};const $i=bi("AsyncFunction"),Ji=((e,t)=>{return e?setImmediate:t?(n="axios@".concat(Math.random()),r=[],qi.addEventListener("message",e=>{let{source:t,data:a}=e;t===qi&&a===n&&r.length&&r.shift()()},!1),e=>{r.push(e),qi.postMessage(n,"*")}):e=>setTimeout(e);var n,r})("function"===typeof setImmediate,Ei(qi.postMessage)),Xi="undefined"!==typeof queueMicrotask?queueMicrotask.bind(qi):"undefined"!==typeof process&&process.nextTick||Ji,Zi={isArray:ji,isArrayBuffer:Si,isBuffer:_i,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||Ei(e.append)&&("formdata"===(t=xi(e))||"object"===t&&Ei(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Si(e.buffer),t},isString:ki,isNumber:Ai,isBoolean:e=>!0===e||!1===e,isObject:Ci,isPlainObject:Di,isEmptyObject:e=>{if(!Ci(e)||_i(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(BM){return!1}},isReadableStream:Mi,isRequest:Li,isResponse:Fi,isHeaders:Ui,isUndefined:Ni,isDate:Ti,isFile:Oi,isBlob:Pi,isRegExp:Qi,isFunction:Ei,isStream:e=>Ci(e)&&Ei(e.pipe),isURLSearchParams:Ri,isTypedArray:Hi,isFileList:Ii,forEach:Bi,merge:function e(){const{caseless:t,skipUndefined:n}=Vi(this)&&this||{},r={},a=(a,s)=>{const i=t&&zi(r,s)||s;Di(r[i])&&Di(a)?r[i]=e(r[i],a):Di(a)?r[i]=e({},a):ji(a)?r[i]=a.slice():n&&Ni(a)||(r[i]=a)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Bi(arguments[s],a);return r},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Bi(t,(t,r)=>{n&&Ei(t)?e[r]=mi(t,n):e[r]=t},{allOwnKeys:r}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let a,s,i;const o={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)i=a[s],r&&!r(i,e,t)||o[i]||(t[i]=e[i],o[i]=!0);e=!1!==n&&fi(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:xi,kindOfTest:bi,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(ji(e))return e;let t=e.length;if(!Ai(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[gi]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:Gi,hasOwnProperty:Ki,hasOwnProp:Ki,reduceDescriptors:Yi,freezeMethods:e=>{Yi(e,(t,n)=>{if(Ei(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];Ei(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach(e=>{n[e]=!0})};return ji(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:zi,global:qi,isContextDefined:Vi,isSpecCompliantForm:function(e){return!!(e&&Ei(e.append)&&"FormData"===e[yi]&&e[gi])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(Ci(e)){if(t.indexOf(e)>=0)return;if(_i(e))return e;if(!("toJSON"in e)){t[r]=e;const a=ji(e)?[]:{};return Bi(e,(e,t)=>{const s=n(e,r+1);!Ni(s)&&(a[t]=s)}),t[r]=void 0,a}}return e};return n(e,0)},isAsyncFn:$i,isThenable:e=>e&&(Ci(e)||Ei(e))&&Ei(e.then)&&Ei(e.catch),setImmediate:Ji,asap:Xi,isIterable:e=>null!=e&&Ei(e[gi])};function eo(e,t,n,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}Zi.inherits(eo,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Zi.toJSONObject(this.config),code:this.code,status:this.status}}});const to=eo.prototype,no={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{no[e]={value:e}}),Object.defineProperties(eo,no),Object.defineProperty(to,"isAxiosError",{value:!0}),eo.from=(e,t,n,r,a,s)=>{const i=Object.create(to);Zi.toFlatObject(e,i,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const o=e&&e.message?e.message:"Error",l=null==t&&e?e.code:t;return eo.call(i,o,l,n,r,a),e&&null==i.cause&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",s&&Object.assign(i,s),i};const ro=eo;function ao(e){return Zi.isPlainObject(e)||Zi.isArray(e)}function so(e){return Zi.endsWith(e,"[]")?e.slice(0,-2):e}function io(e,t,n){return e?e.concat(t).map(function(e,t){return e=so(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const oo=Zi.toFlatObject(Zi,{},null,function(e){return/^is[A-Z]/.test(e)});const lo=function(e,t,n){if(!Zi.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=Zi.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Zi.isUndefined(t[e])})).metaTokens,a=n.visitor||c,s=n.dots,i=n.indexes,o=(n.Blob||"undefined"!==typeof Blob&&Blob)&&Zi.isSpecCompliantForm(t);if(!Zi.isFunction(a))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(Zi.isDate(e))return e.toISOString();if(Zi.isBoolean(e))return e.toString();if(!o&&Zi.isBlob(e))throw new ro("Blob is not supported. Use a Buffer instead.");return Zi.isArrayBuffer(e)||Zi.isTypedArray(e)?o&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,a){let o=e;if(e&&!a&&"object"===typeof e)if(Zi.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(Zi.isArray(e)&&function(e){return Zi.isArray(e)&&!e.some(ao)}(e)||(Zi.isFileList(e)||Zi.endsWith(n,"[]"))&&(o=Zi.toArray(e)))return n=so(n),o.forEach(function(e,r){!Zi.isUndefined(e)&&null!==e&&t.append(!0===i?io([n],r,s):null===i?n:n+"[]",l(e))}),!1;return!!ao(e)||(t.append(io(a,n,s),l(e)),!1)}const d=[],u=Object.assign(oo,{defaultVisitor:c,convertValue:l,isVisitable:ao});if(!Zi.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!Zi.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+r.join("."));d.push(n),Zi.forEach(n,function(n,s){!0===(!(Zi.isUndefined(n)||null===n)&&a.call(t,n,Zi.isString(s)?s.trim():s,r,u))&&e(n,r?r.concat(s):[s])}),d.pop()}}(e),t};function co(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function uo(e,t){this._pairs=[],e&&lo(e,this,t)}const ho=uo.prototype;ho.append=function(e,t){this._pairs.push([e,t])},ho.toString=function(e){const t=e?function(t){return e.call(this,t,co)}:co;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const mo=uo;function po(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function fo(e,t,n){if(!t)return e;const r=n&&n.encode||po;Zi.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let s;if(s=a?a(t,n):Zi.isURLSearchParams(t)?t.toString():new mo(t,n).toString(r),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const go=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Zi.forEach(this.handlers,function(t){null!==t&&e(t)})}},yo={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xo={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:mo,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},vo="undefined"!==typeof window&&"undefined"!==typeof document,bo="object"===typeof navigator&&navigator||void 0,wo=vo&&(!bo||["ReactNative","NativeScript","NS"].indexOf(bo.product)<0),jo="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,No=vo&&window.location.href||"http://localhost",_o=(0,o.A)((0,o.A)({},e),xo);const So=function(e){function t(e,n,r,a){let s=e[a++];if("__proto__"===s)return!0;const i=Number.isFinite(+s),o=a>=e.length;if(s=!s&&Zi.isArray(r)?r.length:s,o)return Zi.hasOwnProp(r,s)?r[s]=[r[s],n]:r[s]=n,!i;r[s]&&Zi.isObject(r[s])||(r[s]=[]);return t(e,n,r[s],a)&&Zi.isArray(r[s])&&(r[s]=function(e){const t={},n=Object.keys(e);let r;const a=n.length;let s;for(r=0;r<a;r++)s=n[r],t[s]=e[s];return t}(r[s])),!i}if(Zi.isFormData(e)&&Zi.isFunction(e.entries)){const n={};return Zi.forEachEntry(e,(e,r)=>{t(function(e){return Zi.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,n,0)}),n}return null};const ko={transitional:yo,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,a=Zi.isObject(e);a&&Zi.isHTMLForm(e)&&(e=new FormData(e));if(Zi.isFormData(e))return r?JSON.stringify(So(e)):e;if(Zi.isArrayBuffer(e)||Zi.isBuffer(e)||Zi.isStream(e)||Zi.isFile(e)||Zi.isBlob(e)||Zi.isReadableStream(e))return e;if(Zi.isArrayBufferView(e))return e.buffer;if(Zi.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return lo(e,new _o.classes.URLSearchParams,(0,o.A)({visitor:function(e,t,n,r){return _o.isNode&&Zi.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=Zi.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return lo(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||r?(t.setContentType("application/json",!1),function(e,t,n){if(Zi.isString(e))try{return(t||JSON.parse)(e),Zi.trim(e)}catch(BM){if("SyntaxError"!==BM.name)throw BM}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||ko.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(Zi.isResponse(e)||Zi.isReadableStream(e))return e;if(e&&Zi.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(BM){if(n){if("SyntaxError"===BM.name)throw ro.from(BM,ro.ERR_BAD_RESPONSE,this,null,this.response);throw BM}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_o.classes.FormData,Blob:_o.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Zi.forEach(["delete","get","head","post","put","patch"],e=>{ko.headers[e]={}});const Eo=ko,Ao=Zi.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Co=Symbol("internals");function Do(e){return e&&String(e).trim().toLowerCase()}function To(e){return!1===e||null==e?e:Zi.isArray(e)?e.map(To):String(e)}function Oo(e,t,n,r,a){return Zi.isFunction(r)?r.call(this,t,n):(a&&(t=n),Zi.isString(t)?Zi.isString(r)?-1!==t.indexOf(r):Zi.isRegExp(r)?r.test(t):void 0:void 0)}class Po{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function a(e,t,n){const a=Do(t);if(!a)throw new Error("header name must be a non-empty string");const s=Zi.findKey(r,a);(!s||void 0===r[s]||!0===n||void 0===n&&!1!==r[s])&&(r[s||t]=To(e))}const s=(e,t)=>Zi.forEach(e,(e,n)=>a(e,n,t));if(Zi.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(Zi.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let n,r,a;return e&&e.split("\n").forEach(function(e){a=e.indexOf(":"),n=e.substring(0,a).trim().toLowerCase(),r=e.substring(a+1).trim(),!n||t[n]&&Ao[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(e),t);else if(Zi.isObject(e)&&Zi.isIterable(e)){let n,r,a={};for(const t of e){if(!Zi.isArray(t))throw TypeError("Object iterator must return a key-value pair");a[r=t[0]]=(n=a[r])?Zi.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}s(a,t)}else null!=e&&a(t,e,n);return this}get(e,t){if(e=Do(e)){const n=Zi.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(Zi.isFunction(t))return t.call(this,e,n);if(Zi.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Do(e)){const n=Zi.findKey(this,e);return!(!n||void 0===this[n]||t&&!Oo(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function a(e){if(e=Do(e)){const a=Zi.findKey(n,e);!a||t&&!Oo(0,n[a],a,t)||(delete n[a],r=!0)}}return Zi.isArray(e)?e.forEach(a):a(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const a=t[n];e&&!Oo(0,this[a],a,e,!0)||(delete this[a],r=!0)}return r}normalize(e){const t=this,n={};return Zi.forEach(this,(r,a)=>{const s=Zi.findKey(n,a);if(s)return t[s]=To(r),void delete t[a];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(a):String(a).trim();i!==a&&delete t[a],t[i]=To(r),n[i]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Zi.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&Zi.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[Co]=this[Co]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=Do(e);t[r]||(!function(e,t){const n=Zi.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(e,n,a){return this[r].call(this,t,e,n,a)},configurable:!0})})}(n,e),t[r]=!0)}return Zi.isArray(e)?e.forEach(r):r(e),this}}Po.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Zi.reduceDescriptors(Po.prototype,(e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}}),Zi.freezeMethods(Po);const Io=Po;function Ro(e,t){const n=this||Eo,r=t||n,a=Io.from(r.headers);let s=r.data;return Zi.forEach(e,function(e){s=e.call(n,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function Mo(e){return!(!e||!e.__CANCEL__)}function Lo(e,t,n){ro.call(this,null==e?"canceled":e,ro.ERR_CANCELED,t,n),this.name="CanceledError"}Zi.inherits(Lo,ro,{__CANCEL__:!0});const Fo=Lo;function Uo(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new ro("Request failed with status code "+n.status,[ro.ERR_BAD_REQUEST,ro.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Bo=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let a,s=0,i=0;return t=void 0!==t?t:1e3,function(o){const l=Date.now(),c=r[i];a||(a=l),n[s]=o,r[s]=l;let d=i,u=0;for(;d!==s;)u+=n[d++],d%=e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),l-a<t)return;const h=c&&l-c;return h?Math.round(1e3*u/h):void 0}};const zo=function(e,t){let n,r,a=0,s=1e3/t;const i=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();a=s,n=null,r&&(clearTimeout(r),r=null),e(...t)};return[function(){const e=Date.now(),t=e-a;for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];t>=s?i(l,e):(n=l,r||(r=setTimeout(()=>{r=null,i(n)},s-t)))},()=>n&&i(n)]},qo=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const a=Bo(50,250);return zo(n=>{const s=n.loaded,i=n.lengthComputable?n.total:void 0,o=s-r,l=a(o);r=s;e({loaded:s,total:i,progress:i?s/i:void 0,bytes:o,rate:l||void 0,estimated:l&&i&&s<=i?(i-s)/l:void 0,event:n,lengthComputable:null!=i,[t?"download":"upload"]:!0})},n)},Vo=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Ho=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Zi.asap(()=>e(...n))},Wo=_o.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,_o.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(_o.origin),_o.navigator&&/(msie|trident)/i.test(_o.navigator.userAgent)):()=>!0,Go=_o.hasStandardBrowserEnv?{write(e,t,n,r,a,s){const i=[e+"="+encodeURIComponent(t)];Zi.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),Zi.isString(r)&&i.push("path="+r),Zi.isString(a)&&i.push("domain="+a),!0===s&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Ko(e,t,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Qo=e=>e instanceof Io?(0,o.A)({},e):e;function Yo(e,t){t=t||{};const n={};function r(e,t,n,r){return Zi.isPlainObject(e)&&Zi.isPlainObject(t)?Zi.merge.call({caseless:r},e,t):Zi.isPlainObject(t)?Zi.merge({},t):Zi.isArray(t)?t.slice():t}function a(e,t,n,a){return Zi.isUndefined(t)?Zi.isUndefined(e)?void 0:r(void 0,e,0,a):r(e,t,0,a)}function s(e,t){if(!Zi.isUndefined(t))return r(void 0,t)}function i(e,t){return Zi.isUndefined(t)?Zi.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function l(n,a,s){return s in t?r(n,a):s in e?r(void 0,n):void 0}const c={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(e,t,n)=>a(Qo(e),Qo(t),0,!0)};return Zi.forEach(Object.keys((0,o.A)((0,o.A)({},e),t)),function(r){const s=c[r]||a,i=s(e[r],t[r],r);Zi.isUndefined(i)&&s!==l||(n[r]=i)}),n}const $o=e=>{const t=Yo({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:s,headers:i,auth:o}=t;if(t.headers=i=Io.from(i),t.url=fo(Ko(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Zi.isFormData(n))if(_o.hasStandardBrowserEnv||_o.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Zi.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[n,r]=e;t.includes(n.toLowerCase())&&i.set(n,r)})}if(_o.hasStandardBrowserEnv&&(r&&Zi.isFunction(r)&&(r=r(t)),r||!1!==r&&Wo(t.url))){const e=a&&s&&Go.read(s);e&&i.set(a,e)}return t},Jo="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const r=$o(e);let a=r.data;const s=Io.from(r.headers).normalize();let i,o,l,c,d,{responseType:u,onUploadProgress:h,onDownloadProgress:m}=r;function p(){c&&c(),d&&d(),r.cancelToken&&r.cancelToken.unsubscribe(i),r.signal&&r.signal.removeEventListener("abort",i)}let f=new XMLHttpRequest;function g(){if(!f)return;const r=Io.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());Uo(function(e){t(e),p()},function(e){n(e),p()},{data:u&&"text"!==u&&"json"!==u?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:r,config:e,request:f}),f=null}f.open(r.method.toUpperCase(),r.url,!0),f.timeout=r.timeout,"onloadend"in f?f.onloadend=g:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(g)},f.onabort=function(){f&&(n(new ro("Request aborted",ro.ECONNABORTED,e,f)),f=null)},f.onerror=function(t){const r=t&&t.message?t.message:"Network Error",a=new ro(r,ro.ERR_NETWORK,e,f);a.event=t||null,n(a),f=null},f.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const a=r.transitional||yo;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new ro(t,a.clarifyTimeoutError?ro.ETIMEDOUT:ro.ECONNABORTED,e,f)),f=null},void 0===a&&s.setContentType(null),"setRequestHeader"in f&&Zi.forEach(s.toJSON(),function(e,t){f.setRequestHeader(t,e)}),Zi.isUndefined(r.withCredentials)||(f.withCredentials=!!r.withCredentials),u&&"json"!==u&&(f.responseType=r.responseType),m&&([l,d]=qo(m,!0),f.addEventListener("progress",l)),h&&f.upload&&([o,c]=qo(h),f.upload.addEventListener("progress",o),f.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(i=t=>{f&&(n(!t||t.type?new Fo(null,e,f):t),f.abort(),f=null)},r.cancelToken&&r.cancelToken.subscribe(i),r.signal&&(r.signal.aborted?i():r.signal.addEventListener("abort",i)));const y=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);y&&-1===_o.protocols.indexOf(y)?n(new ro("Unsupported protocol "+y+":",ro.ERR_BAD_REQUEST,e)):f.send(a||null)})},Xo=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const a=function(e){if(!n){n=!0,i();const t=e instanceof Error?e:this.reason;r.abort(t instanceof ro?t:new Fo(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,a(new ro("timeout ".concat(t," of ms exceeded"),ro.ETIMEDOUT))},t);const i=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)}),e=null)};e.forEach(e=>e.addEventListener("abort",a));const{signal:o}=r;return o.unsubscribe=()=>Zi.asap(i),o}};function Zo(e,t){this.v=e,this.k=t}function el(e){return function(){return new tl(e.apply(this,arguments))}}function tl(e){var t,n;function r(t,n){try{var s=e[t](n),i=s.value,o=i instanceof Zo;Promise.resolve(o?i.v:i).then(function(n){if(o){var l="return"===t?"return":"next";if(!i.k||n.done)return r(l,n);n=e[l](n).value}a(s.done?"return":"normal",n)},function(e){r("throw",e)})}catch(e){a("throw",e)}}function a(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,a){return new Promise(function(s,i){var o={key:e,arg:a,resolve:s,reject:i,next:null};n?n=n.next=o:(t=n=o,r(e,a))})},"function"!=typeof e.return&&(this.return=void 0)}function nl(e){return new Zo(e,0)}function rl(e){var t={},n=!1;function r(t,r){return n=!0,r=new Promise(function(n){n(e[t](r))}),{done:!1,value:new Zo(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}function al(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new sl(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function sl(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return sl=function(e){this.s=e,this.n=e.next},sl.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new sl(e)}tl.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},tl.prototype.next=function(e){return this._invoke("next",e)},tl.prototype.throw=function(e){return this._invoke("throw",e)},tl.prototype.return=function(e){return this._invoke("return",e)};const il=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,a=0;for(;a<n;)r=a+t,yield e.slice(a,r),a=r},ol=function(){var e=el(function*(e,t){var n,r=!1,a=!1;try{for(var s,i=al(ll(e));r=!(s=yield nl(i.next())).done;r=!1){const e=s.value;yield*rl(al(il(e,t)))}}catch(o){a=!0,n=o}finally{try{r&&null!=i.return&&(yield nl(i.return()))}finally{if(a)throw n}}});return function(t,n){return e.apply(this,arguments)}}(),ll=function(){var e=el(function*(e){if(e[Symbol.asyncIterator])return void(yield*rl(al(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield nl(t.read());if(e)break;yield n}}finally{yield nl(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),cl=(e,t,n,r)=>{const a=ol(e,t);let s,i=0,o=e=>{s||(s=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await a.next();if(t)return o(),void e.close();let s=r.byteLength;if(n){let e=i+=s;n(e)}e.enqueue(new Uint8Array(r))}catch(t){throw o(t),t}},cancel:e=>(o(e),a.return())},{highWaterMark:2})},{isFunction:dl}=Zi,ul=(e=>{let{Request:t,Response:n}=e;return{Request:t,Response:n}})(Zi.global),{ReadableStream:hl,TextEncoder:ml}=Zi.global,pl=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(BM){return!1}},fl=e=>{e=Zi.merge.call({skipUndefined:!0},ul,e);const{fetch:t,Request:n,Response:r}=e,a=t?dl(t):"function"===typeof fetch,s=dl(n),i=dl(r);if(!a)return!1;const l=a&&dl(hl),c=a&&("function"===typeof ml?(d=new ml,e=>d.encode(e)):async e=>new Uint8Array(await new n(e).arrayBuffer()));var d;const u=s&&l&&pl(()=>{let e=!1;const t=new n(_o.origin,{body:new hl,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),h=i&&l&&pl(()=>Zi.isReadableStream(new r("").body)),m={stream:h&&(e=>e.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!m[e]&&(m[e]=(t,n)=>{let r=t&&t[e];if(r)return r.call(t);throw new ro("Response type '".concat(e,"' is not supported"),ro.ERR_NOT_SUPPORT,n)})});const p=async(e,t)=>{const r=Zi.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(Zi.isBlob(e))return e.size;if(Zi.isSpecCompliantForm(e)){const t=new n(_o.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Zi.isArrayBufferView(e)||Zi.isArrayBuffer(e)?e.byteLength:(Zi.isURLSearchParams(e)&&(e+=""),Zi.isString(e)?(await c(e)).byteLength:void 0)})(t):r};return async e=>{let{url:a,method:i,data:l,signal:c,cancelToken:d,timeout:f,onDownloadProgress:g,onUploadProgress:y,responseType:x,headers:v,withCredentials:b="same-origin",fetchOptions:w}=$o(e),j=t||fetch;x=x?(x+"").toLowerCase():"text";let N=Xo([c,d&&d.toAbortSignal()],f),_=null;const S=N&&N.unsubscribe&&(()=>{N.unsubscribe()});let k;try{if(y&&u&&"get"!==i&&"head"!==i&&0!==(k=await p(v,l))){let e,t=new n(a,{method:"POST",body:l,duplex:"half"});if(Zi.isFormData(l)&&(e=t.headers.get("content-type"))&&v.setContentType(e),t.body){const[e,n]=Vo(k,qo(Ho(y)));l=cl(t.body,65536,e,n)}}Zi.isString(b)||(b=b?"include":"omit");const t=s&&"credentials"in n.prototype,c=(0,o.A)((0,o.A)({},w),{},{signal:N,method:i.toUpperCase(),headers:v.normalize().toJSON(),body:l,duplex:"half",credentials:t?b:void 0});_=s&&new n(a,c);let d=await(s?j(_,w):j(a,c));const f=h&&("stream"===x||"response"===x);if(h&&(g||f&&S)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=d[t]});const t=Zi.toFiniteNumber(d.headers.get("content-length")),[n,a]=g&&Vo(t,qo(Ho(g),!0))||[];d=new r(cl(d.body,65536,n,()=>{a&&a(),S&&S()}),e)}x=x||"text";let E=await m[Zi.findKey(m,x)||"text"](d,e);return!f&&S&&S(),await new Promise((t,n)=>{Uo(t,n,{data:E,headers:Io.from(d.headers),status:d.status,statusText:d.statusText,config:e,request:_})})}catch(E){if(S&&S(),E&&"TypeError"===E.name&&/Load failed|fetch/i.test(E.message))throw Object.assign(new ro("Network Error",ro.ERR_NETWORK,e,_),{cause:E.cause||E});throw ro.from(E,E&&E.code,e,_)}}},gl=new Map,yl=e=>{let t=e?e.env:{};const{fetch:n,Request:r,Response:a}=t,s=[r,a,n];let i,o,l=s.length,c=gl;for(;l--;)i=s[l],o=c.get(i),void 0===o&&c.set(i,o=l?new Map:fl(t)),c=o;return o},xl=(yl(),{http:null,xhr:Jo,fetch:{get:yl}});Zi.forEach(xl,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(BM){}Object.defineProperty(e,"adapterName",{value:t})}});const vl=e=>"- ".concat(e),bl=e=>Zi.isFunction(e)||null===e||!1===e,wl=(e,t)=>{e=Zi.isArray(e)?e:[e];const{length:n}=e;let r,a;const s={};for(let i=0;i<n;i++){let n;if(r=e[i],a=r,!bl(r)&&(a=xl[(n=String(r)).toLowerCase()],void 0===a))throw new ro("Unknown adapter '".concat(n,"'"));if(a&&(Zi.isFunction(a)||(a=a.get(t))))break;s[n||"#"+i]=a}if(!a){const e=Object.entries(s).map(e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")});let t=n?e.length>1?"since :\n"+e.map(vl).join("\n"):" "+vl(e[0]):"as no adapter specified";throw new ro("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return a};function jl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Fo(null,e)}function Nl(e){jl(e),e.headers=Io.from(e.headers),e.data=Ro.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return wl(e.adapter||Eo.adapter,e)(e).then(function(t){return jl(e),t.data=Ro.call(e,e.transformResponse,t),t.headers=Io.from(t.headers),t},function(t){return Mo(t)||(jl(e),t&&t.response&&(t.response.data=Ro.call(e,e.transformResponse,t.response),t.response.headers=Io.from(t.response.headers))),Promise.reject(t)})}const _l="1.12.2",Sl={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Sl[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const kl={};Sl.transitional=function(e,t,n){function r(e,t){return"[Axios v"+_l+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,a,s)=>{if(!1===e)throw new ro(r(a," has been removed"+(t?" in "+t:"")),ro.ERR_DEPRECATED);return t&&!kl[a]&&(kl[a]=!0,console.warn(r(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,a,s)}},Sl.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const El={assertOptions:function(e,t,n){if("object"!==typeof e)throw new ro("options must be an object",ro.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const s=r[a],i=t[s];if(i){const t=e[s],n=void 0===t||i(t,s,e);if(!0!==n)throw new ro("option "+s+" must be "+n,ro.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new ro("Unknown option "+s,ro.ERR_BAD_OPTION)}},validators:Sl},Al=El.validators;class Cl{constructor(e){this.defaults=e||{},this.interceptors={request:new go,response:new go}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(BM){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=Yo(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:a}=t;void 0!==n&&El.assertOptions(n,{silentJSONParsing:Al.transitional(Al.boolean),forcedJSONParsing:Al.transitional(Al.boolean),clarifyTimeoutError:Al.transitional(Al.boolean)},!1),null!=r&&(Zi.isFunction(r)?t.paramsSerializer={serialize:r}:El.assertOptions(r,{encode:Al.function,serialize:Al.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),El.assertOptions(t,{baseUrl:Al.spelling("baseURL"),withXsrfToken:Al.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=a&&Zi.merge(a.common,a[t.method]);a&&Zi.forEach(["delete","get","head","post","put","patch","common"],e=>{delete a[e]}),t.headers=Io.concat(s,a);const i=[];let o=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,i.unshift(e.fulfilled,e.rejected))});const l=[];let c;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let d,u=0;if(!o){const e=[Nl.bind(this),void 0];for(e.unshift(...i),e.push(...l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=i.length;let h=t;for(;u<d;){const e=i[u++],t=i[u++];try{h=e(h)}catch(m){t.call(this,m);break}}try{c=Nl.call(this,h)}catch(m){return Promise.reject(m)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return fo(Ko((e=Yo(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}Zi.forEach(["delete","get","head","options"],function(e){Cl.prototype[e]=function(t,n){return this.request(Yo(n||{},{method:e,url:t,data:(n||{}).data}))}}),Zi.forEach(["post","put","patch"],function(e){function t(t){return function(n,r,a){return this.request(Yo(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Cl.prototype[e]=t(),Cl.prototype[e+"Form"]=t(!0)});const Dl=Cl;class Tl{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,r,a){n.reason||(n.reason=new Fo(e,r,a),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new Tl(function(t){e=t});return{token:t,cancel:e}}}const Ol=Tl;const Pl={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Pl).forEach(e=>{let[t,n]=e;Pl[n]=t});const Il=Pl;const Rl=function e(t){const n=new Dl(t),r=mi(Dl.prototype.request,n);return Zi.extend(r,Dl.prototype,n,{allOwnKeys:!0}),Zi.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(Yo(t,n))},r}(Eo);Rl.Axios=Dl,Rl.CanceledError=Fo,Rl.CancelToken=Ol,Rl.isCancel=Mo,Rl.VERSION=_l,Rl.toFormData=lo,Rl.AxiosError=ro,Rl.Cancel=Rl.CanceledError,Rl.all=function(e){return Promise.all(e)},Rl.spread=function(e){return function(t){return e.apply(null,t)}},Rl.isAxiosError=function(e){return Zi.isObject(e)&&!0===e.isAxiosError},Rl.mergeConfig=Yo,Rl.AxiosHeaders=Io,Rl.formToJSON=e=>So(Zi.isHTMLForm(e)?new FormData(e):e),Rl.getAdapter=wl,Rl.HttpStatusCode=Il,Rl.default=Rl;const Ml=Rl;function Ll(e){const t=[],n=e.toLowerCase();return n.includes("complete")||n.includes("finish")||n.includes("build")||n.includes("create")||t.push("Consider making your goal more action-oriented with specific outcomes."),n.includes("hour")||n.includes("minute")||n.includes("page")||/\d+/.test(n)||t.push("Add measurable criteria to track your progress."),t.push("\u2022 What specific steps will you take to achieve this?"),t.push("\u2022 How will you know when you've completed it?"),t.push("\u2022 What resources or help do you need?"),t.join("\n\n")}const Fl=Un("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),Ul=e=>{let{goal:t,studentId:n,onSubmitSuccess:a}=e;const[s,i]=(0,r.useState)(!1),[l,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!1),[h,m]=(0,r.useState)(null),[p,f]=(0,r.useState)(t.target_percentage),[g,y]=(0,r.useState)({workedWell:"",howAchieved:"",keyLearning:"",challenges:""}),x=(e,t)=>{y(n=>(0,o.A)((0,o.A)({},n),{},{[e]:t}))},v=()=>g.workedWell.trim().length>0&&g.howAchieved.trim().length>0&&g.keyLearning.trim().length>0&&g.challenges.trim().length>0&&p>=0&&p<=100;return d?(0,Pt.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(qn,{className:"h-6 w-6 text-green-600"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-green-900",children:"Reflection Submitted!"}),(0,Pt.jsx)("p",{className:"text-sm text-green-700",children:"Your daily reflection has been recorded successfully."})]})]})}):s?(0,Pt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,Pt.jsx)(pa,{className:"h-5 w-5 text-primary-600"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Daily Reflection"})]}),(0,Pt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),v()){c(!0),m(null);try{console.log("\ud83d\udcdd [DailyReflection] Submitting reflection for goal:",t.id),await dn.createReflection({student_id:n,goal_id:t.id,phase_id:t.phase_id,topic_id:t.topic_id,reflection_answers:g,achieved_percentage:p,status:"pending"}),console.log("\u2705 [DailyReflection] Reflection submitted successfully"),u(!0),i(!1),a&&a(),setTimeout(()=>{u(!1),y({workedWell:"",howAchieved:"",keyLearning:"",challenges:""})},2e3)}catch(r){console.error("\u274c [DailyReflection] Error submitting reflection:",r),m("Failed to submit reflection. Please try again.")}finally{c(!1)}}else m("Please fill in all fields before submitting.")},className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Today's Goal:"}),(0,Pt.jsx)("p",{className:"text-gray-900 font-medium",children:t.goal_text}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Target: ",t.target_percentage,"%"]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{htmlFor:"achievedPercentage",className:"block text-sm font-medium text-gray-700 mb-2",children:"How much did you achieve? (%)"}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pt.jsx)("input",{type:"range",id:"achievedPercentage",min:"0",max:"100",step:"5",value:p,onChange:e=>f(Number(e.target.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,Pt.jsxs)("span",{className:"text-lg font-bold text-primary-600 min-w-[60px] text-right",children:[p,"%"]})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{htmlFor:"workedWell",className:"block text-sm font-medium text-gray-700 mb-2",children:"1. What worked well for you today? What were you able to achieve? *"}),(0,Pt.jsx)("textarea",{id:"workedWell",rows:4,value:g.workedWell,onChange:e=>x("workedWell",e.target.value),placeholder:"Describe what went well and what you accomplished...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",required:!0})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{htmlFor:"howAchieved",className:"block text-sm font-medium text-gray-700 mb-2",children:"2. How did you achieve this, and who supported you? *"}),(0,Pt.jsx)("textarea",{id:"howAchieved",rows:4,value:g.howAchieved,onChange:e=>x("howAchieved",e.target.value),placeholder:"Explain your approach and mention any support you received...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",required:!0})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{htmlFor:"keyLearning",className:"block text-sm font-medium text-gray-700 mb-2",children:"3. What was your special learning from today's task? *"}),(0,Pt.jsx)("textarea",{id:"keyLearning",rows:4,value:g.keyLearning,onChange:e=>x("keyLearning",e.target.value),placeholder:"Share your key takeaway or insight...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",required:!0})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{htmlFor:"challenges",className:"block text-sm font-medium text-gray-700 mb-2",children:"4. What challenges did you face, and what would you need to make it better? *"}),(0,Pt.jsx)("textarea",{id:"challenges",rows:4,value:g.challenges,onChange:e=>x("challenges",e.target.value),placeholder:"Describe any difficulties and what could help improve...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",required:!0})]}),h&&(0,Pt.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-red-600 mt-0.5"}),(0,Pt.jsx)("p",{className:"text-sm text-red-700",children:h})]}),(0,Pt.jsxs)("div",{className:"flex items-center justify-end space-x-4 pt-4 border-t",children:[(0,Pt.jsx)("button",{type:"button",onClick:()=>i(!1),className:"px-6 py-2 text-gray-700 hover:text-gray-900 font-medium",disabled:l,children:"Cancel"}),(0,Pt.jsx)("button",{type:"submit",disabled:l||!v(),className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:l?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Fl,{className:"h-4 w-4 animate-spin"}),(0,Pt.jsx)("span",{children:"Submitting..."})]}):(0,Pt.jsx)("span",{children:"Submit Reflection"})})]})]})]}):(0,Pt.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(pa,{className:"h-5 w-5 text-primary-600"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Daily Reflection"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Reflect on your learning progress today"})]})]}),(0,Pt.jsx)("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium",children:"Record My Reflection"})]})})};var Bl=n(1267);class zl{static async requestPhaseApproval(e,t,n){const r=await _t.B.getWhereCompound(_t.I.PHASE_APPROVALS,[{field:"student_id",operator:"==",value:e},{field:"next_phase_id",operator:"==",value:n},{field:"status",operator:"==",value:"pending"}]);if(r.length>0)return r[0].id;const[a,s,i]=await Promise.all([_t.UserService.getById(_t.I.USERS,e),on.getPhaseById(t),on.getPhaseById(n)]),o={student_id:e,student_name:(null===a||void 0===a?void 0:a.name)||"Unknown Student",current_phase_id:t,current_phase_name:(null===s||void 0===s?void 0:s.name)||"Unknown Phase",next_phase_id:n,next_phase_name:(null===i||void 0===i?void 0:i.name)||"Unknown Phase",requested_at:new Date,status:"pending"};return await _t.B.create(_t.I.PHASE_APPROVALS,o)}static async getPendingApprovals(e){return await _t.B.getWhereCompound(_t.I.PHASE_APPROVALS,[{field:"student_id",operator:"==",value:e},{field:"status",operator:"==",value:"pending"}],"requested_at","desc")}static async getAllPendingApprovals(){return await _t.B.getWhere(_t.I.PHASE_APPROVALS,"status","==","pending")}static async approvePhaseTransition(e,t){const n=await _t.B.getById(_t.I.PHASE_APPROVALS,e);if(!n)throw new Error("Approval request not found");const r=await _t.UserService.getById(_t.I.USERS,t);await _t.B.update(_t.I.PHASE_APPROVALS,e,{status:"approved",approved_by:t,approved_by_name:(null===r||void 0===r?void 0:r.name)||"Unknown Admin",approved_at:new Date});try{const e=await on.getAllPhases(),t=e.find(e=>e.id===n.current_phase_id),r=e.find(e=>e.id===n.next_phase_id);if(!t||!r)throw new Error("Phase not found");const a=e.filter(e=>!(e.order>=9)&&(e.order>=t.order&&e.order<r.order)).map(async e=>{const t=e.active_students_count||0,n=e.completed_students_count||0;await _t.B.update(_t.I.PHASES,e.id,{active_students_count:Math.max(0,t-1),completed_students_count:n+1})});if(await Promise.all(a),r){const e=r.active_students_count||0;await _t.B.update(_t.I.PHASES,n.next_phase_id,{active_students_count:e+1})}}catch(a){console.error("Error updating phase student counts:",a)}}static async rejectPhaseTransition(e,t,n){const r=await _t.UserService.getById(_t.I.USERS,t);await _t.B.update(_t.I.PHASE_APPROVALS,e,{status:"rejected",approved_by:t,approved_by_name:(null===r||void 0===r?void 0:r.name)||"Unknown Admin",approved_at:new Date,rejection_reason:n})}static async canAccessPhase(e,t,n,r){if(r<=n)return!0;return(await _t.B.getWhereCompound(_t.I.PHASE_APPROVALS,[{field:"student_id",operator:"==",value:e},{field:"status",operator:"==",value:"approved"}])).map(e=>e.next_phase_id).includes(t)}static async getApprovalHistory(e){return await _t.B.getWhere(_t.I.PHASE_APPROVALS,"student_id","==",e)}static async getHighestApprovedPhase(e){const t=await _t.B.getWhereCompound(_t.I.PHASE_APPROVALS,[{field:"student_id",operator:"==",value:e},{field:"status",operator:"==",value:"approved"}],"approved_at","desc");return t.length>0?t[0].next_phase_id:null}static async recalculatePhaseCounts(){try{const[e,t,n]=await Promise.all([on.getAllPhases(),_t.B.getAll(_t.I.PHASE_APPROVALS),_t.B.getAll(_t.I.DAILY_GOALS)]),r=new Map,a=new Map;e.forEach(e=>{r.set(e.id,new Set),a.set(e.id,new Set)}),n.forEach(e=>{e.phase_id&&e.student_id&&(r.has(e.phase_id)||r.set(e.phase_id,new Set),r.get(e.phase_id).add(e.student_id))});const s=t.filter(e=>"approved"===e.status),i=new Map(e.map(e=>[e.id,e]));s.forEach(t=>{const n=i.get(t.current_phase_id),s=i.get(t.next_phase_id);if(!n||!s)return;e.filter(e=>!(e.order>=9)&&(e.order>=n.order&&e.order<s.order)).forEach(e=>{r.has(e.id)&&r.get(e.id).delete(t.student_id),a.has(e.id)||a.set(e.id,new Set),a.get(e.id).add(t.student_id)}),r.has(t.next_phase_id)&&r.get(t.next_phase_id).add(t.student_id)});const o=e.map(e=>{var t,n;const s=(null===(t=r.get(e.id))||void 0===t?void 0:t.size)||0,i=(null===(n=a.get(e.id))||void 0===n?void 0:n.size)||0;return _t.B.update(_t.I.PHASES,e.id,{active_students_count:s,completed_students_count:i})});await Promise.all(o),console.log("Phase counts recalculated successfully")}catch(e){throw console.error("Error recalculating phase counts:",e),e}}}const ql=Un("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Vl=Un("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Hl=Un("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Wl=Un("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Gl=()=>{const{userData:e}=Rt(),[t,n]=(0,r.useState)([]),[a,s]=(0,r.useState)([]),[i,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),[m,p]=(0,r.useState)({phase_id:"",topic_id:"",goal_text:"",target_percentage:80,goal_date:new Date}),[f,g]=(0,r.useState)(!1),[y,x]=(0,r.useState)(!1),[v,b]=(0,r.useState)(""),[w,j]=(0,r.useState)(!1),[N,_]=(0,r.useState)(!1),[S,k]=(0,r.useState)({phasesCount:0,topicsCount:0,isSeeded:!1}),[E,A]=(0,r.useState)(!1),[C,D]=(0,r.useState)(!1),[T,O]=(0,r.useState)(""),[P,I]=(0,r.useState)(""),[R,M]=(0,r.useState)(""),[L,F]=(0,r.useState)(null),[U,B]=(0,r.useState)(!1),[z,q]=(0,r.useState)(""),[V,H]=(0,r.useState)(new Set),[W,G]=(0,r.useState)([]),[K,Q]=(0,r.useState)(null),[Y,$]=(0,r.useState)(!1),[J,X]=(0,r.useState)(null),Z=e=>{if(!e)return"";const t=is.parse(e);return ui.sanitize(t)},ee=(0,r.useCallback)(async()=>{if(null!==e&&void 0!==e&&e.id){l(!0);try{const r=await on.getAllPhases();let a=[],s=[];try{a=await zl.getApprovalHistory(e.id),s=await zl.getPendingApprovals(e.id)}catch(t){console.warn("Could not load approval data (index may need to be created):",t)}const i=r.filter((e,t,n)=>t===n.findIndex(t=>t.name===e.name));i.sort((e,t)=>{if("Induction: Life Skills & Learning"===e.name)return-1;if("Induction: Life Skills & Learning"===t.name)return 1;const n="Self Learning Space"===e.name||"Super mentor Phase"===e.name,r="Self Learning Space"===t.name||"Super mentor Phase"===t.name;return n||r?n&&!r?1:!n&&r||"Self Learning Space"===e.name?-1:"Self Learning Space"===t.name?1:0:e.order-t.order}),n(i),G(s);const o=i.find(e=>"Induction: Life Skills & Learning"===e.name),l=i.find(t=>t.id===e.current_phase_id)||o||i[0];Q(l);const c=new Set;o&&c.add(o.id),i.forEach(e=>{!("Self Learning Space"===e.name||"Super mentor Phase"===e.name)&&e.order>=0&&e.order<=((null===l||void 0===l?void 0:l.order)||0)&&c.add(e.id)}),a.filter(e=>"approved"===e.status).forEach(e=>c.add(e.next_phase_id)),H(c);const u=new Date,m=new Date(u);m.setHours(0,0,0,0);const p=new Date(u);p.setHours(23,59,59,999);const f=(await _t.B.getWhere(_t.I.DAILY_GOALS,"student_id","==",e.id)).find(e=>{const t=e.created_at instanceof Date?e.created_at:new Date(e.created_at);return t>=m&&t<=p})||null;if(d(f),null!==f&&void 0!==f&&f.goal_feedback){O(f.goal_feedback);const e=Z(f.goal_feedback);M(e);const t=f.goal_feedback.match(/\*\*INTERNAL RATING:\s*\[(\d+)\]\*\*/i);if(t){const e=parseInt(t[1],10);e>=0&&e<=100&&F(e)}}if(k({phasesCount:r.length,topicsCount:0,isSeeded:r.length>0}),f){const e=(await _t.B.getWhere(_t.I.DAILY_REFLECTIONS,"goal_id","==",f.id))[0]||null;h(e)}}catch(v){console.error("Error loading initial data:",v),b("Failed to load data. Please try again.")}finally{l(!1)}}},[null===e||void 0===e?void 0:e.id,null===e||void 0===e?void 0:e.current_phase_id]);(0,r.useEffect)(()=>{ee()},[ee]),(0,r.useEffect)(()=>{m.phase_id&&te(m.phase_id)},[m.phase_id]),(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&E&&A(!1)};return E&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[E]);const te=async e=>{try{const t=(await ln.getTopicsByPhase(e)).filter((e,t,n)=>t===n.findIndex(t=>t.name===e.name));s(t)}catch(v){console.error("Error loading topics:",v),b("Failed to load topics")}},ne=e=>!!V.has(e.id),re=e=>{const{name:t,value:n}=e.target;p(e=>(0,o.A)((0,o.A)({},e),{},{[t]:"target_percentage"===t?Number(n):"goal_date"===t?new Date(n):n}))},ae=async t=>{t.preventDefault(),g(!0),b("");try{const t=null===c||void 0===c?void 0:c.id;let n=!0;if(t){const e=(0,o.A)((0,o.A)({},m),{},{status:"pending"});null!==L&&void 0!==L&&(e.goal_rating=L),null!==T&&void 0!==T&&""!==T.trim()&&(e.goal_feedback=T),await _t.B.update(_t.I.DAILY_GOALS,t,e)}else{const t=(0,o.A)((0,o.A)({},m),{},{student_id:(null===e||void 0===e?void 0:e.id)||"",status:"pending"});null!==L&&void 0!==L&&(t.goal_rating=L),null!==T&&void 0!==T&&""!==T.trim()&&(t.goal_feedback=T),await _t.B.create(_t.I.DAILY_GOALS,t)}n?(x(!0),setTimeout(()=>x(!1),3e3),await ee(),_(!1)):b("Failed to save goal")}catch(v){console.error("Error saving goal:",v),b("Failed to save goal. Please try again.")}finally{g(!1)}},se=async()=>{if(c){const e=(await _t.B.getWhere(_t.I.DAILY_REFLECTIONS,"goal_id","==",c.id))[0]||null;h(e)}},ie=async()=>{try{j(!0),b("");await hi.seedInitialData()?(x(!0),setTimeout(()=>x(!1),3e3),await ee()):b("Failed to initialize curriculum data")}catch(v){console.error("Error seeding data:",v),b("Failed to initialize curriculum data")}finally{j(!1)}};return(0,Pt.jsxs)(r.Fragment,{children:[(0,Pt.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,Pt.jsxs)("div",{className:"bg-white shadow-sm rounded-lg relative",children:[i&&(0,Pt.jsx)("div",{className:"absolute top-0 left-0 right-0",children:(0,Pt.jsx)("div",{className:"h-1 bg-primary-100 overflow-hidden rounded-t-lg",children:(0,Pt.jsx)("div",{className:"h-1 bg-primary-500 transition-all duration-500 ease-in-out animate-progress",style:{width:"100%"}})})}),(0,Pt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center space-x-3 flex-wrap",children:[(0,Pt.jsx)("div",{className:"p-2 bg-primary-100 rounded-lg",children:(0,Pt.jsx)(Yn,{className:"h-6 w-6 text-primary-600"})}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:N?"Update Goal":"Set Learning Goal"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:N?"Modify your learning objective for today":"Track and reflect on your daily progress"})]}),(0,Pt.jsx)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4 mt-2",children:(!c||N)&&(0,Pt.jsx)(Pt.Fragment,{children:(0,Pt.jsxs)("button",{type:"button",className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 flex items-center gap-2",onClick:async()=>{A(!0),D(!0),I(""),O(""),M(""),F(null);try{if(!m.goal_text)return I("Please enter your goal first."),void D(!1);const n=a.find(e=>e.id===m.topic_id),r=t.find(e=>e.id===m.phase_id);let s={phase:(null===r||void 0===r?void 0:r.name)||"General",topic:(null===n||void 0===n?void 0:n.name)||"General"};try{if(r&&n){const e=r.name,t=Bl.detailedTopics[e],a=t?t.find(e=>e.name===n.name):void 0;a&&(s.description=a.description,s.keyTags=a.keyTags,s.deliverable=a.deliverable)}}catch(BM){}const i=await async function(e){let{goalText:t,apiKey:n,context:r}=e;if(!t)throw new Error("Goal text is required");if(!n)return{feedback:Ll(t),provider:"fallback",error:"No API key provided"};if(!n.startsWith("AIza")||n.length<20)return console.warn("API key format appears invalid"),{feedback:Ll(t),provider:"fallback",error:"Invalid API key format"};try{let e=r||"No additional context provided.";try{const t="string"===typeof r?JSON.parse(r):r;if(t&&"object"===typeof t){const n=[];t.phase&&n.push("- Phase: ".concat(t.phase)),t.topic&&n.push("- Topic: ".concat(t.topic)),t.description&&n.push("- Topic Description: ".concat(t.description)),t.keyTags&&n.push("- Key Tags: ".concat(Array.isArray(t.keyTags)?t.keyTags.join(", "):t.keyTags)),t.deliverable&&n.push("- Deliverable: ".concat(t.deliverable)),e=n.join("\n")||e}}catch(BM){}const h='You are a supportive senior mentor guiding a first-time learner. Your role is to help the student think, reflect, and improve their goal, not rewrite it or lecture. Responses should be human, critical but gentle, reflective, and slightly playful, with contextual examples if applicable.\n\nStudent goal: "'.concat(t,'"\nContext:\n').concat(e,"\n\nInstructions (Markdown only, ~250 words soft limit):\n\n**INTERNAL RATING: [0-100]** - Start your response with this exact format for parsing, then provide the feedback below. DO NOT include any rating text, numbers, or brackets in the visible feedback content.\n\nAcknowledgment of Positives:\n\nStart with 1\u20132 sentences highlighting any strengths, creativity, relevance, or SMART elements in the goal. Skip if none.\n\nSMART Analysis:\n\nEvaluate each SMART factor with a brief assessment. Use line breaks for readability.\n\n**Specific:** [1-2 sentences assessing how clear and specific the goal is]\n\n**Measurable:** [1-2 sentences assessing how the goal can be measured/tracked]\n\n**Achievable:** [1-2 sentences assessing if the goal is realistic given resources/time]\n\n**Relevant:** [1-2 sentences assessing if the goal aligns with learning objectives]\n\n**Time-bound:** [1-2 sentences assessing if there's a clear timeframe/deadline]\n\nCritical Feedback & Socratic Questions (no headers):\n\nIntegrate 2\u20133 lines of critical but approachable feedback naturally in flowing sentences.\n\nAsk 3\u20135 reflective, context-aware, example-driven Socratic questions that make the student pause and think.\n\nAvoid sounding like a lecture; make it human and relatable.\n\nSlight playfulness or references relevant to the goal are welcome.\n\nEnd with 1 short Hinglish sentence motivating the student to refine and try again. Format this as an emphasized quote.\n\nConstraints:\n\nDo not rewrite the goal.\n\nKeep total feedback under ~250 words, but prioritize clarity and depth over strict brevity.\n\nMake the student clearly understand where they need to reflect and improve."),m=["gemini-2.5-flash","gemini-2.0-flash","gemini-pro-latest","gemini-flash-latest"];let p=null;for(const t of m)try{var a,s,i,o,l,c;const e="https://generativelanguage.googleapis.com/v1beta/models/".concat(t,":generateContent?key=").concat(n);console.log("Trying Gemini model: ".concat(t," with endpoint: ").concat(e));const r=await Ml.post(e,{contents:[{parts:[{text:h}]}],generationConfig:{temperature:.6,maxOutputTokens:600,topP:.8,topK:10}},{headers:{"Content-Type":"application/json"},timeout:15e3});if(console.log("Gemini model ".concat(t," response:"),r.data),null!==(a=r.data)&&void 0!==a&&null!==(s=a.candidates)&&void 0!==s&&null!==(i=s[0])&&void 0!==i&&null!==(o=i.content)&&void 0!==o&&null!==(l=o.parts)&&void 0!==l&&null!==(c=l[0])&&void 0!==c&&c.text)return{feedback:r.data.candidates[0].content.parts[0].text.trim(),provider:"gemini"}}catch(v){var d,u;console.warn("Gemini model ".concat(t," failed:"),null===v||void 0===v||null===(d=v.response)||void 0===d?void 0:d.status,null===v||void 0===v||null===(u=v.response)||void 0===u?void 0:u.data),p=v}throw p||new Error("All Gemini models failed")}catch(v){if(console.warn("Gemini API failed, using fallback:",v),v&&"object"===typeof v&&"response"in v){var h,m,p,f;const t=v;console.warn("API Error Details:",{status:null===(h=t.response)||void 0===h?void 0:h.status,statusText:null===(m=t.response)||void 0===m?void 0:m.statusText,data:null===(p=t.response)||void 0===p?void 0:p.data,url:null===(f=t.config)||void 0===f?void 0:f.url})}return{feedback:Ll(t),provider:"fallback",error:v instanceof Error?v.message:"API request failed"}}}({goalText:m.goal_text,apiKey:(null===e||void 0===e?void 0:e.gemini_api_key)||"",context:s}),o=i.feedback||"No feedback received.";let l=o,c=null;const d=[/\*\*INTERNAL RATING:\s*\[(\d+)\]\*\*/i,/INTERNAL RATING:\s*\[(\d+)\]/i,/INTERNAL RATING:\s*(\d+)/i,/\[(\d+)\]/i];for(const e of d){const t=o.match(e);if(t){const e=parseInt(t[1],10);if(e>=0&&e<=100){c=e,F(e);break}}}null!==c&&(l=o.replace(/\*\*INTERNAL RATING:\s*\[\d+\]\*\*/gi,"").replace(/INTERNAL RATING:\s*\[\d+\]/gi,"").replace(/INTERNAL RATING:\s*\d+/gi,"").replace(/^\s*\[\d+\]\s*$/gm,"").trim()),O(l);const u=Z(l);M(u),"fallback"===i.provider&&(q("\ud83d\udca1 Add your Gemini API key in profile settings for personalized AI feedback tailored to your curriculum!"),B(!0))}catch(s){var n,r;I((null===s||void 0===s||null===(n=s.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.error)||s.message||"Failed to get feedback.")}finally{D(!1)}},disabled:!m.goal_text||C,"aria-label":"Get SMART Feedback",children:[(0,Pt.jsx)(Vl,{className:"h-4 w-4"}),C?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 animate-spin"}),(0,Pt.jsx)("span",{children:"Getting Feedback..."})]}):(0,Pt.jsx)("span",{children:"Get SMART Feedback"})]})})})]})}),(0,Pt.jsxs)("div",{className:"p-6",children:[y&&(0,Pt.jsxs)("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md flex items-center space-x-2",children:[(0,Pt.jsx)(qn,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:"Goal saved successfully! Your mentor will review it soon."})]}),v&&(0,Pt.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:v})]}),!S.isSeeded&&(0,Pt.jsx)("button",{onClick:ie,disabled:w,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-1",children:w?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 animate-spin"}),(0,Pt.jsx)("span",{children:"Initializing..."})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(ma,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Initialize Curriculum"})]})})]})}),!f&&0===t.length&&!v&&(0,Pt.jsxs)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded-md flex justify-between items-center",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:"No curriculum data found. Click initialize to load phases."})]}),(0,Pt.jsx)("button",{onClick:ie,disabled:w,className:"px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-md hover:bg-yellow-200 disabled:opacity-50 flex items-center space-x-1",children:w?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 animate-spin"}),(0,Pt.jsx)("span",{children:"Initializing..."})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Initialize Data"})]})})]}),!c||N?(0,Pt.jsxs)("form",{onSubmit:ae,className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("label",{htmlFor:"phase_id",className:"block text-sm font-medium text-gray-700 mb-2",children:["Phase ",(0,Pt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Pt.jsxs)("select",{id:"phase_id",name:"phase_id",value:m.phase_id,onChange:e=>(e=>{const n=t.find(t=>t.id===e);n&&e&&(ne(n)?p(t=>(0,o.A)((0,o.A)({},t),{},{phase_id:e,topic_id:""})):(p(e=>(0,o.A)((0,o.A)({},e),{},{phase_id:"",topic_id:""})),X(n),$(!0)))})(e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[(0,Pt.jsx)("option",{value:"",children:"Select a phase"}),t.map(e=>{const t=ne(e),n=W.some(t=>t.next_phase_id===e.id);return(0,Pt.jsxs)("option",{value:e.id,children:[e.name,t||n?"":" \ud83d\udd12 (Request Approval)",n?" \u23f3 (Pending Approval)":"",t&&e.id!==(null===K||void 0===K?void 0:K.id)?" \u2713 (Approved)":""]},e.id)})]}),W.length>0&&(0,Pt.jsxs)("p",{className:"mt-2 text-sm text-blue-600",children:["You have ",W.length," pending approval request(s)"]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("label",{htmlFor:"topic_id",className:"block text-sm font-medium text-gray-700 mb-2",children:["Topic ",(0,Pt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Pt.jsxs)("select",{id:"topic_id",name:"topic_id",value:m.topic_id,onChange:re,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[(0,Pt.jsx)("option",{value:"",children:"Select a topic"}),a.map(e=>(0,Pt.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("label",{htmlFor:"goal_text",className:"block text-sm font-medium text-gray-700 mb-2",children:["Goal Description ",(0,Pt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Pt.jsx)("textarea",{id:"goal_text",name:"goal_text",rows:4,value:m.goal_text,onChange:re,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),(0,Pt.jsxs)("div",{className:"mt-2",children:[(0,Pt.jsxs)("label",{htmlFor:"goal_date",className:"block text-sm font-medium text-gray-700 mb-2",children:["Goal Date ",(0,Pt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Pt.jsx)("input",{type:"date",id:"goal_date",name:"goal_date",value:m.goal_date?m.goal_date.toISOString().split("T")[0]:"",onChange:re,className:"block w-48 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Select the date for this goal (defaults to today)"})]}),(0,Pt.jsx)("div",{className:"flex justify-end",children:(0,Pt.jsx)("button",{type:"submit",disabled:f,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:f?"Saving...":"Save Goal"})})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,Pt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Set Learning Goal"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-4",children:null===c||void 0===c?void 0:c.goal_text}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,Pt.jsx)($n,{className:"h-4 w-4"}),(0,Pt.jsxs)("span",{children:["Target Achievement: ",null===c||void 0===c?void 0:c.target_percentage,"%"]})]})]}),("pending"===(null===c||void 0===c?void 0:c.status)||"reviewed"===(null===c||void 0===c?void 0:c.status))&&(0,Pt.jsx)("button",{onClick:()=>_(!0),className:"p-2 text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(ql,{className:"h-5 w-5"})})]}),"reviewed"===(null===c||void 0===c?void 0:c.status)&&(0,Pt.jsxs)("div",{className:"mt-4 p-4 bg-orange-50 border border-orange-200 rounded-md",children:[(0,Pt.jsxs)("h4",{className:"text-sm font-medium text-orange-900 mb-2 flex items-center space-x-2",children:[(0,Pt.jsx)(Hn,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Mentor Feedback - Revision Needed"})]}),(0,Pt.jsx)("p",{className:"text-orange-800",children:"Your mentor has reviewed your goal and is requesting changes. Please edit and resubmit."})]}),"approved"===(null===c||void 0===c?void 0:c.status)&&(0,Pt.jsxs)("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-md",children:[(0,Pt.jsxs)("h4",{className:"text-sm font-medium text-green-900 mb-2 flex items-center space-x-2",children:[(0,Pt.jsx)(qn,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Goal Approved"})]}),(0,Pt.jsx)("p",{className:"text-green-800",children:"Your mentor has approved your goal. You can now complete your reflection at the end of the day."})]})]}),"approved"===c.status&&(0,Pt.jsx)("div",{className:"mt-6",children:u?(0,Pt.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-green-900 mb-4 flex items-center space-x-2",children:[(0,Pt.jsx)(qn,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:"Reflection Completed"})]}),(0,Pt.jsx)("p",{className:"text-green-800 mb-2",children:u.reflection_answers.workedWell}),(0,Pt.jsxs)("div",{className:"mt-4 text-sm text-green-700 font-medium",children:["Achievement Level: ",u.achieved_percentage,"%"]})]}):(0,Pt.jsxs)("div",{className:"text-center py-8 bg-white rounded-lg shadow-sm",children:[(0,Pt.jsx)(pa,{className:"h-12 w-12 text-primary-600 mx-auto mb-4"}),(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Time to Reflect"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-4",children:"Your goal has been approved. Take a moment to reflect on your progress."}),(0,Pt.jsx)(Ul,{goal:c,studentId:(null===e||void 0===e?void 0:e.id)||"",onSubmitSuccess:se})]})})]})]})]})}),E&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-20 z-40 pointer-events-none","aria-hidden":!0}),(0,Pt.jsxs)("aside",{className:"fixed right-0 top-0 h-full bg-white z-50 shadow-2xl transform transition-transform duration-300 ease-in-out w-full sm:w-[400px] max-w-[90vw] pointer-events-auto ".concat(E?"translate-x-0":"translate-x-full"),role:"dialog","aria-modal":"true",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-purple-50 to-blue-50",children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-purple-700 flex items-center gap-2",children:[(0,Pt.jsx)("span",{className:"text-purple-600",children:"\ud83d\udca1"}),"SMART Feedback"]}),(0,Pt.jsx)("button",{onClick:()=>A(!1),className:"text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full w-8 h-8 flex items-center justify-center text-xl font-bold transition-colors","aria-label":"Close feedback panel",children:"\xd7"})]}),(0,Pt.jsxs)("div",{className:"p-4 overflow-y-auto h-[calc(100%-64px)]",children:[(0,Pt.jsxs)("div",{className:"mb-4 text-sm text-gray-700",children:[(0,Pt.jsx)("strong",{children:"SMART Hints"}),(0,Pt.jsxs)("ul",{className:"list-disc pl-5 mt-2 text-xs text-gray-600",children:[(0,Pt.jsxs)("li",{children:[(0,Pt.jsx)("strong",{children:"S"}),"pecific: Is your goal clear and well-defined?"]}),(0,Pt.jsxs)("li",{children:[(0,Pt.jsx)("strong",{children:"M"}),"easurable: Can you track progress or completion?"]}),(0,Pt.jsxs)("li",{children:[(0,Pt.jsx)("strong",{children:"A"}),"chievable: Is it realistic given your resources?"]}),(0,Pt.jsxs)("li",{children:[(0,Pt.jsx)("strong",{children:"R"}),"elevant: Does it align with your learning objectives?"]}),(0,Pt.jsxs)("li",{children:[(0,Pt.jsx)("strong",{children:"T"}),"ime-bound: Is there a clear deadline or timeframe?"]})]})]}),null!==L&&(0,Pt.jsxs)("div",{className:"mb-4 p-3 bg-purple-50 rounded-lg border border-purple-100",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Goal Perfection Level"}),(0,Pt.jsxs)("span",{className:"text-sm font-bold text-purple-600",children:[L,"%"]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-2",children:(0,Pt.jsx)("div",{className:"bg-gradient-to-r from-purple-500 to-blue-500 h-3 rounded-full transition-all duration-700 ease-out",style:{width:"".concat(L,"%")}})}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:L>=80?"\ud83c\udf1f Excellent goal!":L>=60?"\ud83d\udc4d Good foundation!":"\ud83d\udca1 Room for improvement"})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 border border-gray-100 rounded-lg p-4 text-gray-700 min-h-[200px]",children:[P&&(0,Pt.jsx)("div",{className:"text-red-600 font-medium",children:P}),!T&&!P&&C&&(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto mb-2"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Getting your personalized feedback..."})]}),R&&(0,Pt.jsx)("div",{className:"prose prose-sm text-gray-800 leading-relaxed",dangerouslySetInnerHTML:{__html:R}}),!R&&T&&!P&&(0,Pt.jsx)("div",{className:"text-sm text-gray-800 italic",children:T})]})]})]})]}),T&&!E&&(0,Pt.jsx)("div",{className:"fixed left-0 top-1/2 transform -translate-y-1/2 z-30",children:(0,Pt.jsxs)("button",{onClick:()=>A(!0),className:"bg-purple-600 hover:bg-purple-700 text-white px-3 py-4 rounded-r-lg shadow-lg transition-all duration-200 flex flex-col items-center justify-center gap-1 group",title:"View SMART Feedback",children:[(0,Pt.jsxs)("div",{className:"flex flex-col items-center gap-0",children:[(0,Pt.jsx)("span",{className:"text-xs font-medium whitespace-nowrap",children:"SMART"}),(0,Pt.jsx)("span",{className:"text-xs font-medium whitespace-nowrap",children:"Feedback"})]}),(0,Pt.jsx)("div",{className:"w-2 h-2 bg-white rounded-full opacity-70 group-hover:opacity-100 transition-opacity"})]})}),Y&&J&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,Pt.jsx)(Wl,{className:"h-8 w-8 text-yellow-500"}),(0,Pt.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Phase Locked"})]}),(0,Pt.jsxs)("p",{className:"text-gray-600 mb-4",children:[(0,Pt.jsx)("strong",{children:J.name})," is currently locked. You need approval from an admin or academic associate to access this phase."]}),(0,Pt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:(0,Pt.jsx)("p",{className:"text-sm text-blue-800",children:"This prevents accidentally filling goals for future phases before you're ready."})}),(0,Pt.jsxs)("div",{className:"flex gap-3",children:[(0,Pt.jsx)("button",{onClick:()=>$(!1),className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",disabled:f,children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{if(J&&K&&null!==e&&void 0!==e&&e.id)try{g(!0),await zl.requestPhaseApproval(e.id,K.id,J.id),$(!1),q("Approval request sent to admin/academic associate"),B(!0),await ee()}catch(v){console.error("Error requesting approval:",v),b("Failed to request approval")}finally{g(!1)}},className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400",disabled:f,children:f?"Requesting...":"Request Approval"})]})]})}),(0,Pt.jsx)(hr,{message:z,visible:U,onClose:()=>B(!1)})]})},Kl=()=>{const e=he();return(0,r.useEffect)(()=>{e("/goal-setting")},[e]),(0,Pt.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,Pt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:(0,Pt.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Pt.jsx)(Hn,{className:"h-6 w-6 text-yellow-600 mt-0.5"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-yellow-900 mb-2",children:"Redirecting..."}),(0,Pt.jsx)("p",{className:"text-sm text-yellow-700",children:"Reflection submission is now integrated with the Goal Setting page. You'll be redirected automatically."})]})]})})})},Ql=e=>{let{onUserSelect:t,currentUserId:n,campusFilter:a}=e;const[s,i]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{try{let e;l(!0),e=a&&"All"!==a?await _t.B.getWhere(_t.I.USERS,"campus","==",a):await _t.B.getAll(_t.I.USERS);const t=e.sort((e,t)=>(e.display_name||e.name||"").localeCompare(t.display_name||t.name||""));i(t)}catch(e){console.error("Error loading users:",e)}finally{l(!1)}})()},[a]),(0,Pt.jsx)("div",{className:"mb-4",children:(0,Pt.jsx)("select",{className:"block w-full px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onChange:e=>t(e.target.value),value:n,disabled:o,children:o?(0,Pt.jsx)("option",{children:"Loading users..."}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("option",{value:"",children:"Select a user"}),s.map(e=>(0,Pt.jsx)("option",{value:e.id,children:e.display_name||e.name||e.email||"Unnamed User"},e.id))]})})})},Yl=e=>{let{selectedCampus:t,onCampusSelect:n}=e;return(0,Pt.jsx)("div",{className:"mr-4",children:(0,Pt.jsx)("select",{className:"block w-full px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:t,onChange:e=>n(e.target.value),children:["All","Dantewada","Dharamshala","Eternal","Jashpur","Kishanganj","Pune","Raigarh","Sarjapura","Bageshree","Malhar","Bhairav"].map(e=>(0,Pt.jsx)("option",{value:e,children:"All"===e?"All Campuses":e},e))})})},$l=Un("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);function Jl(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=Jl(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Xl(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=Jl(e))&&(r&&(r+=" "),r+=t);return r}var Zl=n(7820),ec=n.n(Zl),tc=n(7770),nc=n.n(tc),rc=e=>0===e?0:e>0?1:-1,ac=e=>"number"==typeof e&&e!=+e,sc=e=>"string"===typeof e&&e.indexOf("%")===e.length-1,ic=e=>("number"===typeof e||e instanceof Number)&&!ac(e),oc=e=>ic(e)||"string"===typeof e,lc=0,cc=e=>{var t=++lc;return"".concat(e||"").concat(t)},dc=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!ic(e)&&"string"!==typeof e)return r;if(sc(e)){if(null==t)return r;var s=e.indexOf("%");n=t*parseFloat(e.slice(0,s))/100}else n=+e;return ac(n)&&(n=r),a&&null!=t&&n>t&&(n=t),n},uc=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++){if(n[e[r]])return!0;n[e[r]]=!0}return!1};function hc(e,t,n){return ic(e)&&ic(t)?e+n*(t-e):t}function mc(e,t,n){if(e&&e.length)return e.find(e=>e&&("function"===typeof t?t(e):nc()(e,t))===n)}var pc=e=>null===e||"undefined"===typeof e,fc=e=>pc(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),gc=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]};function yc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yc(Object(n),!0).forEach(function(t){vc(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yc(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vc(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bc=(0,r.forwardRef)((e,t)=>{var{aspect:n,initialDimension:a={width:-1,height:-1},width:s="100%",height:i="100%",minWidth:o=0,minHeight:l,maxHeight:c,children:d,debounce:u=0,id:h,className:m,onResize:p,style:f={}}=e,g=(0,r.useRef)(null),y=(0,r.useRef)();y.current=p,(0,r.useImperativeHandle)(t,()=>g.current);var[x,v]=(0,r.useState)({containerWidth:a.width,containerHeight:a.height}),b=(0,r.useCallback)((e,t)=>{v(n=>{var r=Math.round(e),a=Math.round(t);return n.containerWidth===r&&n.containerHeight===a?n:{containerWidth:r,containerHeight:a}})},[]);(0,r.useEffect)(()=>{var e=e=>{var t,{width:n,height:r}=e[0].contentRect;b(n,r),null===(t=y.current)||void 0===t||t.call(y,n,r)};u>0&&(e=ec()(e,u,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),{width:n,height:r}=g.current.getBoundingClientRect();return b(n,r),t.observe(g.current),()=>{t.disconnect()}},[b,u]);var w=(0,r.useMemo)(()=>{var{containerWidth:e,containerHeight:t}=x;if(e<0||t<0)return null;gc(sc(s)||sc(i),"The width(%s) and height(%s) are both fixed numbers,\n       maybe you don't need to use a ResponsiveContainer.",s,i),gc(!n||n>0,"The aspect(%s) must be greater than zero.",n);var a=sc(s)?e:s,u=sc(i)?t:i;return n&&n>0&&(a?u=a/n:u&&(a=u*n),c&&u>c&&(u=c)),gc(a>0||u>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",a,u,s,i,o,l,n),r.Children.map(d,e=>(0,r.cloneElement)(e,{width:a,height:u,style:xc({width:a,height:u},e.props.style)}))},[n,d,i,c,l,o,x,s]);return r.createElement("div",{id:h?"".concat(h):void 0,className:Xl("recharts-responsive-container",m),style:xc(xc({},f),{},{width:s,height:i,minWidth:o,minHeight:l,maxHeight:c}),ref:g},r.createElement("div",{style:{width:0,height:0,overflow:"visible"}},w))});function wc(e){return"Minified Redux error #".concat(e,"; visit https://redux.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}var jc=(()=>"function"===typeof Symbol&&Symbol.observable||"@@observable")(),Nc=()=>Math.random().toString(36).substring(7).split("").join("."),_c={INIT:"@@redux/INIT".concat(Nc()),REPLACE:"@@redux/REPLACE".concat(Nc()),PROBE_UNKNOWN_ACTION:()=>"@@redux/PROBE_UNKNOWN_ACTION".concat(Nc())};function Sc(e){if("object"!==typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function kc(e,t,n){if("function"!==typeof e)throw new Error(wc(2));if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(wc(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(wc(1));return n(kc)(e,t)}let r=e,a=t,s=new Map,i=s,o=0,l=!1;function c(){i===s&&(i=new Map,s.forEach((e,t)=>{i.set(t,e)}))}function d(){if(l)throw new Error(wc(3));return a}function u(e){if("function"!==typeof e)throw new Error(wc(4));if(l)throw new Error(wc(5));let t=!0;c();const n=o++;return i.set(n,e),function(){if(t){if(l)throw new Error(wc(6));t=!1,c(),i.delete(n),s=null}}}function h(e){if(!Sc(e))throw new Error(wc(7));if("undefined"===typeof e.type)throw new Error(wc(8));if("string"!==typeof e.type)throw new Error(wc(17));if(l)throw new Error(wc(9));try{l=!0,a=r(a,e)}finally{l=!1}return(s=i).forEach(e=>{e()}),e}h({type:_c.INIT});return{dispatch:h,subscribe:u,getState:d,replaceReducer:function(e){if("function"!==typeof e)throw new Error(wc(10));r=e,h({type:_c.REPLACE})},[jc]:function(){const e=u;return{subscribe(t){if("object"!==typeof t||null===t)throw new Error(wc(11));function n(){const e=t;e.next&&e.next(d())}n();return{unsubscribe:e(n)}},[jc](){return this}}}}}function Ec(e){const t=Object.keys(e),n={};for(let s=0;s<t.length;s++){const r=t[s];0,"function"===typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let a;try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if("undefined"===typeof n(void 0,{type:_c.INIT}))throw new Error(wc(12));if("undefined"===typeof n(void 0,{type:_c.PROBE_UNKNOWN_ACTION()}))throw new Error(wc(13))})}(n)}catch(BM){a=BM}return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(a)throw a;let s=!1;const i={};for(let a=0;a<r.length;a++){const o=r[a],l=n[o],c=e[o],d=l(c,t);if("undefined"===typeof d){t&&t.type;throw new Error(wc(14))}i[o]=d,s=s||d!==c}return s=s||r.length!==Object.keys(e).length,s?i:e}}function Ac(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce((e,t)=>function(){return e(t(...arguments))})}function Cc(e){return Sc(e)&&"type"in e&&"string"===typeof e.type}function Dc(e){return t=>{let{dispatch:n,getState:r}=t;return t=>a=>"function"===typeof a?a(n,r,e):t(a)}}var Tc=Dc(),Oc=Dc,Pc=Symbol.for("immer-nothing"),Ic=Symbol.for("immer-draftable"),Rc=Symbol.for("immer-state");function Mc(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var Lc=Object.getPrototypeOf;function Fc(e){return!!e&&!!e[Rc]}function Uc(e){var t;return!!e&&(zc(e)||Array.isArray(e)||!!e[Ic]||!(null===(t=e.constructor)||void 0===t||!t[Ic])||Gc(e)||Kc(e))}var Bc=Object.prototype.constructor.toString();function zc(e){if(!e||"object"!==typeof e)return!1;const t=Lc(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Bc}function qc(e,t){0===Vc(e)?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function Vc(e){const t=e[Rc];return t?t.type_:Array.isArray(e)?1:Gc(e)?2:Kc(e)?3:0}function Hc(e,t){return 2===Vc(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Wc(e,t,n){const r=Vc(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Gc(e){return e instanceof Map}function Kc(e){return e instanceof Set}function Qc(e){return e.copy_||e.base_}function Yc(e,t){if(Gc(e))return new Map(e);if(Kc(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=zc(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[Rc];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const a=n[r],s=t[a];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[a]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[a]})}return Object.create(Lc(e),t)}{const t=Lc(e);if(null!==t&&n)return(0,o.A)({},e);const r=Object.create(t);return Object.assign(r,e)}}function $c(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Xc(e)||Fc(e)||!Uc(e)||(Vc(e)>1&&Object.defineProperties(e,{set:{value:Jc},add:{value:Jc},clear:{value:Jc},delete:{value:Jc}}),Object.freeze(e),t&&Object.values(e).forEach(e=>$c(e,!0))),e}function Jc(){Mc(2)}function Xc(e){return Object.isFrozen(e)}var Zc,ed={};function td(e){const t=ed[e];return t||Mc(0),t}function nd(){return Zc}function rd(e,t){t&&(td("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ad(e){sd(e),e.drafts_.forEach(od),e.drafts_=null}function sd(e){e===Zc&&(Zc=e.parent_)}function id(e){return Zc={drafts_:[],parent_:Zc,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function od(e){const t=e[Rc];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function ld(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[Rc].modified_&&(ad(t),Mc(4)),Uc(e)&&(e=cd(t,e),t.parent_||ud(t,e)),t.patches_&&td("Patches").generateReplacementPatches_(n[Rc].base_,e,t.patches_,t.inversePatches_)):e=cd(t,n,[]),ad(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Pc?e:void 0}function cd(e,t,n){if(Xc(t))return t;const r=t[Rc];if(!r)return qc(t,(a,s)=>dd(e,r,t,a,s,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return ud(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let a=t,s=!1;3===r.type_&&(a=new Set(t),t.clear(),s=!0),qc(a,(a,i)=>dd(e,r,t,a,i,n,s)),ud(e,t,!1),n&&e.patches_&&td("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function dd(e,t,n,r,a,s,i){if(Fc(a)){const i=cd(e,a,s&&t&&3!==t.type_&&!Hc(t.assigned_,r)?s.concat(r):void 0);if(Wc(n,r,i),!Fc(i))return;e.canAutoFreeze_=!1}else i&&n.add(a);if(Uc(a)&&!Xc(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;cd(e,a),t&&t.scope_.parent_||"symbol"===typeof r||!(Gc(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||ud(e,a)}}function ud(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&$c(t,n)}var hd={get(e,t){if(t===Rc)return e;const n=Qc(e);if(!Hc(n,t))return function(e,t,n){var r;const a=fd(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!Uc(r)?r:r===pd(e.base_,t)?(yd(e),e.copy_[t]=xd(r,e)):r},has:(e,t)=>t in Qc(e),ownKeys:e=>Reflect.ownKeys(Qc(e)),set(e,t,n){const r=fd(Qc(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=pd(Qc(e),t),a=null===r||void 0===r?void 0:r[Rc];if(a&&a.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}(n,r)&&(void 0!==n||Hc(e.base_,t)))return!0;yd(e),gd(e)}return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==pd(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,yd(e),gd(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=Qc(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){Mc(11)},getPrototypeOf:e=>Lc(e.base_),setPrototypeOf(){Mc(12)}},md={};function pd(e,t){const n=e[Rc];return(n?Qc(n):e)[t]}function fd(e,t){if(!(t in e))return;let n=Lc(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Lc(n)}}function gd(e){e.modified_||(e.modified_=!0,e.parent_&&gd(e.parent_))}function yd(e){e.copy_||(e.copy_=Yc(e.base_,e.scope_.immer_.useStrictShallowCopy_))}qc(hd,(e,t)=>{md[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),md.deleteProperty=function(e,t){return md.set.call(this,e,t,void 0)},md.set=function(e,t,n){return hd.set.call(this,e[0],t,n,e[0])};function xd(e,t){const n=Gc(e)?td("MapSet").proxyMap_(e,t):Kc(e)?td("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:nd(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,s=hd;n&&(a=[r],s=md);const{revoke:i,proxy:o}=Proxy.revocable(a,s);return r.draft_=o,r.revoke_=i,o}(e,t);return(t?t.scope_:nd()).drafts_.push(n),n}function vd(e){return Fc(e)||Mc(10),bd(e)}function bd(e){if(!Uc(e)||Xc(e))return e;const t=e[Rc];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Yc(e,t.scope_.immer_.useStrictShallowCopy_)}else n=Yc(e,!0);return qc(n,(e,t)=>{Wc(n,e,bd(t))}),t&&(t.finalized_=!1),n}var wd=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];return r.produce(e,e=>t.call(this,e,...s))}}let r;if("function"!==typeof t&&Mc(6),void 0!==n&&"function"!==typeof n&&Mc(7),Uc(e)){const a=id(this),s=xd(e,void 0);let i=!0;try{r=t(s),i=!1}finally{i?ad(a):sd(a)}return rd(a,n),ld(r,a)}if(!e||"object"!==typeof e){if(r=t(e),void 0===r&&(r=e),r===Pc&&(r=void 0),this.autoFreeze_&&$c(r,!0),n){const t=[],a=[];td("Patches").generateReplacementPatches_(e,r,t,a),n(t,a)}return r}Mc(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return t.produceWithPatches(n,t=>e(t,...a))};let r,a;return[this.produce(e,n,(e,t)=>{r=e,a=t}),r,a]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Uc(e)||Mc(8),Fc(e)&&(e=vd(e));const t=id(this),n=xd(e,void 0);return n[Rc].isManual_=!0,sd(t),n}finishDraft(e,t){const n=e&&e[Rc];n&&n.isManual_||Mc(9);const{scope_:r}=n;return rd(r,t),ld(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=td("Patches").applyPatches_;return Fc(e)?r(e,t):this.produce(e,e=>r(e,t))}},jd=wd.produce;const Nd=["reducerPath"];var _d="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?Ac:Ac.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function Sd(e,t){function n(){if(t){let n=t(...arguments);if(!n)throw new Error(vu(0));return(0,o.A)((0,o.A)({type:e,payload:n.payload},"meta"in n&&{meta:n.meta}),"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=()=>"".concat(e),n.type=e,n.match=t=>Cc(t)&&t.type===e,n}var kd=class e extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return super.concat.apply(this,t)}prepend(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return 1===n.length&&Array.isArray(n[0])?new e(...n[0].concat(this)):new e(...n.concat(this))}};function Ed(e){return Uc(e)?jd(e,()=>{}):e}function Ad(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var Cd="RTK_autoBatch",Dd=e=>t=>{setTimeout(t,e)},Td=e=>function(t){const{autoBatch:n=!0}=null!==t&&void 0!==t?t:{};let r=new kd(e);return n&&r.push(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"raf"};return t=>function(){const n=t(...arguments);let r=!0,a=!1,s=!1;const i=new Set,o="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:Dd(10):"callback"===e.type?e.queueNotification:Dd(e.timeout),l=()=>{s=!1,a&&(a=!1,i.forEach(e=>e()))};return Object.assign({},n,{subscribe(e){const t=n.subscribe(()=>r&&e());return i.add(e),()=>{t(),i.delete(e)}},dispatch(e){try{var t;return r=!(null!==e&&void 0!==e&&null!==(t=e.meta)&&void 0!==t&&t[Cd]),a=!r,a&&(s||(s=!0,o(l))),n.dispatch(e)}finally{r=!0}}})}}("object"===typeof n?n:void 0)),r};function Od(e){const t=function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:a=!0}=null!==e&&void 0!==e?e:{};let s=new kd;return t&&(function(e){return"boolean"===typeof e}(t)?s.push(Tc):s.push(Oc(t.extraArgument))),s},{reducer:n,middleware:r,devTools:a=!0,duplicateMiddlewareCheck:s=!0,preloadedState:i,enhancers:l}=e||{};let c,d;if("function"===typeof n)c=n;else{if(!Sc(n))throw new Error(vu(1));c=Ec(n)}d="function"===typeof r?r(t):t();let u=Ac;a&&(u=_d((0,o.A)({trace:!1},"object"===typeof a&&a)));const h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>(n,r)=>{const a=e(n,r);let s=()=>{throw new Error(wc(15))};const i={getState:a.getState,dispatch:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s(e,...n)}},l=t.map(e=>e(i));return s=Ac(...l)(a.dispatch),(0,o.A)((0,o.A)({},a),{},{dispatch:s})}}(...d),m=Td(h);return kc(c,i,u(..."function"===typeof l?l(m):m()))}function Pd(e){const t={},n=[];let r;const a={addCase(e,n){const r="string"===typeof e?e:e.type;if(!r)throw new Error(vu(28));if(r in t)throw new Error(vu(29));return t[r]=n,a},addAsyncThunk:(e,r)=>(r.pending&&(t[e.pending.type]=r.pending),r.rejected&&(t[e.rejected.type]=r.rejected),r.fulfilled&&(t[e.fulfilled.type]=r.fulfilled),r.settled&&n.push({matcher:e.settled,reducer:r.settled}),a),addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),a),addDefaultCase:e=>(r=e,a)};return e(a),[t,n,r]}var Id=function(){let e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;t--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e};var Rd=Symbol.for("rtk-slice-createasyncthunk");function Md(e,t){return"".concat(e,"/").concat(t)}function Ld(){var e;let{creators:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=null===t||void 0===t||null===(e=t.asyncThunk)||void 0===e?void 0:e[Rd];return function(e){const{name:t,reducerPath:r=t}=e;if(!t)throw new Error(vu(11));const a=("function"===typeof e.reducers?e.reducers(function(){function e(e,t){return(0,o.A)({_reducerDefinitionType:"asyncThunk",payloadCreator:e},t)}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name](){return e(...arguments)}}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},s=Object.keys(a),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(e,t){const n="string"===typeof e?e:e.type;if(!n)throw new Error(vu(12));if(n in l.sliceCaseReducersByType)throw new Error(vu(13));return l.sliceCaseReducersByType[n]=t,c},addMatcher:(e,t)=>(l.sliceMatchers.push({matcher:e,reducer:t}),c),exposeAction:(e,t)=>(l.actionCreators[e]=t,c),exposeCaseReducer:(e,t)=>(l.sliceCaseReducersByName[e]=t,c)};function d(){const[t={},n=[],r]="function"===typeof e.extraReducers?Pd(e.extraReducers):[e.extraReducers],a=(0,o.A)((0,o.A)({},t),l.sliceCaseReducersByType);return function(e,t){let n,[r,a,s]=Pd(t);if(function(e){return"function"===typeof e}(e))n=()=>Ed(e());else{const t=Ed(e);n=()=>t}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(),t=arguments.length>1?arguments[1]:void 0,i=[r[t.type],...a.filter(e=>{let{matcher:n}=e;return n(t)}).map(e=>{let{reducer:t}=e;return t})];return 0===i.filter(e=>!!e).length&&(i=[s]),i.reduce((e,n)=>{if(n){if(Fc(e)){const r=n(e,t);return void 0===r?e:r}if(Uc(e))return jd(e,e=>n(e,t));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}}return e},e)}return i.getInitialState=n,i}(e.initialState,e=>{for(let t in a)e.addCase(t,a[t]);for(let t of l.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)})}s.forEach(r=>{const s=a[r],i={reducerName:r,type:Md(t,r),createNotation:"function"===typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(s)?function(e,t,n){let r,a,{type:s,reducerName:i,createNotation:o}=e;if("reducer"in t){if(o&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(t))throw new Error(vu(17));r=t.reducer,a=t.prepare}else r=t;n.addCase(s,r).exposeCaseReducer(i,r).exposeAction(i,a?Sd(s,a):Sd(s))}(i,s,c):function(e,t,n,r){let{type:a,reducerName:s}=e;if(!r)throw new Error(vu(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:d,options:u}=t,h=r(a,i,u);n.exposeAction(s,h),o&&n.addCase(h.fulfilled,o);l&&n.addCase(h.pending,l);c&&n.addCase(h.rejected,c);d&&n.addMatcher(h.settled,d);n.exposeCaseReducer(s,{fulfilled:o||Bd,pending:l||Bd,rejected:c||Bd,settled:d||Bd})}(i,s,c,n)});const u=e=>e,h=new Map,m=new WeakMap;let p;function f(e,t){return p||(p=d()),p(e,t)}function g(){return p||(p=d()),p.getInitialState()}function y(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function r(e){let a=e[t];return"undefined"===typeof a&&n&&(a=Ad(m,r,g)),a}function a(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;const r=Ad(h,n,()=>new WeakMap);return Ad(r,t,()=>{const r={};for(const[s,i]of Object.entries(null!==(a=e.selectors)&&void 0!==a?a:{})){var a;r[s]=Fd(i,t,()=>Ad(m,t,g),n)}return r})}return{reducerPath:t,getSelectors:a,get selectors(){return a(r)},selectSlice:r}}const x=(0,o.A)((0,o.A)({name:t,reducer:f,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:g},y(r)),{},{injectInto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reducerPath:n}=t,a=(0,i.A)(t,Nd);const s=null!==n&&void 0!==n?n:r;return e.inject({reducerPath:s,reducer:f},a),(0,o.A)((0,o.A)({},x),y(s,!0))}});return x}}function Fd(e,t,n,r){function a(a){let s=t(a);"undefined"===typeof s&&r&&(s=n());for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return e(s,...o)}return a.unwrapped=e,a}var Ud=Ld();function Bd(){}var zd="listener",qd="completed",Vd="cancelled",Hd="task-".concat(Vd),Wd="task-".concat(qd),Gd="".concat(zd,"-").concat(Vd),Kd="".concat(zd,"-").concat(qd),Qd=class{constructor(e){(0,va.A)(this,"name","TaskAbortError"),(0,va.A)(this,"message",void 0),this.code=e,this.message="".concat("task"," ").concat(Vd," (reason: ").concat(e,")")}},Yd=(e,t)=>{if("function"!==typeof e)throw new TypeError(vu(32))},$d=()=>{},Jd=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$d;return e.catch(t),e},Xd=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Zd=(e,t)=>{const n=e.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},eu=e=>{if(e.aborted){const{reason:t}=e;throw new Qd(t)}};function tu(e,t){let n=$d;return new Promise((r,a)=>{const s=()=>a(new Qd(e.reason));e.aborted?s():(n=Xd(e,s),t.finally(()=>n()).then(r,a))}).finally(()=>{n=$d})}var nu=e=>t=>Jd(tu(e,t).then(t=>(eu(e),t))),ru=e=>{const t=nu(e);return e=>t(new Promise(t=>setTimeout(t,e)))},{assign:au}=Object,su={},iu="listenerMiddleware",ou=(e,t)=>(n,r)=>{Yd(n);const a=new AbortController;var s;s=a,Xd(e,()=>Zd(s,e.reason));const i=(async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof Qd?"cancelled":"rejected",error:n}}finally{null===t||void 0===t||t()}})(async()=>{eu(e),eu(a.signal);const t=await n({pause:nu(a.signal),delay:ru(a.signal),signal:a.signal});return eu(a.signal),t},()=>Zd(a,Wd));return null!==r&&void 0!==r&&r.autoJoin&&t.push(i.catch($d)),{result:nu(e)(i),cancel(){Zd(a,Hd)}}},lu=(e,t)=>(n,r)=>Jd((async(n,r)=>{eu(t);let a=()=>{};const s=[new Promise((t,r)=>{let s=e({predicate:n,effect:(e,n)=>{n.unsubscribe(),t([e,n.getState(),n.getOriginalState()])}});a=()=>{s(),r()}})];null!=r&&s.push(new Promise(e=>setTimeout(e,r,null)));try{const e=await tu(t,Promise.race(s));return eu(t),e}finally{a()}})(n,r)),cu=e=>{let{type:t,actionCreator:n,matcher:r,predicate:a,effect:s}=e;if(t)a=Sd(t).match;else if(n)t=n.type,a=n.match;else if(r)a=r;else if(!a)throw new Error(vu(21));return Yd(s),{predicate:a,type:t,effect:s}},du=au(e=>{const{type:t,predicate:n,effect:r}=cu(e);return{id:Id(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(vu(22))}}},{withTypes:()=>du}),uu=(e,t)=>{const{type:n,effect:r,predicate:a}=cu(t);return Array.from(e.values()).find(e=>("string"===typeof n?e.type===n:e.predicate===a)&&e.effect===r)},hu=e=>{e.pending.forEach(e=>{Zd(e,Gd)})},mu=(e,t,n)=>{try{e(t,n)}catch(r){setTimeout(()=>{throw r},0)}},pu=au(Sd("".concat(iu,"/add")),{withTypes:()=>pu}),fu=Sd("".concat(iu,"/removeAll")),gu=au(Sd("".concat(iu,"/remove")),{withTypes:()=>gu}),yu=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.error("".concat(iu,"/error"),...t)},xu=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map,{extra:n,onError:r=yu}=e;Yd(r);const a=e=>{var n;return(e=>(e.unsubscribe=()=>t.delete(e.id),t.set(e.id,e),t=>{e.unsubscribe(),null!==t&&void 0!==t&&t.cancelActive&&hu(e)}))(null!==(n=uu(t,e))&&void 0!==n?n:du(e))};au(a,{withTypes:()=>a});const s=e=>{const n=uu(t,e);return n&&(n.unsubscribe(),e.cancelActive&&hu(n)),!!n};au(s,{withTypes:()=>s});const i=async(e,s,i,o)=>{const l=new AbortController,c=lu(a,l.signal),d=[];try{e.pending.add(l),await Promise.resolve(e.effect(s,au({},i,{getOriginalState:o,condition:(e,t)=>c(e,t).then(Boolean),take:c,delay:ru(l.signal),pause:nu(l.signal),extra:n,signal:l.signal,fork:ou(l.signal,d),unsubscribe:e.unsubscribe,subscribe:()=>{t.set(e.id,e)},cancelActiveListeners:()=>{e.pending.forEach((e,t,n)=>{e!==l&&(Zd(e,Gd),n.delete(e))})},cancel:()=>{Zd(l,Gd),e.pending.delete(l)},throwIfCancelled:()=>{eu(l.signal)}})))}catch(u){u instanceof Qd||mu(r,u,{raisedBy:"effect"})}finally{await Promise.all(d),Zd(l,Kd),e.pending.delete(l)}},o=(e=>()=>{e.forEach(hu),e.clear()})(t);return{middleware:e=>n=>l=>{if(!Cc(l))return n(l);if(pu.match(l))return a(l.payload);if(fu.match(l))return void o();if(gu.match(l))return s(l.payload);let c=e.getState();const d=()=>{if(c===su)throw new Error(vu(23));return c};let u;try{if(u=n(l),t.size>0){const n=e.getState(),a=Array.from(t.values());for(const t of a){let a=!1;try{a=t.predicate(l,n,c)}catch(h){a=!1,mu(r,h,{raisedBy:"predicate"})}a&&i(t,l,e,d)}}}finally{c=su}return u},startListening:a,stopListening:s,clearListeners:o}};Symbol.for("rtk-state-proxy-original");function vu(e){return"Minified Redux Toolkit error #".concat(e,"; visit https://redux-toolkit.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}function bu(e,t){if(t){var n=Number.parseInt(t,10);if(!ac(n))return null===e||void 0===e?void 0:e[n]}}var wu=Ud({name:"options",initialState:{chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},reducers:{createEventEmitter:e=>{null==e.eventEmitter&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),ju=wu.reducer,{createEventEmitter:Nu}=wu.actions;n(7237);function _u(e){e()}var Su={notify(){},get:()=>[]};function ku(e,t){let n,r=Su,a=0,s=!1;function i(){c.onStateChange&&c.onStateChange()}function o(){a++,n||(n=t?t.addNestedSub(i):e.subscribe(i),r=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){_u(()=>{let t=e;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0;const a=t={callback:n,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){r&&null!==e&&(r=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}())}function l(){a--,n&&0===a&&(n(),n=void 0,r.clear(),r=Su)}const c={addNestedSub:function(e){o();const t=r.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),l())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:i,isSubscribed:function(){return s},trySubscribe:function(){s||(s=!0,o())},tryUnsubscribe:function(){s&&(s=!1,l())},getListeners:()=>r};return c}var Eu=(()=>!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement))(),Au=(()=>"undefined"!==typeof navigator&&"ReactNative"===navigator.product)(),Cu=(()=>Eu||Au?r.useLayoutEffect:r.useEffect)();Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var Du=Symbol.for("react-redux-context"),Tu="undefined"!==typeof globalThis?globalThis:{};function Ou(){var e;if(!r.createContext)return{};const t=null!==(e=Tu[Du])&&void 0!==e?e:Tu[Du]=new Map;let n=t.get(r.createContext);return n||(n=r.createContext(null),t.set(r.createContext,n)),n}var Pu=Ou();var Iu=function(e){const{children:t,context:n,serverState:a,store:s}=e,i=r.useMemo(()=>{const e=ku(s);return{store:s,subscription:e,getServerState:a?()=>a:void 0}},[s,a]),o=r.useMemo(()=>s.getState(),[s]);Cu(()=>{const{subscription:e}=i;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),o!==s.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[i,o]);const l=n||Pu;return r.createElement(l.Provider,{value:i},t)};var Ru=Symbol.for("immer-nothing"),Mu=Symbol.for("immer-draftable"),Lu=Symbol.for("immer-state");function Fu(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var Uu=Object.getPrototypeOf;function Bu(e){return!!e&&!!e[Lu]}function zu(e){var t;return!!e&&(Vu(e)||Array.isArray(e)||!!e[Mu]||!(null===(t=e.constructor)||void 0===t||!t[Mu])||Qu(e)||Yu(e))}var qu=Object.prototype.constructor.toString();function Vu(e){if(!e||"object"!==typeof e)return!1;const t=Uu(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===qu}function Hu(e,t){0===Wu(e)?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function Wu(e){const t=e[Lu];return t?t.type_:Array.isArray(e)?1:Qu(e)?2:Yu(e)?3:0}function Gu(e,t){return 2===Wu(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ku(e,t,n){const r=Wu(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Qu(e){return e instanceof Map}function Yu(e){return e instanceof Set}function $u(e){return e.copy_||e.base_}function Ju(e,t){if(Qu(e))return new Map(e);if(Yu(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Vu(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[Lu];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const a=n[r],s=t[a];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[a]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[a]})}return Object.create(Uu(e),t)}{const t=Uu(e);if(null!==t&&n)return(0,o.A)({},e);const r=Object.create(t);return Object.assign(r,e)}}function Xu(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return eh(e)||Bu(e)||!zu(e)||(Wu(e)>1&&Object.defineProperties(e,{set:{value:Zu},add:{value:Zu},clear:{value:Zu},delete:{value:Zu}}),Object.freeze(e),t&&Object.values(e).forEach(e=>Xu(e,!0))),e}function Zu(){Fu(2)}function eh(e){return Object.isFrozen(e)}var th,nh={};function rh(e){const t=nh[e];return t||Fu(0),t}function ah(){return th}function sh(e,t){t&&(rh("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ih(e){oh(e),e.drafts_.forEach(ch),e.drafts_=null}function oh(e){e===th&&(th=e.parent_)}function lh(e){return th={drafts_:[],parent_:th,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ch(e){const t=e[Lu];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function dh(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[Lu].modified_&&(ih(t),Fu(4)),zu(e)&&(e=uh(t,e),t.parent_||mh(t,e)),t.patches_&&rh("Patches").generateReplacementPatches_(n[Lu].base_,e,t.patches_,t.inversePatches_)):e=uh(t,n,[]),ih(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Ru?e:void 0}function uh(e,t,n){if(eh(t))return t;const r=t[Lu];if(!r)return Hu(t,(a,s)=>hh(e,r,t,a,s,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return mh(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let a=t,s=!1;3===r.type_&&(a=new Set(t),t.clear(),s=!0),Hu(a,(a,i)=>hh(e,r,t,a,i,n,s)),mh(e,t,!1),n&&e.patches_&&rh("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function hh(e,t,n,r,a,s,i){if(Bu(a)){const i=uh(e,a,s&&t&&3!==t.type_&&!Gu(t.assigned_,r)?s.concat(r):void 0);if(Ku(n,r,i),!Bu(i))return;e.canAutoFreeze_=!1}else i&&n.add(a);if(zu(a)&&!eh(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;uh(e,a),t&&t.scope_.parent_||"symbol"===typeof r||!(Qu(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||mh(e,a)}}function mh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Xu(t,n)}var ph={get(e,t){if(t===Lu)return e;const n=$u(e);if(!Gu(n,t))return function(e,t,n){var r;const a=yh(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!zu(r)?r:r===gh(e.base_,t)?(vh(e),e.copy_[t]=bh(r,e)):r},has:(e,t)=>t in $u(e),ownKeys:e=>Reflect.ownKeys($u(e)),set(e,t,n){const r=yh($u(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=gh($u(e),t),a=null===r||void 0===r?void 0:r[Lu];if(a&&a.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}(n,r)&&(void 0!==n||Gu(e.base_,t)))return!0;vh(e),xh(e)}return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==gh(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,vh(e),xh(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=$u(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){Fu(11)},getPrototypeOf:e=>Uu(e.base_),setPrototypeOf(){Fu(12)}},fh={};function gh(e,t){const n=e[Lu];return(n?$u(n):e)[t]}function yh(e,t){if(!(t in e))return;let n=Uu(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Uu(n)}}function xh(e){e.modified_||(e.modified_=!0,e.parent_&&xh(e.parent_))}function vh(e){e.copy_||(e.copy_=Ju(e.base_,e.scope_.immer_.useStrictShallowCopy_))}Hu(ph,(e,t)=>{fh[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),fh.deleteProperty=function(e,t){return fh.set.call(this,e,t,void 0)},fh.set=function(e,t,n){return ph.set.call(this,e[0],t,n,e[0])};function bh(e,t){const n=Qu(e)?rh("MapSet").proxyMap_(e,t):Yu(e)?rh("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:ah(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,s=ph;n&&(a=[r],s=fh);const{revoke:i,proxy:o}=Proxy.revocable(a,s);return r.draft_=o,r.revoke_=i,o}(e,t);return(t?t.scope_:ah()).drafts_.push(n),n}function wh(e){if(!zu(e)||eh(e))return e;const t=e[Lu];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Ju(e,t.scope_.immer_.useStrictShallowCopy_)}else n=Ju(e,!0);return Hu(n,(e,t)=>{Ku(n,e,wh(t))}),t&&(t.finalized_=!1),n}var jh=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var a=arguments.length,s=new Array(a>1?a-1:0),i=1;i<a;i++)s[i-1]=arguments[i];return r.produce(e,e=>t.call(this,e,...s))}}let r;if("function"!==typeof t&&Fu(6),void 0!==n&&"function"!==typeof n&&Fu(7),zu(e)){const a=lh(this),s=bh(e,void 0);let i=!0;try{r=t(s),i=!1}finally{i?ih(a):oh(a)}return sh(a,n),dh(r,a)}if(!e||"object"!==typeof e){if(r=t(e),void 0===r&&(r=e),r===Ru&&(r=void 0),this.autoFreeze_&&Xu(r,!0),n){const t=[],a=[];rh("Patches").generateReplacementPatches_(e,r,t,a),n(t,a)}return r}Fu(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return t.produceWithPatches(n,t=>e(t,...a))};let r,a;return[this.produce(e,n,(e,t)=>{r=e,a=t}),r,a]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){zu(e)||Fu(8),Bu(e)&&(e=function(e){Bu(e)||Fu(10);return wh(e)}(e));const t=lh(this),n=bh(e,void 0);return n[Lu].isManual_=!0,oh(t),n}finishDraft(e,t){const n=e&&e[Lu];n&&n.isManual_||Fu(9);const{scope_:r}=n;return sh(r,t),dh(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=rh("Patches").applyPatches_;return Bu(e)?r(e,t):this.produce(e,e=>r(e,t))}};jh.produce;var Nh={active:!1,index:null,dataKey:void 0,coordinate:void 0},_h=Ud({name:"tooltip",initialState:{itemInteraction:{click:Nh,hover:Nh},axisInteraction:{click:Nh,hover:Nh},keyboardInteraction:Nh,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var n=vd(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:Sh,removeTooltipEntrySettings:kh,setTooltipSettingsState:Eh,setActiveMouseOverItemIndex:Ah,mouseLeaveItem:Ch,mouseLeaveChart:Dh,setActiveClickItemIndex:Th,setMouseOverAxisIndex:Oh,setMouseClickAxisIndex:Ph,setSyncInteraction:Ih,setKeyboardInteraction:Rh}=_h.actions,Mh=_h.reducer,Lh=Ud({name:"chartData",initialState:{chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},reducers:{setChartData(e,t){if(e.chartData=t.payload,null==t.payload)return e.dataStartIndex=0,void(e.dataEndIndex=0);t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:r}=t.payload;null!=n&&(e.dataStartIndex=n),null!=r&&(e.dataEndIndex=r)}}}),{setChartData:Fh,setDataStartEndIndexes:Uh,setComputedData:Bh}=Lh.actions,zh=Lh.reducer,qh=Ud({name:"chartLayout",initialState:{layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,r,a,s;e.margin.top=null!==(n=t.payload.top)&&void 0!==n?n:0,e.margin.right=null!==(r=t.payload.right)&&void 0!==r?r:0,e.margin.bottom=null!==(a=t.payload.bottom)&&void 0!==a?a:0,e.margin.left=null!==(s=t.payload.left)&&void 0!==s?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Vh,setLayout:Hh,setChartSize:Wh,setScale:Gh}=qh.actions,Kh=qh.reducer;function Qh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected a function, instead received ".concat(typeof e);if("function"!==typeof e)throw new TypeError(t)}var Yh=e=>Array.isArray(e)?e:[e];function $h(e){const t=Array.isArray(e[0])?e[0]:e;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected all items to be functions, instead received the following types: ";if(!e.every(e=>"function"===typeof e)){const n=e.map(e=>"function"===typeof e?"function ".concat(e.name||"unnamed","()"):typeof e).join(", ");throw new TypeError("".concat(t,"[").concat(n,"]"))}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var Jh="undefined"!==typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function Xh(){return{s:0,v:void 0,o:null,p:null}}function Zh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let a,s=0;function i(){let t=n;const{length:i}=arguments;for(let e=0,n=i;e<n;e++){const n=arguments[e];if("function"===typeof n||"object"===typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=Xh(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=Xh(),e.set(n,t)):t=r}}const o=t;let l;if(1===t.s)l=t.v;else if(l=e.apply(null,arguments),s++,r){var c,d,u;const e=null!==(c=null===(d=a)||void 0===d||null===(u=d.deref)||void 0===u?void 0:u.call(d))&&void 0!==c?c:a;null!=e&&r(e,l)&&(l=e,0!==s&&s--);a="object"===typeof l&&null!==l||"function"===typeof l?new Jh(l):l}return o.s=1,o.v=l,l}return i.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},i.resetResultsCount()},i.resultsCount=()=>s,i.resetResultsCount=()=>{s=0},i}function em(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a="function"===typeof e?{memoize:e,memoizeOptions:n}:e,s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r,s=0,i=0,l={},c=t.pop();"object"===typeof c&&(l=c,c=t.pop()),Qh(c,"createSelector expects an output function after the inputs, but received: [".concat(typeof c,"]"));const d=(0,o.A)((0,o.A)({},a),l),{memoize:u,memoizeOptions:h=[],argsMemoize:m=Zh,argsMemoizeOptions:p=[],devModeChecks:f={}}=d,g=Yh(h),y=Yh(p),x=$h(t),v=u(function(){return s++,c.apply(null,arguments)},...g);const b=m(function(){i++;const e=function(e,t){const n=[],{length:r}=e;for(let a=0;a<r;a++)n.push(e[a].apply(null,t));return n}(x,arguments);return r=v.apply(null,e),r},...y);return Object.assign(b,{resultFunc:c,memoizedResultFunc:v,dependencies:x,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>r,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:u,argsMemoize:m})};return Object.assign(s,{withTypes:()=>s}),s}var tm=em(Zh),nm=Object.assign(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tm;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected an object, instead received ".concat(typeof e);if("object"!==typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ".concat(typeof e));const n=Object.keys(e),r=t(n.map(t=>e[t]),function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((e,t,r)=>(e[n[r]]=t,e),{})});return r},{withTypes:()=>nm}),rm=n(8443),am=(0,r.createContext)(null),sm=e=>e,im=()=>{var e=(0,r.useContext)(am);return e?e.store.dispatch:sm},om=()=>{},lm=()=>om,cm=(e,t)=>e===t;function dm(e){var t=(0,r.useContext)(am);return(0,rm.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:lm,t?t.store.getState:om,t?t.store.getState:om,t?e:om,cm)}var um=n(3821),hm=n.n(um),mm=e=>e.legend.settings,pm=tm([e=>e.legend.payload,mm],(e,t)=>{var{itemSorter:n}=t,r=e.flat(1);return n?hm()(r,n):r});function fm(e,t){if((a=e.length)>1)for(var n,r,a,s=1,i=e[t[0]],o=i.length;s<a;++s)for(r=i,i=e[t[s]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}Array.prototype.slice;function gm(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function ym(e){return function(){return e}}function xm(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function vm(e,t){return e[t]}function bm(e){const t=[];return t.key=e,t}function wm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function jm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wm(Object(n),!0).forEach(function(t){Nm(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wm(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Nm(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _m=Math.PI/180,Sm=e=>180*e/Math.PI,km=(e,t,n,r)=>({x:e+Math.cos(-_m*r)*n,y:t+Math.sin(-_m*r)*n}),Em=(e,t)=>{var{x:n,y:r}=e,{cx:a,cy:s}=t,i=((e,t)=>{var{x:n,y:r}=e,{x:a,y:s}=t;return Math.sqrt((n-a)**2+(r-s)**2)})({x:n,y:r},{x:a,y:s});if(i<=0)return{radius:i,angle:0};var o=(n-a)/i,l=Math.acos(o);return r>s&&(l=2*Math.PI-l),{radius:i,angle:Sm(l),angleInRadian:l}},Am=(e,t)=>{var{startAngle:n,endAngle:r}=t,a=Math.floor(n/360),s=Math.floor(r/360);return e+360*Math.min(a,s)},Cm=(e,t)=>{var{x:n,y:r}=e,{radius:a,angle:s}=Em({x:n,y:r},t),{innerRadius:i,outerRadius:o}=t;if(a<i||a>o)return null;if(0===a)return null;var l,{startAngle:c,endAngle:d}=(e=>{var{startAngle:t,endAngle:n}=e,r=Math.floor(t/360),a=Math.floor(n/360),s=Math.min(r,a);return{startAngle:t-360*s,endAngle:n-360*s}})(t),u=s;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;l=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;l=u>=d&&u<=c}return l?jm(jm({},t),{},{radius:a,angle:Am(u,t)}):null};function Dm(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function Tm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Om(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tm(Object(n),!0).forEach(function(t){Pm(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tm(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Pm(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Im(e,t,n){return pc(e)||pc(t)?n:oc(t)?nc()(e,t,n):"function"===typeof t?t(e):n}var Rm=(e,t)=>"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t,Mm=(e,t,n,r)=>{if(r)return e.map(e=>e.coordinate);var a,s,i=e.map(e=>(e.coordinate===t&&(a=!0),e.coordinate===n&&(s=!0),e.coordinate));return a||i.push(t),s||i.push(n),i},Lm=(e,t,n)=>{if(!e)return null;var{duplicateDomain:r,type:a,range:s,scale:i,realScaleType:o,isCategorical:l,categoricalDomain:c,tickCount:d,ticks:u,niceTicks:h,axisType:m}=e;if(!i)return null;var p="scaleBand"===o&&i.bandwidth?i.bandwidth()/2:2,f=(t||n)&&"category"===a&&i.bandwidth?i.bandwidth()/p:0;return f="angleAxis"===m&&s&&s.length>=2?2*rc(s[0]-s[1])*f:f,t&&(u||h)?(u||h||[]).map((e,t)=>{var n=r?r.indexOf(e):e;return{coordinate:i(n)+f,value:e,offset:f,index:t}}).filter(e=>!ac(e.coordinate)):l&&c?c.map((e,t)=>({coordinate:i(e)+f,value:e,index:t,offset:f})):i.ticks&&!n&&null!=d?i.ticks(d).map((e,t)=>({coordinate:i(e)+f,value:e,offset:f,index:t})):i.domain().map((e,t)=>({coordinate:i(e)+f,value:r?r[e]:e,index:t,offset:f}))},Fm=1e-4,Um={sign:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,s=0,i=0;i<t;++i){var o=ac(e[i][n][1])?e[i][n][0]:e[i][n][1];o>=0?(e[i][n][0]=a,e[i][n][1]=a+o,a=e[i][n][1]):(e[i][n][0]=s,e[i][n][1]=s+o,s=e[i][n][1])}},expand:function(e,t){if((r=e.length)>0){for(var n,r,a,s=0,i=e[0].length;s<i;++s){for(a=n=0;n<r;++n)a+=e[n][s][1]||0;if(a)for(n=0;n<r;++n)e[n][s][1]/=a}fm(e,t)}},none:fm,silhouette:function(e,t){if((n=e.length)>0){for(var n,r=0,a=e[t[0]],s=a.length;r<s;++r){for(var i=0,o=0;i<n;++i)o+=e[i][r][1]||0;a[r][1]+=a[r][0]=-o/2}fm(e,t)}},wiggle:function(e,t){if((a=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,a,s=0,i=1;i<r;++i){for(var o=0,l=0,c=0;o<a;++o){for(var d=e[t[o]],u=d[i][1]||0,h=(u-(d[i-1][1]||0))/2,m=0;m<o;++m){var p=e[t[m]];h+=(p[i][1]||0)-(p[i-1][1]||0)}l+=u,c+=h*u}n[i-1][1]+=n[i-1][0]=s,l&&(s-=c/l)}n[i-1][1]+=n[i-1][0]=s,fm(e,t)}},positive:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,s=0;s<t;++s){var i=ac(e[s][n][1])?e[s][n][0]:e[s][n][1];i>=0?(e[s][n][0]=a,e[s][n][1]=a+i,a=e[s][n][1]):(e[s][n][0]=0,e[s][n][1]=0)}}},Bm=(e,t,n)=>{var r=Um[n],a=function(){var e=ym([]),t=xm,n=fm,r=vm;function a(a){var s,i,o=Array.from(e.apply(this,arguments),bm),l=o.length,c=-1;for(const e of a)for(s=0,++c;s<l;++s)(o[s][c]=[0,+r(e,o[s].key,c,a)]).data=e;for(s=0,i=gm(t(o));s<l;++s)o[i[s]].index=s;return n(o,i),o}return a.keys=function(t){return arguments.length?(e="function"===typeof t?t:ym(Array.from(t)),a):e},a.value=function(e){return arguments.length?(r="function"===typeof e?e:ym(+e),a):r},a.order=function(e){return arguments.length?(t=null==e?xm:"function"===typeof e?e:ym(Array.from(e)),a):t},a.offset=function(e){return arguments.length?(n=null==e?fm:e,a):n},a}().keys(t).value((e,t)=>+Im(e,t,0)).order(xm).offset(r);return a(e)};function zm(e){var{axis:t,ticks:n,bandSize:r,entry:a,index:s,dataKey:i}=e;if("category"===t.type){if(!t.allowDuplicatedCategory&&t.dataKey&&!pc(a[t.dataKey])){var o=mc(n,"value",a[t.dataKey]);if(o)return o.coordinate+r/2}return n[s]?n[s].coordinate+r/2:null}var l=Im(a,pc(i)?t.dataKey:i);return pc(l)?null:t.scale(l)}var qm=e=>{var{axis:t,ticks:n,offset:r,bandSize:a,entry:s,index:i}=e;if("category"===t.type)return n[i]?n[i].coordinate+r:null;var o=Im(s,t.dataKey,t.scale.domain()[i]);return pc(o)?null:t.scale(o)-a/2+r},Vm=(e,t,n)=>{if(null!=e)return(e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]])(Object.keys(e).reduce((r,a)=>{var s=e[a],{stackedData:i}=s,o=i.reduce((e,r)=>{var a=(e=>{var t=e.flat(2).filter(ic);return[Math.min(...t),Math.max(...t)]})(Dm(r,t,n));return[Math.min(e[0],a[0]),Math.max(e[1],a[1])]},[1/0,-1/0]);return[Math.min(o[0],r[0]),Math.max(o[1],r[1])]},[1/0,-1/0]))},Hm=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Wm=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Gm=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=hm()(t,e=>e.coordinate),s=1/0,i=1,o=a.length;i<o;i++){var l=a[i],c=a[i-1];s=Math.min((l.coordinate||0)-(c.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0};function Km(e){var{tooltipEntrySettings:t,dataKey:n,payload:r,value:a,name:s}=e;return Om(Om({},t),{},{dataKey:n,payload:r,value:a,name:s})}function Qm(e,t){return e?String(e):"string"===typeof t?t:void 0}var Ym=e=>e.layout.width,$m=e=>e.layout.height,Jm=e=>e.layout.scale,Xm=e=>e.layout.margin,Zm=tm(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),ep=tm(e=>e.cartesianAxis.yAxis,e=>Object.values(e));function tp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function np(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tp(Object(n),!0).forEach(function(t){rp(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tp(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function rp(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ap=tm([Ym,$m,Xm,e=>e.brush.height,function(e){return ep(e).reduce((e,t)=>"left"!==t.orientation||t.mirror||t.hide?e:e+("number"===typeof t.width?t.width:60),0)},function(e){return ep(e).reduce((e,t)=>"right"!==t.orientation||t.mirror||t.hide?e:e+("number"===typeof t.width?t.width:60),0)},function(e){return Zm(e).reduce((e,t)=>"top"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},function(e){return Zm(e).reduce((e,t)=>"bottom"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},mm,e=>e.legend.size],(e,t,n,r,a,s,i,o,l,c)=>{var d={left:(n.left||0)+a,right:(n.right||0)+s},u=np(np({},{top:(n.top||0)+i,bottom:(n.bottom||0)+o}),d),h=u.bottom;u.bottom+=r,u=((e,t,n)=>{if(t&&n){var{width:r,height:a}=n,{align:s,verticalAlign:i,layout:o}=t;if(("vertical"===o||"horizontal"===o&&"middle"===i)&&"center"!==s&&ic(e[s]))return Om(Om({},e),{},{[s]:e[s]+(r||0)});if(("horizontal"===o||"vertical"===o&&"center"===s)&&"middle"!==i&&ic(e[i]))return Om(Om({},e),{},{[i]:e[i]+(a||0)})}return e})(u,l,c);var m=e-u.left-u.right,p=t-u.top-u.bottom;return np(np({brushBottom:h},u),{},{width:Math.max(m,0),height:Math.max(p,0)})}),sp=tm(ap,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),ip=tm(Ym,$m,(e,t)=>({x:0,y:0,width:e,height:t})),op=(0,r.createContext)(null),lp=()=>null!=(0,r.useContext)(op),cp=e=>e.brush,dp=tm([cp,ap,Xm],(e,t,n)=>({height:e.height,x:ic(e.x)?e.x:t.left,y:ic(e.y)?e.y:t.top+t.height+t.brushBottom-((null===n||void 0===n?void 0:n.bottom)||0),width:ic(e.width)?e.width:t.width})),up=()=>{var e,t=lp(),n=dm(sp),r=dm(dp),a=null===(e=dm(cp))||void 0===e?void 0:e.padding;return t&&r&&a?{width:r.width-a.left-a.right,height:r.height-a.top-a.bottom,x:a.left,y:a.top}:n},hp={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},mp=()=>{var e;return null!==(e=dm(ap))&&void 0!==e?e:hp},pp=()=>dm(Ym),fp=()=>dm($m),gp=e=>e.layout.layoutType,yp=()=>dm(gp),xp=n(9859),vp=n.n(xp);function bp(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function wp(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}class jp extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kp;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(Np(this,e))}has(e){return super.has(Np(this,e))}set(e,t){return super.set(_p(this,e),t)}delete(e){return super.delete(Sp(this,e))}}Set;function Np(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)?n.get(a):t}function _p(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)?n.get(a):(n.set(a,t),t)}function Sp(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)&&(t=n.get(a),n.delete(a)),t}function kp(e){return null!==e&&"object"===typeof e?e.valueOf():e}const Ep=Symbol("implicit");function Ap(){var e=new jp,t=[],n=[],r=Ep;function a(a){let s=e.get(a);if(void 0===s){if(r!==Ep)return r;e.set(a,s=t.push(a)-1)}return n[s%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new jp;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return Ap(t,n).unknown(r)},bp.apply(a,arguments),a}function Cp(){var e,t,n=Ap().unknown(void 0),r=n.domain,a=n.range,s=0,i=1,o=!1,l=0,c=0,d=.5;function u(){var n=r().length,u=i<s,h=u?i:s,m=u?s:i;e=(m-h)/Math.max(1,n-l+2*c),o&&(e=Math.floor(e)),h+=(m-h-e*(n-l))*d,t=e*(1-l),o&&(h=Math.round(h),t=Math.round(t));var p=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),s=new Array(a);++r<a;)s[r]=e+r*n;return s}(n).map(function(t){return h+e*t});return a(u?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),u()):r()},n.range=function(e){return arguments.length?([s,i]=e,s=+s,i=+i,u()):[s,i]},n.rangeRound=function(e){return[s,i]=e,s=+s,i=+i,o=!0,u()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,u()):o},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),u()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),u()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,u()):c},n.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),u()):d},n.copy=function(){return Cp(r(),[s,i]).round(o).paddingInner(l).paddingOuter(c).align(d)},bp.apply(u(),arguments)}function Dp(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Dp(t())},e}function Tp(){return Dp(Cp.apply(null,arguments).paddingInner(1))}const Op=Math.sqrt(50),Pp=Math.sqrt(10),Ip=Math.sqrt(2);function Rp(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),s=r/Math.pow(10,a),i=s>=Op?10:s>=Pp?5:s>=Ip?2:1;let o,l,c;return a<0?(c=Math.pow(10,-a)/i,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,a)*i,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=n&&n<2?Rp(e,t,2*n):[o,l,c]}function Mp(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[a,s,i]=r?Rp(t,e,n):Rp(e,t,n);if(!(s>=a))return[];const o=s-a+1,l=new Array(o);if(r)if(i<0)for(let c=0;c<o;++c)l[c]=(s-c)/-i;else for(let c=0;c<o;++c)l[c]=(s-c)*i;else if(i<0)for(let c=0;c<o;++c)l[c]=(a+c)/-i;else for(let c=0;c<o;++c)l[c]=(a+c)*i;return l}function Lp(e,t,n){return Rp(e=+e,t=+t,n=+n)[2]}function Fp(e,t,n){n=+n;const r=(t=+t)<(e=+e),a=r?Lp(t,e,n):Lp(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function Up(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Bp(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function zp(e){let t,n,r;function a(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<s){if(0!==t(r,r))return s;do{const t=a+s>>>1;n(e[t],r)<0?a=t+1:s=t}while(a<s)}return a}return 2!==e.length?(t=Up,n=(t,n)=>Up(e(t),n),r=(t,n)=>e(t)-n):(t=e===Up||e===Bp?e:qp,n=e,r=e),{left:a,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=a(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return s>n&&r(e[s-1],t)>-r(e[s],t)?s-1:s},right:function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<s){if(0!==t(r,r))return s;do{const t=a+s>>>1;n(e[t],r)<=0?a=t+1:s=t}while(a<s)}return a}}}function qp(){return 0}function Vp(e){return null===e?NaN:+e}const Hp=zp(Up),Wp=Hp.right,Gp=(Hp.left,zp(Vp).center,Wp);function Kp(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Qp(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Yp(){}var $p=.7,Jp=1/$p,Xp="\\s*([+-]?\\d+)\\s*",Zp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ef="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tf=/^#([0-9a-f]{3,8})$/,nf=new RegExp("^rgb\\(".concat(Xp,",").concat(Xp,",").concat(Xp,"\\)$")),rf=new RegExp("^rgb\\(".concat(ef,",").concat(ef,",").concat(ef,"\\)$")),af=new RegExp("^rgba\\(".concat(Xp,",").concat(Xp,",").concat(Xp,",").concat(Zp,"\\)$")),sf=new RegExp("^rgba\\(".concat(ef,",").concat(ef,",").concat(ef,",").concat(Zp,"\\)$")),of=new RegExp("^hsl\\(".concat(Zp,",").concat(ef,",").concat(ef,"\\)$")),lf=new RegExp("^hsla\\(".concat(Zp,",").concat(ef,",").concat(ef,",").concat(Zp,"\\)$")),cf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function df(){return this.rgb().formatHex()}function uf(){return this.rgb().formatRgb()}function hf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=tf.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?mf(t):3===n?new gf(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?pf(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?pf(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=nf.exec(e))?new gf(t[1],t[2],t[3],1):(t=rf.exec(e))?new gf(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=af.exec(e))?pf(t[1],t[2],t[3],t[4]):(t=sf.exec(e))?pf(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=of.exec(e))?jf(t[1],t[2]/100,t[3]/100,1):(t=lf.exec(e))?jf(t[1],t[2]/100,t[3]/100,t[4]):cf.hasOwnProperty(e)?mf(cf[e]):"transparent"===e?new gf(NaN,NaN,NaN,0):null}function mf(e){return new gf(e>>16&255,e>>8&255,255&e,1)}function pf(e,t,n,r){return r<=0&&(e=t=n=NaN),new gf(e,t,n,r)}function ff(e,t,n,r){return 1===arguments.length?((a=e)instanceof Yp||(a=hf(a)),a?new gf((a=a.rgb()).r,a.g,a.b,a.opacity):new gf):new gf(e,t,n,null==r?1:r);var a}function gf(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function yf(){return"#".concat(wf(this.r)).concat(wf(this.g)).concat(wf(this.b))}function xf(){const e=vf(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(bf(this.r),", ").concat(bf(this.g),", ").concat(bf(this.b)).concat(1===e?")":", ".concat(e,")"))}function vf(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function bf(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function wf(e){return((e=bf(e))<16?"0":"")+e.toString(16)}function jf(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new _f(e,t,n,r)}function Nf(e){if(e instanceof _f)return new _f(e.h,e.s,e.l,e.opacity);if(e instanceof Yp||(e=hf(e)),!e)return new _f;if(e instanceof _f)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),s=Math.max(t,n,r),i=NaN,o=s-a,l=(s+a)/2;return o?(i=t===s?(n-r)/o+6*(n<r):n===s?(r-t)/o+2:(t-n)/o+4,o/=l<.5?s+a:2-s-a,i*=60):o=l>0&&l<1?0:i,new _f(i,o,l,e.opacity)}function _f(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Sf(e){return(e=(e||0)%360)<0?e+360:e}function kf(e){return Math.max(0,Math.min(1,e||0))}function Ef(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Af(e,t,n,r,a){var s=e*e,i=s*e;return((1-3*e+3*s-i)*t+(4-6*s+3*i)*n+(1+3*e+3*s-3*i)*r+i*a)/6}Kp(Yp,hf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:df,formatHex:df,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Nf(this).formatHsl()},formatRgb:uf,toString:uf}),Kp(gf,ff,Qp(Yp,{brighter(e){return e=null==e?Jp:Math.pow(Jp,e),new gf(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?$p:Math.pow($p,e),new gf(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new gf(bf(this.r),bf(this.g),bf(this.b),vf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:yf,formatHex:yf,formatHex8:function(){return"#".concat(wf(this.r)).concat(wf(this.g)).concat(wf(this.b)).concat(wf(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:xf,toString:xf})),Kp(_f,function(e,t,n,r){return 1===arguments.length?Nf(e):new _f(e,t,n,null==r?1:r)},Qp(Yp,{brighter(e){return e=null==e?Jp:Math.pow(Jp,e),new _f(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?$p:Math.pow($p,e),new _f(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new gf(Ef(e>=240?e-240:e+120,a,r),Ef(e,a,r),Ef(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new _f(Sf(this.h),kf(this.s),kf(this.l),vf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=vf(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Sf(this.h),", ").concat(100*kf(this.s),"%, ").concat(100*kf(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Cf=e=>()=>e;function Df(e,t){return function(n){return e+n*t}}function Tf(e){return 1===(e=+e)?Of:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Cf(isNaN(t)?n:t)}}function Of(e,t){var n=t-e;return n?Df(e,n):Cf(isNaN(e)?t:e)}const Pf=function e(t){var n=Tf(t);function r(e,t){var r=n((e=ff(e)).r,(t=ff(t)).r),a=n(e.g,t.g),s=n(e.b,t.b),i=Of(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=s(t),e.opacity=i(t),e+""}}return r.gamma=e,r}(1);function If(e){return function(t){var n,r,a=t.length,s=new Array(a),i=new Array(a),o=new Array(a);for(n=0;n<a;++n)r=ff(t[n]),s[n]=r.r||0,i[n]=r.g||0,o[n]=r.b||0;return s=e(s),i=e(i),o=e(o),r.opacity=1,function(e){return r.r=s(e),r.g=i(e),r.b=o(e),r+""}}}If(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],s=e[r+1],i=r>0?e[r-1]:2*a-s,o=r<t-1?e[r+2]:2*s-a;return Af((n-r/t)*t,i,a,s,o)}}),If(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],s=e[r%t],i=e[(r+1)%t],o=e[(r+2)%t];return Af((n-r/t)*t,a,s,i,o)}});function Rf(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,s=new Array(a),i=new Array(r);for(n=0;n<a;++n)s[n]=Vf(e[n],t[n]);for(;n<r;++n)i[n]=t[n];return function(e){for(n=0;n<a;++n)i[n]=s[n](e);return i}}function Mf(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Lf(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Ff(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=Vf(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var Uf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Bf=new RegExp(Uf.source,"g");function zf(e,t){var n,r,a,s=Uf.lastIndex=Bf.lastIndex=0,i=-1,o=[],l=[];for(e+="",t+="";(n=Uf.exec(e))&&(r=Bf.exec(t));)(a=r.index)>s&&(a=t.slice(s,a),o[i]?o[i]+=a:o[++i]=a),(n=n[0])===(r=r[0])?o[i]?o[i]+=r:o[++i]=r:(o[++i]=null,l.push({i:i,x:Lf(n,r)})),s=Bf.lastIndex;return s<t.length&&(a=t.slice(s),o[i]?o[i]+=a:o[++i]=a),o.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)o[(n=l[r]).i]=n.x(e);return o.join("")})}function qf(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(s){for(n=0;n<r;++n)a[n]=e[n]*(1-s)+t[n]*s;return a}}function Vf(e,t){var n,r=typeof t;return null==t||"boolean"===r?Cf(t):("number"===r?Lf:"string"===r?(n=hf(t))?(t=n,Pf):zf:t instanceof hf?Pf:t instanceof Date?Mf:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?qf:Array.isArray(t)?Rf:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?Ff:Lf)(e,t)}function Hf(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Wf(e){return+e}var Gf=[0,1];function Kf(e){return e}function Qf(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function Yf(e,t,n){var r=e[0],a=e[1],s=t[0],i=t[1];return a<r?(r=Qf(a,r),s=n(i,s)):(r=Qf(r,a),s=n(s,i)),function(e){return s(r(e))}}function $f(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),s=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=Qf(e[i],e[i+1]),s[i]=n(t[i],t[i+1]);return function(t){var n=Gp(e,t,1,r)-1;return s[n](a[n](t))}}function Jf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Xf(){var e,t,n,r,a,s,i=Gf,o=Gf,l=Vf,c=Kf;function d(){var e=Math.min(i.length,o.length);return c!==Kf&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(i[0],i[e-1])),r=e>2?$f:Yf,a=s=null,u}function u(t){return null==t||isNaN(t=+t)?n:(a||(a=r(i.map(e),o,l)))(e(c(t)))}return u.invert=function(n){return c(t((s||(s=r(o,i.map(e),Lf)))(n)))},u.domain=function(e){return arguments.length?(i=Array.from(e,Wf),d()):i.slice()},u.range=function(e){return arguments.length?(o=Array.from(e),d()):o.slice()},u.rangeRound=function(e){return o=Array.from(e),l=Hf,d()},u.clamp=function(e){return arguments.length?(c=!!e||Kf,d()):c!==Kf},u.interpolate=function(e){return arguments.length?(l=e,d()):l},u.unknown=function(e){return arguments.length?(n=e,u):n},function(n,r){return e=n,t=r,d()}}function Zf(){return Xf()(Kf,Kf)}var eg,tg=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ng(e){if(!(t=tg.exec(e)))throw new Error("invalid format: "+e);var t;return new rg({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function rg(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function ag(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function sg(e){return(e=ag(Math.abs(e)))?e[1]:NaN}function ig(e,t){var n=ag(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}ng.prototype=rg.prototype,rg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const og={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ig(100*e,t),r:ig,s:function(e,t){var n=ag(e,t);if(!n)return e+"";var r=n[0],a=n[1],s=a-(eg=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,i=r.length;return s===i?r:s>i?r+new Array(s-i+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+ag(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function lg(e){return e}var cg,dg,ug,hg=Array.prototype.map,mg=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function pg(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?lg:(t=hg.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,s=[],i=0,o=t[0],l=0;a>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(e.substring(a-=o,a+o)),!((l+=o+1)>r));)o=t[i=(i+1)%t.length];return s.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",s=void 0===e.currency?"":e.currency[1]+"",i=void 0===e.decimal?".":e.decimal+"",o=void 0===e.numerals?lg:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(hg.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",d=void 0===e.nan?"NaN":e.nan+"";function u(e){var t=(e=ng(e)).fill,n=e.align,u=e.sign,h=e.symbol,m=e.zero,p=e.width,f=e.comma,g=e.precision,y=e.trim,x=e.type;"n"===x?(f=!0,x="g"):og[x]||(void 0===g&&(g=12),y=!0,x="g"),(m||"0"===t&&"="===n)&&(m=!0,t="0",n="=");var v="$"===h?a:"#"===h&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",b="$"===h?s:/[%p]/.test(x)?l:"",w=og[x],j=/[defgprs%]/.test(x);function N(e){var a,s,l,h=v,N=b;if("c"===x)N=w(e)+N,e="";else{var _=(e=+e)<0||1/e<0;if(e=isNaN(e)?d:w(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),_&&0===+e&&"+"!==u&&(_=!1),h=(_?"("===u?u:c:"-"===u||"("===u?"":u)+h,N=("s"===x?mg[8+eg/3]:"")+N+(_&&"("===u?")":""),j)for(a=-1,s=e.length;++a<s;)if(48>(l=e.charCodeAt(a))||l>57){N=(46===l?i+e.slice(a+1):e.slice(a))+N,e=e.slice(0,a);break}}f&&!m&&(e=r(e,1/0));var S=h.length+e.length+N.length,k=S<p?new Array(p-S+1).join(t):"";switch(f&&m&&(e=r(k+e,k.length?p-N.length:1/0),k=""),n){case"<":e=h+e+N+k;break;case"=":e=h+k+e+N;break;case"^":e=k.slice(0,S=k.length>>1)+h+e+N+k.slice(S);break;default:e=k+h+e+N}return o(e)}return g=void 0===g?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),N.toString=function(){return e+""},N}return{format:u,formatPrefix:function(e,t){var n=u(((e=ng(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(sg(t)/3))),a=Math.pow(10,-r),s=mg[8+r/3];return function(e){return n(a*e)+s}}}}function fg(e,t,n,r){var a,s=Fp(e,t,n);switch((r=ng(null==r?",f":r)).type){case"s":var i=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(sg(t)/3)))-sg(Math.abs(e)))}(s,i))||(r.precision=a),ug(r,i);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,sg(t)-sg(e))+1}(s,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(e){return Math.max(0,-sg(Math.abs(e)))}(s))||(r.precision=a-2*("%"===r.type))}return dg(r)}function gg(e){var t=e.domain;return e.ticks=function(e){var n=t();return Mp(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return fg(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,s=t(),i=0,o=s.length-1,l=s[i],c=s[o],d=10;for(c<l&&(a=l,l=c,c=a,a=i,i=o,o=a);d-- >0;){if((a=Lp(l,c,n))===r)return s[i]=l,s[o]=c,t(s);if(a>0)l=Math.floor(l/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;l=Math.ceil(l*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function yg(){var e=Zf();return e.copy=function(){return Jf(e,yg())},bp.apply(e,arguments),gg(e)}function xg(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,Wf),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return xg(e).unknown(t)},e=arguments.length?Array.from(e,Wf):[0,1],gg(n)}function vg(e,t){var n,r=0,a=(e=e.slice()).length-1,s=e[r],i=e[a];return i<s&&(n=r,r=a,a=n,n=s,s=i,i=n),e[r]=t.floor(s),e[a]=t.ceil(i),e}function bg(e){return Math.log(e)}function wg(e){return Math.exp(e)}function jg(e){return-Math.log(-e)}function Ng(e){return-Math.exp(-e)}function _g(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Sg(e){return(t,n)=>-e(-t,n)}function kg(e){const t=e(bg,wg),n=t.domain;let r,a,s=10;function i(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(s),a=function(e){return 10===e?_g:e===Math.E?Math.exp:t=>Math.pow(e,t)}(s),n()[0]<0?(r=Sg(r),a=Sg(a),e(jg,Ng)):e(bg,wg),t}return t.base=function(e){return arguments.length?(s=+e,i()):s},t.domain=function(e){return arguments.length?(n(e),i()):n()},t.ticks=e=>{const t=n();let i=t[0],o=t[t.length-1];const l=o<i;l&&([i,o]=[o,i]);let c,d,u=r(i),h=r(o);const m=null==e?10:+e;let p=[];if(!(s%1)&&h-u<m){if(u=Math.floor(u),h=Math.ceil(h),i>0){for(;u<=h;++u)for(c=1;c<s;++c)if(d=u<0?c/a(-u):c*a(u),!(d<i)){if(d>o)break;p.push(d)}}else for(;u<=h;++u)for(c=s-1;c>=1;--c)if(d=u>0?c/a(-u):c*a(u),!(d<i)){if(d>o)break;p.push(d)}2*p.length<m&&(p=Mp(i,o,m))}else p=Mp(u,h,Math.min(h-u,m)).map(a);return l?p.reverse():p},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===s?"s":","),"function"!==typeof n&&(s%1||null!=(n=ng(n)).precision||(n.trim=!0),n=dg(n)),e===1/0)return n;const i=Math.max(1,s*e/t.ticks().length);return e=>{let t=e/a(Math.round(r(e)));return t*s<s-.5&&(t*=s),t<=i?n(e):""}},t.nice=()=>n(vg(n(),{floor:e=>a(Math.floor(r(e))),ceil:e=>a(Math.ceil(r(e)))})),t}function Eg(){const e=kg(Xf()).domain([1,10]);return e.copy=()=>Jf(e,Eg()).base(e.base()),bp.apply(e,arguments),e}function Ag(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Cg(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Dg(e){var t=1,n=e(Ag(t),Cg(t));return n.constant=function(n){return arguments.length?e(Ag(t=+n),Cg(t)):t},gg(n)}function Tg(){var e=Dg(Xf());return e.copy=function(){return Jf(e,Tg()).constant(e.constant())},bp.apply(e,arguments)}function Og(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Pg(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ig(e){return e<0?-e*e:e*e}function Rg(e){var t=e(Kf,Kf),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(Kf,Kf):.5===n?e(Pg,Ig):e(Og(n),Og(1/n)):n},gg(t)}function Mg(){var e=Rg(Xf());return e.copy=function(){return Jf(e,Mg()).exponent(e.exponent())},bp.apply(e,arguments),e}function Lg(){return Mg.apply(null,arguments).exponent(.5)}function Fg(e){return Math.sign(e)*e*e}function Ug(){var e,t=Zf(),n=[0,1],r=!1;function a(n){var a=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(n));return isNaN(a)?e:r?Math.round(a):a}return a.invert=function(e){return t.invert(Fg(e))},a.domain=function(e){return arguments.length?(t.domain(e),a):t.domain()},a.range=function(e){return arguments.length?(t.range((n=Array.from(e,Wf)).map(Fg)),a):n.slice()},a.rangeRound=function(e){return a.range(e).round(!0)},a.round=function(e){return arguments.length?(r=!!e,a):r},a.clamp=function(e){return arguments.length?(t.clamp(e),a):t.clamp()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return Ug(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},bp.apply(a,arguments),gg(a)}function Bg(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function zg(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}function qg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Up;if(e===Up)return Vg;if("function"!==typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}function Vg(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function Hg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,a=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=void 0===a?Vg:qg(a);r>n;){if(r-n>600){const s=r-n+1,i=t-n+1,o=Math.log(s),l=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*l*(s-l)/s)*(i-s/2<0?-1:1);Hg(e,t,Math.max(n,Math.floor(t-i*l/s+c)),Math.min(r,Math.floor(t+(s-i)*l/s+c)),a)}const s=e[t];let i=n,o=r;for(Wg(e,n,t),a(e[r],s)>0&&Wg(e,n,r);i<o;){for(Wg(e,i,o),++i,--o;a(e[i],s)<0;)++i;for(;a(e[o],s)>0;)--o}0===a(e[n],s)?Wg(e,n,o):(++o,Wg(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function Wg(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Gg(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return zg(e);if(t>=1)return Bg(e);var r,a=(r-1)*t,s=Math.floor(a),i=Bg(Hg(e,s).subarray(0,s+1));return i+(zg(e.subarray(s+1))-i)*(a-s)}}function Kg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vp;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,s=Math.floor(a),i=+n(e[s],s,e);return i+(+n(e[s+1],s+1,e)-i)*(a-s)}}function Qg(){var e,t=[],n=[],r=[];function a(){var e=0,a=Math.max(1,n.length);for(r=new Array(a-1);++e<a;)r[e-1]=Kg(t,e/a);return s}function s(t){return null==t||isNaN(t=+t)?e:n[Gp(r,t)]}return s.invertExtent=function(e){var a=n.indexOf(e);return a<0?[NaN,NaN]:[a>0?r[a-1]:t[0],a<r.length?r[a]:t[t.length-1]]},s.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(Up),a()},s.range=function(e){return arguments.length?(n=Array.from(e),a()):n.slice()},s.unknown=function(t){return arguments.length?(e=t,s):e},s.quantiles=function(){return r.slice()},s.copy=function(){return Qg().domain(t).range(n).unknown(e)},bp.apply(s,arguments)}function Yg(){var e,t=0,n=1,r=1,a=[.5],s=[0,1];function i(t){return null!=t&&t<=t?s[Gp(a,t,0,r)]:e}function o(){var e=-1;for(a=new Array(r);++e<r;)a[e]=((e+1)*n-(e-r)*t)/(r+1);return i}return i.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,o()):[t,n]},i.range=function(e){return arguments.length?(r=(s=Array.from(e)).length-1,o()):s.slice()},i.invertExtent=function(e){var i=s.indexOf(e);return i<0?[NaN,NaN]:i<1?[t,a[0]]:i>=r?[a[r-1],n]:[a[i-1],a[i]]},i.unknown=function(t){return arguments.length?(e=t,i):i},i.thresholds=function(){return a.slice()},i.copy=function(){return Yg().domain([t,n]).range(s).unknown(e)},bp.apply(gg(i),arguments)}function $g(){var e,t=[.5],n=[0,1],r=1;function a(a){return null!=a&&a<=a?n[Gp(t,a,0,r)]:e}return a.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),a):t.slice()},a.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),a):n.slice()},a.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return $g().domain(t).range(n).unknown(e)},bp.apply(a,arguments)}cg=pg({thousands:",",grouping:[3],currency:["$",""]}),dg=cg.format,ug=cg.formatPrefix;const Jg=1e3,Xg=6e4,Zg=36e5,ey=864e5,ty=6048e5,ny=2592e6,ry=31536e6,ay=new Date,sy=new Date;function iy(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=t=>(e(t=new Date(+t)),t),a.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),a.round=e=>{const t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),a.range=(n,r,s)=>{const i=[];if(n=a.ceil(n),s=null==s?1:Math.floor(s),!(n<r)||!(s>0))return i;let o;do{i.push(o=new Date(+n)),t(n,s),e(n)}while(o<n&&n<r);return i},a.filter=n=>iy(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}),n&&(a.count=(t,r)=>(ay.setTime(+t),sy.setTime(+r),e(ay),e(sy),Math.floor(n(ay,sy))),a.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?t=>r(t)%e===0:t=>a.count(0,t)%e===0):a:null)),a}const oy=iy(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);oy.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?iy(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):oy:null);oy.range;const ly=iy(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Jg)},(e,t)=>(t-e)/Jg,e=>e.getUTCSeconds()),cy=(ly.range,iy(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jg)},(e,t)=>{e.setTime(+e+t*Xg)},(e,t)=>(t-e)/Xg,e=>e.getMinutes())),dy=(cy.range,iy(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Xg)},(e,t)=>(t-e)/Xg,e=>e.getUTCMinutes())),uy=(dy.range,iy(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Jg-e.getMinutes()*Xg)},(e,t)=>{e.setTime(+e+t*Zg)},(e,t)=>(t-e)/Zg,e=>e.getHours())),hy=(uy.range,iy(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Zg)},(e,t)=>(t-e)/Zg,e=>e.getUTCHours())),my=(hy.range,iy(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Xg)/ey,e=>e.getDate()-1)),py=(my.range,iy(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ey,e=>e.getUTCDate()-1)),fy=(py.range,iy(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ey,e=>Math.floor(e/ey)));fy.range;function gy(e){return iy(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Xg)/ty)}const yy=gy(0),xy=gy(1),vy=gy(2),by=gy(3),wy=gy(4),jy=gy(5),Ny=gy(6);yy.range,xy.range,vy.range,by.range,wy.range,jy.range,Ny.range;function _y(e){return iy(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/ty)}const Sy=_y(0),ky=_y(1),Ey=_y(2),Ay=_y(3),Cy=_y(4),Dy=_y(5),Ty=_y(6),Oy=(Sy.range,ky.range,Ey.range,Ay.range,Cy.range,Dy.range,Ty.range,iy(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth())),Py=(Oy.range,iy(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth())),Iy=(Py.range,iy(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear()));Iy.every=e=>isFinite(e=Math.floor(e))&&e>0?iy(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null;Iy.range;const Ry=iy(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ry.every=e=>isFinite(e=Math.floor(e))&&e>0?iy(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null;Ry.range;function My(e,t,n,r,a,s){const i=[[ly,1,Jg],[ly,5,5e3],[ly,15,15e3],[ly,30,3e4],[s,1,Xg],[s,5,3e5],[s,15,9e5],[s,30,18e5],[a,1,Zg],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,ey],[r,2,1728e5],[n,1,ty],[t,1,ny],[t,3,7776e6],[e,1,ry]];function o(t,n,r){const a=Math.abs(n-t)/r,s=zp(e=>{let[,,t]=e;return t}).right(i,a);if(s===i.length)return e.every(Fp(t/ry,n/ry,r));if(0===s)return oy.every(Math.max(Fp(t,n,r),1));const[o,l]=i[a/i[s-1][2]<i[s][2]/a?s-1:s];return o.every(l)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const a=n&&"function"===typeof n.range?n:o(e,t,n),s=a?a.range(e,+t+1):[];return r?s.reverse():s},o]}const[Ly,Fy]=My(Ry,Py,Sy,fy,hy,dy),[Uy,By]=My(Iy,Oy,yy,my,uy,cy);function zy(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function qy(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Vy(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var Hy,Wy,Gy,Ky={"-":"",_:" ",0:"0"},Qy=/^\s*\d+/,Yy=/^%/,$y=/[\\^$*+?|[\]().{}]/g;function Jy(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",s=a.length;return r+(s<n?new Array(n-s+1).join(t)+a:a)}function Xy(e){return e.replace($y,"\\$&")}function Zy(e){return new RegExp("^(?:"+e.map(Xy).join("|")+")","i")}function ex(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function tx(e,t,n){var r=Qy.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function nx(e,t,n){var r=Qy.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function rx(e,t,n){var r=Qy.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ax(e,t,n){var r=Qy.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function sx(e,t,n){var r=Qy.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function ix(e,t,n){var r=Qy.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function ox(e,t,n){var r=Qy.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function lx(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function cx(e,t,n){var r=Qy.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function dx(e,t,n){var r=Qy.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function ux(e,t,n){var r=Qy.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function hx(e,t,n){var r=Qy.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function mx(e,t,n){var r=Qy.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function px(e,t,n){var r=Qy.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function fx(e,t,n){var r=Qy.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function gx(e,t,n){var r=Qy.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function yx(e,t,n){var r=Qy.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function xx(e,t,n){var r=Yy.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function vx(e,t,n){var r=Qy.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function bx(e,t,n){var r=Qy.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function wx(e,t){return Jy(e.getDate(),t,2)}function jx(e,t){return Jy(e.getHours(),t,2)}function Nx(e,t){return Jy(e.getHours()%12||12,t,2)}function _x(e,t){return Jy(1+my.count(Iy(e),e),t,3)}function Sx(e,t){return Jy(e.getMilliseconds(),t,3)}function kx(e,t){return Sx(e,t)+"000"}function Ex(e,t){return Jy(e.getMonth()+1,t,2)}function Ax(e,t){return Jy(e.getMinutes(),t,2)}function Cx(e,t){return Jy(e.getSeconds(),t,2)}function Dx(e){var t=e.getDay();return 0===t?7:t}function Tx(e,t){return Jy(yy.count(Iy(e)-1,e),t,2)}function Ox(e){var t=e.getDay();return t>=4||0===t?wy(e):wy.ceil(e)}function Px(e,t){return e=Ox(e),Jy(wy.count(Iy(e),e)+(4===Iy(e).getDay()),t,2)}function Ix(e){return e.getDay()}function Rx(e,t){return Jy(xy.count(Iy(e)-1,e),t,2)}function Mx(e,t){return Jy(e.getFullYear()%100,t,2)}function Lx(e,t){return Jy((e=Ox(e)).getFullYear()%100,t,2)}function Fx(e,t){return Jy(e.getFullYear()%1e4,t,4)}function Ux(e,t){var n=e.getDay();return Jy((e=n>=4||0===n?wy(e):wy.ceil(e)).getFullYear()%1e4,t,4)}function Bx(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Jy(t/60|0,"0",2)+Jy(t%60,"0",2)}function zx(e,t){return Jy(e.getUTCDate(),t,2)}function qx(e,t){return Jy(e.getUTCHours(),t,2)}function Vx(e,t){return Jy(e.getUTCHours()%12||12,t,2)}function Hx(e,t){return Jy(1+py.count(Ry(e),e),t,3)}function Wx(e,t){return Jy(e.getUTCMilliseconds(),t,3)}function Gx(e,t){return Wx(e,t)+"000"}function Kx(e,t){return Jy(e.getUTCMonth()+1,t,2)}function Qx(e,t){return Jy(e.getUTCMinutes(),t,2)}function Yx(e,t){return Jy(e.getUTCSeconds(),t,2)}function $x(e){var t=e.getUTCDay();return 0===t?7:t}function Jx(e,t){return Jy(Sy.count(Ry(e)-1,e),t,2)}function Xx(e){var t=e.getUTCDay();return t>=4||0===t?Cy(e):Cy.ceil(e)}function Zx(e,t){return e=Xx(e),Jy(Cy.count(Ry(e),e)+(4===Ry(e).getUTCDay()),t,2)}function ev(e){return e.getUTCDay()}function tv(e,t){return Jy(ky.count(Ry(e)-1,e),t,2)}function nv(e,t){return Jy(e.getUTCFullYear()%100,t,2)}function rv(e,t){return Jy((e=Xx(e)).getUTCFullYear()%100,t,2)}function av(e,t){return Jy(e.getUTCFullYear()%1e4,t,4)}function sv(e,t){var n=e.getUTCDay();return Jy((e=n>=4||0===n?Cy(e):Cy.ceil(e)).getUTCFullYear()%1e4,t,4)}function iv(){return"+0000"}function ov(){return"%"}function lv(e){return+e}function cv(e){return Math.floor(+e/1e3)}function dv(e){return new Date(e)}function uv(e){return e instanceof Date?+e:+new Date(+e)}function hv(e,t,n,r,a,s,i,o,l,c){var d=Zf(),u=d.invert,h=d.domain,m=c(".%L"),p=c(":%S"),f=c("%I:%M"),g=c("%I %p"),y=c("%a %d"),x=c("%b %d"),v=c("%B"),b=c("%Y");function w(e){return(l(e)<e?m:o(e)<e?p:i(e)<e?f:s(e)<e?g:r(e)<e?a(e)<e?y:x:n(e)<e?v:b)(e)}return d.invert=function(e){return new Date(u(e))},d.domain=function(e){return arguments.length?h(Array.from(e,uv)):h().map(dv)},d.ticks=function(t){var n=h();return e(n[0],n[n.length-1],null==t?10:t)},d.tickFormat=function(e,t){return null==t?w:c(t)},d.nice=function(e){var n=h();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?h(vg(n,e)):d},d.copy=function(){return Jf(d,hv(e,t,n,r,a,s,i,o,l,c))},d}function mv(){return bp.apply(hv(Uy,By,Iy,Oy,yy,my,uy,cy,ly,Wy).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function pv(){return bp.apply(hv(Ly,Fy,Ry,Py,Sy,py,hy,dy,ly,Gy).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function fv(){var e,t,n,r,a,s=0,i=1,o=Kf,l=!1;function c(t){return null==t||isNaN(t=+t)?a:o(0===n?.5:(t=(r(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var n,r;return arguments.length?([n,r]=t,o=e(n,r),c):[o(0),o(1)]}}return c.domain=function(a){return arguments.length?([s,i]=a,e=r(s=+s),t=r(i=+i),n=e===t?0:1/(t-e),c):[s,i]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(o=e,c):o},c.range=d(Vf),c.rangeRound=d(Hf),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(s),t=a(i),n=e===t?0:1/(t-e),c}}function gv(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function yv(){var e=gg(fv()(Kf));return e.copy=function(){return gv(e,yv())},wp.apply(e,arguments)}function xv(){var e=kg(fv()).domain([1,10]);return e.copy=function(){return gv(e,xv()).base(e.base())},wp.apply(e,arguments)}function vv(){var e=Dg(fv());return e.copy=function(){return gv(e,vv()).constant(e.constant())},wp.apply(e,arguments)}function bv(){var e=Rg(fv());return e.copy=function(){return gv(e,bv()).exponent(e.exponent())},wp.apply(e,arguments)}function wv(){return bv.apply(null,arguments).exponent(.5)}function jv(){var e=[],t=Kf;function n(n){if(null!=n&&!isNaN(n=+n))return t((Gp(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(Up),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map((n,r)=>t(r/(e.length-1)))},n.quantiles=function(t){return Array.from({length:t+1},(n,r)=>Gg(e,r/t))},n.copy=function(){return jv(t).domain(e)},wp.apply(n,arguments)}function Nv(){var e,t,n,r,a,s,i,o=0,l=.5,c=1,d=1,u=Kf,h=!1;function m(e){return isNaN(e=+e)?i:(e=.5+((e=+s(e))-t)*(d*e<d*t?r:a),u(h?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a;return arguments.length?([n,r,a]=t,u=function(e,t){void 0===t&&(t=e,e=Vf);for(var n=0,r=t.length-1,a=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return s[t](e-t)}}(e,[n,r,a]),m):[u(0),u(.5),u(1)]}}return m.domain=function(i){return arguments.length?([o,l,c]=i,e=s(o=+o),t=s(l=+l),n=s(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),d=t<e?-1:1,m):[o,l,c]},m.clamp=function(e){return arguments.length?(h=!!e,m):h},m.interpolator=function(e){return arguments.length?(u=e,m):u},m.range=p(Vf),m.rangeRound=p(Hf),m.unknown=function(e){return arguments.length?(i=e,m):i},function(i){return s=i,e=i(o),t=i(l),n=i(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),d=t<e?-1:1,m}}function _v(){var e=gg(Nv()(Kf));return e.copy=function(){return gv(e,_v())},wp.apply(e,arguments)}function Sv(){var e=kg(Nv()).domain([.1,1,10]);return e.copy=function(){return gv(e,Sv()).base(e.base())},wp.apply(e,arguments)}function kv(){var e=Dg(Nv());return e.copy=function(){return gv(e,kv()).constant(e.constant())},wp.apply(e,arguments)}function Ev(){var e=Rg(Nv());return e.copy=function(){return gv(e,Ev()).exponent(e.exponent())},wp.apply(e,arguments)}function Av(){return Ev.apply(null,arguments).exponent(.5)}!function(e){Hy=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,s=e.days,i=e.shortDays,o=e.months,l=e.shortMonths,c=Zy(a),d=ex(a),u=Zy(s),h=ex(s),m=Zy(i),p=ex(i),f=Zy(o),g=ex(o),y=Zy(l),x=ex(l),v={a:function(e){return i[e.getDay()]},A:function(e){return s[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return o[e.getMonth()]},c:null,d:wx,e:wx,f:kx,g:Lx,G:Ux,H:jx,I:Nx,j:_x,L:Sx,m:Ex,M:Ax,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:lv,s:cv,S:Cx,u:Dx,U:Tx,V:Px,w:Ix,W:Rx,x:null,X:null,y:Mx,Y:Fx,Z:Bx,"%":ov},b={a:function(e){return i[e.getUTCDay()]},A:function(e){return s[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return o[e.getUTCMonth()]},c:null,d:zx,e:zx,f:Gx,g:rv,G:sv,H:qx,I:Vx,j:Hx,L:Wx,m:Kx,M:Qx,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:lv,s:cv,S:Yx,u:$x,U:Jx,V:Zx,w:ev,W:tv,x:null,X:null,y:nv,Y:av,Z:iv,"%":ov},w={a:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=u.exec(t.slice(n));return r?(e.w=h.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=x.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return _(e,t,n,r)},d:ux,e:ux,f:yx,g:ox,G:ix,H:mx,I:mx,j:hx,L:gx,m:dx,M:px,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=d.get(r[0].toLowerCase()),n+r[0].length):-1},q:cx,Q:vx,s:bx,S:fx,u:nx,U:rx,V:ax,w:tx,W:sx,x:function(e,t,r){return _(e,n,t,r)},X:function(e,t,n){return _(e,r,t,n)},y:ox,Y:ix,Z:lx,"%":xx};function j(e,t){return function(n){var r,a,s,i=[],o=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++o<c;)37===e.charCodeAt(o)&&(i.push(e.slice(l,o)),null!=(a=Ky[r=e.charAt(++o)])?r=e.charAt(++o):a="e"===r?" ":"0",(s=t[r])&&(r=s(n,a)),i.push(r),l=o+1);return i.push(e.slice(l,o)),i.join("")}}function N(e,t){return function(n){var r,a,s=Vy(1900,void 0,1);if(_(s,e,n+="",0)!=n.length)return null;if("Q"in s)return new Date(s.Q);if("s"in s)return new Date(1e3*s.s+("L"in s?s.L:0));if(t&&!("Z"in s)&&(s.Z=0),"p"in s&&(s.H=s.H%12+12*s.p),void 0===s.m&&(s.m="q"in s?s.q:0),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(a=(r=qy(Vy(s.y,0,1))).getUTCDay(),r=a>4||0===a?ky.ceil(r):ky(r),r=py.offset(r,7*(s.V-1)),s.y=r.getUTCFullYear(),s.m=r.getUTCMonth(),s.d=r.getUTCDate()+(s.w+6)%7):(a=(r=zy(Vy(s.y,0,1))).getDay(),r=a>4||0===a?xy.ceil(r):xy(r),r=my.offset(r,7*(s.V-1)),s.y=r.getFullYear(),s.m=r.getMonth(),s.d=r.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:"W"in s?1:0),a="Z"in s?qy(Vy(s.y,0,1)).getUTCDay():zy(Vy(s.y,0,1)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(a+5)%7:s.w+7*s.U-(a+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,qy(s)):zy(s)}}function _(e,t,n,r){for(var a,s,i=0,o=t.length,l=n.length;i<o;){if(r>=l)return-1;if(37===(a=t.charCodeAt(i++))){if(a=t.charAt(i++),!(s=w[a in Ky?t.charAt(i++):a])||(r=s(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return v.x=j(n,v),v.X=j(r,v),v.c=j(t,v),b.x=j(n,b),b.X=j(r,b),b.c=j(t,b),{format:function(e){var t=j(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=N(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=j(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=N(e+="",!0);return t.toString=function(){return e},t}}}(e),Wy=Hy.format,Hy.parse,Gy=Hy.utcFormat,Hy.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Cv=e=>e.chartData,Dv=tm([Cv],e=>{var t=null!=e.chartData?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Tv=(e,t,n,r)=>r?Dv(e):Cv(e);function Ov(e){return Number.isFinite(e)}function Pv(e){return"number"===typeof e&&e>0&&Number.isFinite(e)}function Iv(e){if(Array.isArray(e)&&2===e.length){var[t,n]=e;if(Ov(t)&&Ov(n))return!0}return!1}function Rv(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}var Mv=n(8210),Lv=n.n(Mv),Fv=e=>e,Uv={"@@functional/placeholder":!0},Bv=e=>e===Uv,zv=e=>function t(){return 0===arguments.length||1===arguments.length&&Bv(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},qv=(e,t)=>1===e?t:zv(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var s=r.filter(e=>e!==Uv).length;return s>=e?t(...r):qv(e-s,zv(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var s=r.map(e=>Bv(e)?n.shift():e);return t(...s,...n)}))}),Vv=e=>qv(e.length,e),Hv=(e,t)=>{for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},Wv=Vv((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(e=>t[e]).map(e)),Gv=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),Kv=e=>{var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return t&&a.every((e,n)=>{var r;return e===(null===(r=t)||void 0===r?void 0:r[n])})?n:(t=a,n=e(...a))}};function Qv(e){return 0===e?1:Math.floor(new(Lv())(e).abs().log(10).toNumber())+1}function Yv(e,t,n){for(var r=new(Lv())(e),a=0,s=[];r.lt(t)&&a<1e5;)s.push(r.toNumber()),r=r.add(n),a++;return s}Vv((e,t,n)=>{var r=+e;return r+n*(+t-r)}),Vv((e,t,n)=>{var r=t-+e;return(n-e)/(r=r||1/0)}),Vv((e,t,n)=>{var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});var $v=e=>{var[t,n]=e,[r,a]=[t,n];return t>n&&([r,a]=[n,t]),[r,a]},Jv=(e,t,n)=>{if(e.lte(0))return new(Lv())(0);var r=Qv(e.toNumber()),a=new(Lv())(10).pow(r),s=e.div(a),i=1!==r?.05:.1,o=new(Lv())(Math.ceil(s.div(i).toNumber())).add(n).mul(i).mul(a);return t?new(Lv())(o.toNumber()):new(Lv())(Math.ceil(o.toNumber()))},Xv=(e,t,n)=>{var r=new(Lv())(1),a=new(Lv())(e);if(!a.isint()&&n){var s=Math.abs(e);s<1?(r=new(Lv())(10).pow(Qv(e)-1),a=new(Lv())(Math.floor(a.div(r).toNumber())).mul(r)):s>1&&(a=new(Lv())(Math.floor(e)))}else 0===e?a=new(Lv())(Math.floor((t-1)/2)):n||(a=new(Lv())(Math.floor(e)));var i=Math.floor((t-1)/2);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return Fv;var r=t.reverse(),a=r[0],s=r.slice(1);return function(){return s.reduce((e,t)=>t(e),a(...arguments))}}(Wv(e=>a.add(new(Lv())(e-i).mul(r)).toNumber()),Hv)(0,t)},Zv=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new(Lv())(0),tickMin:new(Lv())(0),tickMax:new(Lv())(0)};var s,i=Jv(new(Lv())(t).sub(e).div(n-1),r,a);s=e<=0&&t>=0?new(Lv())(0):(s=new(Lv())(e).add(t).div(2)).sub(new(Lv())(s).mod(i));var o=Math.ceil(s.sub(e).div(i).toNumber()),l=Math.ceil(new(Lv())(t).sub(s).div(i).toNumber()),c=o+l+1;return c>n?Zv(e,t,n,r,a+1):(c<n&&(l=t>0?l+(n-c):l,o=t>0?o:o+(n-c)),{step:i,tickMin:s.sub(new(Lv())(o).mul(i)),tickMax:s.add(new(Lv())(l).mul(i))})};var eb=Kv(function(e){var[t,n]=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=Math.max(r,2),[i,o]=$v([t,n]);if(i===-1/0||o===1/0){var l=o===1/0?[i,...Hv(0,r-1).map(()=>1/0)]:[...Hv(0,r-1).map(()=>-1/0),o];return t>n?Gv(l):l}if(i===o)return Xv(i,r,a);var{step:c,tickMin:d,tickMax:u}=Zv(i,o,s,a,0),h=Yv(d,u.add(new(Lv())(.1).mul(c)),c);return t>n?Gv(h):h}),tb=Kv(function(e,t){var[n,r]=e,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],[s,i]=$v([n,r]);if(s===-1/0||i===1/0)return[n,r];if(s===i)return[s];var o=Math.max(t,2),l=Jv(new(Lv())(i).sub(s).div(o-1),a,0),c=[...Yv(new(Lv())(s),new(Lv())(i),l),i];return!1===a&&(c=c.map(e=>Math.round(e))),n>r?Gv(c):c}),nb=e=>e.rootProps.maxBarSize,rb=e=>e.rootProps.barCategoryGap,ab=e=>e.rootProps.stackOffset,sb=e=>e.options.chartName,ib=e=>e.rootProps.syncId,ob=e=>e.rootProps.syncMethod,lb=e=>e.options.eventEmitter,cb=0,db="auto",ub=!0,hb=!1,mb=!0,pb=0,fb="auto",gb=!0,yb=5,xb=(e,t)=>{if(e&&t)return null!==e&&void 0!==e&&e.reversed?[t[1],t[0]]:t},vb={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:cb,includeHidden:!1,name:void 0,reversed:!1,scale:db,tick:ub,tickCount:void 0,ticks:void 0,type:"category",unit:void 0},bb={allowDataOverflow:hb,allowDecimals:!1,allowDuplicatedCategory:mb,dataKey:void 0,domain:void 0,id:pb,includeHidden:!1,name:void 0,reversed:!1,scale:fb,tick:gb,tickCount:yb,ticks:void 0,type:"number",unit:void 0},wb={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,dataKey:void 0,domain:void 0,id:cb,includeHidden:!1,name:void 0,reversed:!1,scale:db,tick:ub,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},jb={allowDataOverflow:hb,allowDecimals:!1,allowDuplicatedCategory:mb,dataKey:void 0,domain:void 0,id:pb,includeHidden:!1,name:void 0,reversed:!1,scale:fb,tick:gb,tickCount:yb,ticks:void 0,type:"category",unit:void 0},Nb=(e,t)=>null!=e.polarAxis.angleAxis[t]?e.polarAxis.angleAxis[t]:"radial"===e.layout.layoutType?wb:vb,_b=(e,t)=>null!=e.polarAxis.radiusAxis[t]?e.polarAxis.radiusAxis[t]:"radial"===e.layout.layoutType?jb:bb,Sb=e=>e.polarOptions,kb=tm([Ym,$m,ap],function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2}),Eb=tm([Sb,kb],(e,t)=>{if(null!=e)return dc(e.innerRadius,t,0)}),Ab=tm([Sb,kb],(e,t)=>{if(null!=e)return dc(e.outerRadius,t,.8*t)}),Cb=tm([Sb],e=>{if(null==e)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]}),Db=(tm([Nb,Cb],xb),tm([kb,Eb,Ab],(e,t,n)=>{if(null!=e&&null!=t&&null!=n)return[t,n]})),Tb=(tm([_b,Db],xb),tm([gp,Sb,Eb,Ab,Ym,$m],(e,t,n,r,a,s)=>{if(("centric"===e||"radial"===e)&&null!=t&&null!=n&&null!=r){var{cx:i,cy:o,startAngle:l,endAngle:c}=t;return{cx:dc(i,a,a/2),cy:dc(o,s,s/2),innerRadius:n,outerRadius:r,startAngle:l,endAngle:c,clockWise:!1}}})),Ob=(e,t)=>t,Pb=(e,t,n)=>n;function Ib(e){return null===e||void 0===e?void 0:e.id}var Rb=e=>{var t=gp(e);return"horizontal"===t?"xAxis":"vertical"===t?"yAxis":"centric"===t?"angleAxis":"radiusAxis"},Mb=e=>e.tooltip.settings.axisId,Lb=e=>{var t=Rb(e),n=Mb(e);return ew(e,t,n)},Fb=tm([Lb],e=>null===e||void 0===e?void 0:e.dataKey);function Ub(e,t,n){var{chartData:r=[]}=t,{allowDuplicatedCategory:a,dataKey:s}=n,i=new Map;return e.forEach(e=>{var t,n=null!==(t=e.data)&&void 0!==t?t:r;if(null!=n&&0!==n.length){var o=Ib(e);n.forEach((t,n)=>{var r,l=null==s||a?n:String(Im(t,s,null)),c=Im(t,e.dataKey,0);r=i.has(l)?i.get(l):{},Object.assign(r,{[o]:c}),i.set(l,r)})}}),Array.from(i.values())}function Bb(e){return null!=e.stackId&&null!=e.dataKey}function zb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function qb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zb(Object(n),!0).forEach(function(t){Vb(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zb(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Vb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Hb=[0,"auto"],Wb={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Gb=(e,t)=>e.cartesianAxis.xAxis[t],Kb=(e,t)=>{var n=Gb(e,t);return null==n?Wb:n},Qb={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Hb,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:60},Yb=(e,t)=>e.cartesianAxis.yAxis[t],$b=(e,t)=>{var n=Yb(e,t);return null==n?Qb:n},Jb={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Xb=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return null==n?Jb:n},Zb=(e,t,n)=>{switch(t){case"xAxis":return Kb(e,n);case"yAxis":return $b(e,n);case"zAxis":return Xb(e,n);case"angleAxis":return Nb(e,n);case"radiusAxis":return _b(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},ew=(e,t,n)=>{switch(t){case"xAxis":return Kb(e,n);case"yAxis":return $b(e,n);case"angleAxis":return Nb(e,n);case"radiusAxis":return _b(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},tw=e=>e.graphicalItems.cartesianItems.some(e=>"bar"===e.type)||e.graphicalItems.polarItems.some(e=>"radialBar"===e.type);function nw(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var rw=e=>e.graphicalItems.cartesianItems,aw=tm([Ob,Pb],nw),sw=(e,t,n)=>e.filter(n).filter(e=>!0===(null===t||void 0===t?void 0:t.includeHidden)||!e.hide),iw=tm([rw,Zb,aw],sw),ow=tm([iw],e=>e.filter(e=>"area"===e.type||"bar"===e.type).filter(Bb)),lw=e=>e.filter(e=>!("stackId"in e)||void 0===e.stackId),cw=tm([iw],lw),dw=e=>e.map(e=>e.data).filter(Boolean).flat(1),uw=tm([iw],dw),hw=(e,t)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:a}=t;return e.length>0?e:n.slice(r,a+1)},mw=tm([uw,Tv],hw),pw=(e,t,n)=>null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:Im(e,t.dataKey)})):n.length>0?n.map(e=>e.dataKey).flatMap(t=>e.map(e=>({value:Im(e,t)}))):e.map(e=>({value:e})),fw=tm([mw,Zb,iw],pw);function gw(e,t){switch(e){case"xAxis":return"x"===t.direction;case"yAxis":return"y"===t.direction;default:return!1}}function yw(e){return e.filter(e=>oc(e)||e instanceof Date).map(Number).filter(e=>!1===ac(e))}function xw(e,t,n){return!n||"number"!==typeof t||ac(t)?[]:n.length?yw(n.flatMap(n=>{var r,a,s=Im(e,n.dataKey);if(Array.isArray(s)?[r,a]=s:r=a=s,Ov(r)&&Ov(a))return[t-r,t+a]})):[]}var vw=tm([ow,Tv,Lb],Ub),bw=(e,t,n)=>{var r=t.reduce((e,t)=>(null==t.stackId||(null==e[t.stackId]&&(e[t.stackId]=[]),e[t.stackId].push(t)),e),{});return Object.fromEntries(Object.entries(r).map(t=>{var[r,a]=t,s=a.map(Ib);return[r,{stackedData:Bm(e,s,n),graphicalItems:a}]}))},ww=tm([vw,ow,ab],bw),jw=(e,t,n)=>{var{dataStartIndex:r,dataEndIndex:a}=t;if("zAxis"!==n){var s=Vm(e,r,a);if(null==s||0!==s[0]||0!==s[1])return s}},Nw=tm([ww,Cv,Ob],jw),_w=(e,t,n,r,a)=>n.length>0?e.flatMap(e=>n.flatMap(n=>{var s,i,o=null===(s=r[n.id])||void 0===s?void 0:s.filter(e=>gw(a,e)),l=Im(e,null!==(i=t.dataKey)&&void 0!==i?i:n.dataKey);return{value:l,errorDomain:xw(e,l,o)}})).filter(Boolean):null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:Im(e,t.dataKey),errorDomain:[]})):e.map(e=>({value:e,errorDomain:[]})),Sw=e=>e.errorBars,kw=(e,t,n)=>e.flatMap(e=>t[e.id]).filter(Boolean).filter(e=>gw(n,e)),Ew=(tm([cw,Sw,Ob],kw),tm([mw,Zb,cw,Sw,Ob],_w));function Aw(e){var{value:t}=e;if(oc(t)||t instanceof Date)return t}var Cw=e=>{var t=yw(e.flatMap(e=>[e.value,e.errorDomain]).flat(1));if(0!==t.length)return[Math.min(...t),Math.max(...t)]},Dw=e=>{var t;if(null==e||!("domain"in e))return Hb;if(null!=e.domain)return e.domain;if(null!=e.ticks){if("number"===e.type){var n=yw(e.ticks);return[Math.min(...n),Math.max(...n)]}if("category"===e.type)return e.ticks.map(String)}return null!==(t=null===e||void 0===e?void 0:e.domain)&&void 0!==t?t:Hb},Tw=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);if(0!==r.length){var a=r.flat();return[Math.min(...a),Math.max(...a)]}},Ow=e=>e.referenceElements.dots,Pw=(e,t,n)=>e.filter(e=>"extendDomain"===e.ifOverflow).filter(e=>"xAxis"===t?e.xAxisId===n:e.yAxisId===n),Iw=tm([Ow,Ob,Pb],Pw),Rw=e=>e.referenceElements.areas,Mw=tm([Rw,Ob,Pb],Pw),Lw=e=>e.referenceElements.lines,Fw=tm([Lw,Ob,Pb],Pw),Uw=(e,t)=>{var n=yw(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},Bw=tm(Iw,Ob,Uw),zw=(e,t)=>{var n=yw(e.flatMap(e=>["xAxis"===t?e.x1:e.y1,"xAxis"===t?e.x2:e.y2]));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},qw=tm([Mw,Ob],zw),Vw=(e,t)=>{var n=yw(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},Hw=tm(Fw,Ob,Vw),Ww=tm(Bw,Hw,qw,(e,t,n)=>Tw(e,n,t)),Gw=tm([Zb],Dw),Kw=(e,t,n,r,a,s,i)=>{var o=function(e,t){if(t&&"function"!==typeof e&&Array.isArray(e)&&2===e.length){var n,r,[a,s]=e;if(Ov(a))n=a;else if("function"===typeof a)return;if(Ov(s))r=s;else if("function"===typeof s)return;var i=[n,r];if(Iv(i))return i}}(t,e.allowDataOverflow);return null!=o?o:function(e,t,n){if(n||null!=t){if("function"===typeof e&&null!=t)try{var r=e(t,n);if(Iv(r))return Rv(r,t,n)}catch(m){}if(Array.isArray(e)&&2===e.length){var a,s,[i,o]=e;if("auto"===i)null!=t&&(a=Math.min(...t));else if(ic(i))a=i;else if("function"===typeof i)try{null!=t&&(a=i(null===t||void 0===t?void 0:t[0]))}catch(p){}else if("string"===typeof i&&Hm.test(i)){var l=Hm.exec(i);if(null==l||null==t)a=void 0;else{var c=+l[1];a=t[0]-c}}else a=null===t||void 0===t?void 0:t[0];if("auto"===o)null!=t&&(s=Math.max(...t));else if(ic(o))s=o;else if("function"===typeof o)try{null!=t&&(s=o(null===t||void 0===t?void 0:t[1]))}catch(f){}else if("string"===typeof o&&Wm.test(o)){var d=Wm.exec(o);if(null==d||null==t)s=void 0;else{var u=+d[1];s=t[1]+u}}else s=null===t||void 0===t?void 0:t[1];var h=[a,s];if(Iv(h))return null==t?h:Rv(h,t,n)}}}(t,"vertical"===s&&"xAxis"===i||"horizontal"===s&&"yAxis"===i?Tw(n,a,Cw(r)):Tw(a,Cw(r)),e.allowDataOverflow)},Qw=tm([Zb,Gw,Nw,Ew,Ww,gp,Ob],Kw),Yw=[0,1],$w=(e,t,n,r,a,s,i)=>{if(null!=e&&null!=n&&0!==n.length||void 0!==i){var{dataKey:o,type:l}=e,c=Rm(t,s);return c&&null==o?vp()(0,n.length):"category"===l?((e,t,n)=>{var r=e.map(Aw).filter(e=>null!=e);return n&&(null==t.dataKey||t.allowDuplicatedCategory&&uc(r))?vp()(0,e.length):t.allowDuplicatedCategory?r:Array.from(new Set(r))})(r,e,c):"expand"===a?Yw:i}},Jw=tm([Zb,gp,mw,fw,ab,Ob,Qw],$w),Xw=(e,n,r,a,s)=>{if(null!=e){var{scale:i,type:o}=e;if("auto"===i)return"radial"===n&&"radiusAxis"===s?"band":"radial"===n&&"angleAxis"===s?"linear":"category"===o&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!r)?"point":"category"===o?"band":"linear";if("string"===typeof i){var l="scale".concat(fc(i));return l in t?l:"point"}}},Zw=tm([Zb,gp,tw,sb,Ob],Xw);function ej(e,n,r,a){if(null!=r&&null!=a){if("function"===typeof e.scale)return e.scale.copy().domain(r).range(a);var s=function(e){if(null!=e){if(e in t)return t[e]();var n="scale".concat(fc(e));return n in t?t[n]():void 0}}(n);if(null!=s){var i=s.domain(r).range(a);return(e=>{var t=e.domain();if(t&&!(t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-Fm,s=Math.max(r[0],r[1])+Fm,i=e(t[0]),o=e(t[n-1]);(i<a||i>s||o<a||o>s)&&e.domain([t[0],t[n-1]])}})(i),i}}}var tj=(e,t,n)=>{var r=Dw(t);if("auto"===n||"linear"===n)return null!=t&&t.tickCount&&Array.isArray(r)&&("auto"===r[0]||"auto"===r[1])&&Iv(e)?eb(e,t.tickCount,t.allowDecimals):null!=t&&t.tickCount&&"number"===t.type&&Iv(e)?tb(e,t.tickCount,t.allowDecimals):void 0},nj=tm([Jw,ew,Zw],tj),rj=(e,t,n,r)=>{if("angleAxis"!==r&&"number"===(null===e||void 0===e?void 0:e.type)&&Iv(t)&&Array.isArray(n)&&n.length>0){var a=t[0],s=n[0],i=t[1],o=n[n.length-1];return[Math.min(a,s),Math.max(i,o)]}return t},aj=tm([Zb,Jw,nj,Ob],rj),sj=tm(fw,Zb,(e,t)=>{if(t&&"number"===t.type){var n=1/0,r=Array.from(yw(e.map(e=>e.value))).sort((e,t)=>e-t);if(r.length<2)return 1/0;var a=r[r.length-1]-r[0];if(0===a)return 1/0;for(var s=0;s<r.length-1;s++){var i=r[s+1]-r[s];n=Math.min(n,i)}return n/a}}),ij=tm(sj,gp,rb,ap,(e,t,n,r)=>r,(e,t,n,r,a)=>{if(!Ov(e))return 0;var s="vertical"===t?r.height:r.width;if("gap"===a)return e*s/2;if("no-gap"===a){var i=dc(n,e*s),o=e*s/2;return o-i-(o-i)/s*i}return 0}),oj=tm(Kb,(e,t)=>{var n=Kb(e,t);return null==n||"string"!==typeof n.padding?0:ij(e,"xAxis",t,n.padding)},(e,t)=>{var n,r;if(null==e)return{left:0,right:0};var{padding:a}=e;return"string"===typeof a?{left:t,right:t}:{left:(null!==(n=a.left)&&void 0!==n?n:0)+t,right:(null!==(r=a.right)&&void 0!==r?r:0)+t}}),lj=tm($b,(e,t)=>{var n=$b(e,t);return null==n||"string"!==typeof n.padding?0:ij(e,"yAxis",t,n.padding)},(e,t)=>{var n,r;if(null==e)return{top:0,bottom:0};var{padding:a}=e;return"string"===typeof a?{top:t,bottom:t}:{top:(null!==(n=a.top)&&void 0!==n?n:0)+t,bottom:(null!==(r=a.bottom)&&void 0!==r?r:0)+t}}),cj=tm([ap,oj,dp,cp,(e,t,n)=>n],(e,t,n,r,a)=>{var{padding:s}=r;return a?[s.left,n.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),dj=tm([ap,gp,lj,dp,cp,(e,t,n)=>n],(e,t,n,r,a,s)=>{var{padding:i}=a;return s?[r.height-i.bottom,i.top]:"horizontal"===t?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),uj=(e,t,n,r)=>{var a;switch(t){case"xAxis":return cj(e,n,r);case"yAxis":return dj(e,n,r);case"zAxis":return null===(a=Xb(e,n))||void 0===a?void 0:a.range;case"angleAxis":return Cb(e);case"radiusAxis":return Db(e,n);default:return}},hj=tm([Zb,uj],xb),mj=tm([Zb,Zw,aj,hj],ej);tm([iw,Sw,Ob],kw);function pj(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var fj=(e,t)=>t,gj=(e,t,n)=>n,yj=tm(Zm,fj,gj,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(pj)),xj=tm(ep,fj,gj,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(pj)),vj=(e,t)=>({width:e.width,height:t.height}),bj=tm(ap,Kb,vj),wj=tm($m,ap,yj,fj,gj,(e,t,n,r,a)=>{var s,i={};return n.forEach(n=>{var o=vj(t,n);null==s&&(s=((e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}})(t,r,e));var l="top"===r&&!a||"bottom"===r&&a;i[n.id]=s-Number(l)*o.height,s+=(l?-1:1)*o.height}),i}),jj=tm(Ym,ap,xj,fj,gj,(e,t,n,r,a)=>{var s,i={};return n.forEach(n=>{var o=((e,t)=>({width:"number"===typeof t.width?t.width:60,height:e.height}))(t,n);null==s&&(s=((e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}})(t,r,e));var l="left"===r&&!a||"right"===r&&a;i[n.id]=s-Number(l)*o.width,s+=(l?-1:1)*o.width}),i}),Nj=tm([ap,Kb,(e,t)=>{var n=Kb(e,t);if(null!=n)return wj(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(null!=t){var a=null===n||void 0===n?void 0:n[r];return null==a?{x:e.left,y:0}:{x:e.left,y:a}}}),_j=tm([ap,$b,(e,t)=>{var n=$b(e,t);if(null!=n)return jj(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(null!=t){var a=null===n||void 0===n?void 0:n[r];return null==a?{x:0,y:e.top}:{x:a,y:e.top}}}),Sj=tm(ap,$b,(e,t)=>({width:"number"===typeof t.width?t.width:60,height:e.height})),kj=(e,t,n)=>{switch(t){case"xAxis":return bj(e,n).width;case"yAxis":return Sj(e,n).height;default:return}},Ej=(e,t,n,r)=>{if(null!=n){var{allowDuplicatedCategory:a,type:s,dataKey:i}=n,o=Rm(e,r),l=t.map(e=>e.value);return i&&o&&"category"===s&&a&&uc(l)?l:void 0}},Aj=tm([gp,fw,Zb,Ob],Ej),Cj=(e,t,n,r)=>{if(null!=n&&null!=n.dataKey){var{type:a,scale:s}=n;return!Rm(e,r)||"number"!==a&&"auto"===s?void 0:t.map(e=>e.value)}},Dj=tm([gp,fw,ew,Ob],Cj),Tj=tm([gp,(e,t,n)=>{switch(t){case"xAxis":return Kb(e,n);case"yAxis":return $b(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},Zw,mj,Aj,Dj,uj,nj,Ob],(e,t,n,r,a,s,i,o,l)=>{if(null==t)return null;var c=Rm(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:s,duplicateDomain:a,isCategorical:c,niceTicks:o,range:i,realScaleType:n,scale:r}}),Oj=tm([gp,ew,Zw,mj,nj,uj,Aj,Dj,Ob],(e,t,n,r,a,s,i,o,l)=>{if(null!=t&&null!=r){var c=Rm(e,l),{type:d,ticks:u,tickCount:h}=t,m="scaleBand"===n&&"function"===typeof r.bandwidth?r.bandwidth()/2:2,p="category"===d&&r.bandwidth?r.bandwidth()/m:0;p="angleAxis"===l&&null!=s&&s.length>=2?2*rc(s[0]-s[1])*p:p;var f=u||a;return f?f.map((e,t)=>{var n=i?i.indexOf(e):e;return{index:t,coordinate:r(n)+p,value:e,offset:p}}).filter(e=>!ac(e.coordinate)):c&&o?o.map((e,t)=>({coordinate:r(e)+p,value:e,index:t,offset:p})):r.ticks?r.ticks(h).map(e=>({coordinate:r(e)+p,value:e,offset:p})):r.domain().map((e,t)=>({coordinate:r(e)+p,value:i?i[e]:e,index:t,offset:p}))}}),Pj=tm([gp,ew,mj,uj,Aj,Dj,Ob],(e,t,n,r,a,s,i)=>{if(null!=t&&null!=n&&null!=r&&r[0]!==r[1]){var o=Rm(e,i),{tickCount:l}=t,c=0;return c="angleAxis"===i&&(null===r||void 0===r?void 0:r.length)>=2?2*rc(r[0]-r[1])*c:c,o&&s?s.map((e,t)=>({coordinate:n(e)+c,value:e,index:t,offset:c})):n.ticks?n.ticks(l).map(e=>({coordinate:n(e)+c,value:e,offset:c})):n.domain().map((e,t)=>({coordinate:n(e)+c,value:a?a[e]:e,index:t,offset:c}))}}),Ij=tm(Zb,mj,(e,t)=>{if(null!=e&&null!=t)return qb(qb({},e),{},{scale:t})}),Rj=tm([Zb,Zw,Jw,hj],ej),Mj=(tm((e,t,n)=>Xb(e,n),Rj,(e,t)=>{if(null!=e&&null!=t)return qb(qb({},e),{},{scale:t})}),tm([gp,Zm,ep],(e,t,n)=>{switch(e){case"horizontal":return t.some(e=>e.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(e=>e.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}})),Lj=e=>e.options.defaultTooltipEventType,Fj=e=>e.options.validateTooltipEventTypes;function Uj(e,t,n){if(null==e)return t;var r=e?"axis":"item";return null==n?t:n.includes(r)?r:t}function Bj(e,t){return Uj(t,Lj(e),Fj(e))}var zj=(e,t)=>{var n,r=Number(t);if(!ac(r)&&null!=t)return r>=0?null===e||void 0===e||null===(n=e[r])||void 0===n?void 0:n.value:void 0};function qj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Vj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qj(Object(n),!0).forEach(function(t){Hj(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qj(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Hj(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wj=(e,t,n,r)=>{if(null==t)return Nh;var a=function(e,t,n){return"axis"===t?"click"===n?e.axisInteraction.click:e.axisInteraction.hover:"click"===n?e.itemInteraction.click:e.itemInteraction.hover}(e,t,n);if(null==a)return Nh;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&null!=e.syncInteraction.index)return e.syncInteraction;var s=!0===e.settings.active;if(null!=a.index){if(s)return Vj(Vj({},a),{},{active:!0})}else if(null!=r)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return Vj(Vj({},Nh),{},{coordinate:a.coordinate})},Gj=(e,t)=>{var n=null===e||void 0===e?void 0:e.index;if(null==n)return null;var r=Number(n);if(!Ov(r))return n;var a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(0,Math.min(r,a)))},Kj=(e,t,n,r,a,s,i,o)=>{if(null!=s&&null!=o){var l=i[0],c=null==l?void 0:o(l.positions,s);if(null!=c)return c;var d=null===a||void 0===a?void 0:a[Number(s)];if(d)return"horizontal"===n?{x:d.coordinate,y:(r.top+t)/2}:{x:(r.left+e)/2,y:d.coordinate}}},Qj=(e,t,n,r)=>{return"axis"===t?e.tooltipItemPayloads:0===e.tooltipItemPayloads.length?[]:null==(a="hover"===n?e.itemInteraction.hover.dataKey:e.itemInteraction.click.dataKey)&&null!=r?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(e=>{var t;return(null===(t=e.settings)||void 0===t?void 0:t.dataKey)===a});var a},Yj=e=>e.options.tooltipPayloadSearcher,$j=e=>e.tooltip;function Jj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Xj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jj(Object(n),!0).forEach(function(t){Zj(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jj(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Zj(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eN=(e,t,n,r,a,s,i)=>{if(null!=t&&null!=s){var{chartData:o,computedData:l,dataStartIndex:c,dataEndIndex:d}=n;return e.reduce((e,n)=>{var u,h,m,{dataDefinedOnItem:p,settings:f}=n,g=function(e,t){return null!=e?e:t}(p,o),y=Array.isArray(g)?Dm(g,c,d):g,x=null!==(u=null===f||void 0===f?void 0:f.dataKey)&&void 0!==u?u:r,v=null===f||void 0===f?void 0:f.nameKey;(h=r&&Array.isArray(y)&&!Array.isArray(y[0])&&"axis"===i?mc(y,r,a):s(y,t,l,v),Array.isArray(h))?h.forEach(t=>{var n=Xj(Xj({},f),{},{name:t.name,unit:t.unit,color:void 0,fill:void 0});e.push(Km({tooltipEntrySettings:n,dataKey:t.dataKey,payload:t.payload,value:Im(t.payload,t.dataKey),name:t.name}))}):e.push(Km({tooltipEntrySettings:f,dataKey:x,payload:h,value:Im(h,x),name:null!==(m=Im(h,v))&&void 0!==m?m:null===f||void 0===f?void 0:f.name}));return e},[])}},tN=tm([Lb,gp,tw,sb,Rb],Xw),nN=tm([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),rN=tm([Rb,Mb],nw),aN=tm([nN,Lb,rN],sw),sN=tm([aN],e=>e.filter(Bb)),iN=tm([aN],dw),oN=tm([iN,Cv],hw),lN=tm([sN,Cv,Lb],Ub),cN=tm([oN,Lb,aN],pw),dN=tm([Lb],Dw),uN=tm([aN],e=>e.filter(Bb)),hN=tm([lN,uN,ab],bw),mN=tm([hN,Cv,Rb],jw),pN=tm([aN],lw),fN=tm([oN,Lb,pN,Sw,Rb],_w),gN=tm([Ow,Rb,Mb],Pw),yN=tm([gN,Rb],Uw),xN=tm([Rw,Rb,Mb],Pw),vN=tm([xN,Rb],zw),bN=tm([Lw,Rb,Mb],Pw),wN=tm([bN,Rb],Vw),jN=tm([yN,wN,vN],Tw),NN=tm([Lb,dN,mN,fN,jN,gp,Rb],Kw),_N=tm([Lb,gp,oN,cN,ab,Rb,NN],$w),SN=tm([_N,Lb,tN],tj),kN=tm([Lb,_N,SN,Rb],rj),EN=e=>{var t=Rb(e),n=Mb(e);return uj(e,t,n,!1)},AN=tm([Lb,EN],xb),CN=tm([Lb,tN,kN,AN],ej),DN=tm([gp,cN,Lb,Rb],Ej),TN=tm([gp,cN,Lb,Rb],Cj),ON=tm([gp,Lb,tN,CN,EN,DN,TN,Rb],(e,t,n,r,a,s,i,o)=>{if(t){var{type:l}=t,c=Rm(e,o);if(r){var d="scaleBand"===n&&r.bandwidth?r.bandwidth()/2:2,u="category"===l&&r.bandwidth?r.bandwidth()/d:0;return u="angleAxis"===o&&null!=a&&(null===a||void 0===a?void 0:a.length)>=2?2*rc(a[0]-a[1])*u:u,c&&i?i.map((e,t)=>({coordinate:r(e)+u,value:e,index:t,offset:u})):r.domain().map((e,t)=>({coordinate:r(e)+u,value:s?s[e]:e,index:t,offset:u}))}}}),PN=tm([Lj,Fj,e=>e.tooltip.settings],(e,t,n)=>Uj(n.shared,e,t)),IN=e=>e.tooltip.settings.trigger,RN=e=>e.tooltip.settings.defaultIndex,MN=tm([$j,PN,IN,RN],Wj),LN=tm([MN,oN],Gj),FN=tm([ON,LN],zj),UN=tm([MN],e=>{if(e)return e.dataKey}),BN=tm([$j,PN,IN,RN],Qj),zN=tm([Ym,$m,gp,ap,ON,RN,BN,Yj],Kj),qN=tm([MN,zN],(e,t)=>null!==e&&void 0!==e&&e.coordinate?e.coordinate:t),VN=tm([MN],e=>e.active),HN=tm([BN,LN,Cv,Fb,FN,Yj,PN],eN),WN=tm([HN],e=>{if(null!=e){var t=e.map(e=>e.payload).filter(e=>null!=e);return Array.from(new Set(t))}}),GN=(e,t)=>t,KN=(e,t,n)=>n,QN=(e,t,n,r)=>r,YN=tm(ON,e=>hm()(e,e=>e.coordinate)),$N=tm([$j,GN,KN,QN],Wj),JN=tm([$N,oN],Gj),XN=tm([$j,GN,KN,QN],Qj),ZN=tm([Ym,$m,gp,ap,ON,QN,XN,Yj],Kj),e_=tm([$N,ZN],(e,t)=>{var n;return null!==(n=e.coordinate)&&void 0!==n?n:t}),t_=tm(ON,JN,zj),n_=tm([XN,JN,Cv,Fb,t_,Yj,GN],eN),r_=tm([$N],e=>({isActive:e.active,activeIndex:e.index})),a_=tm([(e,t)=>t,gp,Tb,Rb,AN,ON,YN,ap],(e,t,n,r,a,s,i,o)=>{if(e&&t&&r&&a&&s){var l=function(e,t,n,r,a){return"horizontal"===n||"vertical"===n?e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height?{x:e,y:t}:null:r?Cm({x:e,y:t},r):null}(e.chartX,e.chartY,t,n,o);if(l){var c=((e,t)=>"horizontal"===t?e.x:"vertical"===t?e.y:"centric"===t?e.angle:e.radius)(l,t),d=((e,t,n,r,a)=>{var s,i=-1,o=null!==(s=null===t||void 0===t?void 0:t.length)&&void 0!==s?s:0;if(o<=1||null==e)return 0;if("angleAxis"===r&&null!=a&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c=l>0?n[l-1].coordinate:n[o-1].coordinate,d=n[l].coordinate,u=l>=o-1?n[0].coordinate:n[l+1].coordinate,h=void 0;if(rc(d-c)!==rc(u-d)){var m=[];if(rc(u-d)===rc(a[1]-a[0])){h=u;var p=d+a[1]-a[0];m[0]=Math.min(p,(p+c)/2),m[1]=Math.max(p,(p+c)/2)}else{h=c;var f=u+a[1]-a[0];m[0]=Math.min(d,(f+d)/2),m[1]=Math.max(d,(f+d)/2)}var g=[Math.min(d,(h+d)/2),Math.max(d,(h+d)/2)];if(e>g[0]&&e<=g[1]||e>=m[0]&&e<=m[1]){({index:i}=n[l]);break}}else{var y=Math.min(c,u),x=Math.max(c,u);if(e>(y+d)/2&&e<=(x+d)/2){({index:i}=n[l]);break}}}else if(t)for(var v=0;v<o;v++)if(0===v&&e<=(t[v].coordinate+t[v+1].coordinate)/2||v>0&&v<o-1&&e>(t[v].coordinate+t[v-1].coordinate)/2&&e<=(t[v].coordinate+t[v+1].coordinate)/2||v===o-1&&e>(t[v].coordinate+t[v-1].coordinate)/2){({index:i}=t[v]);break}return i})(c,i,s,r,a),u=((e,t,n,r)=>{var a=t.find(e=>e&&e.index===n);if(a){if("horizontal"===e)return{x:a.coordinate,y:r.y};if("vertical"===e)return{x:r.x,y:a.coordinate};if("centric"===e){var s=a.coordinate,{radius:i}=r;return Om(Om(Om({},r),km(r.cx,r.cy,i,s)),{},{angle:s,radius:i})}var o=a.coordinate,{angle:l}=r;return Om(Om(Om({},r),km(r.cx,r.cy,o,l)),{},{angle:l,radius:o})}return{x:0,y:0}})(t,s,d,l);return{activeIndex:String(d),activeCoordinate:u}}}}),s_=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,r=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/r)}},i_=Sd("mouseClick"),o_=xu();o_.startListening({actionCreator:i_,effect:(e,t)=>{var n=e.payload,r=a_(t.getState(),s_(n));null!=(null===r||void 0===r?void 0:r.activeIndex)&&t.dispatch(Ph({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var l_=Sd("mouseMove"),c_=xu();function d_(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}function u_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u_(Object(n),!0).forEach(function(t){m_(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function m_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}c_.startListening({actionCreator:l_,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=Bj(r,r.tooltip.settings.shared),s=a_(r,s_(n));"axis"===a&&(null!=(null===s||void 0===s?void 0:s.activeIndex)?t.dispatch(Oh({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate})):t.dispatch(Dh()))}});var p_=Ud({name:"cartesianAxis",initialState:{xAxis:{},yAxis:{},zAxis:{}},reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:n,width:r}=t.payload;e.yAxis[n]&&(e.yAxis[n]=h_(h_({},e.yAxis[n]),{},{width:r}))}}}),{addXAxis:f_,removeXAxis:g_,addYAxis:y_,removeYAxis:x_,addZAxis:v_,removeZAxis:b_,updateYAxisWidth:w_}=p_.actions,j_=p_.reducer,N_=Ud({name:"graphicalItems",initialState:{cartesianItems:[],polarItems:[]},reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:n,next:r}=t.payload,a=vd(e).cartesianItems.indexOf(n);a>-1&&(e.cartesianItems[a]=r)},removeCartesianGraphicalItem(e,t){var n=vd(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var n=vd(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)}}}),{addCartesianGraphicalItem:__,replaceCartesianGraphicalItem:S_,removeCartesianGraphicalItem:k_,addPolarGraphicalItem:E_,removePolarGraphicalItem:A_}=N_.actions,C_=N_.reducer,D_=Ud({name:"referenceElements",initialState:{dots:[],areas:[],lines:[]},reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=vd(e).dots.findIndex(e=>e===t.payload);-1!==n&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=vd(e).areas.findIndex(e=>e===t.payload);-1!==n&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=vd(e).lines.findIndex(e=>e===t.payload);-1!==n&&e.lines.splice(n,1)}}}),{addDot:T_,removeDot:O_,addArea:P_,removeArea:I_,addLine:R_,removeLine:M_}=D_.actions,L_=D_.reducer,F_={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},U_=Ud({name:"brush",initialState:F_,reducers:{setBrushSettings:(e,t)=>null==t.payload?F_:t.payload}}),{setBrushSettings:B_}=U_.actions,z_=U_.reducer,q_=Ud({name:"legend",initialState:{settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var n=vd(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)}}}),{setLegendSize:V_,setLegendSettings:H_,addLegendPayload:W_,removeLegendPayload:G_}=q_.actions,K_=q_.reducer,Q_={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},Y_=Ud({name:"rootProps",initialState:Q_,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=null!==(n=t.payload.barGap)&&void 0!==n?n:Q_.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),$_=Y_.reducer,{updateOptions:J_}=Y_.actions,X_=Ud({name:"polarAxis",initialState:{radiusAxis:{},angleAxis:{}},reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Z_,removeRadiusAxis:eS,addAngleAxis:tS,removeAngleAxis:nS}=X_.actions,rS=X_.reducer,aS=Ud({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:sS}=aS.actions,iS=aS.reducer,oS=Sd("keyDown"),lS=Sd("focus"),cS=xu();cS.startListening({actionCreator:oS,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip,a=e.payload;if("ArrowRight"===a||"ArrowLeft"===a||"Enter"===a){var s=Number(Gj(r,oN(n))),i=ON(n);if("Enter"!==a){var o=s+("ArrowRight"===a?1:-1)*("left-to-right"===Mj(n)?1:-1);if(!(null==i||o>=i.length||o<0)){var l=ZN(n,"axis","hover",String(o));t.dispatch(Rh({active:!0,activeIndex:o.toString(),activeDataKey:void 0,activeCoordinate:l}))}}else{var c=ZN(n,"axis","hover",String(r.index));t.dispatch(Rh({active:!r.active,activeIndex:r.index,activeDataKey:r.dataKey,activeCoordinate:c}))}}}}}),cS.startListening({actionCreator:lS,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&null==r.index){var a=ZN(n,"axis","hover",String("0"));t.dispatch(Rh({activeDataKey:void 0,active:!0,activeIndex:"0",activeCoordinate:a}))}}}});var dS=Sd("externalEvent"),uS=xu();uS.startListening({actionCreator:dS,effect:(e,t)=>{if(null!=e.payload.handler){var n=t.getState(),r={activeCoordinate:qN(n),activeDataKey:UN(n),activeIndex:LN(n),activeLabel:FN(n),activeTooltipIndex:LN(n),isTooltipActive:VN(n)};e.payload.handler(r,e.payload.reactEvent)}}});var hS=tm([$j],e=>e.tooltipItemPayloads),mS=tm([hS,Yj,(e,t,n)=>t,(e,t,n)=>n],(e,t,n,r)=>{var a=e.find(e=>e.settings.dataKey===r);if(null!=a){var{positions:s}=a;if(null!=s)return t(s,n)}}),pS=Sd("touchMove"),fS=xu();fS.startListening({actionCreator:pS,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=Bj(r,r.tooltip.settings.shared);if("axis"===a){var s=a_(r,s_({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));null!=(null===s||void 0===s?void 0:s.activeIndex)&&t.dispatch(Oh({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if("item"===a){var i,o=n.touches[0],l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute("data-recharts-item-index"),d=null!==(i=l.getAttribute("data-recharts-item-data-key"))&&void 0!==i?i:void 0,u=mS(t.getState(),c,d);t.dispatch(Ah({activeDataKey:d,activeIndex:c,activeCoordinate:u}))}}});var gS=Ud({name:"errorBars",initialState:{},reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]||(e[n]=[]),e[n].push(r)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:r,next:a}=t.payload;e[n]&&(e[n]=e[n].map(e=>e.dataKey===r.dataKey&&e.direction===r.direction?a:e))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]&&(e[n]=e[n].filter(e=>e.dataKey!==r.dataKey||e.direction!==r.direction))}}}),{addErrorBar:yS,replaceErrorBar:xS,removeErrorBar:vS}=gS.actions,bS=gS.reducer,wS=!1,jS=!("undefined"!==typeof window&&window.document&&Boolean(window.document.createElement)&&window.setTimeout),NS=Ec({brush:z_,cartesianAxis:j_,chartData:zh,errorBars:bS,graphicalItems:C_,layout:Kh,legend:K_,options:ju,polarAxis:rS,polarOptions:iS,referenceElements:L_,rootProps:$_,tooltip:Mh});function _S(e){var{preloadedState:t,children:n,reduxStoreName:a}=e,s=lp(),i=(0,r.useRef)(null);if(s)return n;null==i.current&&(i.current=function(e){return Od({reducer:NS,preloadedState:e,middleware:e=>e({serializableCheck:!1}).concat([o_.middleware,c_.middleware,cS.middleware,uS.middleware,fS.middleware]),devTools:wS&&{serialize:{replacer:d_},name:"recharts-".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Chart")}})}(t,a));var o=am;return r.createElement(Iu,{context:o,store:i.current},n)}var SS=e=>{var{chartData:t}=e,n=im(),a=lp();return(0,r.useEffect)(()=>a?()=>{}:(n(Fh(t)),()=>{n(Fh(void 0))}),[t,n,a]),null};function kS(e){var{layout:t,width:n,height:a,margin:s}=e,i=im(),o=lp();return(0,r.useEffect)(()=>{o||(i(Hh(t)),i(Wh({width:n,height:a})),i(Vh(s)))},[i,o,t,n,a,s]),null}function ES(e){var t=im();return(0,r.useEffect)(()=>{t(J_(e))},[t,e]),null}var AS=()=>dm(e=>e.rootProps.accessibilityLayer),CS=n(2086),DS=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function TS(e){return"string"===typeof e&&DS.includes(e)}var OS=["points","pathLength"],PS={svg:["viewBox","children"],polygon:OS,polyline:OS},IS=(e,t)=>{if(!e||"function"===typeof e||"boolean"===typeof e)return null;var n=e;if((0,r.isValidElement)(e)&&(n=e.props),"object"!==typeof n&&"function"!==typeof n)return null;var a={};return Object.keys(n).forEach(e=>{TS(e)&&(a[e]=t||(t=>n[e](n,t)))}),a},RS=(e,t,n)=>{if(null===e||"object"!==typeof e&&"function"!==typeof e)return null;var r=null;return Object.keys(e).forEach(a=>{var s=e[a];TS(a)&&"function"===typeof s&&(r||(r={}),r[a]=((e,t,n)=>r=>(e(t,n,r),null))(s,t,n))}),r},MS=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function LS(e){return"string"===typeof e&&MS.includes(e)}function FS(e){var t=Object.entries(e).filter(e=>{var[t]=e;return LS(t)});return Object.fromEntries(t)}var US=e=>"string"===typeof e?e:e?e.displayName||e.name||"Component":"",BS=null,zS=null,qS=e=>{if(e===BS&&Array.isArray(zS))return zS;var t=[];return r.Children.forEach(e,e=>{pc(e)||((0,CS.isFragment)(e)?t=t.concat(qS(e.props.children)):t.push(e))}),zS=t,BS=e,t};var VS=e=>!e||"object"!==typeof e||!("clipDot"in e)||Boolean(e.clipDot),HS=(e,t,n)=>{if(!e||"function"===typeof e||"boolean"===typeof e)return null;var a=e;if((0,r.isValidElement)(e)&&(a=e.props),"object"!==typeof a&&"function"!==typeof a)return null;var s={};return Object.keys(a).forEach(e=>{var r;((e,t,n,r)=>{var a;if("symbol"===typeof t||"number"===typeof t)return!0;var s=null!==(a=r&&(null===PS||void 0===PS?void 0:PS[r]))&&void 0!==a?a:[],i=t.startsWith("data-"),o="function"!==typeof e&&(Boolean(r)&&s.includes(t)||LS(t)),l=Boolean(n)&&TS(t);return i||o||l})(null===(r=a)||void 0===r?void 0:r[e],e,t,n)&&(s[e]=a[e])}),s},WS=["children","width","height","viewBox","className","style","title","desc"];function GS(){return GS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GS.apply(null,arguments)}var KS=(0,r.forwardRef)((e,t)=>{var{children:n,width:a,height:s,viewBox:i,className:o,style:l,title:c,desc:d}=e,u=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,WS),h=i||{width:a,height:s,x:0,y:0},m=Xl("recharts-surface",o);return r.createElement("svg",GS({},HS(u,!0,"svg"),{className:m,width:a,height:s,style:l,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),r.createElement("title",null,c),r.createElement("desc",null,d),n)}),QS=["children"];function YS(){return YS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YS.apply(null,arguments)}var $S={width:"100%",height:"100%"},JS=(0,r.forwardRef)((e,t)=>{var n=pp(),a=fp(),s=AS();if(!Pv(n)||!Pv(a))return null;var i,o,{children:l,otherAttributes:c,title:d,desc:u}=e;return i="number"===typeof c.tabIndex?c.tabIndex:s?0:void 0,o="string"===typeof c.role?c.role:s?"application":void 0,r.createElement(KS,YS({},c,{title:d,desc:u,role:o,tabIndex:i,width:n,height:a,style:$S,ref:t}),l)}),XS=e=>{var{children:t}=e,n=dm(dp);if(!n)return null;var{width:a,height:s,y:i,x:o}=n;return r.createElement(KS,{width:a,height:s,x:o,y:i},t)},ZS=(0,r.forwardRef)((e,t)=>{var{children:n}=e,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,QS);return lp()?r.createElement(XS,null,n):r.createElement(JS,YS({ref:t},a),n)});var ek=new(n(7283)),tk="recharts.syncEvent.tooltip",nk="recharts.syncEvent.brush";function rk(e){return e.tooltip.syncInteraction}var ak=["x","y"];function sk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ik(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sk(Object(n),!0).forEach(function(t){ok(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ok(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lk=()=>{};function ck(){var e=dm(ib),t=dm(lb),n=im(),a=dm(ob),s=dm(ON),i=yp(),o=up(),l=dm(e=>e.rootProps.className);(0,r.useEffect)(()=>{if(null==e)return lk;var r=(r,l,c)=>{var d;if(t!==c&&e===r)if("index"!==a){if(null!=s){var u;if("function"===typeof a){var h={activeTooltipIndex:null==l.payload.index?void 0:Number(l.payload.index),isTooltipActive:l.payload.active,activeIndex:null==l.payload.index?void 0:Number(l.payload.index),activeLabel:l.payload.label,activeDataKey:l.payload.dataKey,activeCoordinate:l.payload.coordinate},m=a(s,h);u=s[m]}else"value"===a&&(u=s.find(e=>String(e.value)===l.payload.label));var{coordinate:p}=l.payload;if(null!=u&&!1!==l.payload.active&&null!=p&&null!=o){var{x:f,y:g}=p,y=Math.min(f,o.x+o.width),x=Math.min(g,o.y+o.height),v={x:"horizontal"===i?u.coordinate:y,y:"horizontal"===i?x:u.coordinate},b=Ih({active:l.payload.active,coordinate:v,dataKey:l.payload.dataKey,index:String(u.index),label:l.payload.label});n(b)}else n(Ih({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}))}}else if(o&&null!==l&&void 0!==l&&null!==(d=l.payload)&&void 0!==d&&d.coordinate){var w=l.payload.coordinate,{x:j,y:N}=w,_=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(w,ak),S=ik(ik(ik({},_),"number"===typeof j&&{x:Math.max(o.x,Math.min(j,o.x+o.width))}),"number"===typeof N&&{y:Math.max(o.y,Math.min(N,o.y+o.height))}),k=ik(ik({},l),{},{payload:ik(ik({},l.payload),{},{coordinate:S})});n(k)}else n(l)};return ek.on(tk,r),()=>{ek.off(tk,r)}},[l,n,t,e,a,s,i,o])}function dk(){var e=im();(0,r.useEffect)(()=>{e(Nu())},[e]),ck(),function(){var e=dm(ib),t=dm(lb),n=im();(0,r.useEffect)(()=>{if(null==e)return lk;var r=(r,a,s)=>{t!==s&&e===r&&n(Uh(a))};return ek.on(nk,r),()=>{ek.off(nk,r)}},[n,t,e])}()}function uk(e,t,n,a,s,i){var o=dm(n=>((e,t,n)=>{if(null!=t){var r=$j(e);return"axis"===t?"hover"===n?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:"hover"===n?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}})(n,e,t)),l=dm(lb),c=dm(ib),d=dm(ob),u=dm(rk),h=null===u||void 0===u?void 0:u.active;(0,r.useEffect)(()=>{if(!h&&null!=c&&null!=l){var e=Ih({active:i,coordinate:n,dataKey:o,index:s,label:"number"===typeof a?String(a):a});ek.emit(tk,c,e,l)}},[h,n,o,s,a,l,c,d,i])}var hk=(0,r.createContext)(null),mk=(0,r.createContext)(null);function pk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pk(Object(n),!0).forEach(function(t){gk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function gk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yk=(0,r.forwardRef)((e,t)=>{var{children:n,className:a,height:s,onClick:i,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,onMouseMove:h,onMouseUp:m,onTouchEnd:p,onTouchMove:f,onTouchStart:g,style:y,width:x}=e,v=im(),[b,w]=(0,r.useState)(null),[j,N]=(0,r.useState)(null);dk();var _=function(){var e=im(),[t,n]=(0,r.useState)(null),a=dm(Jm);return(0,r.useEffect)(()=>{if(null!=t){var n=t.getBoundingClientRect().width/t.offsetWidth;Ov(n)&&n!==a&&e(Gh(n))}},[t,e,a]),n}(),S=(0,r.useCallback)(e=>{_(e),"function"===typeof t&&t(e),w(e),N(e)},[_,t,w,N]),k=(0,r.useCallback)(e=>{v(i_(e)),v(dS({handler:i,reactEvent:e}))},[v,i]),E=(0,r.useCallback)(e=>{v(l_(e)),v(dS({handler:d,reactEvent:e}))},[v,d]),A=(0,r.useCallback)(e=>{v(Dh()),v(dS({handler:u,reactEvent:e}))},[v,u]),C=(0,r.useCallback)(e=>{v(l_(e)),v(dS({handler:h,reactEvent:e}))},[v,h]),D=(0,r.useCallback)(()=>{v(lS())},[v]),T=(0,r.useCallback)(e=>{v(oS(e.key))},[v]),O=(0,r.useCallback)(e=>{v(dS({handler:o,reactEvent:e}))},[v,o]),P=(0,r.useCallback)(e=>{v(dS({handler:l,reactEvent:e}))},[v,l]),I=(0,r.useCallback)(e=>{v(dS({handler:c,reactEvent:e}))},[v,c]),R=(0,r.useCallback)(e=>{v(dS({handler:m,reactEvent:e}))},[v,m]),M=(0,r.useCallback)(e=>{v(dS({handler:g,reactEvent:e}))},[v,g]),L=(0,r.useCallback)(e=>{v(pS(e)),v(dS({handler:f,reactEvent:e}))},[v,f]),F=(0,r.useCallback)(e=>{v(dS({handler:p,reactEvent:e}))},[v,p]);return r.createElement(hk.Provider,{value:b},r.createElement(mk.Provider,{value:j},r.createElement("div",{className:Xl("recharts-wrapper",a),style:fk({position:"relative",cursor:"default",width:x,height:s},y),onClick:k,onContextMenu:O,onDoubleClick:P,onFocus:D,onKeyDown:T,onMouseDown:I,onMouseEnter:E,onMouseLeave:A,onMouseMove:C,onMouseUp:R,onTouchEnd:F,onTouchMove:L,onTouchStart:M,ref:S},n)))}),xk=tm([ap],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),vk=tm([xk,Ym,$m],(e,t,n)=>{if(e&&null!=t&&null!=n)return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),bk=()=>dm(vk),wk=(0,r.createContext)(void 0),jk=e=>{var{children:t}=e,[n]=(0,r.useState)("".concat(cc("recharts"),"-clip")),a=bk();if(null==a)return null;var{x:s,y:i,width:o,height:l}=a;return r.createElement(wk.Provider,{value:n},r.createElement("defs",null,r.createElement("clipPath",{id:n},r.createElement("rect",{x:s,y:i,height:l,width:o}))),t)},Nk=["children","className","width","height","style","compact","title","desc"];var _k=(0,r.forwardRef)((e,t)=>{var{children:n,className:a,width:s,height:i,style:o,compact:l,title:c,desc:d}=e,u=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Nk),h=FS(u);return l?r.createElement(ZS,{otherAttributes:h,title:c,desc:d},n):r.createElement(yk,{className:a,style:o,width:s,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},r.createElement(ZS,{otherAttributes:h,title:c,desc:d,ref:t},r.createElement(jk,null,n)))});function Sk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function kk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ek(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sk(Object(n),!0).forEach(function(t){kk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e),r=t;return Object.keys(t).reduce((e,t)=>(void 0===e[t]&&void 0!==r[t]&&(e[t]=r[t]),e),n)}var Ak=["width","height"];function Ck(){return Ck=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ck.apply(null,arguments)}var Dk={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},Tk=(0,r.forwardRef)(function(e,t){var n,a=Ek(e.categoricalChartProps,Dk),{width:s,height:i}=a,o=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(a,Ak);if(!Pv(s)||!Pv(i))return null;var{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,categoricalChartProps:h}=e,m={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,eventEmitter:void 0};return r.createElement(_S,{preloadedState:{options:m},reduxStoreName:null!==(n=h.id)&&void 0!==n?n:l},r.createElement(SS,{chartData:h.data}),r.createElement(kS,{width:s,height:i,layout:a.layout,margin:a.margin}),r.createElement(ES,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),r.createElement(_k,Ck({},o,{width:s,height:i,ref:t})))}),Ok=["axis"],Pk=(0,r.forwardRef)((e,t)=>r.createElement(Tk,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Ok,tooltipPayloadSearcher:bu,categoricalChartProps:e,ref:t}));function Ik(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Mk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rk(Object(n),!0).forEach(function(t){Lk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Lk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fk=Mk({},{cacheSize:2e3,enableCache:!0}),Uk=new class{constructor(e){Ik(this,"cache",new Map),this.maxSize=e}get(e){var t=this.cache.get(e);return void 0!==t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}}(Fk.cacheSize),Bk={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},zk="recharts_measurement_span";var qk=(e,t)=>{try{var n=document.getElementById(zk);n||((n=document.createElement("span")).setAttribute("id",zk),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,Bk,t),n.textContent="".concat(e);var r=n.getBoundingClientRect();return{width:r.width,height:r.height}}catch(a){return{width:0,height:0}}},Vk=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e||null===e||jS)return{width:0,height:0};if(!Fk.enableCache)return qk(e,t);var n=function(e,t){var n=t.fontSize||"",r=t.fontFamily||"",a=t.fontWeight||"",s=t.fontStyle||"",i=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(r,"|").concat(a,"|").concat(s,"|").concat(i,"|").concat(o)}(e,t),r=Uk.get(n);if(r)return r;var a=qk(e,t);return Uk.set(n,a),a};function Hk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Wk{static create(e){return new Wk(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:t,position:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0!==e){if(n)switch(n){case"start":default:return this.scale(e);case"middle":var r=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+r;case"end":var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}if(t){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}return this.scale(e)}}isInRange(e){var t=this.range(),n=t[0],r=t[t.length-1];return n<=r?e>=n&&e<=r:e>=r&&e<=n}}Hk(Wk,"EPS",1e-4);function Gk(e,t,n){if(t<1)return[];if(1===t&&void 0===n)return e;for(var r=[],a=0;a<e.length;a+=t){if(void 0!==n&&!0!==n(e[a]))return;r.push(e[a])}return r}function Kk(e,t,n){return function(e){var{width:t,height:n}=e,r=function(e){return(e%180+180)%180}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),a=r*Math.PI/180,s=Math.atan(n/t),i=a>s&&a<Math.PI-s?n/Math.sin(a):t/Math.cos(a);return Math.abs(i)}({width:e.width+t.width,height:e.height+t.height},n)}function Qk(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var s=n();return e*(t-e*s/2-r)>=0&&e*(t+e*s/2-a)<=0}function Yk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yk(Object(n),!0).forEach(function(t){Jk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Jk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xk(e,t,n){var r,{tick:a,ticks:s,viewBox:i,minTickGap:o,orientation:l,interval:c,tickFormatter:d,unit:u,angle:h}=e;if(!s||!s.length||!a)return[];if(ic(c)||jS)return null!==(r=function(e,t){return Gk(e,t+1)}(s,ic(c)?c:0))&&void 0!==r?r:[];var m=[],p="top"===l||"bottom"===l?"width":"height",f=u&&"width"===p?Vk(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},g=(e,r)=>{var a="function"===typeof d?d(e.value,r):e.value;return"width"===p?Kk(Vk(a,{fontSize:t,letterSpacing:n}),f,h):Vk(a,{fontSize:t,letterSpacing:n})[p]},y=s.length>=2?rc(s[1].coordinate-s[0].coordinate):1,x=function(e,t,n){var r="width"===n,{x:a,y:s,width:i,height:o}=e;return 1===t?{start:r?a:s,end:r?a+i:s+o}:{start:r?a+i:s+o,end:r?a:s}}(i,y,p);return"equidistantPreserveStart"===c?function(e,t,n,r,a){for(var s,i=(r||[]).slice(),{start:o,end:l}=t,c=0,d=1,u=o,h=function(){var t=null===r||void 0===r?void 0:r[c];if(void 0===t)return{v:Gk(r,d)};var s,i=c,h=()=>(void 0===s&&(s=n(t,i)),s),m=t.coordinate,p=0===c||Qk(e,m,h,u,l);p||(c=0,u=o,d+=1),p&&(u=m+e*(h()/2+a),c+=d)};d<=i.length;)if(s=h())return s.v;return[]}(y,x,g,s,o):(m="preserveStart"===c||"preserveStartEnd"===c?function(e,t,n,r,a,s){var i=(r||[]).slice(),o=i.length,{start:l,end:c}=t;if(s){var d=r[o-1],u=n(d,o-1),h=e*(d.coordinate+e*u/2-c);i[o-1]=d=$k($k({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate}),Qk(e,d.tickCoord,()=>u,l,c)&&(c=d.tickCoord-e*(u/2+a),i[o-1]=$k($k({},d),{},{isShow:!0}))}for(var m=s?o-1:o,p=function(t){var r,s=i[t],o=()=>(void 0===r&&(r=n(s,t)),r);if(0===t){var d=e*(s.coordinate-e*o()/2-l);i[t]=s=$k($k({},s),{},{tickCoord:d<0?s.coordinate-d*e:s.coordinate})}else i[t]=s=$k($k({},s),{},{tickCoord:s.coordinate});Qk(e,s.tickCoord,o,l,c)&&(l=s.tickCoord+e*(o()/2+a),i[t]=$k($k({},s),{},{isShow:!0}))},f=0;f<m;f++)p(f);return i}(y,x,g,s,o,"preserveStartEnd"===c):function(e,t,n,r,a){for(var s=(r||[]).slice(),i=s.length,{start:o}=t,{end:l}=t,c=function(t){var r,c=s[t],d=()=>(void 0===r&&(r=n(c,t)),r);if(t===i-1){var u=e*(c.coordinate+e*d()/2-l);s[t]=c=$k($k({},c),{},{tickCoord:u>0?c.coordinate-u*e:c.coordinate})}else s[t]=c=$k($k({},c),{},{tickCoord:c.coordinate});Qk(e,c.tickCoord,d,o,l)&&(l=c.tickCoord-e*(d()/2+a),s[t]=$k($k({},c),{},{isShow:!0}))},d=i-1;d>=0;d--)c(d);return s}(y,x,g,s,o),m.filter(e=>e.isShow))}function Zk(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}var eE=["children","className"];function tE(){return tE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tE.apply(null,arguments)}var nE=r.forwardRef((e,t)=>{var{children:n,className:a}=e,s=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,eE),i=Xl("recharts-layer",a);return r.createElement("g",tE({className:i},HS(s,!0),{ref:t}),n)}),rE=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,aE=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,sE=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,iE=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,oE={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},lE=Object.keys(oE),cE="NaN";class dE{static parse(e){var t,[,n,r]=null!==(t=iE.exec(e))&&void 0!==t?t:[];return new dE(parseFloat(n),null!==r&&void 0!==r?r:"")}constructor(e,t){this.num=e,this.unit=t,this.num=e,this.unit=t,ac(e)&&(this.unit=""),""===t||sE.test(t)||(this.num=NaN,this.unit=""),lE.includes(t)&&(this.num=function(e,t){return e*oE[t]}(e,t),this.unit="px")}add(e){return this.unit!==e.unit?new dE(NaN,""):new dE(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new dE(NaN,""):new dE(this.num-e.num,this.unit)}multiply(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new dE(NaN,""):new dE(this.num*e.num,this.unit||e.unit)}divide(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new dE(NaN,""):new dE(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ac(this.num)}}function uE(e){if(e.includes(cE))return cE;for(var t=e;t.includes("*")||t.includes("/");){var n,[,r,a,s]=null!==(n=rE.exec(t))&&void 0!==n?n:[],i=dE.parse(null!==r&&void 0!==r?r:""),o=dE.parse(null!==s&&void 0!==s?s:""),l="*"===a?i.multiply(o):i.divide(o);if(l.isNaN())return cE;t=t.replace(rE,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,d,u,h]=null!==(c=aE.exec(t))&&void 0!==c?c:[],m=dE.parse(null!==d&&void 0!==d?d:""),p=dE.parse(null!==h&&void 0!==h?h:""),f="+"===u?m.add(p):m.subtract(p);if(f.isNaN())return cE;t=t.replace(aE,f.toString())}return t}var hE=/\(([^()]*)\)/;function mE(e){var t=e.replace(/\s+/g,"");return t=function(e){for(var t,n=e;null!=(t=hE.exec(n));){var[,r]=t;n=n.replace(hE,uE(r))}return n}(t),t=uE(t)}function pE(e){var t=function(e){try{return mE(e)}catch(t){return cE}}(e.slice(5,-1));return t===cE?"":t}var fE=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],gE=["dx","dy","angle","className","breakAll"];function yE(){return yE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yE.apply(null,arguments)}function xE(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var vE=/[ \f\n\r\t\v\u2028\u2029]+/,bE=e=>{var{children:t,breakAll:n,style:r}=e;try{var a=[];return pc(t)||(a=n?t.toString().split(""):t.toString().split(vE)),{wordsWithComputedWidth:a.map(e=>({word:e,width:Vk(e,r).width})),spaceWidth:n?0:Vk("\xa0",r).width}}catch(s){return null}},wE=e=>[{words:pc(e)?[]:e.toString().split(vE)}],jE=e=>{var{width:t,scaleToFit:n,children:r,style:a,breakAll:s,maxLines:i}=e;if((t||n)&&!jS){var o=bE({breakAll:s,children:r,style:a});if(!o)return wE(r);var{wordsWithComputedWidth:l,spaceWidth:c}=o;return((e,t,n,r,a)=>{var{maxLines:s,children:i,style:o,breakAll:l}=e,c=ic(s),d=i,u=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((e,t)=>{var{word:s,width:i}=t,o=e[e.length-1];if(o&&(null==r||a||o.width+i+n<Number(r)))o.words.push(s),o.width+=i+n;else{var l={words:[s],width:i};e.push(l)}return e},[])},h=u(t),m=e=>e.reduce((e,t)=>e.width>t.width?e:t);if(!c||a)return h;if(!(h.length>s||m(h).width>Number(r)))return h;for(var p,f=e=>{var t=d.slice(0,e),n=bE({breakAll:l,style:o,children:t+"\u2026"}).wordsWithComputedWidth,a=u(n);return[a.length>s||m(a).width>Number(r),a]},g=0,y=d.length-1,x=0;g<=y&&x<=d.length-1;){var v=Math.floor((g+y)/2),b=v-1,[w,j]=f(b),[N]=f(v);if(w||N||(g=v+1),w&&N&&(y=v-1),!w&&N){p=j;break}x++}return p||h})({breakAll:s,children:r,maxLines:i,style:a},l,c,t,n)}return wE(r)},NE="#808080",_E=(0,r.forwardRef)((e,t)=>{var{x:n=0,y:a=0,lineHeight:s="1em",capHeight:i="0.71em",scaleToFit:o=!1,textAnchor:l="start",verticalAnchor:c="end",fill:d=NE}=e,u=xE(e,fE),h=(0,r.useMemo)(()=>jE({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:o,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,o,u.style,u.width]),{dx:m,dy:p,angle:f,className:g,breakAll:y}=u,x=xE(u,gE);if(!oc(n)||!oc(a)||0===h.length)return null;var v,b=n+(ic(m)?m:0),w=a+(ic(p)?p:0);switch(c){case"start":v=pE("calc(".concat(i,")"));break;case"middle":v=pE("calc(".concat((h.length-1)/2," * -").concat(s," + (").concat(i," / 2))"));break;default:v=pE("calc(".concat(h.length-1," * -").concat(s,")"))}var j=[];if(o){var N=h[0].width,{width:_}=u;j.push("scale(".concat(ic(_)?_/N:1,")"))}return f&&j.push("rotate(".concat(f,", ").concat(b,", ").concat(w,")")),j.length&&(x.transform=j.join(" ")),r.createElement("text",yE({},HS(x,!0),{ref:t,x:b,y:w,className:Xl("recharts-text",g),textAnchor:l,fill:d.includes("url")?NE:d}),h.map((e,t)=>{var n=e.words.join(y?"":" ");return r.createElement("tspan",{x:b,dy:0===t?v:s,key:"".concat(n,"-").concat(t)},n)}))});_E.displayName="Text";var SE=["labelRef"];function kE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function EE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kE(Object(n),!0).forEach(function(t){AE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function AE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CE(){return CE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CE.apply(null,arguments)}var DE=(0,r.createContext)(null),TE=e=>{var{x:t,y:n,width:a,height:s,children:i}=e,o=(0,r.useMemo)(()=>({x:t,y:n,width:a,height:s}),[t,n,a,s]);return r.createElement(DE.Provider,{value:o},i)},OE=()=>{var e=(0,r.useContext)(DE),t=up();return e||t},PE=(0,r.createContext)(null),IE=()=>{var e=(0,r.useContext)(PE),t=dm(Tb);return e||t},RE=e=>null!=e&&"function"===typeof e,ME=(e,t,n,a,s)=>{var i,o,{offset:l,className:c}=e,{cx:d,cy:u,innerRadius:h,outerRadius:m,startAngle:p,endAngle:f,clockWise:g}=s,y=(h+m)/2,x=((e,t)=>rc(t-e)*Math.min(Math.abs(t-e),360))(p,f),v=x>=0?1:-1;switch(t){case"insideStart":i=p+v*l,o=g;break;case"insideEnd":i=f-v*l,o=!g;break;case"end":i=f+v*l,o=g;break;default:throw new Error("Unsupported position ".concat(t))}o=x<=0?o:!o;var b=km(d,u,y,i),w=km(d,u,y,i+359*(o?1:-1)),j="M".concat(b.x,",").concat(b.y,"\n    A").concat(y,",").concat(y,",0,1,").concat(o?0:1,",\n    ").concat(w.x,",").concat(w.y),N=pc(e.id)?cc("recharts-radial-line-"):e.id;return r.createElement("text",CE({},a,{dominantBaseline:"central",className:Xl("recharts-radial-bar-label",c)}),r.createElement("defs",null,r.createElement("path",{id:N,d:j})),r.createElement("textPath",{xlinkHref:"#".concat(N)},n))},LE=e=>"cx"in e&&ic(e.cx),FE={offset:5};function UE(e){var t=Ek(e,FE),{viewBox:n,position:a,value:s,children:i,content:o,className:l="",textBreakAll:c,labelRef:d}=t,u=IE(),h=OE(),m=n||("center"===a?h:null!==u&&void 0!==u?u:h);if(!m||pc(s)&&pc(i)&&!(0,r.isValidElement)(o)&&"function"!==typeof o)return null;var p,f=EE(EE({},t),{},{viewBox:m});if((0,r.isValidElement)(o)){var{labelRef:g}=f,y=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(f,SE);return(0,r.cloneElement)(o,y)}if("function"===typeof o){if(p=(0,r.createElement)(o,f),(0,r.isValidElement)(p))return p}else p=(e=>{var{value:t,formatter:n}=e,r=pc(e.children)?t:e.children;return"function"===typeof n?n(r):r})(t);var x=LE(m),v=HS(t,!0);if(x&&("insideStart"===a||"insideEnd"===a||"end"===a))return ME(t,a,p,v,m);var b=x?((e,t,n)=>{var{cx:r,cy:a,innerRadius:s,outerRadius:i,startAngle:o,endAngle:l}=e,c=(o+l)/2;if("outside"===n){var{x:d,y:u}=km(r,a,i+t,c);return{x:d,y:u,textAnchor:d>=r?"start":"end",verticalAnchor:"middle"}}if("center"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"end"};var h=(s+i)/2,{x:m,y:p}=km(r,a,h,c);return{x:m,y:p,textAnchor:"middle",verticalAnchor:"middle"}})(m,t.offset,t.position):((e,t)=>{var n,{parentViewBox:r,offset:a,position:s}=e;null==r||LE(r)||(n=r);var{x:i,y:o,width:l,height:c}=t,d=c>=0?1:-1,u=d*a,h=d>0?"end":"start",m=d>0?"start":"end",p=l>=0?1:-1,f=p*a,g=p>0?"end":"start",y=p>0?"start":"end";if("top"===s)return EE(EE({},{x:i+l/2,y:o-d*a,textAnchor:"middle",verticalAnchor:h}),n?{height:Math.max(o-n.y,0),width:l}:{});if("bottom"===s)return EE(EE({},{x:i+l/2,y:o+c+u,textAnchor:"middle",verticalAnchor:m}),n?{height:Math.max(n.y+n.height-(o+c),0),width:l}:{});if("left"===s){var x={x:i-f,y:o+c/2,textAnchor:g,verticalAnchor:"middle"};return EE(EE({},x),n?{width:Math.max(x.x-n.x,0),height:c}:{})}if("right"===s){var v={x:i+l+f,y:o+c/2,textAnchor:y,verticalAnchor:"middle"};return EE(EE({},v),n?{width:Math.max(n.x+n.width-v.x,0),height:c}:{})}var b=n?{width:l,height:c}:{};return"insideLeft"===s?EE({x:i+f,y:o+c/2,textAnchor:y,verticalAnchor:"middle"},b):"insideRight"===s?EE({x:i+l-f,y:o+c/2,textAnchor:g,verticalAnchor:"middle"},b):"insideTop"===s?EE({x:i+l/2,y:o+u,textAnchor:"middle",verticalAnchor:m},b):"insideBottom"===s?EE({x:i+l/2,y:o+c-u,textAnchor:"middle",verticalAnchor:h},b):"insideTopLeft"===s?EE({x:i+f,y:o+u,textAnchor:y,verticalAnchor:m},b):"insideTopRight"===s?EE({x:i+l-f,y:o+u,textAnchor:g,verticalAnchor:m},b):"insideBottomLeft"===s?EE({x:i+f,y:o+c-u,textAnchor:y,verticalAnchor:h},b):"insideBottomRight"===s?EE({x:i+l-f,y:o+c-u,textAnchor:g,verticalAnchor:h},b):s&&"object"===typeof s&&(ic(s.x)||sc(s.x))&&(ic(s.y)||sc(s.y))?EE({x:i+dc(s.x,l),y:o+dc(s.y,c),textAnchor:"end",verticalAnchor:"end"},b):EE({x:i+l/2,y:o+c/2,textAnchor:"middle",verticalAnchor:"middle"},b)})(t,m);return r.createElement(_E,CE({ref:d,className:Xl("recharts-label",l)},v,b,{breakAll:c}),p)}UE.displayName="Label";var BE=(e,t,n)=>{if(!e)return null;var a={viewBox:t,labelRef:n};return!0===e?r.createElement(UE,CE({key:"label-implicit"},a)):oc(e)?r.createElement(UE,CE({key:"label-implicit",value:e},a)):(0,r.isValidElement)(e)?e.type===UE?(0,r.cloneElement)(e,EE({key:"label-implicit"},a)):r.createElement(UE,CE({key:"label-implicit",content:e},a)):RE(e)?r.createElement(UE,CE({key:"label-implicit",content:e},a)):e&&"object"===typeof e?r.createElement(UE,CE({},e,{key:"label-implicit"},a)):null};function zE(e){var{label:t}=e,n=OE();return BE(t,n)||null}var qE=["axisLine","width","height","className","hide","ticks"],VE=["viewBox"],HE=["viewBox"];function WE(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function GE(){return GE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GE.apply(null,arguments)}function KE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function QE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?KE(Object(n),!0).forEach(function(t){YE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function YE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $E={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function JE(e){var{x:t,y:n,width:a,height:s,orientation:i,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var d=QE(QE(QE({},c),HS(l,!1)),{},{fill:"none"});if("top"===i||"bottom"===i){var u=+("top"===i&&!o||"bottom"===i&&o);d=QE(QE({},d),{},{x1:t,y1:n+u*s,x2:t+a,y2:n+u*s})}else{var h=+("left"===i&&!o||"right"===i&&o);d=QE(QE({},d),{},{x1:t+h*a,y1:n,x2:t+h*a,y2:n+s})}return r.createElement("line",GE({},d,{className:Xl("recharts-cartesian-axis-line",nc()(l,"className"))}))}function XE(e){var t,{option:n,tickProps:a,value:s}=e,i=Xl(a.className,"recharts-cartesian-axis-tick-value");if(r.isValidElement(n))t=r.cloneElement(n,QE(QE({},a),{},{className:i}));else if("function"===typeof n)t=n(QE(QE({},a),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";"boolean"!==typeof n&&(o=Xl(o,null===n||void 0===n?void 0:n.className)),t=r.createElement(_E,GE({},a,{className:o}),s)}return t}function ZE(e){var{ticks:t=[],tick:n,tickLine:a,stroke:s,tickFormatter:i,unit:o,padding:l,tickTextProps:c,orientation:d,mirror:u,x:h,y:m,width:p,height:f,tickSize:g,tickMargin:y,fontSize:x,letterSpacing:v,getTicksConfig:b,events:w}=e,j=Xk(QE(QE({},b),{},{ticks:t}),x,v),N=function(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}(d,u),_=function(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}(d,u),S=FS(b),k=HS(n,!1),E=QE(QE({},S),{},{fill:"none"},HS(a,!1)),A=j.map((e,t)=>{var{line:x,tick:v}=function(e,t,n,r,a,s,i,o,l){var c,d,u,h,m,p,f=o?-1:1,g=e.tickSize||i,y=ic(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":c=d=e.coordinate,p=(u=(h=n+ +!o*a)-f*g)-f*l,m=y;break;case"left":u=h=e.coordinate,m=(c=(d=t+ +!o*r)-f*g)-f*l,p=y;break;case"right":u=h=e.coordinate,m=(c=(d=t+ +o*r)+f*g)+f*l,p=y;break;default:c=d=e.coordinate,p=(u=(h=n+ +o*a)+f*g)+f*l,m=y}return{line:{x1:c,y1:u,x2:d,y2:h},tick:{x:m,y:p}}}(e,h,m,p,f,d,g,u,y),b=QE(QE(QE(QE({textAnchor:N,verticalAnchor:_},S),{},{stroke:"none",fill:s},k),v),{},{index:t,payload:e,visibleTicksCount:j.length,tickFormatter:i,padding:l},c);return r.createElement(nE,GE({className:"recharts-cartesian-axis-tick",key:"tick-".concat(e.value,"-").concat(e.coordinate,"-").concat(e.tickCoord)},RS(w,e,t)),a&&r.createElement("line",GE({},E,x,{className:Xl("recharts-cartesian-axis-tick-line",nc()(a,"className"))})),n&&r.createElement(XE,{option:n,tickProps:b,value:"".concat("function"===typeof i?i(e.value,t):e.value).concat(o||"")}))});return A.length>0?r.createElement("g",{className:"recharts-cartesian-axis-ticks"},A):null}var eA=(0,r.forwardRef)((e,t)=>{var{axisLine:n,width:a,height:s,className:i,hide:o,ticks:l}=e,c=WE(e,qE),[d,u]=(0,r.useState)(""),[h,m]=(0,r.useState)(""),p=(0,r.useRef)([]);(0,r.useImperativeHandle)(t,()=>({getCalculatedWidth:()=>{var t;return(e=>{var{ticks:t,label:n,labelGapWithTick:r=5,tickSize:a=0,tickMargin:s=0}=e,i=0;if(t){t.forEach(e=>{if(e){var t=e.getBoundingClientRect();t.width>i&&(i=t.width)}});var o=n?n.getBoundingClientRect().width:0,l=i+(a+s)+o+(n?r:0);return Math.round(l)}return 0})({ticks:p.current,label:null===(t=e.labelRef)||void 0===t?void 0:t.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var f=(0,r.useCallback)(e=>{if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=Array.from(t);var n=t[0];if(n){var r=window.getComputedStyle(n),a=r.fontSize,s=r.letterSpacing;a===d&&s===h||(u(a),m(s))}}},[d,h]);return o||null!=a&&a<=0||null!=s&&s<=0?null:r.createElement(nE,{className:Xl("recharts-cartesian-axis",i),ref:f},r.createElement(JE,{x:e.x,y:e.y,width:a,height:s,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:FS(e)}),r.createElement(ZE,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:d,letterSpacing:h,getTicksConfig:e,events:c}),r.createElement(TE,{x:e.x,y:e.y,width:e.width,height:e.height},r.createElement(zE,{label:e.label}),e.children))}),tA=r.memo(eA,(e,t)=>{var{viewBox:n}=e,r=WE(e,VE),{viewBox:a}=t,s=WE(t,HE);return Zk(n,a)&&Zk(r,s)}),nA=r.forwardRef((e,t)=>{var n=Ek(e,$E);return r.createElement(tA,GE({},n,{ref:t}))});nA.displayName="CartesianAxis";var rA=["x1","y1","x2","y2","key"],aA=["offset"],sA=["xAxisId","yAxisId"],iA=["xAxisId","yAxisId"];function oA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oA(Object(n),!0).forEach(function(t){cA(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function cA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dA(){return dA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dA.apply(null,arguments)}function uA(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var hA=e=>{var{fill:t}=e;if(!t||"none"===t)return null;var{fillOpacity:n,x:a,y:s,width:i,height:o,ry:l}=e;return r.createElement("rect",{x:a,y:s,ry:l,width:i,height:o,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function mA(e,t){var n;if(r.isValidElement(e))n=r.cloneElement(e,t);else if("function"===typeof e)n=e(t);else{var{x1:a,y1:s,x2:i,y2:o,key:l}=t,c=FS(uA(t,rA)),{offset:d}=c,u=uA(c,aA);n=r.createElement("line",dA({},u,{x1:a,y1:s,x2:i,y2:o,fill:"none",key:l}))}return n}function pA(e){var{x:t,width:n,horizontal:a=!0,horizontalPoints:s}=e;if(!a||!s||!s.length)return null;var{xAxisId:i,yAxisId:o}=e,l=uA(e,sA),c=s.map((e,r)=>{var s=lA(lA({},l),{},{x1:t,y1:e,x2:t+n,y2:e,key:"line-".concat(r),index:r});return mA(a,s)});return r.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function fA(e){var{y:t,height:n,vertical:a=!0,verticalPoints:s}=e;if(!a||!s||!s.length)return null;var{xAxisId:i,yAxisId:o}=e,l=uA(e,iA),c=s.map((e,r)=>{var s=lA(lA({},l),{},{x1:e,y1:t,x2:e,y2:t+n,key:"line-".concat(r),index:r});return mA(a,s)});return r.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function gA(e){var{horizontalFill:t,fillOpacity:n,x:a,y:s,width:i,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var d=l.map(e=>Math.round(e+s-s)).sort((e,t)=>e-t);s!==d[0]&&d.unshift(0);var u=d.map((e,l)=>{var c=!d[l+1]?s+o-e:d[l+1]-e;if(c<=0)return null;var u=l%t.length;return r.createElement("rect",{key:"react-".concat(l),y:e,x:a,height:c,width:i,stroke:"none",fill:t[u],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return r.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function yA(e){var{vertical:t=!0,verticalFill:n,fillOpacity:a,x:s,y:i,width:o,height:l,verticalPoints:c}=e;if(!t||!n||!n.length)return null;var d=c.map(e=>Math.round(e+s-s)).sort((e,t)=>e-t);s!==d[0]&&d.unshift(0);var u=d.map((e,t)=>{var c=!d[t+1]?s+o-e:d[t+1]-e;if(c<=0)return null;var u=t%n.length;return r.createElement("rect",{key:"react-".concat(t),x:e,y:i,width:c,height:l,stroke:"none",fill:n[u],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return r.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var xA=(e,t)=>{var{xAxis:n,width:r,height:a,offset:s}=e;return Mm(Xk(lA(lA(lA({},$E),n),{},{ticks:Lm(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),s.left,s.left+s.width,t)},vA=(e,t)=>{var{yAxis:n,width:r,height:a,offset:s}=e;return Mm(Xk(lA(lA(lA({},$E),n),{},{ticks:Lm(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),s.top,s.top+s.height,t)},bA={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function wA(e){var t=pp(),n=fp(),a=mp(),s=lA(lA({},Ek(e,bA)),{},{x:ic(e.x)?e.x:a.left,y:ic(e.y)?e.y:a.top,width:ic(e.width)?e.width:a.width,height:ic(e.height)?e.height:a.height}),{xAxisId:i,yAxisId:o,x:l,y:c,width:d,height:u,syncWithTicks:h,horizontalValues:m,verticalValues:p}=s,f=lp(),g=dm(e=>Tj(e,"xAxis",i,f)),y=dm(e=>Tj(e,"yAxis",o,f));if(!ic(d)||d<=0||!ic(u)||u<=0||!ic(l)||l!==+l||!ic(c)||c!==+c)return null;var x=s.verticalCoordinatesGenerator||xA,v=s.horizontalCoordinatesGenerator||vA,{horizontalPoints:b,verticalPoints:w}=s;if((!b||!b.length)&&"function"===typeof v){var j=m&&m.length,N=v({yAxis:y?lA(lA({},y),{},{ticks:j?m:y.ticks}):void 0,width:t,height:n,offset:a},!!j||h);gc(Array.isArray(N),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof N,"]")),Array.isArray(N)&&(b=N)}if((!w||!w.length)&&"function"===typeof x){var _=p&&p.length,S=x({xAxis:g?lA(lA({},g),{},{ticks:_?p:g.ticks}):void 0,width:t,height:n,offset:a},!!_||h);gc(Array.isArray(S),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(w=S)}return r.createElement("g",{className:"recharts-cartesian-grid"},r.createElement(hA,{fill:s.fill,fillOpacity:s.fillOpacity,x:s.x,y:s.y,width:s.width,height:s.height,ry:s.ry}),r.createElement(gA,dA({},s,{horizontalPoints:b})),r.createElement(yA,dA({},s,{verticalPoints:w})),r.createElement(pA,dA({},s,{offset:a,horizontalPoints:b,xAxis:g,yAxis:y})),r.createElement(fA,dA({},s,{offset:a,verticalPoints:w,xAxis:g,yAxis:y})))}wA.displayName="CartesianGrid";var jA=["dangerouslySetInnerHTML","ticks"],NA=["id"],_A=["domain"],SA=["domain"];function kA(){return kA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kA.apply(null,arguments)}function EA(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function AA(e){var t=im();return(0,r.useEffect)(()=>(t(f_(e)),()=>{t(g_(e))}),[e,t]),null}var CA=e=>{var{xAxisId:t,className:n}=e,a=dm(ip),s=lp(),i="xAxis",o=dm(e=>mj(e,i,t,s)),l=dm(e=>Oj(e,i,t,s)),c=dm(e=>bj(e,t)),d=dm(e=>Nj(e,t)),u=dm(e=>Gb(e,t));if(null==c||null==d||null==u)return null;var{dangerouslySetInnerHTML:h,ticks:m}=e,p=EA(e,jA),{id:f}=u,g=EA(u,NA);return r.createElement(nA,kA({},p,g,{scale:o,x:d.x,y:d.y,width:c.width,height:c.height,className:Xl("recharts-".concat(i," ").concat(i),n),viewBox:a,ticks:l}))},DA={allowDataOverflow:Wb.allowDataOverflow,allowDecimals:Wb.allowDecimals,allowDuplicatedCategory:Wb.allowDuplicatedCategory,height:Wb.height,hide:!1,mirror:Wb.mirror,orientation:Wb.orientation,padding:Wb.padding,reversed:Wb.reversed,scale:Wb.scale,tickCount:Wb.tickCount,type:Wb.type,xAxisId:0},TA=e=>{var t,n,a,s,i,o=Ek(e,DA);return r.createElement(r.Fragment,null,r.createElement(AA,{interval:null!==(t=o.interval)&&void 0!==t?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:null!==(n=o.includeHidden)&&void 0!==n&&n,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:null!==(a=o.angle)&&void 0!==a?a:0,minTickGap:null!==(s=o.minTickGap)&&void 0!==s?s:5,tick:null===(i=o.tick)||void 0===i||i,tickFormatter:o.tickFormatter}),r.createElement(CA,o))},OA=(e,t)=>{var{domain:n}=e,r=EA(e,_A),{domain:a}=t;return!!Zk(r,EA(t,SA))&&(Array.isArray(n)&&2===n.length&&Array.isArray(a)&&2===a.length?n[0]===a[0]&&n[1]===a[1]:Zk({domain:n},{domain:a}))},PA=r.memo(TA,OA);PA.displayName="XAxis";var IA=["dangerouslySetInnerHTML","ticks"],RA=["id"],MA=["domain"],LA=["domain"];function FA(){return FA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FA.apply(null,arguments)}function UA(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function BA(e){var t=im();return(0,r.useEffect)(()=>(t(y_(e)),()=>{t(x_(e))}),[e,t]),null}var zA=e=>{var{yAxisId:t,className:n,width:a,label:s}=e,i=(0,r.useRef)(null),o=(0,r.useRef)(null),l=dm(ip),c=lp(),d=im(),u="yAxis",h=dm(e=>mj(e,u,t,c)),m=dm(e=>Sj(e,t)),p=dm(e=>_j(e,t)),f=dm(e=>Oj(e,u,t,c)),g=dm(e=>Yb(e,t));if((0,r.useLayoutEffect)(()=>{if("auto"===a&&m&&!RE(s)&&!(0,r.isValidElement)(s)&&null!=g){var e=i.current;if(e){var n=e.getCalculatedWidth();Math.round(m.width)!==Math.round(n)&&d(w_({id:t,width:n}))}}},[f,m,d,s,t,a,g]),null==m||null==p||null==g)return null;var{dangerouslySetInnerHTML:y,ticks:x}=e,v=UA(e,IA),{id:b}=g,w=UA(g,RA);return r.createElement(nA,FA({},v,w,{ref:i,labelRef:o,scale:h,x:p.x,y:p.y,tickTextProps:"auto"===a?{width:void 0}:{width:a},width:m.width,height:m.height,className:Xl("recharts-".concat(u," ").concat(u),n),viewBox:l,ticks:f}))},qA={allowDataOverflow:Qb.allowDataOverflow,allowDecimals:Qb.allowDecimals,allowDuplicatedCategory:Qb.allowDuplicatedCategory,hide:!1,mirror:Qb.mirror,orientation:Qb.orientation,padding:Qb.padding,reversed:Qb.reversed,scale:Qb.scale,tickCount:Qb.tickCount,type:Qb.type,width:Qb.width,yAxisId:0},VA=e=>{var t,n,a,s,i,o=Ek(e,qA);return r.createElement(r.Fragment,null,r.createElement(BA,{interval:null!==(t=o.interval)&&void 0!==t?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:null!==(n=o.includeHidden)&&void 0!==n&&n,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:null!==(a=o.angle)&&void 0!==a?a:0,minTickGap:null!==(s=o.minTickGap)&&void 0!==s?s:5,tick:null===(i=o.tick)||void 0===i||i,tickFormatter:o.tickFormatter}),r.createElement(zA,o))},HA=(e,t)=>{var{domain:n}=e,r=UA(e,MA),{domain:a}=t;return!!Zk(r,UA(t,LA))&&(Array.isArray(n)&&2===n.length&&Array.isArray(a)&&2===a.length?n[0]===a[0]&&n[1]===a[1]:Zk({domain:n},{domain:a}))},WA=r.memo(VA,HA);WA.displayName="YAxis";var GA=n(7950);function KA(){return KA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KA.apply(null,arguments)}function QA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function YA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?QA(Object(n),!0).forEach(function(t){$A(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $A(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JA(e){return Array.isArray(e)&&oc(e[0])&&oc(e[1])?e.join(" ~ "):e}var XA=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:a={},labelStyle:s={},payload:i,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:d,label:u,labelFormatter:h,accessibilityLayer:m=!1}=e,p=YA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),f=YA({margin:0},s),g=!pc(u),y=g?u:"",x=Xl("recharts-default-tooltip",c),v=Xl("recharts-tooltip-label",d);g&&h&&void 0!==i&&null!==i&&(y=h(u,i));var b=m?{role:"status","aria-live":"assertive"}:{};return r.createElement("div",KA({className:x,style:p},b),r.createElement("p",{className:v,style:f},r.isValidElement(y)?y:"".concat(y)),(()=>{if(i&&i.length){var e=(l?hm()(i,l):i).map((e,n)=>{if("none"===e.type)return null;var s=e.formatter||o||JA,{value:l,name:c}=e,d=l,u=c;if(s){var h=s(l,c,e,n,i);if(Array.isArray(h))[d,u]=h;else{if(null==h)return null;d=h}}var m=YA({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},a);return r.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(n),style:m},oc(u)?r.createElement("span",{className:"recharts-tooltip-item-name"},u):null,oc(u)?r.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,r.createElement("span",{className:"recharts-tooltip-item-value"},d),r.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))});return r.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null})())},ZA="recharts-tooltip-wrapper",eC={visibility:"hidden"};function tC(e){var{coordinate:t,translateX:n,translateY:r}=e;return Xl(ZA,{["".concat(ZA,"-right")]:ic(n)&&t&&ic(t.x)&&n>=t.x,["".concat(ZA,"-left")]:ic(n)&&t&&ic(t.x)&&n<t.x,["".concat(ZA,"-bottom")]:ic(r)&&t&&ic(t.y)&&r>=t.y,["".concat(ZA,"-top")]:ic(r)&&t&&ic(t.y)&&r<t.y})}function nC(e){var{allowEscapeViewBox:t,coordinate:n,key:r,offsetTopLeft:a,position:s,reverseDirection:i,tooltipDimension:o,viewBox:l,viewBoxDimension:c}=e;if(s&&ic(s[r]))return s[r];var d=n[r]-o-(a>0?a:0),u=n[r]+a;if(t[r])return i[r]?d:u;var h=l[r];return null==h?0:i[r]?d<h?Math.max(u,h):Math.max(d,h):null==c?0:u+o>h+c?Math.max(d,h):Math.max(u,h)}function rC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function aC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rC(Object(n),!0).forEach(function(t){sC(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function sC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iC extends r.PureComponent{constructor(){super(...arguments),sC(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),sC(this,"handleKeyDown",e=>{var t,n,r,a;"Escape"===e.key&&this.setState({dismissed:!0,dismissedAtCoordinate:{x:null!==(t=null===(n=this.props.coordinate)||void 0===n?void 0:n.x)&&void 0!==t?t:0,y:null!==(r=null===(a=this.props.coordinate)||void 0===a?void 0:a.y)&&void 0!==r?r:0}})})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,t;this.state.dismissed&&((null===(e=this.props.coordinate)||void 0===e?void 0:e.x)===this.state.dismissedAtCoordinate.x&&(null===(t=this.props.coordinate)||void 0===t?void 0:t.y)===this.state.dismissedAtCoordinate.y||(this.state.dismissed=!1))}render(){var{active:e,allowEscapeViewBox:t,animationDuration:n,animationEasing:a,children:s,coordinate:i,hasPayload:o,isAnimationActive:l,offset:c,position:d,reverseDirection:u,useTranslate3d:h,viewBox:m,wrapperStyle:p,lastBoundingBox:f,innerRef:g,hasPortalFromProps:y}=this.props,{cssClasses:x,cssProperties:v}=function(e){var t,n,r,{allowEscapeViewBox:a,coordinate:s,offsetTopLeft:i,position:o,reverseDirection:l,tooltipBox:c,useTranslate3d:d,viewBox:u}=e;return t=c.height>0&&c.width>0&&s?function(e){var{translateX:t,translateY:n,useTranslate3d:r}=e;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}({translateX:n=nC({allowEscapeViewBox:a,coordinate:s,key:"x",offsetTopLeft:i,position:o,reverseDirection:l,tooltipDimension:c.width,viewBox:u,viewBoxDimension:u.width}),translateY:r=nC({allowEscapeViewBox:a,coordinate:s,key:"y",offsetTopLeft:i,position:o,reverseDirection:l,tooltipDimension:c.height,viewBox:u,viewBoxDimension:u.height}),useTranslate3d:d}):eC,{cssProperties:t,cssClasses:tC({translateX:n,translateY:r,coordinate:s})}}({allowEscapeViewBox:t,coordinate:i,offsetTopLeft:c,position:d,reverseDirection:u,tooltipBox:{height:f.height,width:f.width},useTranslate3d:h,viewBox:m}),b=y?{}:aC(aC({transition:l&&e?"transform ".concat(n,"ms ").concat(a):void 0},v),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&o?"visible":"hidden",position:"absolute",top:0,left:0}),w=aC(aC({},b),{},{visibility:!this.state.dismissed&&e&&o?"visible":"hidden"},p);return r.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:x,style:w,ref:g},s)}}var oC=n(4332),lC=n.n(oC);function cC(e,t,n){return!0===t?lC()(e,n):"function"===typeof t?lC()(e,t):e}var dC,uC,hC,mC,pC,fC,gC,yC,xC,vC,bC,wC,jC,NC;function _C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,n]=(0,r.useState)({height:0,left:0,top:0,width:0}),a=(0,r.useCallback)(e=>{if(null!=e){var r=e.getBoundingClientRect(),a={height:r.height,left:r.left,top:r.top,width:r.width};(Math.abs(a.height-t.height)>1||Math.abs(a.left-t.left)>1||Math.abs(a.top-t.top)>1||Math.abs(a.width-t.width)>1)&&n({height:a.height,left:a.left,top:a.top,width:a.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}function SC(){}function kC(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function EC(e){this._context=e}function AC(e){this._context=e}function CC(e){this._context=e}EC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:kC(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:kC(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},AC.prototype={areaStart:SC,areaEnd:SC,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:kC(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},CC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:kC(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class DC{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function TC(e){this._context=e}function OC(e){this._context=e}function PC(e){return new OC(e)}function IC(e){return e<0?-1:1}function RC(e,t,n){var r=e._x1-e._x0,a=t-e._x1,s=(e._y1-e._y0)/(r||a<0&&-0),i=(n-e._y1)/(a||r<0&&-0),o=(s*a+i*r)/(r+a);return(IC(s)+IC(i))*Math.min(Math.abs(s),Math.abs(i),.5*Math.abs(o))||0}function MC(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function LC(e,t,n){var r=e._x0,a=e._y0,s=e._x1,i=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,a+o*t,s-o,i-o*n,s,i)}function FC(e){this._context=e}function UC(e){this._context=new BC(e)}function BC(e){this._context=e}function zC(e){this._context=e}function qC(e){var t,n,r=e.length-1,a=new Array(r),s=new Array(r),i=new Array(r);for(a[0]=0,s[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,s[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,s[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/s[t-1],s[t]-=n,i[t]-=n*i[t-1];for(a[r-1]=i[r-1]/s[r-1],t=r-2;t>=0;--t)a[t]=(i[t]-a[t+1])/s[t];for(s[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-a[t+1];return[a,s]}function VC(e,t){this._context=e,this._t=t}function HC(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}TC.prototype={areaStart:SC,areaEnd:SC,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},OC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},FC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:LC(this,this._t0,MC(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,LC(this,MC(this,n=RC(this,e,t)),n);break;default:LC(this,this._t0,n=RC(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(UC.prototype=Object.create(FC.prototype)).point=function(e,t){FC.prototype.point.call(this,t,e)},BC.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,s){this._context.bezierCurveTo(t,e,r,n,s,a)}},zC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=qC(e),a=qC(t),s=0,i=1;i<n;++s,++i)this._context.bezierCurveTo(r[0][s],a[0][s],r[1][s],a[1][s],e[i],t[i]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},VC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const WC=Math.PI,GC=2*WC,KC=1e-6,QC=GC-KC;function YC(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class $C{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?YC:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return YC;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(dC||(dC=HC(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(uC||(uC=HC(["Z"]))))}lineTo(e,t){this._append(hC||(hC=HC(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(mC||(mC=HC(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,a,s){this._append(pC||(pC=HC(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+a,this._y1=+s)}arcTo(e,t,n,r,a){if(e=+e,t=+t,n=+n,r=+r,(a=+a)<0)throw new Error("negative radius: ".concat(a));let s=this._x1,i=this._y1,o=n-e,l=r-t,c=s-e,d=i-t,u=c*c+d*d;if(null===this._x1)this._append(fC||(fC=HC(["M",",",""])),this._x1=e,this._y1=t);else if(u>KC)if(Math.abs(d*o-l*c)>KC&&a){let h=n-s,m=r-i,p=o*o+l*l,f=h*h+m*m,g=Math.sqrt(p),y=Math.sqrt(u),x=a*Math.tan((WC-Math.acos((p+u-f)/(2*g*y)))/2),v=x/y,b=x/g;Math.abs(v-1)>KC&&this._append(yC||(yC=HC(["L",",",""])),e+v*c,t+v*d),this._append(xC||(xC=HC(["A",",",",0,0,",",",",",""])),a,a,+(d*h>c*m),this._x1=e+b*o,this._y1=t+b*l)}else this._append(gC||(gC=HC(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,a,s){if(e=+e,t=+t,s=!!s,(n=+n)<0)throw new Error("negative radius: ".concat(n));let i=n*Math.cos(r),o=n*Math.sin(r),l=e+i,c=t+o,d=1^s,u=s?r-a:a-r;null===this._x1?this._append(vC||(vC=HC(["M",",",""])),l,c):(Math.abs(this._x1-l)>KC||Math.abs(this._y1-c)>KC)&&this._append(bC||(bC=HC(["L",",",""])),l,c),n&&(u<0&&(u=u%GC+GC),u>QC?this._append(wC||(wC=HC(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,d,e-i,t-o,n,n,d,this._x1=l,this._y1=c):u>KC&&this._append(jC||(jC=HC(["A",",",",0,",",",",",",",""])),n,n,+(u>=WC),d,this._x1=e+n*Math.cos(a),this._y1=t+n*Math.sin(a)))}rect(e,t,n,r){this._append(NC||(NC=HC(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function JC(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new $C(t)}function XC(e){return e[0]}function ZC(e){return e[1]}function eD(e,t){var n=ym(!0),r=null,a=PC,s=null,i=JC(o);function o(o){var l,c,d,u=(o=gm(o)).length,h=!1;for(null==r&&(s=a(d=i())),l=0;l<=u;++l)!(l<u&&n(c=o[l],l,o))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(c,l,o),+t(c,l,o));if(d)return s=null,d+""||null}return e="function"===typeof e?e:void 0===e?XC:ym(e),t="function"===typeof t?t:void 0===t?ZC:ym(t),o.x=function(t){return arguments.length?(e="function"===typeof t?t:ym(+t),o):e},o.y=function(e){return arguments.length?(t="function"===typeof e?e:ym(+e),o):t},o.defined=function(e){return arguments.length?(n="function"===typeof e?e:ym(!!e),o):n},o.curve=function(e){return arguments.length?(a=e,null!=r&&(s=a(r)),o):a},o.context=function(e){return arguments.length?(null==e?r=s=null:s=a(r=e),o):r},o}function tD(e,t,n){var r=null,a=ym(!0),s=null,i=PC,o=null,l=JC(c);function c(c){var d,u,h,m,p,f=(c=gm(c)).length,g=!1,y=new Array(f),x=new Array(f);for(null==s&&(o=i(p=l())),d=0;d<=f;++d){if(!(d<f&&a(m=c[d],d,c))===g)if(g=!g)u=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),h=d-1;h>=u;--h)o.point(y[h],x[h]);o.lineEnd(),o.areaEnd()}g&&(y[d]=+e(m,d,c),x[d]=+t(m,d,c),o.point(r?+r(m,d,c):y[d],n?+n(m,d,c):x[d]))}if(p)return o=null,p+""||null}function d(){return eD().defined(a).curve(i).context(s)}return e="function"===typeof e?e:void 0===e?XC:ym(+e),t="function"===typeof t?t:ym(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?ZC:ym(+n),c.x=function(t){return arguments.length?(e="function"===typeof t?t:ym(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:ym(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:ym(+e),c):r},c.y=function(e){return arguments.length?(t="function"===typeof e?e:ym(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:ym(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:ym(+e),c):n},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(n)},c.lineX1=function(){return d().x(r).y(t)},c.defined=function(e){return arguments.length?(a="function"===typeof e?e:ym(!!e),c):a},c.curve=function(e){return arguments.length?(i=e,null!=s&&(o=i(s)),c):i},c.context=function(e){return arguments.length?(null==e?s=o=null:o=i(s=e),c):s},c}function nD(){return nD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nD.apply(null,arguments)}function rD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function aD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rD(Object(n),!0).forEach(function(t){sD(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rD(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function sD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var iD={curveBasisClosed:function(e){return new AC(e)},curveBasisOpen:function(e){return new CC(e)},curveBasis:function(e){return new EC(e)},curveBumpX:function(e){return new DC(e,!0)},curveBumpY:function(e){return new DC(e,!1)},curveLinearClosed:function(e){return new TC(e)},curveLinear:PC,curveMonotoneX:function(e){return new FC(e)},curveMonotoneY:function(e){return new UC(e)},curveNatural:function(e){return new zC(e)},curveStep:function(e){return new VC(e,.5)},curveStepAfter:function(e){return new VC(e,1)},curveStepBefore:function(e){return new VC(e,0)}},oD=e=>Ov(e.x)&&Ov(e.y),lD=e=>e.x,cD=e=>e.y,dD=e=>{var t,{type:n="linear",points:r=[],baseLine:a,layout:s,connectNulls:i=!1}=e,o=((e,t)=>{if("function"===typeof e)return e;var n="curve".concat(fc(e));return"curveMonotone"!==n&&"curveBump"!==n||!t?iD[n]||PC:iD["".concat(n).concat("vertical"===t?"Y":"X")]})(n,s),l=i?r.filter(oD):r;if(Array.isArray(a)){var c=i?a.filter(e=>oD(e)):a,d=l.map((e,t)=>aD(aD({},e),{},{base:c[t]}));return(t="vertical"===s?tD().y(cD).x1(lD).x0(e=>e.base.x):tD().x(lD).y1(cD).y0(e=>e.base.y)).defined(oD).curve(o),t(d)}return(t="vertical"===s&&ic(a)?tD().y(cD).x1(lD).x0(a):ic(a)?tD().x(lD).y1(cD).y0(a):eD().x(lD).y(cD)).defined(oD).curve(o),t(l)},uD=e=>{var{className:t,points:n,path:a,pathRef:s}=e;if((!n||!n.length)&&!a)return null;var i=n&&n.length?dD(e):a;return r.createElement("path",nD({},FS(e),IS(e),{className:Xl("recharts-curve",t),d:null===i?void 0:i,ref:s}))},hD=["x","y","top","left","width","height","className"];function mD(){return mD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mD.apply(null,arguments)}function pD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gD=(e,t,n,r,a,s)=>"M".concat(e,",").concat(a,"v").concat(r,"M").concat(s,",").concat(t,"h").concat(n),yD=e=>{var{x:t=0,y:n=0,top:a=0,left:s=0,width:i=0,height:o=0,className:l}=e,c=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,hD),d=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pD(Object(n),!0).forEach(function(t){fD(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pD(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({x:t,y:n,top:a,left:s,width:i,height:o},c);return ic(t)&&ic(n)&&ic(i)&&ic(o)&&ic(a)&&ic(s)?r.createElement("path",mD({},HS(d,!0),{className:Xl("recharts-cross",l),d:gD(t,n,i,o,a,s)})):null};function xD(){}function vD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vD(Object(n),!0).forEach(function(t){wD(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vD(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jD=(e,t,n)=>e.map(e=>{return"".concat((r=e,r.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())))," ").concat(t,"ms ").concat(n);var r}).join(","),ND=(e,t)=>Object.keys(t).reduce((n,r)=>bD(bD({},n),{},{[r]:e(r,t[r])}),{});function _D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function SD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_D(Object(n),!0).forEach(function(t){kD(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function kD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ED=(e,t,n)=>e+(t-e)*n,AD=e=>{var{from:t,to:n}=e;return t!==n},CD=(e,t,n)=>{var r=ND((t,n)=>{if(AD(n)){var[r,a]=e(n.from,n.to,n.velocity);return SD(SD({},n),{},{from:r,velocity:a})}return n},t);return n<1?ND((e,t)=>AD(t)?SD(SD({},t),{},{velocity:ED(t.velocity,r[e].velocity,n),from:ED(t.from,r[e].from,n)}):t,t):CD(e,r,n-1)};function DD(e,t,n,r,a,s){var i,o=r.reduce((n,r)=>SD(SD({},n),{},{[r]:{from:e[r],velocity:0,to:t[r]}}),{}),l=null,c=r=>{i||(i=r);var d=(r-i)/n.dt;o=CD(n,o,d),a(SD(SD(SD({},e),t),ND((e,t)=>t.from,o))),i=r,Object.values(o).filter(AD).length&&(l=s.setTimeout(c))};return()=>(l=s.setTimeout(c),()=>{l()})}const TD=(e,t,n,r,a,s)=>{var i,o,l=(i=e,o=t,[Object.keys(i),Object.keys(o)].reduce((e,t)=>e.filter(e=>t.includes(e))));return!0===n.isStepper?DD(e,t,n,l,a,s):function(e,t,n,r,a,s,i){var o,l=null,c=a.reduce((n,r)=>SD(SD({},n),{},{[r]:[e[r],t[r]]}),{}),d=a=>{o||(o=a);var u=(a-o)/r,h=ND((e,t)=>ED(...t,n(u)),c);if(s(SD(SD(SD({},e),t),h)),u<1)l=i.setTimeout(d);else{var m=ND((e,t)=>ED(...t,n(1)),c);s(SD(SD(SD({},e),t),m))}};return()=>(l=i.setTimeout(d),()=>{l()})}(e,t,n,r,l,a,s)};var OD=1e-4,PD=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],ID=(e,t)=>e.map((e,n)=>e*t**n).reduce((e,t)=>e+t),RD=(e,t)=>n=>{var r=PD(e,t);return ID(r,n)},MD=function(){for(var e,t,n,r,a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];if(1===s.length)switch(s[0]){case"linear":[e,n,t,r]=[0,0,1,1];break;case"ease":[e,n,t,r]=[.25,.1,.25,1];break;case"ease-in":[e,n,t,r]=[.42,0,1,1];break;case"ease-out":[e,n,t,r]=[.42,0,.58,1];break;case"ease-in-out":[e,n,t,r]=[0,0,.58,1];break;default:var o=s[0].split("(");"cubic-bezier"===o[0]&&4===o[1].split(")")[0].split(",").length&&([e,n,t,r]=o[1].split(")")[0].split(",").map(e=>parseFloat(e)))}else 4===s.length&&([e,n,t,r]=s);var l,c,d=RD(e,t),u=RD(n,r),h=(l=e,c=t,e=>{var t=[...PD(l,c).map((e,t)=>e*t).slice(1),0];return ID(t,e)}),m=e=>e>1?1:e<0?0:e,p=e=>{for(var t=e>1?1:e,n=t,r=0;r<8;++r){var a=d(n)-t,s=h(n);if(Math.abs(a-t)<OD||s<OD)return u(n);n=m(n-a/s)}return u(n)};return p.isStepper=!1,p},LD=e=>{if("string"===typeof e)switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return MD(e);case"spring":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stiff:t=100,damping:n=8,dt:r=17}=e,a=(e,a,s)=>{var i=s+(-(e-a)*t-s*n)*r/1e3,o=s*r/1e3+e;return Math.abs(o-a)<OD&&Math.abs(i)<OD?[a,0]:[o,i]};return a.isStepper=!0,a.dt=r,a}();default:if("cubic-bezier"===e.split("(")[0])return MD(e)}return"function"===typeof e?e:null};class FD{setTimeout(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=performance.now(),r=null,a=s=>{s-n>=t?e(s):"function"===typeof requestAnimationFrame&&(r=requestAnimationFrame(a))};return r=requestAnimationFrame(a),()=>{cancelAnimationFrame(r)}}}function UD(){return function(e){var t=()=>null,n=!1,r=null,a=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var i=s,[o,...l]=i;return"number"===typeof o?void(r=e.setTimeout(a.bind(null,l),o)):(a(o),void(r=e.setTimeout(a.bind(null,l))))}"string"===typeof s&&t(s),"object"===typeof s&&t(s),"function"===typeof s&&s()}};return{stop:()=>{n=!0},start:e=>{n=!1,r&&(r(),r=null),a(e)},subscribe:e=>(t=e,()=>{t=()=>null}),getTimeoutController:()=>e}}(new FD)}var BD=(0,r.createContext)(UD);var zD={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},qD={t:0},VD={t:1};function HD(e){var t=Ek(e,zD),{isActive:n,canBegin:a,duration:s,easing:i,begin:o,onAnimationEnd:l,onAnimationStart:c,children:d}=t,u=function(e,t){var n=(0,r.useContext)(BD);return(0,r.useMemo)(()=>null!==t&&void 0!==t?t:n(e),[e,t,n])}(t.animationId,t.animationManager),[h,m]=(0,r.useState)(n?qD:VD),p=(0,r.useRef)(null);return(0,r.useEffect)(()=>{n||m(VD)},[n]),(0,r.useEffect)(()=>{if(!n||!a)return xD;var e=TD(qD,VD,LD(i),s,m,u.getTimeoutController());return u.start([c,o,()=>{p.current=e()},s,l]),()=>{u.stop(),p.current&&p.current(),l()}},[n,a,s,i,o,c,l,u]),d(h.t)}function WD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"animation-",n=(0,r.useRef)(cc(t)),a=(0,r.useRef)(e);return a.current!==e&&(n.current=cc(t),a.current=e),n.current}function GD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function KD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?GD(Object(n),!0).forEach(function(t){QD(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GD(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function QD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YD(){return YD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YD.apply(null,arguments)}var $D=(e,t,n,r,a)=>{var s,i=Math.min(Math.abs(n)/2,Math.abs(r)/2),o=r>=0?1:-1,l=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0;if(i>0&&a instanceof Array){for(var d=[0,0,0,0],u=0;u<4;u++)d[u]=a[u]>i?i:a[u];s="M".concat(e,",").concat(t+o*d[0]),d[0]>0&&(s+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+l*d[0],",").concat(t)),s+="L ".concat(e+n-l*d[1],",").concat(t),d[1]>0&&(s+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,",\n        ").concat(e+n,",").concat(t+o*d[1])),s+="L ".concat(e+n,",").concat(t+r-o*d[2]),d[2]>0&&(s+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,",\n        ").concat(e+n-l*d[2],",").concat(t+r)),s+="L ".concat(e+l*d[3],",").concat(t+r),d[3]>0&&(s+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,",\n        ").concat(e,",").concat(t+r-o*d[3])),s+="Z"}else if(i>0&&a===+a&&a>0){var h=Math.min(i,a);s="M ".concat(e,",").concat(t+o*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+l*h,",").concat(t,"\n            L ").concat(e+n-l*h,",").concat(t,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n,",").concat(t+o*h,"\n            L ").concat(e+n,",").concat(t+r-o*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n-l*h,",").concat(t+r,"\n            L ").concat(e+l*h,",").concat(t+r,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+r-o*h," Z")}else s="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return s},JD={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},XD=e=>{var t=Ek(e,JD),n=(0,r.useRef)(null),[a,s]=(0,r.useState)(-1);(0,r.useEffect)(()=>{if(n.current&&n.current.getTotalLength)try{var e=n.current.getTotalLength();e&&s(e)}catch(t){}},[]);var{x:i,y:o,width:l,height:c,radius:d,className:u}=t,{animationEasing:h,animationDuration:m,animationBegin:p,isAnimationActive:f,isUpdateAnimationActive:g}=t,y=(0,r.useRef)(l),x=(0,r.useRef)(c),v=(0,r.useRef)(i),b=(0,r.useRef)(o),w=WD((0,r.useMemo)(()=>({x:i,y:o,width:l,height:c,radius:d}),[i,o,l,c,d]),"rectangle-");if(i!==+i||o!==+o||l!==+l||c!==+c||0===l||0===c)return null;var j=Xl("recharts-rectangle",u);if(!g)return r.createElement("path",YD({},HS(t,!0),{className:j,d:$D(i,o,l,c,d)}));var N=y.current,_=x.current,S=v.current,k=b.current,E="0px ".concat(-1===a?1:a,"px"),A="".concat(a,"px 0px"),C=jD(["strokeDasharray"],m,"string"===typeof h?h:void 0);return r.createElement(HD,{animationId:w,key:w,canBegin:a>0,duration:m,easing:h,isActive:g,begin:p},e=>{var a,s=hc(N,l,e),u=hc(_,c,e),h=hc(S,i,e),m=hc(k,o,e);return n.current&&(y.current=s,x.current=u,v.current=h,b.current=m),a=f?e>0?{transition:C,strokeDasharray:A}:{strokeDasharray:E}:{strokeDasharray:A},r.createElement("path",YD({},HS(t,!0),{className:j,d:$D(h,m,s,u,d),ref:n,style:KD(KD({},a),t.style)}))})};function ZD(e){var{cx:t,cy:n,radius:r,startAngle:a,endAngle:s}=e;return{points:[km(t,n,r,a),km(t,n,r,s)],cx:t,cy:n,radius:r,startAngle:a,endAngle:s}}function eT(){return eT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eT.apply(null,arguments)}var tT=e=>{var{cx:t,cy:n,radius:r,angle:a,sign:s,isExternal:i,cornerRadius:o,cornerIsExternal:l}=e,c=o*(i?1:-1)+r,d=Math.asin(o/c)/_m,u=l?a:a+s*d,h=l?a-s*d:a;return{center:km(t,n,c,u),circleTangency:km(t,n,r,u),lineTangency:km(t,n,c*Math.cos(d*_m),h),theta:d}},nT=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:s,endAngle:i}=e,o=((e,t)=>rc(t-e)*Math.min(Math.abs(t-e),359.999))(s,i),l=s+o,c=km(t,n,a,s),d=km(t,n,a,l),u="M ".concat(c.x,",").concat(c.y,"\n    A ").concat(a,",").concat(a,",0,\n    ").concat(+(Math.abs(o)>180),",").concat(+(s>l),",\n    ").concat(d.x,",").concat(d.y,"\n  ");if(r>0){var h=km(t,n,r,s),m=km(t,n,r,l);u+="L ".concat(m.x,",").concat(m.y,"\n            A ").concat(r,",").concat(r,",0,\n            ").concat(+(Math.abs(o)>180),",").concat(+(s<=l),",\n            ").concat(h.x,",").concat(h.y," Z")}else u+="L ".concat(t,",").concat(n," Z");return u},rT={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},aT=e=>{var t=Ek(e,rT),{cx:n,cy:a,innerRadius:s,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:h}=t;if(i<s||d===u)return null;var m,p=Xl("recharts-sector",h),f=i-s,g=dc(o,f,0,!0);return m=g>0&&Math.abs(d-u)<360?(e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,cornerRadius:s,forceCornerRadius:i,cornerIsExternal:o,startAngle:l,endAngle:c}=e,d=rc(c-l),{circleTangency:u,lineTangency:h,theta:m}=tT({cx:t,cy:n,radius:a,angle:l,sign:d,cornerRadius:s,cornerIsExternal:o}),{circleTangency:p,lineTangency:f,theta:g}=tT({cx:t,cy:n,radius:a,angle:c,sign:-d,cornerRadius:s,cornerIsExternal:o}),y=o?Math.abs(l-c):Math.abs(l-c)-m-g;if(y<0)return i?"M ".concat(h.x,",").concat(h.y,"\n        a").concat(s,",").concat(s,",0,0,1,").concat(2*s,",0\n        a").concat(s,",").concat(s,",0,0,1,").concat(2*-s,",0\n      "):nT({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:l,endAngle:c});var x="M ".concat(h.x,",").concat(h.y,"\n    A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(u.x,",").concat(u.y,"\n    A").concat(a,",").concat(a,",0,").concat(+(y>180),",").concat(+(d<0),",").concat(p.x,",").concat(p.y,"\n    A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,"\n  ");if(r>0){var{circleTangency:v,lineTangency:b,theta:w}=tT({cx:t,cy:n,radius:r,angle:l,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:o}),{circleTangency:j,lineTangency:N,theta:_}=tT({cx:t,cy:n,radius:r,angle:c,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:o}),S=o?Math.abs(l-c):Math.abs(l-c)-w-_;if(S<0&&0===s)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(N.x,",").concat(N.y,"\n      A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(j.x,",").concat(j.y,"\n      A").concat(r,",").concat(r,",0,").concat(+(S>180),",").concat(+(d>0),",").concat(v.x,",").concat(v.y,"\n      A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(b.x,",").concat(b.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x})({cx:n,cy:a,innerRadius:s,outerRadius:i,cornerRadius:Math.min(g,f/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):nT({cx:n,cy:a,innerRadius:s,outerRadius:i,startAngle:d,endAngle:u}),r.createElement("path",eT({},HS(t,!0),{className:p,d:m}))};function sT(e,t,n){var r,a,s,i;if("horizontal"===e)s=r=t.x,a=n.top,i=n.top+n.height;else if("vertical"===e)i=a=t.y,r=n.left,s=n.left+n.width;else if(null!=t.cx&&null!=t.cy){if("centric"!==e)return ZD(t);var{cx:o,cy:l,innerRadius:c,outerRadius:d,angle:u}=t,h=km(o,l,c,u),m=km(o,l,d,u);r=h.x,a=h.y,s=m.x,i=m.y}return[{x:r,y:a},{x:s,y:i}]}function iT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function oT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iT(Object(n),!0).forEach(function(t){lT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function lT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var cT=()=>{var e=dm(Lb),t=dm(ON),n=dm(CN);return Gm(oT(oT({},e),{},{scale:n}),t)};function dT(){return dT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dT.apply(null,arguments)}function uT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uT(Object(n),!0).forEach(function(t){mT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function mT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pT(e){var t,n,{coordinate:a,payload:s,index:i,offset:o,tooltipAxisBandSize:l,layout:c,cursor:d,tooltipEventType:u,chartName:h}=e,m=a,p=s,f=i;if(!d||!m||"ScatterChart"!==h&&"axis"!==u)return null;if("ScatterChart"===h)t=m,n=yD;else if("BarChart"===h)t=function(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?t.x-a:n.left+.5,y:"horizontal"===e?n.top+.5:t.y-a,width:"horizontal"===e?r:n.width-1,height:"horizontal"===e?n.height-1:r}}(c,m,o,l),n=XD;else if("radial"===c){var{cx:g,cy:y,radius:x,startAngle:v,endAngle:b}=ZD(m);t={cx:g,cy:y,startAngle:v,endAngle:b,innerRadius:x,outerRadius:x},n=aT}else t={points:sT(c,m,o)},n=uD;var w="object"===typeof d&&"className"in d?d.className:void 0,j=hT(hT(hT(hT({stroke:"#ccc",pointerEvents:"none"},o),t),HS(d,!1)),{},{payload:p,payloadIndex:f,className:Xl("recharts-tooltip-cursor",w)});return(0,r.isValidElement)(d)?(0,r.cloneElement)(d,j):(0,r.createElement)(n,j)}function fT(e){var t=cT(),n=mp(),a=yp(),s=dm(sb);return r.createElement(pT,dT({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:n,layout:a,tooltipAxisBandSize:t,chartName:s}))}function gT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function yT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gT(Object(n),!0).forEach(function(t){xT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function xT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vT(e){return e.dataKey}var bT=[],wT={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!jS,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function jT(e){var t=Ek(e,wT),{active:n,allowEscapeViewBox:a,animationDuration:s,animationEasing:i,content:o,filterNull:l,isAnimationActive:c,offset:d,payloadUniqBy:u,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:f,cursor:g,shared:y,trigger:x,defaultIndex:v,portal:b,axisId:w}=t,j=im(),N="number"===typeof v?String(v):v;(0,r.useEffect)(()=>{j(Eh({shared:y,trigger:x,axisId:w,active:n,defaultIndex:N}))},[j,y,x,w,n,N]);var _=up(),S=AS(),k=function(e){return dm(t=>Bj(t,e))}(y),{activeIndex:E,isActive:A}=dm(e=>r_(e,k,x,N)),C=dm(e=>n_(e,k,x,N)),D=dm(e=>t_(e,k,x,N)),T=dm(e=>e_(e,k,x,N)),O=C,P=(0,r.useContext)(hk),I=null!==n&&void 0!==n?n:A,[R,M]=_C([O,I]),L="axis"===k?D:void 0;uk(k,x,T,L,E,I);var F=null!==b&&void 0!==b?b:P;if(null==F)return null;var U=null!==O&&void 0!==O?O:bT;I||(U=bT),l&&U.length&&(U=cC(O.filter(e=>null!=e.value&&(!0!==e.hide||t.includeHidden)),u,vT));var B=U.length>0,z=r.createElement(iC,{allowEscapeViewBox:a,animationDuration:s,animationEasing:i,isAnimationActive:c,active:I,coordinate:T,hasPayload:B,offset:d,position:h,reverseDirection:m,useTranslate3d:p,viewBox:_,wrapperStyle:f,lastBoundingBox:R,innerRef:M,hasPortalFromProps:Boolean(b)},function(e,t){return r.isValidElement(e)?r.cloneElement(e,t):"function"===typeof e?r.createElement(e,t):r.createElement(XA,t)}(o,yT(yT({},t),{},{payload:U,label:L,active:I,coordinate:T,accessibilityLayer:S})));return r.createElement(r.Fragment,null,(0,GA.createPortal)(z,F),I&&r.createElement(fT,{cursor:g,tooltipEventType:k,coordinate:T,payload:O,index:E}))}Math.abs,Math.atan2;const NT=Math.cos,_T=(Math.max,Math.min,Math.sin),ST=Math.sqrt,kT=Math.PI,ET=2*kT;const AT={draw(e,t){const n=ST(t/kT);e.moveTo(n,0),e.arc(0,0,n,0,ET)}},CT={draw(e,t){const n=ST(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},DT=ST(1/3),TT=2*DT,OT={draw(e,t){const n=ST(t/TT),r=n*DT;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},PT={draw(e,t){const n=ST(t),r=-n/2;e.rect(r,r,n,n)}},IT=_T(kT/10)/_T(7*kT/10),RT=_T(ET/10)*IT,MT=-NT(ET/10)*IT,LT={draw(e,t){const n=ST(.8908130915292852*t),r=RT*n,a=MT*n;e.moveTo(0,-n),e.lineTo(r,a);for(let s=1;s<5;++s){const t=ET*s/5,i=NT(t),o=_T(t);e.lineTo(o*n,-i*n),e.lineTo(i*r-o*a,o*r+i*a)}e.closePath()}},FT=ST(3),UT={draw(e,t){const n=-ST(t/(3*FT));e.moveTo(0,2*n),e.lineTo(-FT*n,-n),e.lineTo(FT*n,-n),e.closePath()}},BT=-.5,zT=ST(3)/2,qT=1/ST(12),VT=3*(qT/2+1),HT={draw(e,t){const n=ST(t/VT),r=n/2,a=n*qT,s=r,i=n*qT+n,o=-s,l=i;e.moveTo(r,a),e.lineTo(s,i),e.lineTo(o,l),e.lineTo(BT*r-zT*a,zT*r+BT*a),e.lineTo(BT*s-zT*i,zT*s+BT*i),e.lineTo(BT*o-zT*l,zT*o+BT*l),e.lineTo(BT*r+zT*a,BT*a-zT*r),e.lineTo(BT*s+zT*i,BT*i-zT*s),e.lineTo(BT*o+zT*l,BT*l-zT*o),e.closePath()}};ST(3),ST(3);var WT=["type","size","sizeType"];function GT(){return GT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GT.apply(null,arguments)}function KT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function QT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?KT(Object(n),!0).forEach(function(t){YT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function YT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $T={symbolCircle:AT,symbolCross:CT,symbolDiamond:OT,symbolSquare:PT,symbolStar:LT,symbolTriangle:UT,symbolWye:HT},JT=Math.PI/180,XT=e=>{var{type:t="circle",size:n=64,sizeType:a="area"}=e,s=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,WT),i=QT(QT({},s),{},{type:t,size:n,sizeType:a}),o="circle";"string"===typeof t&&(o=t);var{className:l,cx:c,cy:d}=i,u=HS(i,!0);return c===+c&&d===+d&&n===+n?r.createElement("path",GT({},u,{className:Xl("recharts-symbols",l),transform:"translate(".concat(c,", ").concat(d,")"),d:(()=>{var e=(e=>{var t="symbol".concat(fc(e));return $T[t]||AT})(o),t=function(e,t){let n=null,r=JC(a);function a(){let a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return e="function"===typeof e?e:ym(e||AT),t="function"===typeof t?t:ym(void 0===t?64:+t),a.type=function(t){return arguments.length?(e="function"===typeof t?t:ym(t),a):e},a.size=function(e){return arguments.length?(t="function"===typeof e?e:ym(+e),a):t},a.context=function(e){return arguments.length?(n=null==e?null:e,a):n},a}().type(e).size(((e,t,n)=>{if("area"===t)return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return.5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var r=18*JT;return 1.25*e*e*(Math.tan(r)-Math.tan(2*r)*Math.tan(r)**2);case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}})(n,a,o));return t()})()})):null};function ZT(){return ZT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZT.apply(null,arguments)}function eO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}XT.registerSymbol=(e,t)=>{$T["symbol".concat(fc(e))]=t};var nO=32;class rO extends r.PureComponent{renderIcon(e,t){var{inactiveColor:n}=this.props,a=16,s=nO/6,i=nO/3,o=e.inactive?n:e.color,l=null!==t&&void 0!==t?t:e.type;if("none"===l)return null;if("plainline"===l)return r.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:a,x2:nO,y2:a,className:"recharts-legend-icon"});if("line"===l)return r.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(a,"h").concat(i,"\n            A").concat(s,",").concat(s,",0,1,1,").concat(2*i,",").concat(a,"\n            H").concat(nO,"M").concat(2*i,",").concat(a,"\n            A").concat(s,",").concat(s,",0,1,1,").concat(i,",").concat(a),className:"recharts-legend-icon"});if("rect"===l)return r.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(4,"h").concat(nO,"v").concat(24,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(r.isValidElement(e.legendIcon)){var c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eO(Object(n),!0).forEach(function(t){tO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e);return delete c.legendIcon,r.cloneElement(e.legendIcon,c)}return r.createElement(XT,{fill:o,cx:a,cy:a,size:nO,sizeType:"diameter",type:l})}renderItems(){var{payload:e,iconSize:t,layout:n,formatter:a,inactiveColor:s,iconType:i}=this.props,o={x:0,y:0,width:nO,height:nO},l={display:"horizontal"===n?"inline-block":"block",marginRight:10},c={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((e,n)=>{var d=e.formatter||a,u=Xl({"recharts-legend-item":!0,["legend-item-".concat(n)]:!0,inactive:e.inactive});if("none"===e.type)return null;var h=e.inactive?s:e.color,m=d?d(e.value,e,n):e.value;return r.createElement("li",ZT({className:u,style:l,key:"legend-item-".concat(n)},RS(this.props,e,n)),r.createElement(KS,{width:t,height:t,viewBox:o,style:c,"aria-label":"".concat(m," legend icon")},this.renderIcon(e,i)),r.createElement("span",{className:"recharts-legend-item-text",style:{color:h}},m))})}render(){var{payload:e,layout:t,align:n}=this.props;if(!e||!e.length)return null;var a={padding:0,margin:0,textAlign:"horizontal"===t?n:"left"};return r.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}tO(rO,"displayName","Legend"),tO(rO,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var aO=["contextPayload"];function sO(){return sO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sO.apply(null,arguments)}function iO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function oO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iO(Object(n),!0).forEach(function(t){lO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function lO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cO(e){return e.value}function dO(e){var{contextPayload:t}=e,n=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,aO),a=cC(t,e.payloadUniqBy,cO),s=oO(oO({},n),{},{payload:a});return r.isValidElement(e.content)?r.cloneElement(e.content,s):"function"===typeof e.content?r.createElement(e.content,s):r.createElement(rO,s)}function uO(e){var t=im();return(0,r.useEffect)(()=>{t(H_(e))},[t,e]),null}function hO(e){var t=im();return(0,r.useEffect)(()=>(t(V_(e)),()=>{t(V_({width:0,height:0}))}),[t,e]),null}function mO(e){var t=dm(pm),n=(0,r.useContext)(mk),a=dm(e=>e.layout.margin),{width:s,height:i,wrapperStyle:o,portal:l}=e,[c,d]=_C([t]),u=pp(),h=fp();if(null==u||null==h)return null;var m=u-(a.left||0)-(a.right||0),p=pO.getWidthOrHeight(e.layout,i,s,m),f=l?o:oO(oO({position:"absolute",width:(null===p||void 0===p?void 0:p.width)||s||"auto",height:(null===p||void 0===p?void 0:p.height)||i||"auto"},function(e,t,n,r,a,s){var i,o,{layout:l,align:c,verticalAlign:d}=t;return e&&(void 0!==e.left&&null!==e.left||void 0!==e.right&&null!==e.right)||(i="center"===c&&"vertical"===l?{left:((r||0)-s.width)/2}:"right"===c?{right:n&&n.right||0}:{left:n&&n.left||0}),e&&(void 0!==e.top&&null!==e.top||void 0!==e.bottom&&null!==e.bottom)||(o="middle"===d?{top:((a||0)-s.height)/2}:"bottom"===d?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),oO(oO({},i),o)}(o,e,a,u,h,c)),o),g=null!==l&&void 0!==l?l:n;if(null==g)return null;var y=r.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:d},r.createElement(uO,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),r.createElement(hO,{width:c.width,height:c.height}),r.createElement(dO,sO({},e,p,{margin:a,chartWidth:u,chartHeight:h,contextPayload:t})));return(0,GA.createPortal)(y,g)}class pO extends r.PureComponent{static getWidthOrHeight(e,t,n,r){return"vertical"===e&&ic(t)?{height:t}:"horizontal"===e?{width:n||r}:null}render(){return r.createElement(mO,this.props)}}lO(pO,"displayName","Legend"),lO(pO,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});var fO=e=>null;fO.displayName="Cell";var gO=n(356),yO=n.n(gO),xO=["valueAccessor"],vO=["dataKey","clockWise","id","textBreakAll"];function bO(){return bO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bO.apply(null,arguments)}function wO(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var jO=e=>Array.isArray(e.value)?yO()(e.value):e.value,NO=(0,r.createContext)(void 0),_O=NO.Provider,SO=(0,r.createContext)(void 0);SO.Provider;function kO(e){var{valueAccessor:t=jO}=e,n=wO(e,xO),{dataKey:a,clockWise:s,id:i,textBreakAll:o}=n,l=wO(n,vO),c=(0,r.useContext)(NO),d=(0,r.useContext)(SO),u=c||d;return u&&u.length?r.createElement(nE,{className:"recharts-label-list"},u.map((e,s)=>{var c,d=pc(a)?t(e,s):Im(e&&e.payload,a),u=pc(i)?{}:{id:"".concat(i,"-").concat(s)};return r.createElement(UE,bO({},HS(e,!0),l,u,{fill:null!==(c=n.fill)&&void 0!==c?c:e.fill,parentViewBox:e.parentViewBox,value:d,textBreakAll:o,viewBox:e.viewBox,key:"label-".concat(s),index:s}))})):null}function EO(e){var{label:t}=e;return t?!0===t?r.createElement(kO,{key:"labelList-implicit"}):r.isValidElement(t)||RE(t)?r.createElement(kO,{key:"labelList-implicit",content:t}):"object"===typeof t?r.createElement(kO,bO({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}kO.displayName="LabelList";var AO="Invariant failed";var CO=n(9397),DO=n.n(CO);function TO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function OO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TO(Object(n),!0).forEach(function(t){PO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function PO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IO(){return IO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},IO.apply(null,arguments)}var RO=(e,t,n,r,a)=>{var s,i=n-r;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+n,",").concat(t),s+="L ".concat(e+n-i/2,",").concat(t+a),s+="L ".concat(e+n-i/2-r,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z")},MO={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},LO=e=>{var t=Ek(e,MO),{x:n,y:a,upperWidth:s,lowerWidth:i,height:o,className:l}=t,{animationEasing:c,animationDuration:d,animationBegin:u,isUpdateAnimationActive:h}=t,m=(0,r.useRef)(),[p,f]=(0,r.useState)(-1),g=(0,r.useRef)(s),y=(0,r.useRef)(i),x=(0,r.useRef)(o),v=(0,r.useRef)(n),b=(0,r.useRef)(a),w=WD(e,"trapezoid-");if((0,r.useEffect)(()=>{if(m.current&&m.current.getTotalLength)try{var e=m.current.getTotalLength();e&&f(e)}catch(t){}},[]),n!==+n||a!==+a||s!==+s||i!==+i||o!==+o||0===s&&0===i||0===o)return null;var j=Xl("recharts-trapezoid",l);if(!h)return r.createElement("g",null,r.createElement("path",IO({},HS(t,!0),{className:j,d:RO(n,a,s,i,o)})));var N=g.current,_=y.current,S=x.current,k=v.current,E=b.current,A="0px ".concat(-1===p?1:p,"px"),C="".concat(p,"px 0px"),D=jD(["strokeDasharray"],d,c);return r.createElement(HD,{animationId:w,key:w,canBegin:p>0,duration:d,easing:c,isActive:h,begin:u},e=>{var l=hc(N,s,e),c=hc(_,i,e),d=hc(S,o,e),u=hc(k,n,e),h=hc(E,a,e);m.current&&(g.current=l,y.current=c,x.current=d,v.current=u,b.current=h);var p=e>0?{transition:D,strokeDasharray:C}:{strokeDasharray:A};return r.createElement("path",IO({},HS(t,!0),{className:j,d:RO(u,h,l,c,d),ref:m,style:OO(OO({},p),t.style)}))})},FO=["option","shapeType","propTransformer","activeClassName","isActive"];function UO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function BO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UO(Object(n),!0).forEach(function(t){zO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function zO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qO(e,t){return BO(BO({},t),e)}function VO(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return r.createElement(XD,n);case"trapezoid":return r.createElement(LO,n);case"sector":return r.createElement(aT,n);case"symbols":if(function(e){return"symbols"===e}(t))return r.createElement(XT,n);break;default:return null}}function HO(e){var t,{option:n,shapeType:a,propTransformer:s=qO,activeClassName:i="recharts-active-shape",isActive:o}=e,l=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,FO);if((0,r.isValidElement)(n))t=(0,r.cloneElement)(n,BO(BO({},l),function(e){return(0,r.isValidElement)(e)?e.props:e}(n)));else if("function"===typeof n)t=n(l);else if(DO()(n)&&"boolean"!==typeof n){var c=s(n,l);t=r.createElement(VO,{shapeType:a,elementProps:c})}else{var d=l;t=r.createElement(VO,{shapeType:a,elementProps:d})}return o?r.createElement(nE,{className:i},t):t}var WO=["x","y"];function GO(){return GO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GO.apply(null,arguments)}function KO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function QO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?KO(Object(n),!0).forEach(function(t){YO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function YO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $O(e,t){var{x:n,y:r}=e,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,WO),s="".concat(n),i=parseInt(s,10),o="".concat(r),l=parseInt(o,10),c="".concat(t.height||a.height),d=parseInt(c,10),u="".concat(t.width||a.width),h=parseInt(u,10);return QO(QO(QO(QO(QO({},t),a),i?{x:i}:{}),l?{y:l}:{}),{},{height:d,width:h,name:t.name,radius:t.radius})}function JO(e){return r.createElement(HO,GO({shapeType:"rectangle",propTransformer:$O,activeClassName:"recharts-active-bar"},e))}var XO=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(n,r)=>{if(ic(e))return e;var a=ic(n)||pc(n);return a?e(n,r):(a||function(e){if(!e)throw new Error(AO)}(!1),t)}},ZO=(e,t)=>{var n=im();return(r,a)=>s=>{null===e||void 0===e||e(r,a,s),n(Ah({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}},eP=e=>{var t=im();return(n,r)=>a=>{null===e||void 0===e||e(n,r,a),t(Ch())}},tP=(e,t)=>{var n=im();return(r,a)=>s=>{null===e||void 0===e||e(r,a,s),n(Th({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}};function nP(e){var{fn:t,args:n}=e,a=im(),s=lp();return(0,r.useEffect)(()=>{if(!s){var e=t(n);return a(Sh(e)),()=>{a(kh(e))}}},[t,n,a,s]),null}var rP=["children"];var aP={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},sP=(0,r.createContext)(aP);function iP(e){var{children:t}=e,n=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,rP);return r.createElement(sP.Provider,{value:n},t)}function oP(e,t){var n,r,a=dm(t=>Kb(t,e)),s=dm(e=>$b(e,t)),i=null!==(n=null===a||void 0===a?void 0:a.allowDataOverflow)&&void 0!==n?n:Wb.allowDataOverflow,o=null!==(r=null===s||void 0===s?void 0:s.allowDataOverflow)&&void 0!==r?r:Qb.allowDataOverflow;return{needClip:i||o,needClipX:i,needClipY:o}}function lP(e){var{xAxisId:t,yAxisId:n,clipPathId:a}=e,s=bk(),{needClipX:i,needClipY:o,needClip:l}=oP(t,n);if(!l)return null;var{x:c,y:d,width:u,height:h}=s;return r.createElement("clipPath",{id:"clipPath-".concat(a)},r.createElement("rect",{x:i?c:c-u/2,y:o?d:d-h/2,width:i?u:2*u,height:o?h:2*h}))}function cP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function dP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cP(Object(n),!0).forEach(function(t){uP(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function uP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hP=tm([rw,(e,t,n,r,a)=>a],(e,t)=>e.filter(e=>"bar"===e.type).find(e=>e.id===t)),mP=tm([hP],e=>null===e||void 0===e?void 0:e.maxBarSize),pP=(e,t,n)=>{var r=null!==n&&void 0!==n?n:e;if(!pc(r))return dc(r,t,0)},fP=tm([gp,rw,(e,t)=>t,(e,t,n)=>n,(e,t,n,r)=>r],(e,t,n,r,a)=>t.filter(t=>"horizontal"===e?t.xAxisId===n:t.yAxisId===r).filter(e=>e.isPanorama===a).filter(e=>!1===e.hide).filter(e=>"bar"===e.type)),gP=tm([fP,e=>e.rootProps.barSize,(e,t,n)=>"horizontal"===gp(e)?kj(e,"xAxis",t):kj(e,"yAxis",n)],(e,t,n)=>{var r=e.filter(Bb),a=e.filter(e=>null==e.stackId),s=r.reduce((e,t)=>(e[t.stackId]||(e[t.stackId]=[]),e[t.stackId].push(t),e),{}),i=Object.entries(s).map(e=>{var[r,a]=e;return{stackId:r,dataKeys:a.map(e=>e.dataKey),barSize:pP(t,n,a[0].barSize)}});return[...i,...a.map(e=>({stackId:void 0,dataKeys:[e.dataKey].filter(e=>null!=e),barSize:pP(t,n,e.barSize)}))]}),yP=(e,t,n,r)=>{var a,s;return"horizontal"===gp(e)?(a=Ij(e,"xAxis",t,r),s=Pj(e,"xAxis",t,r)):(a=Ij(e,"yAxis",n,r),s=Pj(e,"yAxis",n,r)),Gm(a,s)};var xP,vP=tm([gP,nb,e=>e.rootProps.barGap,rb,(e,t,n,r,a)=>{var s,i,o=hP(e,t,n,r,a);if(null!=o){var l,c,d=gp(e),u=nb(e),{maxBarSize:h}=o,m=pc(h)?u:h;return"horizontal"===d?(l=Ij(e,"xAxis",t,r),c=Pj(e,"xAxis",t,r)):(l=Ij(e,"yAxis",n,r),c=Pj(e,"yAxis",n,r)),null!==(s=null!==(i=Gm(l,c,!0))&&void 0!==i?i:m)&&void 0!==s?s:0}},yP,mP],(e,t,n,r,a,s,i)=>{var o=pc(i)?t:i,l=function(e,t,n,r,a){var s=r.length;if(!(s<1)){var i,o=dc(e,n,0,!0),l=[];if(Ov(r[0].barSize)){var c=!1,d=n/s,u=r.reduce((e,t)=>e+(t.barSize||0),0);(u+=(s-1)*o)>=n&&(u-=(s-1)*o,o=0),u>=n&&d>0&&(c=!0,u=s*(d*=.9));var h={offset:((n-u)/2|0)-o,size:0};i=r.reduce((e,t)=>{var n,r=[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:h.offset+h.size+o,size:c?d:null!==(n=t.barSize)&&void 0!==n?n:0}}];return h=r[r.length-1].position,r},l)}else{var m=dc(t,n,0,!0);n-2*m-(s-1)*o<=0&&(o=0);var p=(n-2*m-(s-1)*o)/s;p>1&&(p>>=0);var f=Ov(a)?Math.min(p,a):p;i=r.reduce((e,t,n)=>[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:m+(p+o)*n+(p-f)/2,size:f}}],l)}return i}}(n,r,a!==s?a:s,e,o);return a!==s&&null!=l&&(l=l.map(e=>dP(dP({},e),{},{position:dP(dP({},e.position),{},{offset:e.position.offset-a/2})}))),l}),bP=tm([vP,hP],(e,t)=>{if(null!=e&&null!=t){var n=e.find(e=>e.stackId===t.stackId&&null!=t.dataKey&&e.dataKeys.includes(t.dataKey));if(null!=n)return n.position}}),wP=tm([(e,t,n,r)=>"horizontal"===gp(e)?ww(e,"yAxis",n,r):ww(e,"xAxis",t,r),hP],(e,t)=>{var n=Ib(t);if(e&&null!=n&&null!=t){var{stackId:r}=t;if(null!=r){var a=e[r];if(a){var{stackedData:s}=a;if(s)return s.find(e=>e.key===n)}}}}),jP=tm([ap,ip,(e,t,n,r)=>Ij(e,"xAxis",t,r),(e,t,n,r)=>Ij(e,"yAxis",n,r),(e,t,n,r)=>Pj(e,"xAxis",t,r),(e,t,n,r)=>Pj(e,"yAxis",n,r),bP,gp,Tv,yP,wP,hP,(e,t,n,r,a,s)=>s],(e,t,n,r,a,s,i,o,l,c,d,u,h)=>{var{chartData:m,dataStartIndex:p,dataEndIndex:f}=l;if(null!=u&&null!=i&&null!=t&&("horizontal"===o||"vertical"===o)&&null!=n&&null!=r&&null!=a&&null!=s&&null!=c){var g,{data:y}=u;if(null!=(g=null!=y&&y.length>0?y:null===m||void 0===m?void 0:m.slice(p,f+1)))return function(e){var{layout:t,barSettings:{dataKey:n,minPointSize:r},pos:a,bandSize:s,xAxis:i,yAxis:o,xAxisTicks:l,yAxisTicks:c,stackedData:d,displayedData:u,offset:h,cells:m,parentViewBox:p}=e,f="horizontal"===t?o:i,g=d?f.scale.domain():null,y=(e=>{var{numericAxis:t}=e,n=t.scale.domain();if("number"===t.type){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]})({numericAxis:f});return u.map((e,u)=>{var f,x,v,b,w,j;d?f=((e,t)=>{if(!t||2!==t.length||!ic(t[0])||!ic(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!ic(e[0])||e[0]<n)&&(a[0]=n),(!ic(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a})(d[u],g):(f=Im(e,n),Array.isArray(f)||(f=[y,f]));var N=XO(r,KP)(f[1],u);if("horizontal"===t){var _,[S,k]=[o.scale(f[0]),o.scale(f[1])];x=qm({axis:i,ticks:l,bandSize:s,offset:a.offset,entry:e,index:u}),v=null!==(_=null!==k&&void 0!==k?k:S)&&void 0!==_?_:void 0,b=a.size;var E=S-k;if(w=ac(E)?0:E,j={x:x,y:h.top,width:b,height:h.height},Math.abs(N)>0&&Math.abs(w)<Math.abs(N)){var A=rc(w||N)*(Math.abs(N)-Math.abs(w));v-=A,w+=A}}else{var[C,D]=[i.scale(f[0]),i.scale(f[1])];if(x=C,v=qm({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:e,index:u}),b=D-C,w=a.size,j={x:h.left,y:v,width:h.width,height:w},Math.abs(N)>0&&Math.abs(b)<Math.abs(N))b+=rc(b||N)*(Math.abs(N)-Math.abs(b))}return null==x||null==v||null==b||null==w?null:RP(RP({},e),{},{x:x,y:v,width:b,height:w,value:d?f:f[1],payload:e,background:j,tooltipPosition:{x:x+b/2,y:v+w/2},parentViewBox:p},m&&m[u]&&m[u].props)}).filter(Boolean)}({layout:o,barSettings:u,pos:i,parentViewBox:t,bandSize:c,xAxis:n,yAxis:r,xAxisTicks:a,yAxisTicks:s,stackedData:d,displayedData:g,offset:e,cells:h})}}),NP=()=>{};function _P(e){var{legendPayload:t}=e,n=im(),a=lp();return(0,r.useEffect)(()=>a?NP:(n(W_(t)),()=>{n(G_(t))}),[n,a,t]),null}var SP=null!==(xP=a["useId".toString()])&&void 0!==xP?xP:()=>{var[e]=r.useState(()=>cc("uid-"));return e};var kP=(0,r.createContext)(void 0),EP=e=>{var{id:t,type:n,children:a}=e,s=function(e,t){var n=SP();return t||(e?"".concat(e,"-").concat(n):n)}("recharts-".concat(n),t);return r.createElement(kP.Provider,{value:s},a(s))};function AP(e){var t=im(),n=(0,r.useRef)(null);return(0,r.useEffect)(()=>{null===n.current?t(__(e)):n.current!==e&&t(S_({prev:n.current,next:e})),n.current=e},[t,e]),(0,r.useEffect)(()=>()=>{n.current&&(t(k_(n.current)),n.current=null)},[t]),null}var CP=["onMouseEnter","onMouseLeave","onClick"],DP=["value","background","tooltipPosition"],TP=["id"],OP=["onMouseEnter","onClick","onMouseLeave"];function PP(){return PP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PP.apply(null,arguments)}function IP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function RP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?IP(Object(n),!0).forEach(function(t){MP(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function MP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LP(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var FP=e=>{var{dataKey:t,name:n,fill:r,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:r,value:Qm(n,t),payload:e}]};function UP(e){var{dataKey:t,stroke:n,strokeWidth:r,fill:a,name:s,hide:i,unit:o}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:r,fill:a,dataKey:t,nameKey:void 0,name:Qm(s,t),hide:i,type:e.tooltipType,color:e.fill,unit:o}}}function BP(e){var t=dm(LN),{data:n,dataKey:a,background:s,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=i,d=LP(i,CP),u=ZO(o,a),h=eP(l),m=tP(c,a);if(!s||null==n)return null;var p=HS(s,!1);return r.createElement(r.Fragment,null,n.map((e,n)=>{var{value:i,background:o,tooltipPosition:l}=e,c=LP(e,DP);if(!o)return null;var f=u(e,n),g=h(e,n),y=m(e,n),x=RP(RP(RP(RP(RP({option:s,isActive:String(n)===t},c),{},{fill:"#eee"},o),p),RS(d,e,n)),{},{onMouseEnter:f,onMouseLeave:g,onClick:y,dataKey:a,index:n,className:"recharts-bar-background-rectangle"});return r.createElement(JO,PP({key:"background-bar-".concat(x.index)},x))}))}function zP(e){var{showLabels:t,children:n,rects:a}=e,s=null===a||void 0===a?void 0:a.map(e=>{var t={x:e.x,y:e.y,width:e.width,height:e.height};return RP(RP({},t),{},{value:e.value,payload:e.payload,parentViewBox:e.parentViewBox,viewBox:t,fill:e.fill})});return r.createElement(_O,{value:t?s:void 0},n)}function qP(e){var{shape:t,activeBar:n,baseProps:a,entry:s,index:i,dataKey:o}=e,l=dm(LN),c=dm(UN),d=n&&String(i)===l&&(null==c||o===c),u=d?n:t;return r.createElement(JO,PP({},a,s,{isActive:d,option:u,index:i,dataKey:o}))}function VP(e){var{shape:t,baseProps:n,entry:a,index:s,dataKey:i}=e;return r.createElement(JO,PP({},n,a,{isActive:!1,option:t,index:s,dataKey:i}))}function HP(e){var{data:t,props:n}=e,a=FS(n),{id:s}=a,i=LP(a,TP),{shape:o,dataKey:l,activeBar:c}=n,{onMouseEnter:d,onClick:u,onMouseLeave:h}=n,m=LP(n,OP),p=ZO(d,l),f=eP(h),g=tP(u,l);return t?r.createElement(r.Fragment,null,t.map((e,t)=>r.createElement(nE,PP({className:"recharts-bar-rectangle"},RS(m,e,t),{onMouseEnter:p(e,t),onMouseLeave:f(e,t),onClick:g(e,t),key:"rectangle-".concat(null===e||void 0===e?void 0:e.x,"-").concat(null===e||void 0===e?void 0:e.y,"-").concat(null===e||void 0===e?void 0:e.value,"-").concat(t)}),c?r.createElement(qP,{shape:o,activeBar:c,baseProps:i,entry:e,index:t,dataKey:l}):r.createElement(VP,{shape:o,baseProps:i,entry:e,index:t,dataKey:l})))):null}function WP(e){var{props:t,previousRectanglesRef:n}=e,{data:a,layout:s,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=t,h=n.current,m=WD(t,"recharts-bar-"),[p,f]=(0,r.useState)(!1),g=!p,y=(0,r.useCallback)(()=>{"function"===typeof d&&d(),f(!1)},[d]),x=(0,r.useCallback)(()=>{"function"===typeof u&&u(),f(!0)},[u]);return r.createElement(zP,{showLabels:g,rects:a},r.createElement(HD,{animationId:m,begin:o,duration:l,isActive:i,easing:c,onAnimationEnd:y,onAnimationStart:x,key:m},e=>{var i=1===e?a:null===a||void 0===a?void 0:a.map((t,n)=>{var r=h&&h[n];if(r)return RP(RP({},t),{},{x:hc(r.x,t.x,e),y:hc(r.y,t.y,e),width:hc(r.width,t.width,e),height:hc(r.height,t.height,e)});if("horizontal"===s){var a=hc(0,t.height,e);return RP(RP({},t),{},{y:t.y+t.height-a,height:a})}var i=hc(0,t.width,e);return RP(RP({},t),{},{width:i})});return e>0&&(n.current=null!==i&&void 0!==i?i:null),null==i?null:r.createElement(nE,null,r.createElement(HP,{props:t,data:i}))}),r.createElement(EO,{label:t.label}),t.children)}function GP(e){var t=(0,r.useRef)(null);return r.createElement(WP,{previousRectanglesRef:t,props:e})}var KP=0,QP=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:Im(e,t)}};class YP extends r.PureComponent{render(){var{hide:e,data:t,dataKey:n,className:a,xAxisId:s,yAxisId:i,needClip:o,background:l,id:c}=this.props;if(e||null==t)return null;var d=Xl("recharts-bar",a),u=c;return r.createElement(nE,{className:d,id:c},o&&r.createElement("defs",null,r.createElement(lP,{clipPathId:u,xAxisId:s,yAxisId:i})),r.createElement(nE,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(u,")"):void 0},r.createElement(BP,{data:t,dataKey:n,background:l,allOtherBarProps:this.props}),r.createElement(GP,this.props)))}}var $P={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!jS,legendType:"rect",minPointSize:KP,xAxisId:0,yAxisId:0};function JP(e){var t,{xAxisId:n,yAxisId:a,hide:s,legendType:i,minPointSize:o,activeBar:l,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:h}=e,{needClip:m}=oP(n,a),p=yp(),f=lp(),g=function(e,t){var n=[],r=[];return r=Array.isArray(t)?t.map(e=>US(e)):[US(t)],qS(e).forEach(e=>{var t=nc()(e,"type.displayName")||nc()(e,"type.name");-1!==r.indexOf(t)&&n.push(e)}),n}(e.children,fO),y=dm(t=>jP(t,n,a,f,e.id,g));if("vertical"!==p&&"horizontal"!==p)return null;var x=null===y||void 0===y?void 0:y[0];return t=null==x||null==x.height||null==x.width?0:"vertical"===p?x.height/2:x.width/2,r.createElement(iP,{xAxisId:n,yAxisId:a,data:y,dataPointFormatter:QP,errorBarOffset:t},r.createElement(YP,PP({},e,{layout:p,needClip:m,data:y,xAxisId:n,yAxisId:a,hide:s,legendType:i,minPointSize:o,activeBar:l,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:h})))}function XP(e){var t=Ek(e,$P),n=lp();return r.createElement(EP,{id:t.id,type:"bar"},e=>{return r.createElement(r.Fragment,null,r.createElement(_P,{legendPayload:FP(t)}),r.createElement(nP,{fn:UP,args:t}),r.createElement(AP,{type:"bar",id:e,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:(a=t.stackId,null==a?void 0:String(a)),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),r.createElement(JP,PP({},t,{id:e})));var a})}var ZP=r.memo(XP);function eI(){return eI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eI.apply(null,arguments)}ZP.displayName="Bar";var tI=e=>{var{cx:t,cy:n,r:a,className:s}=e,i=Xl("recharts-dot",s);return t===+t&&n===+n&&a===+a?r.createElement("circle",eI({},FS(e),IS(e),{className:i,cx:t,cy:n,r:a})):null};function nI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nI(Object(n),!0).forEach(function(t){aI(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function aI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sI(e){var{points:t,mainColor:n,activeDot:a,itemDataKey:s}=e,i=dm(LN),o=dm(WN);if(null==t||null==o)return null;var l=t.find(e=>o.includes(e.payload));return pc(l)?null:(e=>{var{point:t,childIndex:n,mainColor:a,activeDot:s,dataKey:i}=e;if(!1===s||null==t.x||null==t.y)return null;var o,l=rI(rI({index:n,dataKey:i,cx:t.x,cy:t.y,r:4,fill:null!==a&&void 0!==a?a:"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},HS(s,!1)),IS(s));return o=(0,r.isValidElement)(s)?(0,r.cloneElement)(s,l):"function"===typeof s?s(l):r.createElement(tI,l),r.createElement(nE,{className:"recharts-active-dot"},o)})({point:l,childIndex:Number(i),mainColor:n,dataKey:s,activeDot:a})}var iI=(e,t,n,r)=>Ij(e,"xAxis",t,r),oI=(e,t,n,r)=>Pj(e,"xAxis",t,r),lI=(e,t,n,r)=>Ij(e,"yAxis",n,r),cI=(e,t,n,r)=>Pj(e,"yAxis",n,r),dI=tm([gp,iI,lI,oI,cI],(e,t,n,r,a)=>Rm(e,"xAxis")?Gm(t,r,!1):Gm(n,a,!1));function uI(e){return"line"===e.type}var hI=tm([rw,(e,t,n,r,a)=>a],(e,t)=>e.filter(uI).find(e=>e.id===t)),mI=tm([gp,iI,lI,oI,cI,hI,dI,Tv],(e,t,n,r,a,s,i,o)=>{var{chartData:l,dataStartIndex:c,dataEndIndex:d}=o;if(null!=s&&null!=t&&null!=n&&null!=r&&null!=a&&0!==r.length&&0!==a.length&&null!=i){var u,{dataKey:h,data:m}=s;if(null!=(u=null!=m&&m.length>0?m:null===l||void 0===l?void 0:l.slice(c,d+1)))return function(e){var{layout:t,xAxis:n,yAxis:r,xAxisTicks:a,yAxisTicks:s,dataKey:i,bandSize:o,displayedData:l}=e;return l.map((e,l)=>{var c=Im(e,i);if("horizontal"===t)return{x:zm({axis:n,ticks:a,bandSize:o,entry:e,index:l}),y:pc(c)?null:r.scale(c),value:c,payload:e};var d=pc(c)?null:n.scale(c),u=zm({axis:r,ticks:s,bandSize:o,entry:e,index:l});return null==d||null==u?null:{x:d,y:u,value:c,payload:e}}).filter(Boolean)}({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:a,dataKey:h,bandSize:i,displayedData:u})}}),pI=["id"],fI=["type","layout","connectNulls","needClip"],gI=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function yI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yI(Object(n),!0).forEach(function(t){vI(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bI(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function wI(){return wI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wI.apply(null,arguments)}var jI=e=>{var{dataKey:t,name:n,stroke:r,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:r,value:Qm(n,t),payload:e}]};function NI(e){var{dataKey:t,data:n,stroke:r,strokeWidth:a,fill:s,name:i,hide:o,unit:l}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:s,dataKey:t,nameKey:void 0,name:Qm(i,t),hide:o,type:e.tooltipType,color:e.stroke,unit:l}}}var _I=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function SI(e,t){for(var n=e.length%2!==0?[...e,0]:e,r=[],a=0;a<t;++a)r=[...r,...n];return r}function kI(e){var{clipPathId:t,points:n,props:a}=e,{dot:s,dataKey:i,needClip:o}=a;if(!function(e,t){return null!=e&&(!!t||1===e.length)}(n,s))return null;var{id:l}=a,c=bI(a,pI),d=VS(s),u=FS(c),h=HS(s,!0),m=n.map((e,t)=>{var a=xI(xI(xI({key:"dot-".concat(t),r:3},u),h),{},{index:t,cx:e.x,cy:e.y,dataKey:i,value:e.value,payload:e.payload,points:n});return function(e,t){var n;if(r.isValidElement(e))n=r.cloneElement(e,t);else if("function"===typeof e)n=e(t);else{var a=Xl("recharts-line-dot","boolean"!==typeof e?e.className:"");n=r.createElement(tI,wI({},t,{className:a}))}return n}(s,a)}),p={clipPath:o?"url(#clipPath-".concat(d?"":"dots-").concat(t,")"):void 0};return r.createElement(nE,wI({className:"recharts-line-dots",key:"dots"},p),m)}function EI(e){var{showLabels:t,children:n,points:a}=e,s=(0,r.useMemo)(()=>null===a||void 0===a?void 0:a.map(e=>{var t={x:e.x,y:e.y,width:0,height:0};return xI(xI({},t),{},{value:e.value,payload:e.payload,viewBox:t,parentViewBox:void 0,fill:void 0})}),[a]);return r.createElement(_O,{value:t?s:null},n)}function AI(e){var{clipPathId:t,pathRef:n,points:a,strokeDasharray:s,props:i}=e,{type:o,layout:l,connectNulls:c,needClip:d}=i,u=bI(i,fI),h=xI(xI({},HS(u,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(t,")"):void 0,points:a,type:o,layout:l,connectNulls:c,strokeDasharray:null!==s&&void 0!==s?s:i.strokeDasharray});return r.createElement(r.Fragment,null,(null===a||void 0===a?void 0:a.length)>1&&r.createElement(uD,wI({},h,{pathRef:n})),r.createElement(kI,{points:a,clipPathId:t,props:i}))}function CI(e){var{clipPathId:t,props:n,pathRef:a,previousPointsRef:s,longestAnimatedLengthRef:i}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:d,animationDuration:u,animationEasing:h,animateNewValues:m,width:p,height:f,onAnimationEnd:g,onAnimationStart:y}=n,x=s.current,v=WD(n,"recharts-line-"),[b,w]=(0,r.useState)(!1),j=!b,N=(0,r.useCallback)(()=>{"function"===typeof g&&g(),w(!1)},[g]),_=(0,r.useCallback)(()=>{"function"===typeof y&&y(),w(!0)},[y]),S=function(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}(a.current),k=i.current;return r.createElement(EI,{points:o,showLabels:j},n.children,r.createElement(HD,{animationId:v,begin:d,duration:u,isActive:c,easing:h,onAnimationEnd:N,onAnimationStart:_,key:v},e=>{var d,u=hc(k,S+k,e),h=Math.min(u,S);if(c)if(l){var g="".concat(l).split(/[,\s]+/gim).map(e=>parseFloat(e));d=((e,t,n)=>{var r=n.reduce((e,t)=>e+t);if(!r)return _I(t,e);for(var a=Math.floor(e/r),s=e%r,i=t-e,o=[],l=0,c=0;l<n.length;c+=n[l],++l)if(c+n[l]>s){o=[...n.slice(0,l),s-c];break}var d=o.length%2===0?[0,i]:[i];return[...SI(n,a),...o,...d].map(e=>"".concat(e,"px")).join(", ")})(h,S,g)}else d=_I(S,h);else d=null==l?void 0:String(l);if(x){var y=x.length/o.length,v=1===e?o:o.map((t,n)=>{var r=Math.floor(n*y);if(x[r]){var a=x[r];return xI(xI({},t),{},{x:hc(a.x,t.x,e),y:hc(a.y,t.y,e)})}return xI(xI({},t),{},m?{x:hc(2*p,t.x,e),y:hc(f/2,t.y,e)}:{x:t.x,y:t.y})});return s.current=v,r.createElement(AI,{props:n,points:v,clipPathId:t,pathRef:a,strokeDasharray:d})}return e>0&&S>0&&(s.current=o,i.current=h),r.createElement(AI,{props:n,points:o,clipPathId:t,pathRef:a,strokeDasharray:d})}),r.createElement(EO,{label:n.label}))}function DI(e){var{clipPathId:t,props:n}=e,a=(0,r.useRef)(null),s=(0,r.useRef)(0),i=(0,r.useRef)(null);return r.createElement(CI,{props:n,clipPathId:t,previousPointsRef:a,longestAnimatedLengthRef:s,pathRef:i})}var TI=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Im(e.payload,t)});class OI extends r.Component{render(){var e,{hide:t,dot:n,points:a,className:s,xAxisId:i,yAxisId:o,top:l,left:c,width:d,height:u,id:h,needClip:m}=this.props;if(t)return null;var p=Xl("recharts-line",s),f=h,{r:g=3,strokeWidth:y=2}=null!==(e=HS(n,!1))&&void 0!==e?e:{r:3,strokeWidth:2},x=VS(n),v=2*g+y;return r.createElement(r.Fragment,null,r.createElement(nE,{className:p},m&&r.createElement("defs",null,r.createElement(lP,{clipPathId:f,xAxisId:i,yAxisId:o}),!x&&r.createElement("clipPath",{id:"clipPath-dots-".concat(f)},r.createElement("rect",{x:c-v/2,y:l-v/2,width:d+v,height:u+v}))),r.createElement(iP,{xAxisId:i,yAxisId:o,data:a,dataPointFormatter:TI,errorBarOffset:0},r.createElement(DI,{props:this.props,clipPathId:f}))),r.createElement(sI,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var PI={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!jS,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function II(e){var t=Ek(e,PI),{activeDot:n,animateNewValues:a,animationBegin:s,animationDuration:i,animationEasing:o,connectNulls:l,dot:c,hide:d,isAnimationActive:u,label:h,legendType:m,xAxisId:p,yAxisId:f,id:g}=t,y=bI(t,gI),{needClip:x}=oP(p,f),v=bk(),b=yp(),w=lp(),j=dm(e=>mI(e,p,f,w,g));if("horizontal"!==b&&"vertical"!==b||null==j||null==v)return null;var{height:N,width:_,x:S,y:k}=v;return r.createElement(OI,wI({},y,{id:g,connectNulls:l,dot:c,activeDot:n,animateNewValues:a,animationBegin:s,animationDuration:i,animationEasing:o,isAnimationActive:u,hide:d,label:h,legendType:m,xAxisId:p,yAxisId:f,points:j,layout:b,height:N,width:_,left:S,top:k,needClip:x}))}function RI(e){var t=Ek(e,PI),n=lp();return r.createElement(EP,{id:t.id,type:"line"},e=>r.createElement(r.Fragment,null,r.createElement(_P,{legendPayload:jI(t)}),r.createElement(nP,{fn:NI,args:t}),r.createElement(AP,{type:"line",id:e,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),r.createElement(II,wI({},t,{id:e}))))}var MI=r.memo(RI);MI.displayName="Line";class LI extends _t.B{static async getHouseAverages(e){const t=this.getCurrentWeek(),n=(new Date).getFullYear();try{const r=(await _t.B.getWhere(_t.I.HOUSE_STATS,"house","==",e)).filter(e=>e.weekNumber===t&&e.year===n);return r.length>0?(console.log("Using cached house stats for ".concat(e," (Week ").concat(t,")")),r.sort((e,t)=>parseInt(e.phaseLabel.replace("Phase ",""))-parseInt(t.phaseLabel.replace("Phase ",""))).map(e=>({phaseLabel:e.phaseLabel,averageDays:e.averageDays}))):(console.warn("No cached house stats found for ".concat(e," (Week ").concat(t,"/").concat(n,")")),[])}catch(r){return console.error("Error fetching house averages:",r),[]}}static async calculateAndCacheHouseAverages(e,t){try{console.log("Starting calculation for ".concat(e," house averages..."));const{UserService:s}=await Promise.resolve().then(n.bind(n,2970)),i=await s.getUsersByHouse(e);console.log("Found ".concat(i.length," students in ").concat(e));const o=await fn.getAllPhaseTimelines(),l=new Map(o.map(e=>[e.phaseId,e])),c=t.filter(e=>"Self Learning Space"!==e.name).sort((e,t)=>e.order-t.order),d=[],u=this.getCurrentWeek(),h=(new Date).getFullYear(),m=await _t.B.getWhere(_t.I.HOUSE_STATS,"house","==",e);for(const e of m)await _t.B.delete(_t.I.HOUSE_STATS,e.id);console.log("Deleted ".concat(m.length," old stats for ").concat(e));for(let t=0;t<c.length;t++){var r;const n=c[t],s=[],o=null===(r=l.get(n.id))||void 0===r?void 0:r.expectedDays;console.log("Processing Phase ".concat(t+1,": ").concat(n.name,"..."));for(const e of i){if(!e.campus_joining_date)continue;const r=await _t.B.getWhere(_t.I.DAILY_GOALS,"student_id","==",e.id),i=r.filter(e=>e.phase_id===n.id);if(0===i.length){c.slice(t+1).some(e=>r.filter(t=>t.phase_id===e.id).length>0)&&o&&s.push(o);continue}let l,d=r.filter(e=>e.phase_id===n.id);if(d.length>0)l=new Date(Math.min(...d.map(e=>new Date(e.created_at).getTime())));else{const e=(await ln.getTopicsByPhase(n.id)).map(e=>e.id),t=r.filter(t=>e.includes(t.topic_id));l=t.length>0?new Date(Math.min(...t.map(e=>new Date(e.created_at).getTime()))):new Date(Math.min(...d.map(e=>new Date(e.created_at).getTime())))}let u=l,h=new Date,m=!1;for(const e of i)try{const t=(await _t.B.getWhere(_t.I.DAILY_REFLECTIONS,"goal_id","==",e.id))[0];if(t&&100===t.achieved_percentage){const e=new Date(t.created_at);(e>h||!m)&&(h=e,m=!0)}}catch(a){}if(m){const e=Math.max(0,Math.ceil((h.getTime()-u.getTime())/864e5));s.push(e)}else o&&s.push(o)}const m=s.length>0?Math.round(s.reduce((e,t)=>e+t,0)/s.length):0,p="Phase ".concat(t+1);d.push({phaseLabel:p,averageDays:m});const f={house:e,phaseId:n.id,phaseLabel:p,averageDays:m,studentCount:s.length,calculatedAt:new Date,weekNumber:u,year:h,created_at:new Date,updated_at:new Date};await _t.B.create(_t.I.HOUSE_STATS,f),console.log("Saved stats for ".concat(p,": ").concat(m," days (").concat(s.length," students)"))}return console.log("Completed calculation for ".concat(e,". Saved ").concat(d.length," phase stats.")),d}catch(a){throw console.error("Error calculating and caching house averages:",a),a}}static async calculateAllHouseStats(e){const t=["Bageshree","Malhar","Bhairav"],n={};for(const a of t)try{n[a]=await this.calculateAndCacheHouseAverages(a,e)}catch(r){console.error("Failed to calculate stats for ".concat(a,":"),r),n[a]=[]}return n}static getCurrentWeek(){const e=new Date,t=new Date(e.getFullYear(),0,1),n=e.getTime()-t.getTime();return Math.ceil(n/6048e5)}static async hasCurrentWeekStats(e){const t=this.getCurrentWeek(),n=(new Date).getFullYear();try{return(await _t.B.getWhere(_t.I.HOUSE_STATS,"house","==",e)).some(e=>e.weekNumber===t&&e.year===n)}catch(r){return!1}}}const FI=()=>{var e;const{userData:t}=Rt(),[n,a]=(0,r.useState)(!0),[s,i]=(0,r.useState)(""),[o,l]=(0,r.useState)([]),[c,d]=(0,r.useState)(""),[u,h]=(0,r.useState)([]),[m,p]=(0,r.useState)(""),[f,g]=(0,r.useState)(null),[y,x]=(0,r.useState)("All"),[v,b]=(0,r.useState)([]);(0,r.useEffect)(()=>{"academic_associate"===(null===t||void 0===t?void 0:t.role)&&null!==t&&void 0!==t&&t.campus&&x(t.campus)},[null===t||void 0===t?void 0:t.role,null===t||void 0===t?void 0:t.campus]);const w=(0,r.useCallback)(async()=>{if(null!==t&&void 0!==t&&t.id)try{var e;a(!0),console.log("Starting journey data load...");const n=m||t.id;console.log("Loading data for user:",n),i("Gathering your learning journey data..."),console.log("Starting to load real journey data..."),i("Loading curriculum structure..."),console.log("Loading phases and topics from database...");const[r,s]=await Promise.all([on.getAllPhases(),ln.getAll(_t.I.TOPICS)]);console.log("Loaded phases from database:",r.length),console.log("Loaded topics from database:",s.length);const o=new Map;s.forEach(e=>{o.has(e.phase_id)||o.set(e.phase_id,[]),o.get(e.phase_id).push(e)}),h(r),i("Looking up your goals and reflections..."),console.log("Loading real goals and reflections..."),console.log("Query parameters:",{collection:_t.I.DAILY_GOALS,field:"student_id",value:n});const d=await cn.getGoalsByStudent(n);console.log("Loaded user goals:",d);const u=await fn.getAllPhaseTimelines(),p=new Map(u.map(e=>[e.phaseId,e]));i("Analyzing your learning progress..."),console.log("Processing phase progress with real data...");const g=r.map(async e=>{var t;const n=o.get(e.id)||[];console.log("Phase ".concat(e.name," has ").concat(n.length," topics"));const a=n.map(async t=>{const n=d.filter(e=>e.topic_id===t.id);console.log("Goals for topic ".concat(t.name,":"),n);let a,s=!1;try{if(n.length>0){const t=e.order;if(d.some(e=>{const n=r.find(t=>t.id===e.phase_id);return n&&n.order>t})){s=!0;const e=n.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime());a=new Date(e[0].created_at)}else s=!1}}catch(c){console.error("Error checking phase completion:",c)}return{topic:t,completed:s,completionDate:a,phaseName:e.name}}),s=await Promise.all(a);let i=d.filter(t=>t.phase_id===e.id);if(0===i.length){const t=n.map(e=>e.id);i=d.filter(e=>t.includes(e.topic_id)),console.log("Phase ".concat(e.name,": found ").concat(i.length," goals via topic fallback"))}else console.log("Phase ".concat(e.name,": found ").concat(i.length," goals via phase_id"));const l=i.length>0?new Date(Math.min(...i.map(e=>new Date(e.created_at).getTime()))):void 0,u=s.filter(e=>e.completed).length,h=s.length,m=h>0?u/h*100:0,f=(null===(t=p.get(e.id))||void 0===t?void 0:t.expectedDays)||null;return{phase:e,topics:s,completedTopics:u,totalTopics:h,progressPercentage:m,expectedDays:f,earliestGoalDate:l}}),y=await Promise.all(g);console.log("Detailed phase progress:",JSON.stringify(y,null,2)),console.log("Summary phase progress:",y.map(e=>({phase:e.phase.name,completed:e.completedTopics,total:e.totalTopics,percentage:Math.round(e.progressPercentage),topics:e.topics.map(e=>({name:e.topic.name,completed:e.completed,completionDate:e.completionDate}))}))),l(y);const x=((e,t)=>{const n=new Date,r=[],a=e.filter(e=>"Self Learning Space"!==e.phase.name).sort((e,t)=>e.phase.order-t.phase.order);return a.forEach((e,s)=>{let i,o,l;if(e.earliestGoalDate)i=e.earliestGoalDate;else if(0===s)i=t||n;else{const e=a[s-1].topics.filter(e=>e.completed&&e.completionDate).sort((e,t)=>{var n,r;return((null===(n=t.completionDate)||void 0===n?void 0:n.getTime())||0)-((null===(r=e.completionDate)||void 0===r?void 0:r.getTime())||0)})[0];i=(null===e||void 0===e?void 0:e.completionDate)||t||n}if(100===e.progressPercentage){const t=e.topics.filter(e=>e.completed&&e.completionDate).sort((e,t)=>{var n,r;return((null===(n=t.completionDate)||void 0===n?void 0:n.getTime())||0)-((null===(r=e.completionDate)||void 0===r?void 0:r.getTime())||0)})[0];o=(null===t||void 0===t?void 0:t.completionDate)||n,l="completed"}else e.completedTopics>0?(o=n,l="current"):(o=i,l="not_started");const c=Math.max(0,Math.ceil((o.getTime()-i.getTime())/864e5)),d="completed"===l?"#10B981":"current"===l?"#3B82F6":"#E5E7EB";r.push({phaseName:e.phase.name,daysSpent:c,status:l,color:d,phaseLabel:"Phase ".concat(e.phase.order)})}),r})(y,null===(e=f||t)||void 0===e?void 0:e.campus_joining_date);console.log("Duration data:",x);let v=[];const w=f||t;if(null!==w&&void 0!==w&&w.house)try{i("Loading house comparison data..."),console.log("Loading cached house average data..."),v=await LI.getHouseAverages(w.house),console.log("Loaded house averages from cache:",v),0===v.length&&console.warn("No cached house stats found. Admin should refresh house statistics.")}catch(c){console.warn("Failed to load house averages:",c)}const j=((e,t)=>{const n=[],r=new Map(t.map(e=>[e.phaseLabel,e.averageDays]));let a=0;return e.forEach(e=>{a+=e.daysSpent;const t=r.get(e.phaseLabel)||0;n.push({phaseLabel:e.phaseLabel,yourDays:e.daysSpent,cumulativeDays:a,houseAverage:t})}),n})(x,v);console.log("Combined chart data:",j),b(j),console.log("Real journey data loaded successfully")}catch(c){console.error("Error loading real journey data:",c),d("Failed to load journey data")}finally{a(!1)}},[t,m,f]),j=(0,r.useRef)(null);if((0,r.useEffect)(()=>{const e="".concat(m||(null===t||void 0===t?void 0:t.id));j.current!==e&&(j.current=e,w())},[w,m,null===t||void 0===t?void 0:t.id]),n)return(0,Pt.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,Pt.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:(0,Pt.jsx)("div",{className:"w-8 h-8 bg-white rounded-full"})})]}),(0,Pt.jsxs)("div",{className:"text-center space-y-2",children:[(0,Pt.jsx)("p",{className:"text-lg font-medium text-gray-800",children:s||"Preparing your journey data..."}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"This might take a moment"})]})]});if(c)return(0,Pt.jsx)("div",{className:"text-center py-12",children:(0,Pt.jsx)("p",{className:"text-red-600",children:c})});const N=o.reduce((e,t)=>e+t.completedTopics,0),_=o.reduce((e,t)=>e+t.totalTopics,0),S=_>0?N/_*100:0;return(0,Pt.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,Pt.jsxs)("div",{className:"mb-8",children:[(0,Pt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Learning Journey"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Track your progress through the curriculum phases and topics"})]}),((null===t||void 0===t?void 0:t.isAdmin)||"academic_associate"===(null===t||void 0===t?void 0:t.role))&&(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Filter Students"}),(0,Pt.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[null!==t&&void 0!==t&&t.isAdmin?(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Campus"}),(0,Pt.jsx)(Yl,{selectedCampus:y,onCampusSelect:e=>{"academic_associate"!==(null===t||void 0===t?void 0:t.role)&&(x(e),p(""),g(null))}})]}):(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Campus"}),(0,Pt.jsx)("div",{className:"px-4 py-2 text-gray-700 bg-gray-100 border border-gray-300 rounded-md",children:(null===t||void 0===t?void 0:t.campus)||"Not Set"})]}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student"}),(0,Pt.jsx)(Ql,{onUserSelect:async e=>{if(p(e),e)try{const t=(await _t.B.getWhere(_t.I.USERS,"id","==",e))[0];g(t)}catch(c){console.error("Error fetching selected user:",c)}else g(null)},currentUserId:m||(null===t||void 0===t?void 0:t.id),campusFilter:y})]})]}),f&&(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-4",children:["Viewing journey for: ",f.display_name||f.name||f.email]})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-xl shadow-xl p-4 mb-8",children:[(0,Pt.jsxs)("div",{className:"mb-8",children:[(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4",children:[(0,Pt.jsxs)("div",{className:"min-w-0",children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 truncate",children:(null===f||void 0===f?void 0:f.name)||(null===t||void 0===t?void 0:t.name)}),(0,Pt.jsxs)("p",{className:"text-gray-600 text-sm truncate",children:["Student ID: ",(0,Pt.jsx)("span",{className:"font-mono break-words flex flex-wrap",children:(null===f||void 0===f?void 0:f.id)||(null===t||void 0===t?void 0:t.id)})]})]}),(0,Pt.jsxs)("div",{className:"text-right mt-4 sm:mt-0 flex-shrink-0",children:[(0,Pt.jsx)("div",{className:"text-sm text-gray-500",children:"Current Phase"}),(0,Pt.jsx)("div",{className:"text-lg font-semibold text-blue-600",children:(null===f||void 0===f?void 0:f.current_phase_name)||(null===t||void 0===t?void 0:t.current_phase_name)||"Not Set"})]})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,Pt.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Pt.jsx)(ma,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,Pt.jsx)("span",{className:"font-semibold text-blue-900",children:"Total Phases"})]}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:u.length})]}),(0,Pt.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Pt.jsx)(Yn,{className:"h-5 w-5 text-green-600 mr-2"}),(0,Pt.jsx)("span",{className:"font-semibold text-green-900",children:"Total Topics"})]}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-green-700",children:_})]}),(0,Pt.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Pt.jsx)($l,{className:"h-5 w-5 text-yellow-600 mr-2"}),(0,Pt.jsx)("span",{className:"font-semibold text-yellow-900",children:"Completed"})]}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-yellow-700",children:N})]}),(0,Pt.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Pt.jsx)($n,{className:"h-5 w-5 text-purple-600 mr-2"}),(0,Pt.jsx)("span",{className:"font-semibold text-purple-900",children:"Progress"})]}),(0,Pt.jsxs)("p",{className:"text-2xl font-bold text-purple-700",children:[Math.round(S),"%"]})]})]})]}),(0,Pt.jsxs)("div",{className:"mb-8",children:[(0,Pt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Phase Duration Analysis"}),(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Pt.jsxs)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:["Your Progress vs ",null===(e=f||t)||void 0===e?void 0:e.house," House Average"]}),(0,Pt.jsx)("div",{className:"h-64 sm:h-80",children:v.length>0?(0,Pt.jsx)(bc,{width:"100%",height:"100%",children:(0,Pt.jsxs)(Pk,{data:v,margin:{top:20,right:30,left:20,bottom:5},children:[(0,Pt.jsx)(wA,{strokeDasharray:"3 3"}),(0,Pt.jsx)(PA,{dataKey:"phaseLabel",tick:{fontSize:12}}),(0,Pt.jsx)(WA,{yAxisId:"left",label:{value:"Days",angle:-90,position:"insideLeft"},tick:{fontSize:12}}),(0,Pt.jsx)(jT,{formatter:(e,t)=>"yourDays"===t?["".concat(e," days"),"Phase Days"]:"cumulativeDays"===t?["".concat(e," days"),"Cumulative Total"]:"houseAverage"===t?["".concat(e," days"),"House Average"]:["".concat(e," days"),t],labelFormatter:e=>"".concat(e)}),(0,Pt.jsx)(pO,{}),(0,Pt.jsx)(ZP,{yAxisId:"left",dataKey:"yourDays",fill:"#3B82F6",name:"Phase Days",radius:[8,8,0,0]}),(0,Pt.jsx)(MI,{yAxisId:"left",type:"monotone",dataKey:"cumulativeDays",stroke:"#F59E0B",strokeWidth:3,dot:{fill:"#F59E0B",strokeWidth:2,r:6},activeDot:{r:8,stroke:"#F59E0B",strokeWidth:2},name:"Cumulative Total"}),(0,Pt.jsx)(MI,{yAxisId:"left",type:"monotone",dataKey:"houseAverage",stroke:"#10B981",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"#10B981",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#10B981",strokeWidth:2},name:"House Average"})]})}):(0,Pt.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:"Loading chart data..."})}),(0,Pt.jsxs)("div",{className:"flex flex-wrap justify-center mt-6 gap-4 text-sm",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"w-6 h-4 bg-blue-500 rounded mr-2"}),(0,Pt.jsx)("span",{children:"Phase Days (Bar)"})]}),(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"w-6 h-1 bg-amber-500 rounded mr-2"}),(0,Pt.jsx)("span",{children:"Cumulative Total (Line)"})]}),(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"w-6 h-1 bg-green-500 rounded mr-2",style:{borderTop:"2px dashed #10B981"}}),(0,Pt.jsx)("span",{children:"House Average (Dashed)"})]})]})]})]}),(0,Pt.jsxs)("div",{className:"mb-8",children:[(0,Pt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Phase Progress"}),(0,Pt.jsx)("div",{className:"space-y-4",children:o.map(e=>(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2",children:[(0,Pt.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:e.phase.name}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 mt-3 sm:mt-0",children:[e.expectedDays&&(0,Pt.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["Expected: ",e.expectedDays," days"]}),(0,Pt.jsxs)("span",{className:"text-sm text-gray-600",children:[e.completedTopics,"/",e.totalTopics," topics completed"]})]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.progressPercentage,"%")}})}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[Math.round(e.progressPercentage),"% complete"]})]},e.phase.id))})]})]})]})},UI=Un("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const BI=new class{constructor(){this.tokenClient=null,this.accessToken=null,this.isAuthenticated=!1,this.initializeTokenClient()}async initializeTokenClient(){try{var e,t;const n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GOOGLE_CLIENT_ID;if(!n||"your_google_client_id_here"===n)return void console.warn("Google API client ID not configured, skipping TokenClient initialization");null!==(e=window.google)&&void 0!==e&&null!==(t=e.accounts)&&void 0!==t&&t.oauth2?(this.tokenClient=window.google.accounts.oauth2.initTokenClient({client_id:n,scope:"https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events",callback:e=>{e.error?(console.error("Token client error:",e),this.isAuthenticated=!1):(this.accessToken=e.access_token,this.isAuthenticated=!0,console.log("Token client success, access token obtained"))}}),console.log("Initialized Google Identity Services TokenClient")):console.warn("Google Identity Services not available, will use Firebase Auth tokens only")}catch(n){console.warn("Failed to initialize TokenClient, using Firebase Auth tokens:",n)}}async authenticateWithGoogle(){try{const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GOOGLE_CLIENT_ID;if(!t||"your_google_client_id_here"===t)return console.warn("Google API client ID not configured, skipping Google Calendar authentication"),this.isAuthenticated=!1,!1;const n=Nt.j2.currentUser;if(!n)throw new Error("User not authenticated with Firebase");try{const e=await n.getIdToken();if(e)return this.tokenClient?new Promise(e=>{this.tokenClient.requestAccessToken({prompt:""}),setTimeout(()=>{e(this.isAuthenticated)},1e3)}):(this.accessToken=e,this.isAuthenticated=!0,!0)}catch(e){console.warn("Failed to get Firebase token for Calendar API:",e)}return this.isAuthenticated=!1,!1}catch(t){return console.error("Authentication failed:",t),this.isAuthenticated=!1,!1}}async getCalendarEvents(e,t){const n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GOOGLE_CLIENT_ID;if(!n||"your_google_client_id_here"===n)return console.warn("Google API client ID not configured, returning empty calendar events"),[];if(!this.isAuthenticated||!this.accessToken)return console.warn("Google Calendar not authenticated, returning empty events"),[];try{const n=new URLSearchParams({timeMin:(null===e||void 0===e?void 0:e.toISOString())||(new Date).toISOString(),singleEvents:"true",orderBy:"startTime"});t&&n.append("timeMax",t.toISOString());const r=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events?".concat(n),{headers:{Authorization:"Bearer ".concat(this.accessToken),Accept:"application/json"}});if(!r.ok)throw new Error("Calendar API error: ".concat(r.status," ").concat(r.statusText));return(await r.json()).items.map(e=>({id:e.id,summary:e.summary,description:e.description,start:e.start,end:e.end,attendees:e.attendees,location:e.location,status:e.status}))}catch(r){throw console.error("Failed to fetch calendar events:",r),r}}async createCalendarEvent(e){const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GOOGLE_CLIENT_ID;if(!t||"your_google_client_id_here"===t)throw new Error("Google API client ID not configured");if(!this.isAuthenticated||!this.accessToken)throw new Error("Google Calendar not authenticated");try{var n;const t={summary:e.summary,description:e.description,start:{dateTime:e.start.toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},end:{dateTime:e.end.toISOString(),timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},attendees:null===(n=e.attendees)||void 0===n?void 0:n.map(e=>({email:e})),location:e.location},r=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events",{method:"POST",headers:{Authorization:"Bearer ".concat(this.accessToken),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error("Calendar API error: ".concat(r.status," ").concat(r.statusText));const a=await r.json();return{id:a.id,summary:a.summary,description:a.description,start:a.start,end:a.end,attendees:a.attendees,location:a.location,status:a.status}}catch(r){throw console.error("Failed to create calendar event:",r),r}}async updateCalendarEvent(e,t){if(!this.isAuthenticated||!this.accessToken)throw new Error("Google Calendar not authenticated");try{const n=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events/".concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(this.accessToken),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Calendar API error: ".concat(n.status," ").concat(n.statusText));const r=await n.json();return{id:r.id,summary:r.summary,description:r.description,start:r.start,end:r.end,attendees:r.attendees,location:r.location,status:r.status}}catch(n){throw console.error("Failed to update calendar event:",n),n}}async deleteCalendarEvent(e){if(!this.isAuthenticated||!this.accessToken)throw new Error("Google Calendar not authenticated");try{const t=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(this.accessToken),Accept:"application/json"}});if(!t.ok)throw new Error("Calendar API error: ".concat(t.status," ").concat(t.statusText))}catch(t){throw console.error("Failed to delete calendar event:",t),t}}filterPairProgrammingEvents(e){const t=["pair programming","pair-programming","mentoring","mentoring session","code review","code-review","debugging session","programming help","coding session","1:1 mentoring","one-on-one","tutoring","teaching session"];return e.filter(e=>{if(!e.summary)return!1;const n=e.summary.toLowerCase(),r=(e.description||"").toLowerCase(),a="".concat(n," ").concat(r);return t.some(e=>a.includes(e))}).map(e=>{const t=this.extractMentorInfo(e);return{id:e.id,mentorId:t.id,mentorName:t.name,startTime:new Date(e.start.dateTime),endTime:new Date(e.end.dateTime),topic:this.extractTopicFromEvent(e),isAvailable:this.isSlotAvailable(e),calendarEventId:e.id}})}extractMentorInfo(e){if(e.attendees&&e.attendees.length>0){const t=e.attendees.find(e=>"accepted"===e.responseStatus);if(t)return{id:t.email||"",name:t.displayName||t.email||"Unknown Mentor"};const n=e.attendees[0];return{id:n.email||"",name:n.displayName||n.email||"Unknown Mentor"}}const t="".concat(e.summary," ").concat(e.description||"").toLowerCase(),n=[/mentor:\s*([^,\n]+)/i,/with\s+([^,\n]+)\s*(?:\(|$)/i,/tutor:\s*([^,\n]+)/i];for(const r of n){const e=t.match(r);if(e)return{id:"",name:e[1].trim()}}return{id:"",name:"Unknown Mentor"}}isSlotAvailable(e){var t;if("confirmed"!==e.status)return!1;if(null!==(t=e.attendees)&&void 0!==t&&t.some(e=>"declined"===e.responseStatus))return!1;const n=new Date;return!(new Date(e.start.dateTime)<n)}extractTopicFromEvent(e){const t="".concat(e.summary," ").concat(e.description||"").toLowerCase(),n=[/topic:\s*([^,\n]+)/i,/subject:\s*([^,\n]+)/i,/focus:\s*([^,\n]+)/i,/about:\s*([^,\n]+)/i,/regarding:\s*([^,\n]+)/i];for(const r of n){const e=t.match(r);if(e)return e[1].trim()}return e.summary||"General Pair Programming"}async getAvailableSlots(e,t,n){try{const r=await this.getCalendarEvents(t,n);return this.filterPairProgrammingEvents(r).filter(t=>t.mentorId===e&&t.isAvailable)}catch(r){return console.error("Failed to get available slots:",r),[]}}async checkAvailability(e,t,n){try{const e=await this.getCalendarEvents(t,n);return 0===e.filter(e=>"confirmed"===e.status&&new Date(e.start.dateTime)<n&&new Date(e.end.dateTime)>t).length}catch(r){return console.error("Failed to check availability:",r),!1}}isCalendarAuthenticated(){return this.isAuthenticated}async refreshAuth(){await this.authenticateWithGoogle()}},zI=()=>{var e,t;const n=he(),a=ce(),[s,i]=(0,r.useState)(!1),[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[u,h]=(0,r.useState)("checking"),m=(null===(e=a.state)||void 0===e?void 0:e.returnTo)||"/dashboard",p=(null===(t=a.state)||void 0===t?void 0:t.action)||"connect",f=(0,r.useCallback)(async()=>{if(c){i(!0),l(null);try{if(await BI.authenticateWithGoogle())h("connected"),setTimeout(()=>{n(m,{replace:!0})},2e3);else{const e=new URLSearchParams(window.location.search);e.has("code")||e.has("state")||e.has("access_token")?(h("checking"),setTimeout(async()=>{BI.isCalendarAuthenticated()?(h("connected"),n(m,{replace:!0})):(h("not_connected"),l("Authentication failed. Please try again."),i(!1))},1e3)):(h("not_connected"),l("Failed to connect to Google Calendar. Please try again."),i(!1))}}catch(o){console.error("Calendar connection failed:",o),h("not_connected"),l("Failed to connect to Google Calendar. Please check your permissions and try again."),i(!1)}}else l("Please sign in first")},[c,n,m]);(0,r.useEffect)(()=>{(async()=>{const e=new URLSearchParams(window.location.search);if(e.has("code")||e.has("state")||e.has("access_token")){h("checking");try{setTimeout(async()=>{BI.isCalendarAuthenticated()?(h("connected"),window.history.replaceState({},document.title,window.location.pathname),setTimeout(()=>{n(m,{replace:!0})},2e3)):(h("not_connected"),l("Authentication failed. Please try again."))},2e3)}catch(o){console.error("Error checking auth status:",o),h("not_connected"),l("Authentication failed. Please try again.")}return}const t=(0,jt.hg)(Nt.j2,e=>{d(e),e&&"connect"===p&&f()})})()},[p,f,n,m]);const g=()=>{n(m,{replace:!0})};return c?(0,Pt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Pt.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:[(0,Pt.jsxs)("div",{className:"text-center mb-6",children:[(0,Pt.jsx)(Bn,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,Pt.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Google Calendar Integration"}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-2",children:"Connect your Google Calendar to schedule and manage pair programming sessions"})]}),o&&(0,Pt.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-md p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-red-400 mr-3"}),(0,Pt.jsx)("p",{className:"text-sm text-red-700",children:o})]})}),(0,Pt.jsxs)("div",{className:"space-y-4",children:["checking"===u&&(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)(Fl,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Checking connection status..."})]}),"connected"===u&&(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)(qn,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Successfully Connected!"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:"Your Google Calendar is now connected."}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"Redirecting you back..."})]}),"not_connected"===u&&(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)(Hn,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Calendar Not Connected"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:"Click the button below to connect your Google Calendar and enable scheduling features."}),(0,Pt.jsx)("button",{onClick:f,disabled:s,className:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:s?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Fl,{className:"h-5 w-5 mr-3 animate-spin"}),"Connecting..."]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Bn,{className:"h-5 w-5 mr-3"}),"Connect Google Calendar"]})})]})]}),(0,Pt.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,Pt.jsxs)("button",{onClick:g,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[(0,Pt.jsx)(UI,{className:"h-4 w-4 mr-2"}),"Cancel and Go Back"]})}),(0,Pt.jsxs)("div",{className:"mt-6 text-xs text-gray-500 text-center",children:[(0,Pt.jsx)("p",{className:"mb-2",children:(0,Pt.jsx)("strong",{children:"What we'll access:"})}),(0,Pt.jsxs)("ul",{className:"space-y-1",children:[(0,Pt.jsx)("li",{children:"\u2022 Read your calendar events to check availability"}),(0,Pt.jsx)("li",{children:"\u2022 Create events for scheduled sessions"}),(0,Pt.jsx)("li",{children:"\u2022 Update existing events when sessions change"})]})]})]})}):(0,Pt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)(Hn,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),(0,Pt.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Authentication Required"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-6",children:"Please sign in to connect your Google Calendar."}),(0,Pt.jsxs)("button",{onClick:g,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[(0,Pt.jsx)(UI,{className:"h-4 w-4 mr-2"}),"Go Back"]})]})})},qI=Un("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),VI=e=>{let{onConnectionChange:t}=e;const n=he(),[a,s]=(0,r.useState)(!1),[i,o]=(0,r.useState)(null),[l,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=(0,jt.hg)(Nt.j2,e=>{c(e),e?setTimeout(()=>{d()},1e3):s(!1)});return()=>e()},[]);const d=async()=>{try{await BI.getCalendarEvents(new Date,new Date(Date.now()+864e5)),s(!0),null===t||void 0===t||t(!0)}catch(i){console.log("Calendar not connected or error checking status:",i),s(!1),null===t||void 0===t||t(!1)}};return l?(0,Pt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(Bn,{className:"h-6 w-6 text-blue-600 mr-3"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Google Calendar Integration"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Connect your Google Calendar to schedule pair programming sessions"})]})]}),(0,Pt.jsx)("div",{className:"flex items-center",children:a?(0,Pt.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,Pt.jsx)(qn,{className:"h-5 w-5 mr-2"}),(0,Pt.jsx)("span",{className:"text-sm font-medium",children:"Connected"})]}):(0,Pt.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 mr-2"}),(0,Pt.jsx)("span",{className:"text-sm",children:"Not Connected"})]})})]}),i&&(0,Pt.jsx)("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-md p-3",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(Hn,{className:"h-4 w-4 text-red-400 mr-2"}),(0,Pt.jsx)("p",{className:"text-sm text-red-700",children:i})]})}),(0,Pt.jsx)("div",{className:"mt-4",children:a?(0,Pt.jsx)("button",{onClick:()=>{l&&localStorage.removeItem("google_oauth_".concat(l.uid)),s(!1),null===t||void 0===t||t(!1)},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Disconnect Calendar"}):(0,Pt.jsxs)("button",{onClick:async()=>{l?n("/calendar-auth",{state:{returnTo:window.location.pathname,action:"connect"}}):o("Please sign in first")},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,Pt.jsx)(Bn,{className:"h-4 w-4 mr-2"}),"Connect Google Calendar"]})}),(0,Pt.jsxs)("div",{className:"mt-4 text-xs text-gray-500",children:[(0,Pt.jsx)("p",{children:"By connecting your Google Calendar, you allow the app to:"}),(0,Pt.jsxs)("ul",{className:"mt-1 list-disc list-inside space-y-1",children:[(0,Pt.jsx)("li",{children:"Read your calendar events to check availability"}),(0,Pt.jsx)("li",{children:"Create events for scheduled pair programming sessions"}),(0,Pt.jsx)("li",{children:"Update existing events when sessions are modified"})]})]})]}):(0,Pt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-yellow-400 mr-2"}),(0,Pt.jsx)("p",{className:"text-sm text-yellow-700",children:"Please sign in to connect your Google Calendar"})]})})},HI=()=>{var e,t,n;const{userData:a}=Rt(),[s,i]=(0,r.useState)({current:"form",assignedMentor:null}),[l,c]=(0,r.useState)({topic:"",description:"",session_type:null,priority:"medium",preferred_date:"",preferred_time:"",duration_minutes:60,tags:[],is_recurring:!1}),[d,u]=(0,r.useState)({}),[h,m]=(0,r.useState)(!0),[p,f]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[x,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{null!==a&&void 0!==a&&a.id&&(async()=>{try{if(m(!0),null!==a&&void 0!==a&&a.mentor_id){const e=await _t.UserService.getUserById(a.mentor_id);e?i(t=>(0,o.A)((0,o.A)({},t),{},{assignedMentor:e})):u({submit:"Could not load your assigned mentor. Please try again."})}else u({submit:"You do not have an assigned mentor. Please request a mentor first."});if(null!==a&&void 0!==a&&a.id){const e=await mn.getStudentCurrentTopicAndPhase(a.id);e&&(v(e),c(t=>(0,o.A)((0,o.A)({},t),{},{topic:e.topic})))}}catch(e){console.error("Error initializing form:",e),u({submit:"Failed to load form data. Please try again."})}finally{m(!1)}})()},[null===a||void 0===a?void 0:a.id,null===a||void 0===a?void 0:a.mentor_id]);const b=(e,t)=>{c(n=>(0,o.A)((0,o.A)({},n),{},{[e]:t})),d[e]&&u(t=>(0,o.A)((0,o.A)({},t),{},{[e]:""}))},w=[{value:"one_on_one",label:"One-on-One / Personal Mentoring",description:"Personal mentoring session with your assigned mentor"},{value:"code_review",label:"Code/Debug Review",description:"Review and improve existing code"},{value:"project_planning",label:"Project Planning",description:"Plan and architect new projects"}],j=[{value:"low",label:"Low",color:"text-green-600"},{value:"medium",label:"Medium",color:"text-yellow-600"},{value:"high",label:"High",color:"text-orange-600"},{value:"urgent",label:"Urgent",color:"text-red-600"}],N=()=>{"review"===s.current&&i(e=>(0,o.A)((0,o.A)({},e),{},{current:"form"}))};return h?(0,Pt.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,Pt.jsx)(Fl,{className:"w-8 h-8 animate-spin text-blue-500"})}):(0,Pt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:(0,Pt.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Pt.jsxs)("div",{className:"mb-8",children:[(0,Pt.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Request Pair Programming Session"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Book a session with your assigned mentor"})]}),d.submit&&(0,Pt.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[(0,Pt.jsx)(Hn,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"font-semibold text-red-900",children:"Error"}),(0,Pt.jsx)("p",{className:"text-red-700 text-sm",children:d.submit})]})]}),"success"===s.current&&(0,Pt.jsxs)("div",{className:"mb-6 p-6 bg-green-50 border border-green-200 rounded-lg flex items-start gap-4",children:[(0,Pt.jsx)(qI,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"font-semibold text-green-900 text-lg",children:"Session Created Successfully!"}),(0,Pt.jsx)("p",{className:"text-green-700 mt-1",children:"Your session request has been created and your mentor will be notified."}),(0,Pt.jsx)("p",{className:"text-green-600 text-sm mt-2",children:"Redirecting to your sessions..."})]})]}),"form"===s.current&&s.assignedMentor&&(0,Pt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 space-y-6",children:[(0,Pt.jsxs)("div",{className:"bg-blue-50 rounded-lg border-l-4 border-blue-500 p-4 mb-6",children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Assigned Mentor:"}),(0,Pt.jsx)("p",{className:"text-lg font-bold text-gray-900",children:s.assignedMentor.display_name||s.assignedMentor.name}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:s.assignedMentor.email})]}),(0,Pt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return l.topic&&""!==l.topic.trim()||(e.topic="Please describe what you want to work on"),l.description&&""!==l.description.trim()||(e.description="Please provide a description"),l.session_type||(e.session_type="Please select a session type"),(l.duration_minutes<30||l.duration_minutes>180)&&(e.duration_minutes="Duration must be between 30 and 180 minutes"),u(e),0===Object.keys(e).length})())if(s.assignedMentor&&null!==a&&void 0!==a&&a.id)try{f(!0),u({});const e={student_id:a.id,topic:l.topic,description:l.description,session_type:l.session_type,priority:l.priority,preferred_date:l.preferred_date,preferred_time:l.preferred_time,duration_minutes:l.duration_minutes,max_participants:1,tags:l.tags||[],specific_mentor_id:s.assignedMentor.id,is_recurring:l.is_recurring||!1,recurring_pattern:null,status:"pending",mentor_id:s.assignedMentor.id,scheduled_date:l.preferred_date?new Date(l.preferred_date):void 0,scheduled_time:l.preferred_time||void 0,completed_at:void 0,feedback_submitted:!1,notes:void 0};await xn.createSessionRequest(e),i(e=>(0,o.A)((0,o.A)({},e),{},{current:"review"}))}catch(t){console.error("Error creating session request:",t),u({submit:"Failed to create session request. Please try again."})}finally{f(!1)}else u({submit:"Mentor information is missing. Please refresh and try again."})},className:"space-y-6",children:[(0,Pt.jsx)(VI,{}),(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What do you want to work on? *"}),(0,Pt.jsx)("input",{type:"text",value:l.topic,onChange:e=>b("topic",e.target.value),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.topic?"border-red-300":"border-gray-300"),placeholder:"Describe what you want to work on"}),x&&(0,Pt.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Current: ",x.topic," (Phase:"," ",x.phase,")"]}),d.topic&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.topic})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Session Type *"}),(0,Pt.jsx)("div",{className:"grid grid-cols-1 gap-3",children:w.map(e=>(0,Pt.jsxs)("label",{className:"flex items-start",children:[(0,Pt.jsx)("input",{type:"radio",name:"session_type",value:e.value,checked:l.session_type===e.value,onChange:e=>b("session_type",e.target.value),className:"text-blue-600 focus:ring-blue-500 mt-1"}),(0,Pt.jsxs)("div",{className:"ml-3",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.label}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]},e.value))}),d.session_type&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.session_type})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,Pt.jsx)("textarea",{value:l.description,onChange:e=>b("description",e.target.value),rows:4,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.description?"border-red-300":"border-gray-300"),placeholder:"Describe what you want to work on, what you're struggling with, or what you want to learn..."}),d.description&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.description})]})]}),(0,Pt.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,Pt.jsxs)("button",{type:"button",onClick:()=>y(!g),className:"flex items-center justify-between w-full text-left",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Optional Preferences"}),g?(0,Pt.jsx)(fa,{className:"h-5 w-5 text-gray-500"}):(0,Pt.jsx)(rr,{className:"h-5 w-5 text-gray-500"})]}),g&&(0,Pt.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Priority Level"}),(0,Pt.jsx)("div",{className:"flex space-x-4",children:j.map(e=>(0,Pt.jsxs)("label",{className:"flex items-center",children:[(0,Pt.jsx)("input",{type:"radio",name:"priority",value:e.value,checked:l.priority===e.value,onChange:e=>b("priority",e.target.value),className:"text-blue-600 focus:ring-blue-500"}),(0,Pt.jsx)("span",{className:"ml-2 text-sm font-medium ".concat(e.color),children:e.label})]},e.value))})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Date & Time"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"We'll check your mentor's availability and suggest the best times"}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Pt.jsx)("div",{children:(0,Pt.jsx)("input",{type:"date",value:l.preferred_date,onChange:e=>b("preferred_date",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,Pt.jsx)("div",{children:(0,Pt.jsx)("input",{type:"time",value:l.preferred_time,onChange:e=>b("preferred_time",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),(0,Pt.jsx)("input",{type:"number",min:"30",max:"180",step:"15",value:l.duration_minutes,onChange:e=>b("duration_minutes",parseInt(e.target.value)),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.duration_minutes?"border-red-300":"border-gray-300")}),d.duration_minutes&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.duration_minutes})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),(0,Pt.jsx)("input",{type:"text",value:null===(e=l.tags)||void 0===e?void 0:e.join(", "),onChange:e=>b("tags",e.target.value.split(",").map(e=>e.trim()).filter(e=>e)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., React, JavaScript, Algorithms (comma-separated)"})]}),(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("input",{type:"checkbox",id:"is_recurring",checked:l.is_recurring,onChange:e=>b("is_recurring",e.target.checked),className:"text-blue-600 focus:ring-blue-500"}),(0,Pt.jsx)("label",{htmlFor:"is_recurring",className:"ml-2 text-sm text-gray-700",children:"Make this a recurring session"})]})]})]}),d.submit&&(0,Pt.jsxs)("div",{className:"flex items-center p-4 bg-red-50 border border-red-200 rounded-md",children:[(0,Pt.jsx)(oa,{className:"h-5 w-5 text-red-400 mr-3"}),(0,Pt.jsx)("p",{className:"text-sm text-red-700",children:d.submit})]}),(0,Pt.jsx)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:(0,Pt.jsx)("button",{type:"submit",disabled:p,className:"px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:p?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Fl,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(qI,{className:"w-4 h-4"}),"Create Session Request"]})})})]})]}),"review"===s.current&&s.assignedMentor&&(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsx)("button",{onClick:N,className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 font-medium",children:"\u2190 Back to Edit"}),(0,Pt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Review Your Request"}),(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"pb-6 border-b border-gray-200",children:[(0,Pt.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase mb-3",children:"Mentor"}),(0,Pt.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:s.assignedMentor.display_name||s.assignedMentor.name}),(0,Pt.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:s.assignedMentor.email})]}),(0,Pt.jsxs)("div",{className:"pb-6 border-b border-gray-200",children:[(0,Pt.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase mb-3",children:"Session Details"}),(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Topic"}),(0,Pt.jsx)("p",{className:"font-bold text-gray-900",children:l.topic})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Session Type"}),(0,Pt.jsx)("p",{className:"font-bold text-gray-900",children:(null===(t=w.find(e=>e.value===l.session_type))||void 0===t?void 0:t.label)||"Not specified"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Description"}),(0,Pt.jsx)("p",{className:"text-gray-700",children:l.description})]})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-semibold text-gray-600 uppercase mb-3",children:"Preferences"}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Priority"}),(0,Pt.jsx)("p",{className:"font-bold text-gray-900",children:null===(n=j.find(e=>e.value===l.priority))||void 0===n?void 0:n.label})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Duration"}),(0,Pt.jsxs)("p",{className:"font-bold text-gray-900",children:[l.duration_minutes," minutes"]})]}),l.preferred_date&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Preferred Date"}),(0,Pt.jsx)("p",{className:"font-bold text-gray-900",children:new Date(l.preferred_date).toLocaleDateString()})]}),l.preferred_time&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Preferred Time"}),(0,Pt.jsx)("p",{className:"font-bold text-gray-900",children:l.preferred_time})]})]})]})]}),(0,Pt.jsxs)("div",{className:"mt-8 flex gap-4",children:[(0,Pt.jsx)("button",{onClick:N,className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-50 transition-colors",children:"Back to Edit"}),(0,Pt.jsxs)("button",{onClick:async()=>{i(e=>(0,o.A)((0,o.A)({},e),{},{current:"success"})),setTimeout(()=>{c({topic:"",description:"",session_type:null,priority:"medium",preferred_date:"",preferred_time:"",duration_minutes:60,tags:[],is_recurring:!1}),i(e=>(0,o.A)((0,o.A)({},e),{},{current:"form"}))},3e3)},className:"flex-1 px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[(0,Pt.jsx)(qI,{className:"w-4 h-4"}),"Confirm & Submit"]})]})]})]})]})})},WI=Un("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),GI=Un("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),KI=Un("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),QI=Un("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),YI=Un("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),$I=Un("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),JI=()=>(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 animate-pulse",children:[(0,Pt.jsx)("div",{className:"h-5 bg-gray-200 rounded mb-2"}),(0,Pt.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2 w-3/4"}),(0,Pt.jsxs)("div",{className:"flex space-x-4 mb-2",children:[(0,Pt.jsx)("div",{className:"h-4 bg-gray-200 rounded w-16"}),(0,Pt.jsx)("div",{className:"h-4 bg-gray-200 rounded w-20"})]})]}),XI=e=>{let{campusId:t}=e;const{userData:n}=Rt(),[a,s]=(0,r.useState)(null),[i,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(""),[u,h]=(0,r.useState)("all"),[m,p]=(0,r.useState)(1),[f,g]=(0,r.useState)(null),[y,x]=(0,r.useState)([]),[v,b]=(0,r.useState)([]),[w,j]=(0,r.useState)(!1),[N,_]=(0,r.useState)(""),[S,k]=(0,r.useState)(""),[E,A]=(0,r.useState)(null),C=((e,t)=>{const[n,a]=(0,r.useState)(e);return(0,r.useEffect)(()=>{const n=setTimeout(()=>{a(e)},t);return()=>{clearTimeout(n)}},[e,t]),n})(c,300);(0,r.useEffect)(()=>{if(N){const e=setTimeout(()=>_(""),3e3);return()=>clearTimeout(e)}},[N]),(0,r.useEffect)(()=>{if(S){const e=setTimeout(()=>k(""),5e3);return()=>clearTimeout(e)}},[S]);const D=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];l(!0);const n=await mn.getCampusData(t,e);s(n),l(!1)},[t]);(0,r.useEffect)(()=>{console.log("MentorCampusTab: Fetching data for campus:",t),D()},[t,D]);const T=async e=>{g(e),j(!0);try{const[t,n]=await Promise.all([cn.getGoalsByStudent(e.id,50),dn.getReflectionsByStudent(e.id)]);x(t),b(n)}catch(t){console.error("Error loading user data:",t)}finally{j(!1)}},O=e=>!!n&&(!(!n.isAdmin&&"admin"!==n.role)||("academic_associate"===n.role&&n.campus?(f&&(f.campus,n.campus),!0):!(!n.isMentor&&"mentor"!==n.role&&"super_mentor"!==n.role))),P=async(e,t)=>{try{A(e),k(""),_(""),console.log("\ud83c\udfaf Approving goal:",e,"with status:",t,"by user:",null===n||void 0===n?void 0:n.id);const r=y.find(t=>t.id===e),a=(null===r||void 0===r?void 0:r.student_id)||(null===f||void 0===f?void 0:f.id);await cn.reviewGoal(e,(null===n||void 0===n?void 0:n.id)||"admin",t),a&&sn.queryCache.invalidate("goals:student:".concat(a)),sn.queryCache.invalidate("all-users"),x(r=>r.map(r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{status:t,reviewed_by:(null===n||void 0===n?void 0:n.id)||"admin",reviewed_at:new Date}):r)),s(r=>r?(0,o.A)((0,o.A)({},r),{},{goals:r.goals.map(r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{status:t,reviewed_by:(null===n||void 0===n?void 0:n.id)||"admin",reviewed_at:new Date}):r)}):r),_("Goal ".concat("approved"===t?"approved":"reviewed"," successfully! \u2705")),setTimeout(()=>{f&&T(f),D(!0)},500)}catch(r){console.error("\u274c Error approving goal:",r),k(r.message||"Failed to approve goal. Please try again."),f&&await T(f)}finally{A(null)}},I=async(e,t)=>{try{A(e),k(""),_(""),console.log("\ud83d\udcad Approving reflection:",e,"with status:",t,"by user:",null===n||void 0===n?void 0:n.id);const r=v.find(t=>t.id===e),a=(null===r||void 0===r?void 0:r.student_id)||(null===f||void 0===f?void 0:f.id);await dn.reviewReflection(e,(null===n||void 0===n?void 0:n.id)||"admin",t),a&&sn.queryCache.invalidate("reflections:student:".concat(a)),sn.queryCache.invalidate("all-users"),b(r=>r.map(r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{status:t,reviewed_by:(null===n||void 0===n?void 0:n.id)||"admin",reviewed_at:new Date}):r)),s(r=>r?(0,o.A)((0,o.A)({},r),{},{reflections:r.reflections.map(r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{status:t,reviewed_by:(null===n||void 0===n?void 0:n.id)||"admin",reviewed_at:new Date}):r)}):r),_("Reflection ".concat("approved"===t?"approved":"reviewed"," successfully! \u2705")),setTimeout(()=>{f&&T(f),D(!0)},500)}catch(r){console.error("\u274c Error approving reflection:",r),k(r.message||"Failed to approve reflection. Please try again."),f&&await T(f)}finally{A(null)}},R=(0,r.useMemo)(()=>{if(!a)return[];let e=a.students;if(C){const t=C.toLowerCase();e=e.filter(e=>{const n=((null===e||void 0===e?void 0:e.name)||"").toString().toLowerCase(),r=((null===e||void 0===e?void 0:e.email)||"").toString().toLowerCase();return n.includes(t)||r.includes(t)})}if("goals"===u){const t=a.goals.filter(e=>"pending"===e.status).map(e=>e.student_id);e=e.filter(e=>t.includes(e.id))}else if("reflections"===u){const t=a.reflections.filter(e=>"pending"===e.status).map(e=>e.student_id);e=e.filter(e=>t.includes(e.id))}else if("no_goals_today"===u){const t=new Date;t.setHours(0,0,0,0);const n=new Date(t);n.setDate(n.getDate()+1);const r=new Set(a.goals.filter(e=>{const r=new Date(e.created_at);return r>=t&&r<n}).map(e=>e.student_id));e=e.filter(e=>!r.has(e.id))}return e.sort((e,t)=>{const n=a.goals.filter(t=>t.student_id===e.id&&"pending"===t.status).length,r=a.reflections.filter(t=>t.student_id===e.id&&"pending"===t.status).length,s=a.goals.filter(e=>e.student_id===t.id&&"pending"===e.status).length,i=a.reflections.filter(e=>e.student_id===t.id&&"pending"===e.status).length,o=n+r,l=s+i;return o!==l?l-o:(e.name||"").localeCompare(t.name||"")}),e},[a,C,u]);(0,r.useEffect)(()=>{p(1)},[C,u]),(0,r.useEffect)(()=>{if(a)try{const e=a.students.length,n=C||"",r=R.length,s=R.slice(0,5).map(e=>e.name||e.email||e.id);console.debug("MentorCampusTab: search debug",{campusId:t,term:n,total:e,matched:r,sample:s})}catch(e){}},[a,C,R,t]);const M=(0,r.useMemo)(()=>{const e=25*(m-1);return R.slice(e,e+25)},[R,m]),L=(null===a||void 0===a?void 0:a.students.length)||0,F=(null===a||void 0===a?void 0:a.goals.filter(e=>"pending"===e.status).length)||0,U=(null===a||void 0===a?void 0:a.reflections.filter(e=>"pending"===e.status).length)||0,B=new Date;B.setHours(0,0,0,0);const z=new Date(B);z.setDate(z.getDate()+1);const q=new Set((null===a||void 0===a?void 0:a.goals.filter(e=>{const t=new Date(e.created_at);return t>=B&&t<z}).map(e=>e.student_id))||[]),V=(null===a||void 0===a?void 0:a.students.filter(e=>!q.has(e.id)).length)||0;return(0,Pt.jsx)("div",{className:"min-h-screen bg-gray-50 p-3 sm:p-6",children:f?(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pt.jsxs)("button",{onClick:()=>{g(null),x([]),b([])},className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800",children:[(0,Pt.jsx)(UI,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{className:"hidden sm:inline",children:"Back to Students"}),(0,Pt.jsx)("span",{className:"sm:hidden",children:"Back"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:f.name}),(0,Pt.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:f.email})]})]}),(0,Pt.jsxs)("button",{onClick:()=>f&&T(f),className:"inline-flex items-center px-3 sm:px-4 py-2 bg-primary-600 text-white rounded-lg shadow hover:bg-primary-700 text-sm sm:text-base",children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),(0,Pt.jsx)("span",{className:"hidden sm:inline",children:"Refresh"}),(0,Pt.jsx)("span",{className:"sm:hidden",children:"Refresh"})]})]}),N&&(0,Pt.jsx)("div",{className:"mb-6 bg-green-50 border-l-4 border-green-400 p-4 rounded-lg shadow-sm animate-fade-in",children:(0,Pt.jsxs)("div",{className:"flex items-start",children:[(0,Pt.jsx)(qn,{className:"h-5 w-5 text-green-400 mt-0.5 mr-3 flex-shrink-0"}),(0,Pt.jsx)("div",{className:"flex-1",children:(0,Pt.jsx)("p",{className:"text-sm font-medium text-green-800",children:N})})]})}),S&&(0,Pt.jsx)("div",{className:"mb-6 bg-red-50 border-l-4 border-red-400 p-4 rounded-lg shadow-sm animate-fade-in",children:(0,Pt.jsxs)("div",{className:"flex items-start",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-red-400 mt-0.5 mr-3 flex-shrink-0"}),(0,Pt.jsx)("div",{className:"flex-1",children:(0,Pt.jsx)("p",{className:"text-sm font-medium text-red-800",children:S})})]})}),w?(0,Pt.jsx)("div",{className:"space-y-4",children:Array.from({length:5}).map((e,t)=>(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 animate-pulse",children:[(0,Pt.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2 animate-pulse"}),(0,Pt.jsx)("div",{className:"h-3 bg-gray-200 rounded mb-2 w-1/2 animate-pulse"}),(0,Pt.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4 animate-pulse"})]},t))}):(0,Pt.jsx)("div",{className:"space-y-6",children:(()=>{const e={};return y.forEach(t=>{const n=new Date(t.created_at).toDateString();e[n]||(e[n]={goals:[],reflections:[]}),e[n].goals.push(t)}),v.forEach(t=>{const n=new Date(t.created_at).toDateString();e[n]||(e[n]={goals:[],reflections:[]}),e[n].reflections.push(t)}),Object.entries(e).sort((e,t)=>{let[n]=e,[r]=t;return new Date(r).getTime()-new Date(n).getTime()}).map(e=>{let[t,{goals:n,reflections:r}]=e;return(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,Pt.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-4",children:(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})}),(0,Pt.jsxs)("div",{className:"p-6 space-y-4",children:[n.sort((e,t)=>"pending"===e.status&&"pending"!==t.status?-1:"pending"!==e.status&&"pending"===t.status?1:0).map(e=>(0,Pt.jsxs)("div",{className:"border-l-4 rounded-r-lg p-4 ".concat("pending"===e.status?"border-l-yellow-400 bg-yellow-50":"approved"===e.status?"border-l-green-400 bg-green-50":"border-l-blue-400 bg-blue-50"),children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(Yn,{className:"h-5 w-5 text-green-600"}),(0,Pt.jsx)("span",{className:"font-medium text-gray-900",children:"Goal"}),(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("approved"===e.status?"bg-green-100 text-green-700":"reviewed"===e.status?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"),children:e.status})]}),O(f.id)&&"pending"===e.status&&(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,Pt.jsx)("button",{onClick:()=>P(e.id,"approved"),disabled:E===e.id,className:"flex items-center justify-center space-x-1 px-3 py-1 text-white text-sm rounded transition-colors ".concat(E===e.id?"bg-green-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),children:E===e.id?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 animate-spin"}),(0,Pt.jsx)("span",{children:"Processing..."})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(qn,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Approve"})]})}),(0,Pt.jsx)("button",{onClick:()=>P(e.id,"reviewed"),disabled:E===e.id,className:"flex items-center justify-center space-x-1 px-3 py-1 text-white text-sm rounded transition-colors ".concat(E===e.id?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),children:E===e.id?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 animate-spin"}),(0,Pt.jsx)("span",{children:"Processing..."})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(YI,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Review"})]})})]})]}),(0,Pt.jsx)("p",{className:"text-gray-700 mb-2",children:e.goal_text}),(0,Pt.jsxs)("div",{className:"text-sm text-gray-600",children:["Target: ",e.target_percentage,"%",e.mentor_comment&&(0,Pt.jsxs)("div",{className:"mt-2 p-2 bg-blue-50 rounded text-blue-800",children:[(0,Pt.jsx)("strong",{children:"Mentor feedback:"})," ",e.mentor_comment]})]})]},e.id)),r.sort((e,t)=>"pending"===e.status&&"pending"!==t.status?-1:"pending"!==e.status&&"pending"===t.status?1:0).map(e=>(0,Pt.jsxs)("div",{className:"border-l-4 rounded-r-lg p-4 ".concat("pending"===e.status?"border-l-yellow-400 bg-yellow-50":"approved"===e.status?"border-l-green-400 bg-green-50":"border-l-blue-400 bg-blue-50"),children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(pa,{className:"h-5 w-5 text-purple-600"}),(0,Pt.jsx)("span",{className:"font-medium text-gray-900",children:"Reflection"}),(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("approved"===e.status?"bg-green-100 text-green-700":"reviewed"===e.status?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"),children:e.status})]}),O(f.id)&&"pending"===e.status&&(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,Pt.jsx)("button",{onClick:()=>I(e.id,"approved"),disabled:E===e.id,className:"flex items-center justify-center space-x-1 px-3 py-1 text-white text-sm rounded transition-colors ".concat(E===e.id?"bg-green-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),children:E===e.id?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 animate-spin"}),(0,Pt.jsx)("span",{children:"Processing..."})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(qn,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Approve"})]})}),(0,Pt.jsx)("button",{onClick:()=>I(e.id,"reviewed"),disabled:E===e.id,className:"flex items-center justify-center space-x-1 px-3 py-1 text-white text-sm rounded transition-colors ".concat(E===e.id?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),children:E===e.id?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 animate-spin"}),(0,Pt.jsx)("span",{children:"Processing..."})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(YI,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Review"})]})})]})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[(0,Pt.jsxs)("div",{className:"bg-green-50 p-3 rounded",children:[(0,Pt.jsx)("strong",{className:"text-green-800",children:"What worked well:"}),(0,Pt.jsx)("p",{className:"text-green-700 mt-1",children:e.reflection_answers.workedWell})]}),(0,Pt.jsxs)("div",{className:"bg-blue-50 p-3 rounded",children:[(0,Pt.jsx)("strong",{className:"text-blue-800",children:"How achieved:"}),(0,Pt.jsx)("p",{className:"text-blue-700 mt-1",children:e.reflection_answers.howAchieved})]}),(0,Pt.jsxs)("div",{className:"bg-purple-50 p-3 rounded",children:[(0,Pt.jsx)("strong",{className:"text-purple-800",children:"Key learning:"}),(0,Pt.jsx)("p",{className:"text-purple-700 mt-1",children:e.reflection_answers.keyLearning})]}),(0,Pt.jsxs)("div",{className:"bg-orange-50 p-3 rounded",children:[(0,Pt.jsx)("strong",{className:"text-orange-800",children:"Challenges:"}),(0,Pt.jsx)("p",{className:"text-orange-700 mt-1",children:e.reflection_answers.challenges})]})]}),(0,Pt.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["Achieved: ",e.achieved_percentage,"%"]}),e.mentor_notes&&(0,Pt.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 rounded",children:[(0,Pt.jsx)("strong",{className:"text-blue-800",children:"Mentor feedback:"}),(0,Pt.jsx)("p",{className:"text-blue-700 mt-1",children:e.mentor_notes}),e.mentor_assessment&&(0,Pt.jsxs)("p",{className:"text-sm text-blue-600 mt-1",children:["Assessment: ",e.mentor_assessment.replace("_"," ")]})]})]},e.id))]})]},t)})})()})]}):(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-3 sm:gap-4 flex-1",children:[(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-3 sm:p-4 flex items-center space-x-2 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>h("all"),children:[(0,Pt.jsx)(er,{className:"h-5 w-5 sm:h-6 sm:w-6 text-blue-600"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Students"}),(0,Pt.jsx)("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:L})]})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-3 sm:p-4 flex items-center space-x-2 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>h("goals"),children:[(0,Pt.jsx)(Yn,{className:"h-5 w-5 sm:h-6 sm:w-6 text-green-600"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Goals to Review"}),(0,Pt.jsx)("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:F})]})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-3 sm:p-4 flex items-center space-x-2 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>h("reflections"),children:[(0,Pt.jsx)(pa,{className:"h-5 w-5 sm:h-6 sm:w-6 text-purple-600"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Reflections to Review"}),(0,Pt.jsx)("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:U})]})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-3 sm:p-4 flex items-center space-x-2 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>h("no_goals_today"),children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 sm:h-6 sm:w-6 text-red-600"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"No Goals Today"}),(0,Pt.jsx)("p",{className:"text-lg sm:text-xl font-bold text-gray-900",children:V})]})]})]}),(0,Pt.jsxs)("button",{onClick:()=>{D(!0)},className:"inline-flex items-center px-3 sm:px-4 py-2 bg-primary-600 text-white rounded-lg shadow hover:bg-primary-700 text-sm sm:text-base self-start sm:self-auto",children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2"}),(0,Pt.jsx)("span",{className:"hidden sm:inline",children:"Refresh"}),(0,Pt.jsx)("span",{className:"sm:hidden",children:"Refresh"})]})]}),(0,Pt.jsx)("div",{className:"mb-4 flex items-center",children:(0,Pt.jsxs)("div",{className:"relative w-full sm:max-w-md",children:[(0,Pt.jsx)("input",{type:"text",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm sm:text-base",placeholder:"Search students...",value:c,onChange:e=>d(e.target.value)}),(0,Pt.jsx)($I,{className:"absolute left-3 top-2.5 h-4 w-4 sm:h-5 sm:w-5 text-gray-400"})]})}),i?(0,Pt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:Array.from({length:6}).map((e,t)=>(0,Pt.jsx)(JI,{},t))}):(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:M.map(e=>{const t=(null===a||void 0===a?void 0:a.goals.filter(t=>t.student_id===e.id))||[],n=(null===a||void 0===a?void 0:a.reflections.filter(t=>t.student_id===e.id))||[],r=t.filter(e=>"pending"===e.status),s=n.filter(e=>"pending"===e.status),i=r.length>0||s.length>0;return(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-3 md:py-3 md:px-1 hover:shadow-md transition-shadow cursor-pointer border-l-4 ".concat(i?"border-l-yellow-400 bg-yellow-50":"border-l-gray-200"),onClick:()=>T(e),children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pt.jsx)("div",{className:"font-semibold text-lg text-gray-900",children:e.name}),(0,Pt.jsx)(rr,{className:"h-5 w-5 text-gray-400"})]}),(0,Pt.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.email}),e.status&&"active"!==e.status&&(0,Pt.jsxs)("div",{className:"inline-block px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800 mb-2",children:["Status: ",e.status]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 text-sm mb-2",children:[(0,Pt.jsxs)("span",{className:"flex items-center space-x-1 ".concat(r.length>0?"text-yellow-700 font-medium":"text-gray-600"),children:[(0,Pt.jsx)(Yn,{className:"h-4 w-4 text-green-600"}),(0,Pt.jsxs)("span",{children:[r.length," pending"]})]}),(0,Pt.jsxs)("span",{className:"flex items-center space-x-1 ".concat(s.length>0?"text-yellow-700 font-medium":"text-gray-600"),children:[(0,Pt.jsx)(pa,{className:"h-4 w-4 text-purple-600"}),(0,Pt.jsxs)("span",{children:[s.length," pending"]})]})]}),(0,Pt.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"Click to view all goals and reflections"})]},e.id)})}),(0,Pt.jsxs)("div",{className:"flex justify-center items-center space-x-2 mt-4",children:[(0,Pt.jsx)("button",{disabled:1===m,onClick:()=>p(m-1),className:"px-2 sm:px-3 py-1 rounded bg-gray-200 text-gray-700 disabled:opacity-50 text-sm sm:text-base",children:"Prev"}),(0,Pt.jsxs)("span",{className:"text-sm sm:text-base",children:["Page ",m," of ",Math.ceil(R.length/25)||1]}),(0,Pt.jsx)("button",{disabled:25*m>=R.length,onClick:()=>p(m+1),className:"px-2 sm:px-3 py-1 rounded bg-gray-200 text-gray-700 disabled:opacity-50 text-sm sm:text-base",children:"Next"})]})]})]})})},ZI="my-goals",eR="my-mentees",tR="my-mentor",nR="campus-overview",rR=()=>{const e=he(),{userData:t}=Rt(),[n,a]=(0,r.useState)(ZI),[s,i]=(0,r.useState)([]),[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)([]),[u,h]=(0,r.useState)([]),[m,p]=(0,r.useState)({myGoals:{total:0,pending:0},myReflections:{total:0,pending:0},menteesGoals:{total:0,pending:0},menteesReflections:{total:0,pending:0},mentorGoals:{total:0,pending:0},mentorReflections:{total:0,pending:0},campusGoals:{total:0,pending:0},campusReflections:{total:0,pending:0},totalMentees:0,totalStudents:0}),[f,g]=(0,r.useState)(!0),[y,x]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),[w,j]=(0,r.useState)(0),N=(0,r.useCallback)(e=>{},[]),_=(0,r.useCallback)(async()=>{try{if(g(!0),null===t||void 0===t||!t.id)return void e("/dashboard");t.campus_joining_date||t.isAdmin||x(!0);const[n,r,a,s]=await Promise.all([cn.getGoalsByStudent(t.id),dn.getReflectionsByStudent(t.id),_t.UserService.getStudentsByMentor(t.id),mn.getAllUsers()]);d(n),h(r);const o={myGoals:{total:n.length,pending:n.filter(e=>"pending"===e.status).length},myReflections:{total:r.length,pending:r.filter(e=>"pending"===e.status).length},menteesGoals:{total:0,pending:0},menteesReflections:{total:0,pending:0},mentorGoals:{total:0,pending:0},mentorReflections:{total:0,pending:0},campusGoals:{total:0,pending:0},campusReflections:{total:0,pending:0},totalMentees:a.length,totalStudents:s.filter(e=>e.campus===((null===t||void 0===t?void 0:t.campus)||"dharamshala")&&!e.isAdmin).length};if(a.length>0){const e=a.map(e=>e.id),[t,n]=await Promise.all([Promise.all(e.map(e=>cn.getGoalsByStudent(e))).then(e=>e.flat()),Promise.all(e.map(e=>dn.getReflectionsByStudent(e))).then(e=>e.flat())]);o.menteesGoals={total:t.length,pending:t.filter(e=>"pending"===e.status).length},o.menteesReflections={total:n.length,pending:n.filter(e=>"pending"===e.status).length}}if(t.mentor_id){const e=s.find(e=>e.id===t.mentor_id);if(l(e||null),e){const[t,n]=await Promise.all([cn.getGoalsByStudent(e.id),dn.getReflectionsByStudent(e.id)]);o.mentorGoals={total:t.length,pending:t.filter(e=>"pending"===e.status).length},o.mentorReflections={total:n.length,pending:n.filter(e=>"pending"===e.status).length}}}const c=s.filter(e=>e.campus===((null===t||void 0===t?void 0:t.campus)||"dharamshala")&&!e.isAdmin).map(e=>e.id),[u,m]=await Promise.all([Promise.all(c.map(e=>cn.getGoalsByStudent(e))).then(e=>e.flat()),Promise.all(c.map(e=>dn.getReflectionsByStudent(e))).then(e=>e.flat())]);o.campusGoals={total:u.length,pending:u.filter(e=>"pending"===e.status).length},o.campusReflections={total:m.length,pending:m.filter(e=>"pending"===e.status).length},p(o);const f=await Promise.all(a.map(async e=>{const[t,n]=await Promise.all([cn.getGoalsByStudent(e.id,30),dn.getReflectionsByStudent(e.id)]),r=t.length>0?t[0]:void 0,a=n.length>0?n[0]:void 0,s=n.filter(e=>void 0!==e.achieved_percentage&&null!==e.achieved_percentage),i=s.length>0?Math.round(s.reduce((e,t)=>e+(t.achieved_percentage||0),0)/s.length):0,o=await gn.getLatestReview(e.id),l=((e,t)=>{if(!e)return"pending";const n=new Date(e.week_start);return Kt(n,t)?"completed":"overdue"})(o,qt());return{student:e,pending_goals:t.filter(e=>"pending"===e.status).length,pending_reflections:n.filter(e=>"pending"===e.status).length,latest_goal:r,latest_reflection:a,average_achievement:i,current_phase:null===r||void 0===r?void 0:r.phase_id,current_topic:null===r||void 0===r?void 0:r.topic_id,weekly_review_status:l,latest_review:o}}));i(f);const y=f.filter(e=>"pending"===e.weekly_review_status).length;y>0&&(j(y),b(!0))}catch(n){console.error("Error loading dashboard data:",n)}finally{g(!1)}},[t,e]);(0,r.useEffect)(()=>{null!==t&&void 0!==t&&t.id&&_()},[t,_]);const S=()=>m.myGoals.pending+m.myReflections.pending+(null!==t&&void 0!==t&&t.isAdmin?m.campusGoals.pending+m.campusReflections.pending:m.menteesGoals.pending+m.menteesReflections.pending);return f?(0,Pt.jsx)(br,{}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,Pt.jsx)("div",{className:"px-6 py-6",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),(0,Pt.jsxs)("p",{className:"mt-2 text-gray-600",children:["Welcome back, ",null===t||void 0===t?void 0:t.name]})]}),S()>0&&(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,Pt.jsx)(WI,{className:"h-5 w-5 text-yellow-600 animate-pulse"}),(0,Pt.jsxs)("span",{className:"text-sm font-semibold text-yellow-800",children:[S()," Pending Review",1!==S()?"s":""]})]})]})})}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,Pt.jsxs)("button",{onClick:()=>a(ZI),className:"p-6 rounded-lg border-2 transition-all text-left ".concat(n===ZI?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-blue-300 hover:shadow-sm bg-white"),children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Pt.jsx)(Yn,{className:"h-8 w-8 text-blue-600"}),m.myGoals.pending>0&&(0,Pt.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:m.myGoals.pending})]}),(0,Pt.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:"My Goals"}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600",children:[m.myGoals.total," total \u2022 ",m.myGoals.pending," pending"]})]}),(0,Pt.jsxs)("button",{onClick:()=>a(eR),className:"p-6 rounded-lg border-2 transition-all text-left ".concat(n===eR?"border-green-500 bg-green-50 shadow-md":"border-gray-200 hover:border-green-300 hover:shadow-sm bg-white"),children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Pt.jsx)(GI,{className:"h-8 w-8 text-green-600"}),m.menteesGoals.pending+m.menteesReflections.pending>0&&(0,Pt.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:m.menteesGoals.pending+m.menteesReflections.pending})]}),(0,Pt.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:"My Mentees"}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600",children:[m.totalMentees," students \u2022 ",m.menteesGoals.pending+m.menteesReflections.pending," pending"]})]}),(0,Pt.jsxs)("button",{onClick:()=>a(tR),className:"p-6 rounded-lg border-2 transition-all text-left ".concat(n===tR?"border-purple-500 bg-purple-50 shadow-md":"border-gray-200 hover:border-purple-300 hover:shadow-sm bg-white"),children:[(0,Pt.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,Pt.jsx)(KI,{className:"h-8 w-8 text-purple-600"})}),(0,Pt.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:"My Mentor"}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600",children:[(null===o||void 0===o?void 0:o.name)||"Not assigned"," \u2022 ",m.mentorGoals.total+m.mentorReflections.total," items"]})]}),(0,Pt.jsxs)("button",{onClick:()=>a(nR),className:"p-6 rounded-lg border-2 transition-all text-left ".concat(n===nR?"border-orange-500 bg-orange-50 shadow-md":"border-gray-200 hover:border-orange-300 hover:shadow-sm bg-white"),children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Pt.jsx)(er,{className:"h-8 w-8 text-orange-600"}),m.campusGoals.pending+m.campusReflections.pending>0&&(0,Pt.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:m.campusGoals.pending+m.campusReflections.pending})]}),(0,Pt.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:"Campus Overview"}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600",children:[m.totalStudents," students \u2022 ",m.campusGoals.pending+m.campusReflections.pending," pending"]})]})]}),n===ZI&&(0,Pt.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"My Goals & Reflections"}),(0,Pt.jsxs)("div",{className:"space-y-6",children:[(()=>{const e=[...c.map(e=>({type:"goal",date:e.created_at,data:e,status:e.status,id:e.id})),...u.map(e=>({type:"reflection",date:e.created_at,data:e,status:e.status,id:e.id}))].sort((e,t)=>"pending"===e.status&&"pending"!==t.status?-1:"pending"!==e.status&&"pending"===t.status?1:new Date(t.date).getTime()-new Date(e.date).getTime()),t=e.reduce((e,t)=>{const n=new Date(t.date).toDateString();return e[n]||(e[n]=[]),e[n].push(t),e},{});return Object.entries(t).map(e=>{let[t,n]=e;return(0,Pt.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,Pt.jsxs)("h3",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[(0,Pt.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),(0,Pt.jsx)("div",{className:"space-y-3",children:n.map(e=>{var t;return(0,Pt.jsx)("div",{className:"border-l-4 rounded-r-lg p-3 ".concat("pending"===e.status?"border-l-yellow-400 bg-yellow-50":"approved"===e.status?"border-l-green-400 bg-green-50":"border-l-gray-400 bg-gray-50"),children:(0,Pt.jsx)("div",{className:"flex items-start justify-between",children:(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-1",children:["goal"===e.type?(0,Pt.jsx)(Yn,{className:"h-4 w-4 mr-2 text-blue-600"}):(0,Pt.jsx)(pa,{className:"h-4 w-4 mr-2 text-green-600"}),(0,Pt.jsx)("span",{className:"font-medium text-sm capitalize",children:e.type}),(0,Pt.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full ".concat("approved"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})]}),"goal"===e.type?(0,Pt.jsx)("p",{className:"text-sm text-gray-700 mb-1",children:e.data.goal_text}):(0,Pt.jsxs)("p",{className:"text-sm text-gray-700 mb-1",children:[(0,Pt.jsx)("strong",{children:"What worked well:"})," ",null===(t=e.data.reflection_answers)||void 0===t?void 0:t.workedWell]}),(0,Pt.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:["goal"===e.type&&e.data.target_percentage&&(0,Pt.jsxs)("span",{className:"mr-3",children:["Target: ",e.data.target_percentage,"%"]}),"reflection"===e.type&&e.data.achieved_percentage&&(0,Pt.jsxs)("span",{children:["Achieved: ",e.data.achieved_percentage,"%"]})]})]})})},"".concat(e.type,"-").concat(e.id))})})]},t)})})(),0===c.length&&0===u.length&&(0,Pt.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,Pt.jsx)(Yn,{className:"h-16 w-16 mx-auto mb-4 text-gray-300"}),(0,Pt.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Goals or Reflections Yet"}),(0,Pt.jsx)("p",{className:"mb-4",children:"Start your learning journey by setting your first goal and writing reflections."}),(0,Pt.jsxs)("div",{className:"flex justify-center space-x-3",children:[(0,Pt.jsx)("button",{onClick:()=>e("/goals"),className:"px-4 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:"Set Your First Goal"}),(0,Pt.jsx)("button",{onClick:()=>e("/reflection"),className:"px-4 py-2 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors",children:"Write First Reflection"})]})]})]})]}),n===eR&&(0,Pt.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"My Mentees Overview"}),0===s.length?(0,Pt.jsx)("p",{className:"text-gray-500",children:"No mentees assigned yet"}):(0,Pt.jsx)("div",{className:"flex flex-col lg:flex-row gap-4 overflow-x-auto",children:s.map(t=>{return(0,Pt.jsxs)("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow min-w-0 flex-1 lg:flex-none lg:w-80",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Pt.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:t.student.name}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[t.pending_goals+t.pending_reflections>0&&(0,Pt.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:t.pending_goals+t.pending_reflections}),(0,Pt.jsx)("span",{className:"text-xs px-2 py-1 rounded-full font-medium ".concat("completed"===t.weekly_review_status?"bg-green-100 text-green-800":"overdue"===t.weekly_review_status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:"completed"===t.weekly_review_status?"\u2713 Reviewed":"overdue"===t.weekly_review_status?"\u26a0 Overdue":"\u23f0 Pending"})]}),"completed"===t.weekly_review_status&&t.latest_review&&(0,Pt.jsxs)("div",{className:"mt-2 p-2 bg-green-50 rounded-lg border border-green-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("span",{className:"text-xs font-medium text-green-800",children:"Latest Score"}),(0,Pt.jsx)("span",{className:"text-sm font-bold text-green-900",children:(()=>{const e=da(t.latest_review);return"".concat(e.toFixed(1),"/2")})()})]}),(0,Pt.jsx)("div",{className:"flex space-x-1 mt-1",children:(()=>{const e=[t.latest_review.morning_exercise,t.latest_review.communication,t.latest_review.academic_effort,t.latest_review.campus_contribution,t.latest_review.behavioural];return"mentorship_level"in t.latest_review&&e.push(t.latest_review.mentorship_level),e.map((e,t)=>(0,Pt.jsx)("div",{className:"flex-1",children:(0,Pt.jsx)("div",{className:"w-full bg-green-200 rounded-full h-1",children:(0,Pt.jsx)("div",{className:"h-1 rounded-full ".concat(e>=1?"bg-green-500":e>=0?"bg-yellow-500":"bg-red-500"),style:{width:"".concat((e+2)/4*100,"%")}})})},t))})()})]})]}),(0,Pt.jsxs)("div",{className:"space-y-2 text-sm mb-3",children:[(0,Pt.jsxs)("div",{className:"flex justify-between",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Goals:"}),(0,Pt.jsxs)("span",{children:[t.pending_goals," pending"]})]}),(0,Pt.jsxs)("div",{className:"flex justify-between",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Reflections:"}),(0,Pt.jsxs)("span",{children:[t.pending_reflections," pending"]})]}),t.average_achievement>0&&(0,Pt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Avg Achievement:"}),(0,Pt.jsxs)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat((n=t.average_achievement,n>=90?"text-green-600 bg-green-50":n>=70?"text-blue-600 bg-blue-50":n>=50?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50")),children:[t.average_achievement,"%"]})]})]}),(0,Pt.jsxs)("div",{className:"flex space-x-2",children:[(0,Pt.jsxs)("button",{onClick:()=>e("/mentor/mentee/".concat(t.student.id)),className:"flex-1 flex items-center justify-center px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:["View Details",(0,Pt.jsx)(QI,{className:"h-4 w-4 ml-1"})]}),(0,Pt.jsx)("button",{onClick:()=>e("/mentor/mentee/".concat(t.student.id)),className:"px-3 py-2 text-sm rounded transition-colors ".concat("completed"===t.weekly_review_status?"bg-green-100 text-green-700 hover:bg-green-200":"bg-purple-600 text-white hover:bg-purple-700"),title:"completed"===t.weekly_review_status?"View & Update Review":"View & Add Review",children:(0,Pt.jsx)(ha,{className:"h-4 w-4"})})]})]},t.student.id);var n})})]}),n===tR&&(0,Pt.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"My Mentor"}),o?(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium mb-3",children:o.name}),(0,Pt.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,Pt.jsxs)("div",{className:"flex justify-between",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Goals:"}),(0,Pt.jsxs)("span",{children:[m.mentorGoals.total," total"]})]}),(0,Pt.jsxs)("div",{className:"flex justify-between",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Reflections:"}),(0,Pt.jsxs)("span",{children:[m.mentorReflections.total," total"]})]}),(0,Pt.jsxs)("div",{className:"flex justify-between",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Pending Reviews:"}),(0,Pt.jsx)("span",{children:m.mentorGoals.pending+m.mentorReflections.pending})]})]})]}),(0,Pt.jsx)("div",{className:"flex items-center justify-center",children:(0,Pt.jsx)("button",{onClick:()=>e("/mentor/mentee/".concat(o.id)),className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"View Mentor Details"})})]}):(0,Pt.jsx)("p",{className:"text-gray-500",children:"No mentor assigned yet"})]}),n===nR&&(0,Pt.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Campus Overview"}),(0,Pt.jsx)(XI,{campusId:(null===t||void 0===t?void 0:t.campus)||"dharamshala"})]})]}),t&&(0,Pt.jsx)(Vn,{isOpen:y,onClose:()=>x(!1),user:t,onDateUpdated:N}),v&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Pt.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,Pt.jsx)(Hn,{className:"h-6 w-6 text-yellow-600"})}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 ml-3",children:"Weekly Review Reminder"})]}),(0,Pt.jsxs)("p",{className:"text-gray-600 mb-6",children:["You have ",(0,Pt.jsx)("span",{className:"font-semibold text-yellow-600",children:w})," mentee",w>1?"s":"","who need",1===w?"s":""," their weekly performance review. Reviews are due every Saturday."]}),(0,Pt.jsxs)("div",{className:"flex space-x-3",children:[(0,Pt.jsx)("button",{onClick:()=>b(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Remind Me Later"}),(0,Pt.jsx)("button",{onClick:()=>{b(!1),a(eR)},className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Review Now"})]})]})})]})},aR=Un("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),sR=()=>{var e,t,n,a;const{studentId:s}=me(),i=he(),{userData:l}=Rt(),[c,d]=(0,r.useState)(null),[u,h]=(0,r.useState)([]),[m,p]=(0,r.useState)(null),[f,g]=(0,r.useState)(!0),[y,x]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),[w,j]=(0,r.useState)({mentorNotes:"",goalComment:"",assessment:"",goalStatus:"",reflectionStatus:""}),[N,_]=(0,r.useState)(!1),[S,k]=(0,r.useState)(!1),{modalRef:E,contentRef:A,handleOutsideClick:C,handleContentClick:D}=jr(S,()=>k(!1)),[T,O]=(0,r.useState)({morningExercise:0,communication:0,academicEffort:0,campusContribution:0,behavioural:0,notes:""}),[P,I]=(0,r.useState)({morningExercise:0,communication:0,academicEffort:0,campusContribution:0,behavioural:0,mentorshipLevel:0,notes:""}),[R,M]=(0,r.useState)("all"),[L,F]=(0,r.useState)(null),[U,B]=(0,r.useState)({visible:!1,message:"",type:"info"}),z=(0,r.useCallback)(async()=>{try{if(g(!0),!s)return;const t=await _t.UserService.getUserById(s);d(t);const n="mentor"===(null===t||void 0===t?void 0:t.role)||!1;b(n),console.log("\ud83d\udd0d [MentorMenteeReview] Context Detection:",{personId:s,personName:null===t||void 0===t?void 0:t.name,isMentor:n,role:null===t||void 0===t?void 0:t.role});const[r,a,i]=await Promise.all([cn.getGoalsByStudent(s,50),dn.getReflectionsByStudent(s),on.getAllPhases()]),o=i.map(e=>ln.getTopicsByPhase(e.id)),c=(await Promise.all(o)).flat(),u=r.map(e=>{const t=a.find(t=>t.goal_id===e.id),n=i.find(t=>t.id===e.phase_id),r=c.find(t=>t.id===e.topic_id);return{goal:e,reflection:t,phase:n,topic:r}});h(u);try{let e;e=n&&null!==l&&void 0!==l&&l.id?await yn.getLatestReview(s,l.id):await gn.getLatestReview(s),F(e)}catch(e){console.error("Error loading latest review:",e),F(null)}}catch(e){console.error("Error loading student data:",e)}finally{g(!1)}},[s,null===l||void 0===l?void 0:l.id]);(0,r.useEffect)(()=>{s&&z()},[s,z]);const q=()=>{_(!1),p(null),j({mentorNotes:"",goalComment:"",assessment:"",goalStatus:"",reflectionStatus:""})},V=e=>{switch(e){case"approved":return"bg-green-100 text-green-700 border-green-200";case"reviewed":return"bg-blue-100 text-blue-700 border-blue-200";case"pending":return"bg-yellow-100 text-yellow-700 border-yellow-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},H=e=>{switch(e){case"exceeds_expectations":return(0,Pt.jsx)(ha,{className:"h-4 w-4 text-green-600"});case"on_track":return(0,Pt.jsx)(qn,{className:"h-4 w-4 text-blue-600"});case"needs_improvement":return(0,Pt.jsx)(Hn,{className:"h-4 w-4 text-yellow-600"});default:return null}},W=e=>{switch(e){case"exceeds_expectations":return"Exceeds Expectations";case"on_track":return"On Track";case"needs_improvement":return"Needs Improvement";default:return"Not Assessed"}},G=u.filter(e=>{var t;return"all"===R||(e.goal.status===R||(null===(t=e.reflection)||void 0===t?void 0:t.status)===R)}),K=u.filter(e=>{var t;return"pending"===e.goal.status||"pending"===(null===(t=e.reflection)||void 0===t?void 0:t.status)}).length;return f?(0,Pt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):c?(0,Pt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Pt.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-10",children:(0,Pt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Pt.jsx)("div",{className:"py-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pt.jsx)("button",{onClick:()=>i("/mentor/dashboard"),className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,Pt.jsx)(UI,{className:"h-6 w-6"})}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:(0,Pt.jsx)("span",{className:"text-xl font-semibold text-primary-600",children:c.name.charAt(0).toUpperCase()})}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:c.name}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:c.email})]})]})]}),K>0&&(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-yellow-600"}),(0,Pt.jsxs)("span",{className:"text-sm font-semibold text-yellow-800",children:[K," Pending Review",1!==K?"s":""]})]})]})})})}),(0,Pt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,Pt.jsxs)("div",{className:"mb-8",children:[(0,Pt.jsxs)("button",{onClick:()=>k(!0),className:"w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white py-6 px-8 rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 flex items-center justify-center space-x-3 text-xl font-bold",children:[(0,Pt.jsx)(ha,{className:"h-8 w-8"}),(0,Pt.jsxs)("span",{children:["Review ",c.name," Now"]}),(0,Pt.jsx)($l,{className:"h-8 w-8"})]}),(0,Pt.jsx)("p",{className:"text-center text-sm text-gray-500 mt-3",children:v?"Rate your mentor's performance across 6 criteria including mentorship quality":"Rate your mentee's performance across 5 key criteria"})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,Pt.jsx)(Yn,{className:"h-6 w-6 text-blue-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Goals"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:u.length})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,Pt.jsx)(pa,{className:"h-6 w-6 text-purple-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Reflections"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:u.filter(e=>e.reflection).length})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,Pt.jsx)(la,{className:"h-6 w-6 text-yellow-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:K})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,Pt.jsx)($n,{className:"h-6 w-6 text-green-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Achievement"}),(0,Pt.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[u.filter(e=>e.reflection).length>0?Math.round(u.filter(e=>e.reflection).reduce((e,t)=>{var n;return e+((null===(n=t.reflection)||void 0===n?void 0:n.achieved_percentage)||0)},0)/u.filter(e=>e.reflection).length):0,"%"]})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between flex-wrap",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,Pt.jsx)(ha,{className:"h-6 w-6 text-purple-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:v?"Mentor Review":"Mentee Review"}),L?(0,Pt.jsxs)("div",{className:"space-y-1",children:[(0,Pt.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:"Latest Review Scores"}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,Pt.jsxs)("div",{children:["Morning Exercise: ",(0,Pt.jsx)("span",{className:"font-medium ".concat(L.morning_exercise>=0?"text-green-600":"text-red-600"),children:L.morning_exercise})]}),(0,Pt.jsxs)("div",{children:["Communication: ",(0,Pt.jsx)("span",{className:"font-medium ".concat(L.communication>=0?"text-green-600":"text-red-600"),children:L.communication})]}),(0,Pt.jsxs)("div",{children:["Academic Effort: ",(0,Pt.jsx)("span",{className:"font-medium ".concat(L.academic_effort>=0?"text-green-600":"text-red-600"),children:L.academic_effort})]}),(0,Pt.jsxs)("div",{children:["Campus Contribution: ",(0,Pt.jsx)("span",{className:"font-medium ".concat(L.campus_contribution>=0?"text-green-600":"text-red-600"),children:L.campus_contribution})]}),(0,Pt.jsxs)("div",{className:void 0!==L.mentorship_level?"":"col-span-2",children:["Behavioural: ",(0,Pt.jsx)("span",{className:"font-medium ".concat(L.behavioural>=0?"text-green-600":"text-red-600"),children:L.behavioural})]}),void 0!==L.mentorship_level&&(0,Pt.jsxs)("div",{children:["Mentorship Level: ",(0,Pt.jsx)("span",{className:"font-medium ".concat(L.mentorship_level>=0?"text-green-600":"text-red-600"),children:L.mentorship_level})," \u2b50"]})]}),L.notes&&(0,Pt.jsxs)("p",{className:"text-xs text-gray-500 mt-1 italic",children:['"',L.notes,'"']})]}):(0,Pt.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:"Weekly Assessment"})]})]}),(0,Pt.jsx)("button",{onClick:()=>k(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium",title:v?"Review mentor performance":"Review mentee performance",children:L?"Update Review":v?"Review Mentor":"Review Mentee"})]})})]}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6",children:(0,Pt.jsx)("div",{className:"border-b border-gray-200",children:(0,Pt.jsx)("nav",{className:"flex space-x-8 px-6 flex-wrap","aria-label":"Tabs",children:["all","pending","reviewed","approved"].map(e=>(0,Pt.jsxs)("button",{onClick:()=>M(e),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat(R===e?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.charAt(0).toUpperCase()+e.slice(1),"all"!==e&&(0,Pt.jsx)("span",{className:"ml-2 py-0.5 px-2 rounded-full text-xs bg-gray-100 text-gray-600",children:u.filter(t=>{var n;return t.goal.status===e||(null===(n=t.reflection)||void 0===n?void 0:n.status)===e}).length})]},e))})})}),(0,Pt.jsx)("div",{className:"space-y-6",children:0===G.length?(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)(Yn,{className:"mx-auto h-16 w-16 text-gray-400"}),(0,Pt.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No items to review"}),(0,Pt.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"all"===R?"This student hasn't submitted any goals yet.":"No ".concat(R," items found.")})]})}):G.map((e,t)=>(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:[(0,Pt.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between flex-wrap",children:[(0,Pt.jsxs)("div",{className:"flex items-center flex-wrap space-x-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(Bn,{className:"h-4 w-4 text-gray-500"}),(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-900 mb-3",children:new Date(e.goal.created_at).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})})]}),e.phase&&(0,Pt.jsx)("span",{className:"px-2 py-1 my-2 bg-blue-50 text-blue-700 text-xs font-medium rounded",children:e.phase.name}),e.topic&&(0,Pt.jsx)("span",{className:"px-2 py-1 bg-purple-50 text-purple-700 text-xs font-medium rounded mb-3",children:e.topic.name})]}),!("approved"===e.goal.status&&(!e.reflection||"approved"===e.reflection.status))&&(0,Pt.jsxs)("button",{onClick:()=>(e=>{var t,n;p(e),_(!0),j({mentorNotes:(null===(t=e.reflection)||void 0===t?void 0:t.mentor_notes)||"",goalComment:e.goal.mentor_comment||"",assessment:(null===(n=e.reflection)||void 0===n?void 0:n.mentor_assessment)||"",goalStatus:"pending"===e.goal.status?"":e.goal.status,reflectionStatus:e.reflection?"pending"===e.reflection.status?"":e.reflection.status:""}),_(!0)})(e),className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors",children:[(0,Pt.jsx)(ql,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{className:"text-sm font-medium",children:"Review & Feedback"})]})]})}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 divide-y lg:divide-y-0 lg:divide-x divide-gray-200",children:[(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(Yn,{className:"h-5 w-5 text-blue-600"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Goal"})]}),(0,Pt.jsx)("span",{className:"px-3 py-1 text-xs font-semibold rounded-full border ".concat(V(e.goal.status)),children:e.goal.status})]}),(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Goal Statement:"}),(0,Pt.jsx)("p",{className:"text-gray-900",children:e.goal.goal_text})]}),(0,Pt.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"Target Achievement"}),(0,Pt.jsxs)("p",{className:"text-lg font-semibold text-blue-600",children:[e.goal.target_percentage,"%"]})]}),e.goal.reviewed_by&&(0,Pt.jsxs)("div",{className:"text-right",children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"Reviewed"}),(0,Pt.jsx)("p",{className:"text-xs text-gray-700",children:new Date(e.goal.reviewed_at).toLocaleDateString()})]})]})]})]}),(0,Pt.jsx)("div",{className:"p-6 bg-gray-50",children:e.reflection?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("div",{className:"flex items-center flex-wrap justify-between mb-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(pa,{className:"h-5 w-5 text-purple-600"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Reflection"})]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[e.reflection.mentor_assessment&&(0,Pt.jsxs)("div",{className:"flex items-center space-x-1 px-2 py-1 bg-white rounded border border-gray-200",children:[H(e.reflection.mentor_assessment),(0,Pt.jsx)("span",{className:"text-xs font-medium text-gray-700",children:W(e.reflection.mentor_assessment)})]}),(0,Pt.jsx)("span",{className:"px-3 py-1 text-xs font-semibold rounded-full border ".concat(V(e.reflection.status)),children:e.reflection.status})]})]}),(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"\u2b50 What worked well"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900",children:e.reflection.reflection_answers.workedWell})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"\ud83e\udd1d How achieved"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900",children:e.reflection.reflection_answers.howAchieved})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"\ud83d\udca1 Key learning"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900",children:e.reflection.reflection_answers.keyLearning})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"\ud83d\ude80 Challenges"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-900",children:e.reflection.reflection_answers.challenges})]}),(0,Pt.jsx)("div",{className:"pt-3 border-t border-gray-300",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"Actual Achievement"}),(0,Pt.jsxs)("p",{className:"text-lg font-semibold text-purple-600",children:[e.reflection.achieved_percentage,"%"]})]}),(0,Pt.jsxs)("div",{className:"text-right",children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"Variance"}),(0,Pt.jsxs)("p",{className:"text-lg font-semibold ".concat(e.reflection.achieved_percentage>=e.goal.target_percentage?"text-green-600":"text-orange-600"),children:[e.reflection.achieved_percentage>=e.goal.target_percentage?"+":"",e.reflection.achieved_percentage-e.goal.target_percentage,"%"]})]})]})}),e.reflection.mentor_notes&&(0,Pt.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,Pt.jsx)("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:"Your Previous Feedback"}),(0,Pt.jsx)("p",{className:"text-sm text-blue-800",children:e.reflection.mentor_notes}),e.reflection.feedback_given_at&&(0,Pt.jsxs)("p",{className:"text-xs text-blue-600 mt-2",children:["Given on ",new Date(e.reflection.feedback_given_at).toLocaleString()]})]})]})]}):(0,Pt.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center py-8",children:[(0,Pt.jsx)(pa,{className:"h-12 w-12 text-gray-300 mb-3"}),(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"No reflection submitted yet"}),(0,Pt.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Student hasn't completed their evening reflection"})]})})]})]},e.goal.id))})]}),N&&m&&(0,Pt.jsxs)("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[(0,Pt.jsx)("div",{className:"absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:q}),(0,Pt.jsxs)("div",{className:"fixed inset-y-0 right-0 max-w-2xl w-full bg-white shadow-xl flex flex-col",children:[(0,Pt.jsxs)("div",{className:"bg-primary-600 px-6 py-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)($l,{className:"h-6 w-6 text-white"}),(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Review & Feedback"})]}),(0,Pt.jsx)("button",{onClick:q,className:"text-white hover:text-gray-200 transition-colors",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsx)("p",{className:"text-sm text-primary-100 mt-1",children:new Date(m.goal.created_at).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,Pt.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,Pt.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Quick Summary"}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"Goal Target"}),(0,Pt.jsxs)("p",{className:"text-lg font-semibold text-blue-600",children:[m.goal.target_percentage,"%"]})]}),m.reflection&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:"Actual Achievement"}),(0,Pt.jsxs)("p",{className:"text-lg font-semibold text-purple-600",children:[m.reflection.achieved_percentage,"%"]})]})]})]}),"pending"===m.goal.status&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Goal Action ",(0,Pt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsxs)("button",{onClick:()=>j((0,o.A)((0,o.A)({},w),{},{goalStatus:"approved",goalComment:""})),className:"w-full flex items-center space-x-3 p-4 rounded-lg border-2 transition-all ".concat("approved"===w.goalStatus?"border-green-500 bg-green-50":"border-gray-200 hover:border-green-300"),children:[(0,Pt.jsx)(qn,{className:"h-5 w-5 ".concat("approved"===w.goalStatus?"text-green-600":"text-gray-400")}),(0,Pt.jsxs)("div",{className:"text-left",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:"\u2713 Approve Goal"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"Goal is clear and achievable"})]})]}),(0,Pt.jsxs)("button",{onClick:()=>j((0,o.A)((0,o.A)({},w),{},{goalStatus:"reviewed"})),className:"w-full flex items-center space-x-3 p-4 rounded-lg border-2 transition-all ".concat("reviewed"===w.goalStatus?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-yellow-300"),children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 ".concat("reviewed"===w.goalStatus?"text-yellow-600":"text-gray-400")}),(0,Pt.jsxs)("div",{className:"text-left",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:"\u26a0 Request Changes"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"Needs clarification or adjustment"})]})]})]}),"reviewed"===w.goalStatus&&(0,Pt.jsxs)("div",{className:"mt-4",children:[(0,Pt.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Feedback for Student ",(0,Pt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Pt.jsx)("textarea",{value:w.goalComment,onChange:e=>j((0,o.A)((0,o.A)({},w),{},{goalComment:e.target.value})),rows:4,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 ".concat(null!==(e=w.goalComment)&&void 0!==e&&e.trim()?"border-gray-300":"border-red-300"),placeholder:"Required: Explain what needs to be improved or changed..."}),!(null!==(t=w.goalComment)&&void 0!==t&&t.trim())&&(0,Pt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:"\u26a0 Feedback is required when requesting changes"})]})]}),("approved"===w.goalStatus||"reviewed"===w.goalStatus)&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Goal Comment ",(0,Pt.jsx)("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),(0,Pt.jsx)("textarea",{value:w.goalComment,onChange:e=>j((0,o.A)((0,o.A)({},w),{},{goalComment:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Add a comment about this goal (e.g., suggestions, encouragement, guidance)..."}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This comment will be visible to the student alongside their goal"})]}),m.reflection&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Performance Assessment ",(0,Pt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsxs)("button",{onClick:()=>j((0,o.A)((0,o.A)({},w),{},{assessment:"exceeds_expectations"})),className:"w-full flex items-center space-x-3 p-4 rounded-lg border-2 transition-all ".concat("exceeds_expectations"===w.assessment?"border-green-500 bg-green-50":"border-gray-200 hover:border-green-300"),children:[(0,Pt.jsx)(ha,{className:"h-5 w-5 ".concat("exceeds_expectations"===w.assessment?"text-green-600":"text-gray-400")}),(0,Pt.jsxs)("div",{className:"text-left",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:"Exceeds Expectations"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"Outstanding work, going above and beyond"})]})]}),(0,Pt.jsxs)("button",{onClick:()=>j((0,o.A)((0,o.A)({},w),{},{assessment:"on_track"})),className:"w-full flex items-center space-x-3 p-4 rounded-lg border-2 transition-all ".concat("on_track"===w.assessment?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"),children:[(0,Pt.jsx)(qn,{className:"h-5 w-5 ".concat("on_track"===w.assessment?"text-blue-600":"text-gray-400")}),(0,Pt.jsxs)("div",{className:"text-left",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:"On Track"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"Meeting expectations, good progress"})]})]}),(0,Pt.jsxs)("button",{onClick:()=>j((0,o.A)((0,o.A)({},w),{},{assessment:"needs_improvement"})),className:"w-full flex items-center space-x-3 p-4 rounded-lg border-2 transition-all ".concat("needs_improvement"===w.assessment?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-yellow-300"),children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 ".concat("needs_improvement"===w.assessment?"text-yellow-600":"text-gray-400")}),(0,Pt.jsxs)("div",{className:"text-left",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:"Needs Improvement"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"Requires additional support or effort"})]})]})]})]}),"pending"===m.reflection.status&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Reflection Status ",(0,Pt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsxs)("button",{onClick:()=>j((0,o.A)((0,o.A)({},w),{},{reflectionStatus:"approved"})),className:"w-full flex items-center space-x-3 p-4 rounded-lg border-2 transition-all ".concat("approved"===w.reflectionStatus?"border-green-500 bg-green-50":"border-gray-200 hover:border-green-300"),children:[(0,Pt.jsx)(qn,{className:"h-5 w-5 ".concat("approved"===w.reflectionStatus?"text-green-600":"text-gray-400")}),(0,Pt.jsxs)("div",{className:"text-left",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:"Approve Reflection"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"Thoughtful and complete reflection"})]})]}),(0,Pt.jsxs)("button",{onClick:()=>j((0,o.A)((0,o.A)({},w),{},{reflectionStatus:"reviewed"})),className:"w-full flex items-center space-x-3 p-4 rounded-lg border-2 transition-all ".concat("reviewed"===w.reflectionStatus?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"),children:[(0,Pt.jsx)(la,{className:"h-5 w-5 ".concat("reviewed"===w.reflectionStatus?"text-blue-600":"text-gray-400")}),(0,Pt.jsxs)("div",{className:"text-left",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:"Mark as Reviewed"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"Needs more detail or clarity"})]})]})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Detailed Feedback"}),(0,Pt.jsx)("textarea",{value:w.mentorNotes,onChange:e=>j((0,o.A)((0,o.A)({},w),{},{mentorNotes:e.target.value})),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Share constructive feedback, encouragement, and suggestions for improvement..."}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This feedback will be visible to the student on their dashboard"})]})]})]}),(0,Pt.jsx)("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("button",{onClick:q,disabled:y,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{var e,t;if(m&&l)if("pending"!==m.goal.status||w.goalStatus)if("reviewed"!==w.goalStatus||null!==(e=w.goalComment)&&void 0!==e&&e.trim())if("pending"!==(null===(t=m.reflection)||void 0===t?void 0:t.status)||w.reflectionStatus)try{x(!0),w.goalStatus&&"pending"===m.goal.status&&(await cn.reviewGoal(m.goal.id,l.id,w.goalStatus,w.goalComment),sn.queryCache.invalidate("goals:student:".concat(m.goal.student_id)),sn.queryCache.invalidate("all-users")),m.reflection&&(await dn.reviewReflection(m.reflection.id,l.id,w.reflectionStatus||"reviewed",w.mentorNotes,w.assessment||void 0),sn.queryCache.invalidate("reflections:student:".concat(m.reflection.student_id)),sn.queryCache.invalidate("all-users")),h(e=>e.map(e=>e.goal.id===m.goal.id?(0,o.A)((0,o.A)({},e),{},{goal:(0,o.A)((0,o.A)({},e.goal),{},{status:w.goalStatus||e.goal.status,mentor_comment:w.goalComment||e.goal.mentor_comment,reviewed_by:l.id,reviewed_at:new Date}),reflection:e.reflection?(0,o.A)((0,o.A)({},e.reflection),{},{status:w.reflectionStatus||e.reflection.status,mentor_notes:w.mentorNotes||e.reflection.mentor_notes,mentor_assessment:w.assessment||e.reflection.mentor_assessment,reviewed_by:l.id,reviewed_at:new Date}):void 0}):e)),B({visible:!0,message:"approved"===w.goalStatus?"\u2705 Successfully approved!":"\u2705 Feedback submitted successfully!",type:"success"}),setTimeout(()=>{z()},500),q()}catch(n){console.error("Error submitting feedback:",n),B({visible:!0,message:"\u274c Failed to submit feedback. Please try again.",type:"error"})}finally{x(!1)}else alert("Please select an action for the reflection.");else alert("Please provide feedback when requesting changes.");else alert("Please select an action (Approve or Request Changes) for the goal.")},disabled:y||"pending"===m.goal.status&&!w.goalStatus||"reviewed"===w.goalStatus&&!(null!==(n=w.goalComment)&&void 0!==n&&n.trim())||"pending"===(null===(a=m.reflection)||void 0===a?void 0:a.status)&&!w.reflectionStatus,className:"flex items-center space-x-2 px-6 py-2 rounded-md text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed ".concat("approved"===w.goalStatus||"approved"===w.reflectionStatus?"bg-green-600 hover:bg-green-700":"bg-yellow-600 hover:bg-yellow-700"),children:y?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,Pt.jsx)("span",{children:"Submitting..."})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(aR,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"approved"===w.goalStatus||"approved"===w.reflectionStatus?"Approve":"Send Feedback"})]})})]})})]})]}),S&&(0,Pt.jsx)("div",{ref:E,className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:C,children:(0,Pt.jsxs)("div",{ref:A,className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:D,children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(ha,{className:"h-6 w-6 text-purple-600 mr-2"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:v?"Mentor Performance Review":"Mentee Performance Review"})]}),(0,Pt.jsx)("button",{onClick:()=>k(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Close review modal",children:(0,Pt.jsx)(zn,{className:"h-5 w-5"})})]}),(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Morning Exercise"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:v?P.morningExercise:T.morningExercise,onChange:e=>{const t=parseInt(e.target.value);v?I(e=>(0,o.A)((0,o.A)({},e),{},{morningExercise:t})):O(e=>(0,o.A)((0,o.A)({},e),{},{morningExercise:t}))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{className:(v?P.morningExercise:T.morningExercise)<=-1?"font-semibold text-red-600":"",children:"-2: Needs to put in serious effort"}),(0,Pt.jsx)("span",{className:0===(v?P.morningExercise:T.morningExercise)?"font-semibold text-yellow-600":"",children:"0: Has scope for improvement"}),(0,Pt.jsx)("span",{className:(v?P.morningExercise:T.morningExercise)>=1?"font-semibold text-green-600":"",children:"+2: Showing great growth"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat((v?P.morningExercise:T.morningExercise)>=1?"bg-green-100 text-green-800":(v?P.morningExercise:T.morningExercise)<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:-2===(v?P.morningExercise:T.morningExercise)?"Needs to put in serious effort":-1===(v?P.morningExercise:T.morningExercise)?"Needs consistent effort":0===(v?P.morningExercise:T.morningExercise)?"Has scope for improvement":1===(v?P.morningExercise:T.morningExercise)?"Improving consistently":"Showing great growth"})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Communication"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:v?P.communication:T.communication,onChange:e=>{const t=parseInt(e.target.value);v?I(e=>(0,o.A)((0,o.A)({},e),{},{communication:t})):O(e=>(0,o.A)((0,o.A)({},e),{},{communication:t}))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{className:(v?P.communication:T.communication)<=-1?"font-semibold text-red-600":"",children:"-2: Needs to put in serious effort"}),(0,Pt.jsx)("span",{className:0===(v?P.communication:T.communication)?"font-semibold text-yellow-600":"",children:"0: Has scope for improvement"}),(0,Pt.jsx)("span",{className:(v?P.communication:T.communication)>=1?"font-semibold text-green-600":"",children:"+2: Showing great growth"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat((v?P.communication:T.communication)>=1?"bg-green-100 text-green-800":(v?P.communication:T.communication)<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:-2===(v?P.communication:T.communication)?"Needs to put in serious effort":-1===(v?P.communication:T.communication)?"Needs consistent effort":0===(v?P.communication:T.communication)?"Has scope for improvement":1===(v?P.communication:T.communication)?"Improving consistently":"Showing great growth"})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Academic Effort"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:v?P.academicEffort:T.academicEffort,onChange:e=>{const t=parseInt(e.target.value);v?I(e=>(0,o.A)((0,o.A)({},e),{},{academicEffort:t})):O(e=>(0,o.A)((0,o.A)({},e),{},{academicEffort:t}))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{className:(v?P.academicEffort:T.academicEffort)<=-1?"font-semibold text-red-600":"",children:"-2: Needs to put in serious effort"}),(0,Pt.jsx)("span",{className:0===(v?P.academicEffort:T.academicEffort)?"font-semibold text-yellow-600":"",children:"0: Has scope for improvement"}),(0,Pt.jsx)("span",{className:(v?P.academicEffort:T.academicEffort)>=1?"font-semibold text-green-600":"",children:"+2: Showing great growth"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat((v?P.academicEffort:T.academicEffort)>=1?"bg-green-100 text-green-800":(v?P.academicEffort:T.academicEffort)<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:-2===(v?P.academicEffort:T.academicEffort)?"Needs to put in serious effort":-1===(v?P.academicEffort:T.academicEffort)?"Needs consistent effort":0===(v?P.academicEffort:T.academicEffort)?"Has scope for improvement":1===(v?P.academicEffort:T.academicEffort)?"Improving consistently":"Showing great growth"})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Campus Contribution"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:v?P.campusContribution:T.campusContribution,onChange:e=>{const t=parseInt(e.target.value);v?I(e=>(0,o.A)((0,o.A)({},e),{},{campusContribution:t})):O(e=>(0,o.A)((0,o.A)({},e),{},{campusContribution:t}))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{className:(v?P.campusContribution:T.campusContribution)<=-1?"font-semibold text-red-600":"",children:"-2: Needs to put in serious effort"}),(0,Pt.jsx)("span",{className:0===(v?P.campusContribution:T.campusContribution)?"font-semibold text-yellow-600":"",children:"0: Has scope for improvement"}),(0,Pt.jsx)("span",{className:(v?P.campusContribution:T.campusContribution)>=1?"font-semibold text-green-600":"",children:"+2: Showing great growth"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat((v?P.campusContribution:T.campusContribution)>=1?"bg-green-100 text-green-800":(v?P.campusContribution:T.campusContribution)<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:-2===(v?P.campusContribution:T.campusContribution)?"Needs to put in serious effort":-1===(v?P.campusContribution:T.campusContribution)?"Needs consistent effort":0===(v?P.campusContribution:T.campusContribution)?"Has scope for improvement":1===(v?P.campusContribution:T.campusContribution)?"Improving consistently":"Showing great growth"})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Behavioural"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:v?P.behavioural:T.behavioural,onChange:e=>{const t=parseInt(e.target.value);v?I(e=>(0,o.A)((0,o.A)({},e),{},{behavioural:t})):O(e=>(0,o.A)((0,o.A)({},e),{},{behavioural:t}))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Pt.jsx)("span",{className:(v?P.behavioural:T.behavioural)<=-1?"font-semibold text-red-600":"",children:"-2: Needs to put in serious effort"}),(0,Pt.jsx)("span",{className:0===(v?P.behavioural:T.behavioural)?"font-semibold text-yellow-600":"",children:"0: Has scope for improvement"}),(0,Pt.jsx)("span",{className:(v?P.behavioural:T.behavioural)>=1?"font-semibold text-green-600":"",children:"+2: Showing great growth"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat((v?P.behavioural:T.behavioural)>=1?"bg-green-100 text-green-800":(v?P.behavioural:T.behavioural)<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:-2===(v?P.behavioural:T.behavioural)?"Needs to put in serious effort":-1===(v?P.behavioural:T.behavioural)?"Needs consistent effort":0===(v?P.behavioural:T.behavioural)?"Has scope for improvement":1===(v?P.behavioural:T.behavioural)?"Improving consistently":"Showing great growth"})]}),v&&(0,Pt.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg border-2 border-purple-200",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-purple-900 mb-3",children:"Mentorship Level \u2b50"}),(0,Pt.jsx)("input",{type:"range",min:"-2",max:"2",value:P.mentorshipLevel,onChange:e=>I(t=>(0,o.A)((0,o.A)({},t),{},{mentorshipLevel:parseInt(e.target.value)})),className:"w-full h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer slider"}),(0,Pt.jsxs)("div",{className:"flex justify-between text-xs text-purple-700 mt-1",children:[(0,Pt.jsx)("span",{className:P.mentorshipLevel<=-1?"font-semibold text-red-600":"",children:"-2: Not providing adequate support"}),(0,Pt.jsx)("span",{className:0===P.mentorshipLevel?"font-semibold text-yellow-600":"",children:"0: Meets basic expectations"}),(0,Pt.jsx)("span",{className:P.mentorshipLevel>=1?"font-semibold text-green-600":"",children:"+2: Exceptional mentor"})]}),(0,Pt.jsx)("div",{className:"text-center text-sm font-medium mt-2 px-3 py-1 rounded-full inline-block ".concat(P.mentorshipLevel>=1?"bg-green-100 text-green-800":P.mentorshipLevel<=-1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:-2===P.mentorshipLevel?"Not providing adequate support":-1===P.mentorshipLevel?"Needs to improve guidance":0===P.mentorshipLevel?"Meets basic expectations":1===P.mentorshipLevel?"Great mentor":"Exceptional mentor"})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Additional Notes"}),(0,Pt.jsx)("textarea",{value:v?P.notes:T.notes,onChange:e=>{const t=e.target.value;v?I(e=>(0,o.A)((0,o.A)({},e),{},{notes:t})):O(e=>(0,o.A)((0,o.A)({},e),{},{notes:t}))},placeholder:"Add any additional comments or observations...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3})]})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,Pt.jsx)("button",{onClick:()=>k(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{if(c&&l)try{x(!0);const e=qt();if(k(!1),v){const t={mentor_id:c.id,student_id:l.id,morning_exercise:P.morningExercise,communication:P.communication,academic_effort:P.academicEffort,campus_contribution:P.campusContribution,behavioural:P.behavioural,mentorship_level:P.mentorshipLevel,notes:P.notes,week_start:e};console.log("\ud83d\udcdd [MentorMenteeReview] Submitting MENTOR review data:",t);const n=await yn.createReview(t);console.log("\ud83d\udcdd [MentorMenteeReview] Mentor review saved:",n),I({morningExercise:0,communication:0,academicEffort:0,campusContribution:0,behavioural:0,mentorshipLevel:0,notes:""}),B({visible:!0,message:"\u2705 Mentor review submitted successfully!",type:"success"}),setTimeout(async()=>{try{if(s&&null!==l&&void 0!==l&&l.id){const e=await yn.getLatestReview(s,l.id);F(e)}}catch(e){console.error("Error reloading latest mentor review:",e)}},1e3)}else{const t={student_id:c.id,mentor_id:l.id,morning_exercise:T.morningExercise,communication:T.communication,academic_effort:T.academicEffort,campus_contribution:T.campusContribution,behavioural:T.behavioural,notes:T.notes,week_start:e};console.log("\ud83d\udcdd [MentorMenteeReview] Submitting MENTEE review data:",t);const n=await gn.createReview(t);console.log("\ud83d\udcdd [MentorMenteeReview] Mentee review saved:",n),O({morningExercise:0,communication:0,academicEffort:0,campusContribution:0,behavioural:0,notes:""}),B({visible:!0,message:"\u2705 Mentee review submitted successfully!",type:"success"}),setTimeout(async()=>{try{if(s){const e=await gn.getLatestReview(s);F(e)}}catch(e){console.error("Error reloading latest review:",e)}},1e3)}}catch(e){console.error("Error submitting review:",e),B({visible:!0,message:"\u274c Failed to submit review. Please try again.",type:"error"})}finally{x(!1)}},disabled:y,className:"px-4 py-2 text-white bg-purple-600 rounded-lg hover:bg-purple-700 disabled:opacity-50 transition-colors",children:y?"Submitting...":"Submit Review"})]})]})}),(0,Pt.jsx)(hr,{visible:U.visible,message:U.message,type:U.type,onClose:()=>B({visible:!1,message:"",type:"info"})})]}):(0,Pt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Student not found"}),(0,Pt.jsx)("button",{onClick:()=>i("/mentor/dashboard"),className:"mt-4 bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700",children:"Back to Dashboard"})]})})},iR=Un("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),oR=Un("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),lR=Un("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),cR=()=>{const{userData:e}=Rt(),[t,n]=(0,r.useState)([]),[a,s]=(0,r.useState)(!0),[i,l]=(0,r.useState)("all"),[c,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[m,p]=(0,r.useState)(""),[f,g]=(0,r.useState)("sessions"),[y,x]=(0,r.useState)([]),[v,b]=(0,r.useState)(!1),w=(0,r.useCallback)(async()=>{try{s(!0),console.log("Loading sessions for user:",e);const t=await xn.getSessionsByUser(e.id,"mentor");console.log("Assigned sessions:",t.length);const r=await xn.getPendingSessions();console.log("All pending/assigned sessions:",r.length);const a=r.filter(e=>!e.mentor_id);console.log("Truly pending sessions (no mentor):",a.length);const i=[...t,...a].filter((e,t,n)=>t===n.findIndex(t=>t.id===e.id));console.log("Total unique sessions to display:",i.length);const l=await Promise.all(i.map(async e=>{const t=await _t.UserService.getUserById(e.student_id);return(0,o.A)((0,o.A)({},e),{},{student:t})}));n(l)}catch(t){console.error("Error loading pair programming requests:",t),n([])}finally{s(!1)}},[e]),j=(0,r.useCallback)(async()=>{try{const t=await _t.UserService.getMentorAvailability(e.id);if(t.length>0)x(t);else{const t=[],n=["09:00","10:00","11:00","14:00","15:00","16:00","17:00"];["monday","tuesday","wednesday","thursday","friday"].forEach(r=>{n.forEach(n=>{t.push({id:"".concat(e.id,"-").concat(r,"-").concat(n),mentor_id:e.id,campus:e.campus||"Dharamshala",day_of_week:r,start_time:n,end_time:n,is_available:!0,max_sessions_per_slot:1,created_at:new Date,updated_at:new Date})})}),x(t)}}catch(t){console.error("Error loading availability:",t);const n=[],r=["09:00","10:00","11:00","14:00","15:00","16:00","17:00"];["monday","tuesday","wednesday","thursday","friday"].forEach(t=>{r.forEach(r=>{n.push({id:"".concat(e.id,"-").concat(t,"-").concat(r),mentor_id:e.id,campus:e.campus||"Dharamshala",day_of_week:t,start_time:r,end_time:r,is_available:!0,max_sessions_per_slot:1,created_at:new Date,updated_at:new Date})})}),x(n)}},[e]),N=(null===e||void 0===e?void 0:e.isMentor)||"mentor"===(null===e||void 0===e?void 0:e.role)||"super_mentor"===(null===e||void 0===e?void 0:e.role)||(null===e||void 0===e?void 0:e.isSuperMentor);(0,r.useEffect)(()=>{null!==e&&void 0!==e&&e.id&&N?w():(console.log("User is not a mentor or not loaded:",{userData:e,isMentor:N}),s(!1))},[e,N,w]),(0,r.useEffect)(()=>{"availability"===f&&null!==e&&void 0!==e&&e.id&&j()},[f,e,j]);const _=e=>{h(e),p(""),d(!0)},S=()=>{d(!1),h(null),p("")},k=async e=>{try{await xn.updateSession(e,{status:"cancelled",cancelled_at:new Date,cancel_reason:"Cancelled by mentor"}),await w()}catch(t){console.error("Error cancelling session:",t)}},E=e=>{switch(e){case"pending":return"text-yellow-600 bg-yellow-100";case"assigned":return"text-blue-600 bg-blue-100";case"scheduled":return"text-purple-600 bg-purple-100";case"completed":return"text-green-600 bg-green-100";case"cancelled":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},A=e=>{switch(e){case"pending":default:return(0,Pt.jsx)(la,{className:"h-4 w-4"});case"assigned":return(0,Pt.jsx)(iR,{className:"h-4 w-4"});case"scheduled":return(0,Pt.jsx)(Bn,{className:"h-4 w-4"});case"completed":return(0,Pt.jsx)(qn,{className:"h-4 w-4"});case"cancelled":return(0,Pt.jsx)(oR,{className:"h-4 w-4"})}},C=t.filter(e=>"all"===i||e.status===i),D={total:t.length,pending:t.filter(e=>"pending"===e.status).length,assigned:t.filter(e=>"assigned"===e.status).length,scheduled:t.filter(e=>"scheduled"===e.status).length,completed:t.filter(e=>"completed"===e.status).length};return a?(0,Pt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):N?(0,Pt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Pt.jsx)("div",{className:"bg-white shadow",children:(0,Pt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Pt.jsxs)("div",{className:"py-6",children:[(0,Pt.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Pair Programming Management"}),(0,Pt.jsx)("p",{className:"mt-2 text-gray-600",children:"Manage student pair programming requests"})]})})}),(0,Pt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,Pt.jsx)("div",{className:"border-b border-gray-200 mb-8",children:(0,Pt.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,Pt.jsxs)("button",{onClick:()=>g("sessions"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("sessions"===f?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,Pt.jsx)(Zn,{className:"h-5 w-5 inline mr-2"}),"Session Management"]}),(0,Pt.jsxs)("button",{onClick:()=>g("availability"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("availability"===f?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,Pt.jsx)(lR,{className:"h-5 w-5 inline mr-2"}),"Availability Settings"]})]})}),"sessions"===f?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8",children:[(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(Zn,{className:"h-8 w-8 text-blue-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Requests"}),(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:D.total})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(la,{className:"h-8 w-8 text-yellow-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Pending"}),(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:D.pending})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(iR,{className:"h-8 w-8 text-blue-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Assigned"}),(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:D.assigned})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(Bn,{className:"h-8 w-8 text-purple-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Scheduled"}),(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:D.scheduled})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(qn,{className:"h-8 w-8 text-green-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Completed"}),(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:D.completed})]})]})})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow mb-8",children:[(0,Pt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pt.jsx)("div",{className:"flex space-x-4",children:["all","pending","assigned","scheduled","completed"].map(e=>(0,Pt.jsxs)("button",{onClick:()=>l(e),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors ".concat(i===e?"bg-primary-100 text-primary-700 border border-primary-300":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:[e.charAt(0).toUpperCase()+e.slice(1),"all"!==e&&(0,Pt.jsx)("span",{className:"ml-2 px-2 py-1 text-xs bg-gray-200 rounded-full",children:D[e]})]},e))})}),(0,Pt.jsxs)("div",{className:"divide-y divide-gray-200",children:[C.map(t=>(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Pt.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:(0,Pt.jsx)("span",{className:"text-blue-600 font-medium text-sm",children:t.student.name.charAt(0)})})}),(0,Pt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900 truncate",children:t.topic}),(0,Pt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(E(t.status)),children:[A(t.status),(0,Pt.jsx)("span",{className:"ml-1",children:t.status})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,Pt.jsx)(er,{className:"h-4 w-4 mr-1"}),(0,Pt.jsx)("span",{className:"mr-4",children:t.student.name}),(0,Pt.jsx)(Bn,{className:"h-4 w-4 mr-1"}),(0,Pt.jsx)("span",{children:new Date(t.created_at).toLocaleDateString()})]}),t.description&&(0,Pt.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:t.description}),t.assigned_at&&(0,Pt.jsxs)("p",{className:"text-xs text-gray-500",children:["Assigned: ",new Date(t.assigned_at).toLocaleString()]}),t.scheduled_date&&t.scheduled_time&&(0,Pt.jsxs)("p",{className:"text-xs text-purple-600",children:["Scheduled: ",new Date(t.scheduled_date).toLocaleDateString()," at ",t.scheduled_time]}),t.completed_at&&(0,Pt.jsxs)("p",{className:"text-xs text-gray-500",children:["Completed: ",new Date(t.completed_at).toLocaleString()]})]})]}),(0,Pt.jsxs)("div",{className:"flex-shrink-0 ml-4",children:["pending"===t.status&&(0,Pt.jsxs)("div",{className:"flex space-x-2",children:[(0,Pt.jsx)("button",{onClick:()=>(async t=>{try{await xn.assignMentorToSession(t,e.id),await w()}catch(n){console.error("Error assigning session:",n)}})(t.id),className:"bg-blue-600 text-white px-3 py-1 rounded-md text-sm hover:bg-blue-700 transition-colors",children:"Assign to Me"}),(0,Pt.jsx)("button",{onClick:()=>k(t.id),className:"bg-red-600 text-white px-3 py-1 rounded-md text-sm hover:bg-red-700 transition-colors",children:"Cancel"})]}),"assigned"===t.status&&(0,Pt.jsxs)("div",{className:"flex space-x-2",children:[(0,Pt.jsx)("button",{onClick:()=>_(t),className:"bg-green-600 text-white px-3 py-1 rounded-md text-sm hover:bg-green-700 transition-colors",children:"Complete Session"}),(0,Pt.jsx)("button",{onClick:()=>k(t.id),className:"bg-red-600 text-white px-3 py-1 rounded-md text-sm hover:bg-red-700 transition-colors",children:"Cancel"})]}),"scheduled"===t.status&&(0,Pt.jsxs)("div",{className:"flex space-x-2",children:[(0,Pt.jsx)("button",{onClick:()=>_(t),className:"bg-green-600 text-white px-3 py-1 rounded-md text-sm hover:bg-green-700 transition-colors",children:"Mark Complete"}),(0,Pt.jsx)("button",{onClick:()=>k(t.id),className:"bg-red-600 text-white px-3 py-1 rounded-md text-sm hover:bg-red-700 transition-colors",children:"Cancel"})]})]})]})},t.id)),0===C.length&&(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(Zn,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,Pt.jsxs)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:["No ","all"===i?"":i," requests"]}),(0,Pt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"all"===i?"No pair programming requests have been made yet.":"No ".concat(i," pair programming requests at the moment.")})]})]})]})]}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,Pt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Availability Settings"}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-1",children:"Set your weekly availability for pair programming sessions. Click on time slots to toggle availability."})]}),(0,Pt.jsx)("button",{onClick:async()=>{try{b(!0),await _t.UserService.saveBulkMentorAvailability(y),alert("Availability settings saved successfully!")}catch(e){console.error("Error saving availability:",e),alert("Error saving availability settings")}finally{b(!1)}},disabled:v,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:v?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(qn,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})]}),(0,Pt.jsx)("div",{className:"overflow-x-auto",children:(0,Pt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Day"}),["09:00","10:00","11:00","14:00","15:00","16:00","17:00"].map(e=>(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:e},e))]})}),(0,Pt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:["monday","tuesday","wednesday","thursday","friday"].map(e=>(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 capitalize",children:e}),["09:00","10:00","11:00","14:00","15:00","16:00","17:00"].map(t=>{var n;const r=y.find(n=>n.day_of_week===e&&n.start_time===t),a=null===(n=null===r||void 0===r?void 0:r.is_available)||void 0===n||n;return(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,Pt.jsx)("button",{onClick:()=>((e,t)=>{x(n=>n.map(n=>n.day_of_week===e&&n.start_time===t?(0,o.A)((0,o.A)({},n),{},{is_available:!n.is_available}):n))})(e,t),className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ".concat(a?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"),children:a?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(qn,{className:"h-3 w-3 mr-1"}),"Available"]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(oR,{className:"h-3 w-3 mr-1"}),"Unavailable"]})})},t)})]},e))})]})}),(0,Pt.jsx)("div",{className:"mt-6 p-4 bg-blue-50 rounded-md",children:(0,Pt.jsxs)("div",{className:"flex",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(la,{className:"h-5 w-5 text-blue-400"})}),(0,Pt.jsxs)("div",{className:"ml-3",children:[(0,Pt.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"How it works"}),(0,Pt.jsx)("div",{className:"mt-2 text-sm text-blue-700",children:(0,Pt.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,Pt.jsx)("li",{children:"Green slots indicate when you're available for pair programming sessions"}),(0,Pt.jsx)("li",{children:"Red slots indicate when you're unavailable"}),(0,Pt.jsx)("li",{children:"Students can only schedule sessions during your available time slots"}),(0,Pt.jsx)("li",{children:"Changes take effect immediately after saving"})]})})]})]})})]}),c&&u&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,Pt.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,Pt.jsxs)("div",{className:"mt-3",children:[(0,Pt.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Complete Session: ",u.topic]}),(0,Pt.jsxs)("div",{className:"mb-4",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session Feedback/Notes"}),(0,Pt.jsx)("textarea",{value:m,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,placeholder:"Enter your feedback and notes about the session..."})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,Pt.jsx)("button",{onClick:S,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{u&&m.trim()&&(await(async(e,t)=>{try{await xn.updateSession(e,{status:"completed",completed_at:new Date,notes:t}),await w()}catch(n){console.error("Error completing session:",n)}})(u.id,m),S())},disabled:!m.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Complete Session"})]})]})})})]})]}):(0,Pt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,Pt.jsx)("p",{className:"text-xl text-gray-600 mb-4",children:"You need mentor privileges to access this page."}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"Please contact an administrator if you believe this is an error."}),(0,Pt.jsxs)("div",{className:"mt-4 text-sm text-gray-400",children:["User role: ",(null===e||void 0===e?void 0:e.role)||"none"," | isMentor: ",null!==e&&void 0!==e&&e.isMentor?"true":"false"]})]})})},dR=()=>{var e;const{userData:t}=Rt(),n=he(),[a,s]=(0,r.useState)("mentor"),[i,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)(null),[d,u]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),[p,f]=(0,r.useState)(new Map);(0,r.useEffect)(()=>{g()},[t]);const g=async()=>{if(t){o(!0);try{if(t.mentor_id){const e=await _t.UserService.getUserById(t.mentor_id);c(e);const n=await yn.getReviewsByMentor(t.mentor_id);m(n)}const n=await _t.UserService.getStudentsByMentor(t.id);u(n);const r=new Map;for(const t of n)try{const e=await gn.getLatestReview(t.id);e&&r.set(t.id,e)}catch(e){console.error("Error loading review for mentee ".concat(t.id,":"),e)}f(r)}catch(e){console.error("Error loading review data:",e)}finally{o(!1)}}},y=()=>{if(!l||!t)return!1;const e=qt();return h.some(n=>(n.week_start instanceof Date?n.week_start:new Date(n.week_start)).getTime()>=e.getTime()&&n.student_id===t.id)},x=e=>{const t=p.get(e);if(!t)return!1;const n=qt();return(t.week_start instanceof Date?t.week_start:new Date(t.week_start)).getTime()>=n.getTime()},v=()=>{const e=h.filter(e=>e.student_id===(null===t||void 0===t?void 0:t.id));if(0===e.length)return null;const n=e.sort((e,t)=>{const n=e.week_start instanceof Date?e.week_start:new Date(e.week_start);return(t.week_start instanceof Date?t.week_start:new Date(t.week_start)).getTime()-n.getTime()})[0];return da(n)},b=()=>{const e=h.filter(e=>e.student_id===(null===t||void 0===t?void 0:t.id)).sort((e,t)=>{const n=e.week_start instanceof Date?e.week_start:new Date(e.week_start);return(t.week_start instanceof Date?t.week_start:new Date(t.week_start)).getTime()-n.getTime()});if(0===e.length)return 0;let n=1;for(let t=0;t<e.length-1;t++){const r=new Date(e[t].week_start),a=new Date(e[t+1].week_start);if(!(Math.floor((r.getTime()-a.getTime())/864e5)<=7))break;n++}return n},w=()=>{const e=h.filter(e=>e.student_id===(null===t||void 0===t?void 0:t.id)).sort((e,t)=>{const n=e.week_start instanceof Date?e.week_start:new Date(e.week_start);return(t.week_start instanceof Date?t.week_start:new Date(t.week_start)).getTime()-n.getTime()});if(e.length<2)return"neutral";const n=da(e[0]),r=da(e[1]);return n>r?"up":n<r?"down":"neutral"},j=()=>{const e=(new Date).getDay();return 0===e?0:7-e},N=e=>{const t=e instanceof Date?e:new Date(e);return"".concat(t.getMonth()+1,"/").concat(t.getDate())};return i?(0,Pt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Loading reviews..."})]})}):(0,Pt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Pt.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg",children:(0,Pt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mb-6",children:[(0,Pt.jsx)("div",{className:"p-3 bg-white bg-opacity-20 rounded-lg flex-shrink-0",children:(0,Pt.jsx)(ha,{className:"h-10 w-10"})}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold",children:"Performance Reviews"}),(0,Pt.jsx)("p",{className:"text-purple-100 mt-2",children:"Review your mentor and mentees weekly"})]})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[(0,Pt.jsx)("div",{onClick:()=>s("mentor"),className:"bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4 cursor-pointer hover:bg-opacity-20 transition-all hover:scale-105",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-purple-100 text-sm",children:"Mentor to Review"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold",children:l?1:0})]}),(0,Pt.jsx)(Jn,{className:"h-8 w-8 text-purple-200"})]})}),(0,Pt.jsx)("div",{onClick:()=>s("mentees"),className:"bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4 cursor-pointer hover:bg-opacity-20 transition-all hover:scale-105",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-purple-100 text-sm",children:"Mentees to Review"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold",children:d.length})]}),(0,Pt.jsx)(er,{className:"h-8 w-8 text-purple-200"})]})}),(0,Pt.jsx)("div",{className:"bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-purple-100 text-sm",children:"This Week"}),(0,Pt.jsxs)("p",{className:"text-2xl font-bold",children:[(y()?1:0)+d.filter(e=>x(e.id)).length,"/",(l?1:0)+d.length]})]}),(0,Pt.jsx)($n,{className:"h-8 w-8 text-purple-200"})]})})]})]})}),(0,Pt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-9 mb-5",children:(0,Pt.jsxs)("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border-l-4 border-amber-500 rounded-lg shadow-sm p-6",children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,Pt.jsx)("span",{className:"text-2xl mr-2",children:"\ud83d\udcca"}),"Your Review Insights"]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[b()>0&&(0,Pt.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("span",{className:"text-3xl",children:"\ud83d\udd25"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Review Streak"}),(0,Pt.jsxs)("p",{className:"text-2xl font-bold text-amber-600",children:[b()," ",1===b()?"week":"weeks","!"]})]})]})}),"neutral"!==w()&&(0,Pt.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("span",{className:"text-3xl",children:"up"===w()?"\ud83d\udcc8":"\ud83d\udcc9"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Mentor Rating"}),(0,Pt.jsx)("p",{className:"text-lg font-bold ".concat("up"===w()?"text-green-600":"text-orange-600"),children:"up"===w()?"Improving!":"Attention needed"})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("span",{className:"text-3xl",children:y()&&d.every(e=>x(e.id))?"\u2705":"\u23f0"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"This Week"}),(0,Pt.jsx)("p",{className:"text-lg font-bold text-purple-600",children:y()&&d.every(e=>x(e.id))?"All done!":"".concat(j()," day").concat(1===j()?"":"s"," left")})]})]})})]})]})}),(0,Pt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-8",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,Pt.jsx)($n,{className:"h-5 w-5 mr-2 text-purple-600"}),"Review Performance Trends"]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Pt.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg p-4",children:[(0,Pt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"My Mentor's Performance"}),h.filter(e=>e.student_id===(null===t||void 0===t?void 0:t.id)).length>0?(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Total Reviews:"}),(0,Pt.jsx)("span",{className:"font-bold text-purple-600",children:h.filter(e=>e.student_id===(null===t||void 0===t?void 0:t.id)).length})]}),(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Latest Score:"}),(0,Pt.jsx)("span",{className:"font-bold text-purple-600",children:(null===(e=v())||void 0===e?void 0:e.toFixed(1))||"N/A"})]}),(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Average Score:"}),(0,Pt.jsx)("span",{className:"font-bold text-purple-600",children:h.filter(e=>e.student_id===(null===t||void 0===t?void 0:t.id)).length>0?(h.filter(e=>e.student_id===(null===t||void 0===t?void 0:t.id)).reduce((e,t)=>e+da(t),0)/h.filter(e=>e.student_id===(null===t||void 0===t?void 0:t.id)).length).toFixed(1):"N/A"})]}),(0,Pt.jsx)("div",{className:"mt-4 space-y-2",children:h.filter(e=>e.student_id===(null===t||void 0===t?void 0:t.id)).slice(-5).reverse().map((e,t)=>{const n=da(e),r=n/2*100;return(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 group cursor-pointer hover:bg-purple-100 hover:bg-opacity-50 rounded-lg p-1 transition-all",title:"Review from ".concat(N(e.week_start)," - Score: ").concat(n.toFixed(2),"/2.0"),children:[(0,Pt.jsx)("span",{className:"text-xs text-gray-500 w-14 sm:w-16 font-medium",children:N(e.week_start)}),(0,Pt.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-6 shadow-inner",children:(0,Pt.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-purple-500 h-6 rounded-full transition-all group-hover:from-purple-700 group-hover:to-purple-600",style:{width:"".concat(r,"%")}})}),(0,Pt.jsx)("span",{className:"text-xs font-bold text-purple-700 w-12",children:n.toFixed(1)})]},t)})})]}):(0,Pt.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No mentor reviews yet"})]}),(0,Pt.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg p-4",children:[(0,Pt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"My Mentees' Performance"}),Array.from(p.values()).length>0?(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Total Reviews:"}),(0,Pt.jsx)("span",{className:"font-bold text-blue-600",children:Array.from(p.values()).length})]}),(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Average Score:"}),(0,Pt.jsx)("span",{className:"font-bold text-blue-600",children:Array.from(p.values()).length>0?(Array.from(p.values()).reduce((e,t)=>e+da(t),0)/Array.from(p.values()).length).toFixed(1):"N/A"})]}),(0,Pt.jsxs)("div",{className:"mt-4 space-y-2",children:[d.slice(0,5).map(e=>{const t=p.get(e.id),n=t?da(t):0,r=n/2*100;return(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 group cursor-pointer hover:bg-blue-100 hover:bg-opacity-50 rounded-lg p-1 transition-all",title:"".concat(e.name," - Latest Score: ").concat(t?n.toFixed(2):"Not reviewed yet"),children:[(0,Pt.jsx)("span",{className:"text-xs text-gray-500 w-16 sm:w-20 truncate font-medium",title:e.name,children:e.name.split(" ")[0]}),(0,Pt.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-6 shadow-inner",children:(0,Pt.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-500 h-6 rounded-full transition-all group-hover:from-blue-700 group-hover:to-blue-600",style:{width:"".concat(r,"%")}})}),(0,Pt.jsx)("span",{className:"text-xs font-bold text-blue-700 w-12",children:t?n.toFixed(1):"N/A"})]},e.id)}),d.length>5&&(0,Pt.jsxs)("p",{className:"text-xs text-gray-500 italic text-center mt-2",children:["+",d.length-5," more mentees"]})]})]}):(0,Pt.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No mentee reviews yet"})]})]})]})}),(0,Pt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,Pt.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200 rounded-t-lg",children:(0,Pt.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,Pt.jsx)("button",{onClick:()=>s("mentor"),className:"w-full sm:w-auto text-center px-4 py-3 sm:px-6 sm:py-4 font-medium border-b-2 transition-colors ".concat("mentor"===a?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(Jn,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:"My Mentor"}),l&&!y()&&(0,Pt.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Due"})]})}),(0,Pt.jsx)("button",{onClick:()=>s("mentees"),className:"w-full sm:w-auto text-center px-4 py-3 sm:px-6 sm:py-4 font-medium border-b-2 transition-colors ".concat("mentees"===a?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(er,{className:"h-5 w-5"}),(0,Pt.jsxs)("span",{children:["My Mentees (",d.length,")"]}),d.some(e=>!x(e.id))&&(0,Pt.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:d.filter(e=>!x(e.id)).length})]})})]})}),(0,Pt.jsx)("div",{className:"py-8",children:"mentor"===a?(0,Pt.jsx)("div",{children:l?(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border-l-4 border-purple-500 p-2 hover:shadow-md transition-shadow",children:(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-0",children:[(0,Pt.jsxs)("div",{className:"flex items-start sm:items-center space-x-4 min-w-0",children:[(0,Pt.jsxs)("div",{className:"relative w-14 h-14 bg-purple-100 rounded-full flex items-center justify-center",children:[(0,Pt.jsx)("span",{className:"text-2xl font-bold text-purple-600",children:l.name.charAt(0).toUpperCase()}),b()>=3&&(0,Pt.jsx)("div",{className:"absolute -top-1 -right-1 bg-amber-500 rounded-full w-6 h-6 flex items-center justify-center text-xs",children:"\ud83d\udd25"})]}),(0,Pt.jsxs)("div",{className:"min-w-0",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 truncate",children:l.name}),"up"===w()&&(0,Pt.jsx)("span",{className:"text-green-600 text-xl",title:"Performance improving",children:"\u2197\ufe0f"}),"down"===w()&&(0,Pt.jsx)("span",{className:"text-orange-600 text-xl",title:"Needs attention",children:"\u2198\ufe0f"})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 truncate",children:l.email}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-3 mt-2 flex-wrap gap-2",children:[y()?(0,Pt.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"\u2705 Reviewed this week"}):0===j()?(0,Pt.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-600 text-white animate-pulse",children:"\u26a0\ufe0f Due today!"}):j()<=2?(0,Pt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 animate-pulse",children:["\u23f0 ",j()," day",1===j()?"":"s"," left"]}):(0,Pt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:["\ufffd ",j()," days left"]}),null!==v()&&(0,Pt.jsx)(Pt.Fragment,{children:(()=>{const e=v(),t=e>=1.7?"text-green-600 bg-green-100":e>=1.3?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100";return(0,Pt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-bold ".concat(t),children:["\u2b50 ",e.toFixed(1),"/2.0"]})})()}),b()>0&&(0,Pt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:["\ud83d\udd25 ",b(),"-week streak"]})]})]})]}),(0,Pt.jsxs)("button",{onClick:()=>n("/mentor/mentee/".concat(l.id)),className:"mt-4 sm:mt-0 px-4 py-2 sm:px-6 sm:py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium flex items-center space-x-2 hover:scale-105 transform flex-shrink-0",children:[(0,Pt.jsx)(ha,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:"Review Mentor"})]})]})}):(0,Pt.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg shadow-sm border-2 border-dashed border-purple-300 p-16 text-center",children:[(0,Pt.jsxs)("div",{className:"mb-6",children:[(0,Pt.jsx)("div",{className:"w-24 h-24 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Pt.jsx)(Jn,{className:"h-14 w-14 text-purple-400"})}),(0,Pt.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udf93"})]}),(0,Pt.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No Mentor Assigned Yet"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-2 max-w-md mx-auto",children:"A mentor will guide you through your learning journey and help you grow."}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500 mb-8",children:"Contact your admin to get paired with a mentor who matches your goals."}),(0,Pt.jsx)("button",{onClick:()=>n("/student/dashboard"),className:"px-8 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all font-medium shadow-md hover:shadow-lg transform hover:scale-105",children:"Go to Dashboard"})]})}):(0,Pt.jsx)("div",{children:d.length>0?(0,Pt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(e=>{const t=x(e.id),r=p.get(e.id),a=r?da(r):null,s=(e.id,"neutral");return(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border-l-4 border-indigo-500 p-6 hover:shadow-md transition-shadow",children:[(0,Pt.jsx)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4",children:(0,Pt.jsxs)("div",{className:"flex items-center space-x-3 min-w-0",children:[(0,Pt.jsx)("div",{className:"relative w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,Pt.jsx)("span",{className:"text-lg font-bold text-indigo-600",children:e.name.charAt(0).toUpperCase()})}),(0,Pt.jsxs)("div",{className:"min-w-0",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.name}),"up"===s&&(0,Pt.jsx)("span",{className:"text-green-600 text-lg",title:"Performance improving",children:"\u2197\ufe0f"}),"down"===s&&(0,Pt.jsx)("span",{className:"text-orange-600 text-lg",title:"Needs attention",children:"\u2198\ufe0f"})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 truncate",children:e.email})]})]})}),(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[(0,Pt.jsxs)("div",{className:"flex flex-col space-y-2",children:[t?(0,Pt.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"\u2705 Reviewed this week"}):0===j()?(0,Pt.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-600 text-white animate-pulse",children:"\u26a0\ufe0f Due today!"}):j()<=2?(0,Pt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 animate-pulse",children:["\u23f0 ",j()," day",1===j()?"":"s"," left"]}):(0,Pt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:["\ufffd ",j()," days left"]}),null!==a&&(0,Pt.jsx)(Pt.Fragment,{children:(()=>{const e=a>=1.7?"text-green-600 bg-green-100":a>=1.3?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100";return(0,Pt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-bold ".concat(e),children:["\u2b50 ",a.toFixed(1),"/2.0"]})})()})]}),(0,Pt.jsxs)("button",{onClick:()=>n("/mentor/mentee/".concat(e.id)),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium flex items-center space-x-2 hover:scale-105 transform flex-shrink-0",children:[(0,Pt.jsx)(ha,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Review"})]})]})]},e.id)})}):(0,Pt.jsxs)("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-50 rounded-lg shadow-sm border-2 border-dashed border-indigo-300 p-16 text-center",children:[(0,Pt.jsxs)("div",{className:"mb-6",children:[(0,Pt.jsx)("div",{className:"w-24 h-24 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Pt.jsx)(er,{className:"h-14 w-14 text-indigo-400"})}),(0,Pt.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udc65"})]}),(0,Pt.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No Mentees Yet"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-2 max-w-md mx-auto",children:"You'll be assigned mentees to guide and review as they grow."}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500 mb-8",children:"When mentees are assigned, you'll see them here and can provide weekly feedback."}),(0,Pt.jsx)("div",{className:"flex justify-center space-x-4",children:(0,Pt.jsx)("button",{onClick:()=>n("/mentor/dashboard"),className:"px-8 py-3 bg-gradient-to-r from-indigo-600 to-blue-600 text-white rounded-lg hover:from-indigo-700 hover:to-blue-700 transition-all font-medium shadow-md hover:shadow-lg transform hover:scale-105",children:"Mentor Dashboard"})})]})})})]})]})},uR=Un("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),hR=e=>{var t;let{onClose:n,onSuccess:a}=e;const{userData:s}=Rt(),[i,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[m,p]=(0,r.useState)({topic:"",description:"",session_type:"one_on_one",priority:"medium",preferred_date:"",preferred_time:"",duration_minutes:30,max_participants:2,tags:[],specific_mentor_id:"",is_recurring:!1,recurring_pattern:null,student_id:(null===s||void 0===s?void 0:s.id)||"",status:"pending",mentor_id:void 0,scheduled_date:void 0,scheduled_time:void 0,completed_at:void 0,feedback_submitted:!1,notes:void 0}),[f,g]=(0,r.useState)({});(0,r.useEffect)(()=>{(async()=>{try{if(null!==s&&void 0!==s&&s.id){const e=await mn.getStudentCurrentTopicAndPhase(s.id);e&&(h({topic:e.topic,phase:e.phase}),p(t=>(0,o.A)((0,o.A)({},t),{},{topic:"".concat(e.topic," (Phase: ").concat(e.phase,")")})))}}catch(e){console.error("Error loading data:",e)}})()},[null===s||void 0===s?void 0:s.id]);const y=(e,t)=>{p(n=>(0,o.A)((0,o.A)({},n),{},{[e]:t})),f[e]&&g(t=>(0,o.A)((0,o.A)({},t),{},{[e]:""}))};return(0,Pt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,Pt.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white",children:(0,Pt.jsxs)("div",{className:"p-6 max-h-[80vh] overflow-y-auto",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Request Pair Programming Session"}),(0,Pt.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),s&&(()=>{var e,t;const n={};return null!==(e=m.topic)&&void 0!==e&&e.trim()||(n.topic="Topic is required"),null!==(t=m.description)&&void 0!==t&&t.trim()||(n.description="Description is required"),m.session_type||(n.session_type="Session type is required"),"group"===m.session_type&&(!m.max_participants||m.max_participants<2)&&(n.max_participants="Group sessions must have at least 2 participants"),g(n),0===Object.keys(n).length})()){l(!0);try{const e={student_id:s.id,topic:m.topic,description:m.description,session_type:m.session_type,priority:m.priority,preferred_date:m.preferred_date,preferred_time:m.preferred_time,duration_minutes:m.duration_minutes,max_participants:m.max_participants,tags:m.tags||[],specific_mentor_id:m.specific_mentor_id||void 0,is_recurring:m.is_recurring||!1,recurring_pattern:m.recurring_pattern||null,status:"pending",mentor_id:void 0,scheduled_date:void 0,scheduled_time:void 0,completed_at:void 0,feedback_submitted:!1,notes:void 0};await xn.createSessionRequest(e),a(),n()}catch(t){console.error("Error creating session request:",t),g({submit:"Failed to create session request. Please try again."})}finally{l(!1)}}},className:"space-y-6",children:[(0,Pt.jsx)(VI,{}),(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What do you want to work on? *"}),(0,Pt.jsx)("input",{type:"text",value:m.topic,onChange:e=>y("topic",e.target.value),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(f.topic?"border-red-300":"border-gray-300"),placeholder:"Describe what you want to work on"}),u&&(0,Pt.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Current: ",u.topic," (Phase: ",u.phase,")"]}),f.topic&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.topic})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Session Type *"}),(0,Pt.jsx)("div",{className:"grid grid-cols-1 gap-3",children:[{value:"one_on_one",label:"One-on-One / Personal Mentoring",description:"Personal mentoring session"},{value:"code_review",label:"Code/Debug Review",description:"Review and improve existing code"},{value:"project_planning",label:"Project Planning",description:"Plan and architect new projects"}].map(e=>(0,Pt.jsxs)("label",{className:"flex items-center",children:[(0,Pt.jsx)("input",{type:"radio",name:"session_type",value:e.value,checked:m.session_type===e.value,onChange:e=>y("session_type",e.target.value),className:"text-primary-600 focus:ring-primary-500"}),(0,Pt.jsxs)("div",{className:"ml-3",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.label}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]},e.value))}),f.session_type&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.session_type})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,Pt.jsx)("textarea",{value:m.description,onChange:e=>y("description",e.target.value),rows:4,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(f.description?"border-red-300":"border-gray-300"),placeholder:"Describe what you want to work on, what you're struggling with, or what you want to learn..."}),f.description&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.description})]})]}),(0,Pt.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,Pt.jsxs)("button",{type:"button",onClick:()=>d(!c),className:"flex items-center justify-between w-full text-left",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Optional Preferences"}),c?(0,Pt.jsx)(fa,{className:"h-5 w-5 text-gray-500"}):(0,Pt.jsx)(rr,{className:"h-5 w-5 text-gray-500"})]}),c&&(0,Pt.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Priority Level"}),(0,Pt.jsx)("div",{className:"flex space-x-4",children:[{value:"low",label:"Low",color:"text-green-600"},{value:"medium",label:"Medium",color:"text-yellow-600"},{value:"high",label:"High",color:"text-orange-600"},{value:"urgent",label:"Urgent",color:"text-red-600"}].map(e=>(0,Pt.jsxs)("label",{className:"flex items-center",children:[(0,Pt.jsx)("input",{type:"radio",name:"priority",value:e.value,checked:m.priority===e.value,onChange:e=>y("priority",e.target.value),className:"text-primary-600 focus:ring-primary-500"}),(0,Pt.jsx)("span",{className:"ml-2 text-sm font-medium ".concat(e.color),children:e.label})]},e.value))})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Mentor"}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("span",{className:"text-sm text-gray-600",children:"Default: Your assigned mentor"}),(0,Pt.jsx)("button",{type:"button",className:"text-primary-600 hover:text-primary-800 text-sm underline",onClick:()=>{console.log("Open mentor selection")},children:"Change"})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Date & Time"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"We'll check your mentor's availability and suggest the best times"}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Pt.jsx)("div",{children:(0,Pt.jsx)("input",{type:"date",value:m.preferred_date,onChange:e=>y("preferred_date",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})}),(0,Pt.jsx)("div",{children:(0,Pt.jsx)("input",{type:"time",value:m.preferred_time,onChange:e=>y("preferred_time",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500"})})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),(0,Pt.jsx)("input",{type:"number",min:"30",max:"180",step:"15",value:m.duration_minutes,onChange:e=>y("duration_minutes",parseInt(e.target.value)),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(f.duration_minutes?"border-red-300":"border-gray-300")}),f.duration_minutes&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.duration_minutes})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),(0,Pt.jsx)("input",{type:"text",value:null===(t=m.tags)||void 0===t?void 0:t.join(", "),onChange:e=>y("tags",e.target.value.split(",").map(e=>e.trim()).filter(e=>e)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., React, JavaScript, Algorithms (comma-separated)"})]}),(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("input",{type:"checkbox",id:"is_recurring",checked:m.is_recurring,onChange:e=>y("is_recurring",e.target.checked),className:"text-primary-600 focus:ring-primary-500"}),(0,Pt.jsx)("label",{htmlFor:"is_recurring",className:"ml-2 text-sm text-gray-700",children:"Make this a recurring session"})]})]})]}),f.submit&&(0,Pt.jsxs)("div",{className:"flex items-center p-4 bg-red-50 border border-red-200 rounded-md",children:[(0,Pt.jsx)(oa,{className:"h-5 w-5 text-red-400 mr-3"}),(0,Pt.jsx)("p",{className:"text-sm text-red-700",children:f.submit})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,Pt.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),(0,Pt.jsx)("button",{type:"submit",disabled:i,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Creating...":"Create Request"})]})]})]})})})},mR=e=>{let{session:t,onClose:n,onFeedback:a}=e;const{userData:s}=Rt(),[i,o]=(0,r.useState)(null),[l,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{o(null),c(null)}catch(e){console.error("Error loading feedback:",e)}})()},[t.id]);return(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Session Details"}),(0,Pt.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:t.topic}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat((e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(t.status)),children:t.status}),(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat((e=>{switch(e){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(t.priority)),children:t.priority})]})]}),t.description&&(0,Pt.jsx)("p",{className:"text-gray-600 mb-4",children:t.description}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("span",{className:"font-medium text-gray-700",children:"Duration:"}),(0,Pt.jsxs)("span",{className:"ml-2 text-gray-600",children:[t.duration_minutes," minutes"]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("span",{className:"font-medium text-gray-700",children:"Created:"}),(0,Pt.jsx)("span",{className:"ml-2 text-gray-600",children:new Date(t.created_at).toLocaleDateString()})]}),t.scheduled_date&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("span",{className:"font-medium text-gray-700",children:"Scheduled:"}),(0,Pt.jsxs)("span",{className:"ml-2 text-gray-600",children:[new Date(t.scheduled_date).toLocaleDateString(),t.scheduled_time&&" at ".concat(t.scheduled_time)]})]}),t.started_at&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("span",{className:"font-medium text-gray-700",children:"Started:"}),(0,Pt.jsx)("span",{className:"ml-2 text-gray-600",children:new Date(t.started_at).toLocaleString()})]}),t.completed_at&&(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("span",{className:"font-medium text-gray-700",children:"Completed:"}),(0,Pt.jsx)("span",{className:"ml-2 text-gray-600",children:new Date(t.completed_at).toLocaleString()})]})]})]}),(0,Pt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,Pt.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Participants"}),(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(ar,{className:"h-5 w-5 text-blue-500"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:"Mentee"}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600",children:["Student ID: ",t.student_id]})]})]}),t.mentor_id&&(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(ar,{className:"h-5 w-5 text-green-500"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:"Mentor"}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600",children:["Mentor ID: ",t.mentor_id]})]})]})]})]}),t.meeting_link&&(0,Pt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,Pt.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Meeting Link"}),(0,Pt.jsx)("a",{href:t.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:t.meeting_link})]}),(i||l)&&(0,Pt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,Pt.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Feedback"}),i&&(0,Pt.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[(0,Pt.jsx)("h5",{className:"font-medium text-blue-900 mb-2",children:"Mentor Feedback"}),(0,Pt.jsxs)("div",{className:"flex items-center mb-2",children:[[...Array(5)].map((e,t)=>(0,Pt.jsx)(ha,{className:"h-4 w-4 ".concat(t<i.overall_rating?"text-yellow-400 fill-current":"text-gray-300")},t)),(0,Pt.jsxs)("span",{className:"ml-2 text-sm text-blue-700",children:[i.overall_rating,"/5 Overall"]})]}),(0,Pt.jsx)("p",{className:"text-sm text-blue-800",children:i.comments})]}),l&&(0,Pt.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg",children:[(0,Pt.jsx)("h5",{className:"font-medium text-green-900 mb-2",children:"Mentee Feedback"}),(0,Pt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Pt.jsx)(ha,{className:"h-4 w-4 ".concat(l.self_rating>=4?"text-yellow-400 fill-current":"text-gray-300")}),(0,Pt.jsxs)("span",{className:"ml-2 text-sm text-green-700",children:["Self Rating: ",l.self_rating,"/5"]})]}),(0,Pt.jsx)("p",{className:"text-sm text-green-800",children:l.additional_comments})]})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[(()=>{if(!s)return!1;const e=t.mentor_id===s.id,n=t.student_id===s.id;return"completed"===t.status&&(e||n)})()&&!(()=>{if(!s)return!1;const e=t.mentor_id===s.id,n=t.student_id===s.id;return!(!e||!i)||!(!n||!l)})()&&a&&(0,Pt.jsxs)("button",{onClick:a,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[(0,Pt.jsx)(pa,{className:"h-4 w-4 mr-2"}),"Provide Feedback"]}),(0,Pt.jsx)("button",{onClick:n,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Close"})]})]})]})},pR=e=>{let{session:t,onClose:n,onSuccess:a}=e;const{userData:s}=Rt(),[i,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)({}),u=(null===s||void 0===s?void 0:s.id)===t.mentor_id,h=(null===s||void 0===s?void 0:s.id)===t.student_id,[m,p]=(0,r.useState)({engagement_rating:0,creativity_rating:0,problem_solving_rating:0,overall_rating:0,strengths:[],improvement_areas:[],comments:""}),[f,g]=(0,r.useState)({what_learned:"",challenges_faced:"",self_rating:0,additional_comments:""}),y=(e,t)=>{u?p(n=>(0,o.A)((0,o.A)({},n),{},{[e]:t})):g(n=>(0,o.A)((0,o.A)({},n),{},{[e]:t})),c[e]&&d(t=>(0,o.A)((0,o.A)({},t),{},{[e]:""}))},x=(e,t)=>{u?p(n=>(0,o.A)((0,o.A)({},n),{},{[e]:t})):g(n=>(0,o.A)((0,o.A)({},n),{},{[e]:t})),c[e]&&d(t=>(0,o.A)((0,o.A)({},t),{},{[e]:""}))},v=(e,t)=>{p(n=>(0,o.A)((0,o.A)({},n),{},{[e]:t}))},b=e=>{let{value:t,onChange:n,label:r}=e;return(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:r}),(0,Pt.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>(0,Pt.jsx)("button",{type:"button",onClick:()=>n(e),className:"focus:outline-none",children:(0,Pt.jsx)(ha,{className:"h-5 w-5 ".concat(e<=t?"text-yellow-400 fill-current":"text-gray-300")})},e))}),(0,Pt.jsxs)("span",{className:"text-sm text-gray-500",children:["(",t,"/5)"]})]})};return u||h?(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:u?"Mentor Feedback":"Mentee Feedback"}),(0,Pt.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsxs)("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)("h3",{className:"font-medium text-gray-900",children:t.topic}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Session completed on ",t.completed_at?new Date(t.completed_at).toLocaleDateString():"Unknown"]})]}),u?(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsx)(b,{value:m.engagement_rating,onChange:e=>y("engagement_rating",e),label:"Engagement"}),(0,Pt.jsx)(b,{value:m.creativity_rating,onChange:e=>y("creativity_rating",e),label:"Creativity"}),(0,Pt.jsx)(b,{value:m.problem_solving_rating,onChange:e=>y("problem_solving_rating",e),label:"Problem Solving"}),(0,Pt.jsx)(b,{value:m.overall_rating,onChange:e=>y("overall_rating",e),label:"Overall Performance"}),c.overall_rating&&(0,Pt.jsx)("p",{className:"text-sm text-red-600",children:c.overall_rating})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Strengths (Optional)"}),(0,Pt.jsx)("input",{type:"text",value:m.strengths.join(", "),onChange:e=>v("strengths",e.target.value.split(",").map(e=>e.trim()).filter(e=>e)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., Quick learner, Good communication, Creative solutions"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Areas for Improvement (Optional)"}),(0,Pt.jsx)("input",{type:"text",value:m.improvement_areas.join(", "),onChange:e=>v("improvement_areas",e.target.value.split(",").map(e=>e.trim()).filter(e=>e)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., Code organization, Testing practices, Documentation"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comments *"}),(0,Pt.jsx)("textarea",{value:m.comments,onChange:e=>x("comments",e.target.value),rows:4,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(c.comments?"border-red-300":"border-gray-300"),placeholder:"Provide detailed feedback about the session..."}),c.comments&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:c.comments})]})]}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What did you learn? *"}),(0,Pt.jsx)("textarea",{value:f.what_learned,onChange:e=>x("what_learned",e.target.value),rows:3,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 ".concat(c.what_learned?"border-red-300":"border-gray-300"),placeholder:"Describe the key concepts, skills, or insights you gained..."}),c.what_learned&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:c.what_learned})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Challenges Faced (Optional)"}),(0,Pt.jsx)("textarea",{value:f.challenges_faced,onChange:e=>x("challenges_faced",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"What difficulties did you encounter during the session?"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)(b,{value:f.self_rating,onChange:e=>y("self_rating",e),label:"Your Self-Assessment"}),c.self_rating&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:c.self_rating})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Comments (Optional)"}),(0,Pt.jsx)("textarea",{value:f.additional_comments,onChange:e=>x("additional_comments",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Any other feedback about the session or mentor?"})]})]}),c.submit&&(0,Pt.jsxs)("div",{className:"flex items-center p-4 bg-red-50 border border-red-200 rounded-md",children:[(0,Pt.jsx)(oa,{className:"h-5 w-5 text-red-400 mr-3"}),(0,Pt.jsx)("p",{className:"text-sm text-red-700",children:c.submit})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[(0,Pt.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:u?async()=>{if((()=>{const e={};return 0===m.overall_rating&&(e.overall_rating="Overall rating is required"),m.comments.trim()||(e.comments="Comments are required"),d(e),0===Object.keys(e).length})()&&s){l(!0);try{const e={session_id:t.id,mentor_id:s.id,engagement_rating:m.engagement_rating,creativity_rating:m.creativity_rating,problem_solving_rating:m.problem_solving_rating,overall_rating:m.overall_rating,strengths:m.strengths,improvement_areas:m.improvement_areas,comments:m.comments,submitted_at:new Date};await xn.submitMentorFeedback(e),a(),n()}catch(e){console.error("Error submitting mentor feedback:",e),d({submit:"Failed to submit feedback. Please try again."})}finally{l(!1)}}}:async()=>{if((()=>{const e={};return f.what_learned.trim()||(e.what_learned="Please describe what you learned"),0===f.self_rating&&(e.self_rating="Self rating is required"),d(e),0===Object.keys(e).length})()&&s){l(!0);try{const e={session_id:t.id,student_id:s.id,what_learned:f.what_learned,challenges_faced:f.challenges_faced,self_rating:f.self_rating,additional_comments:f.additional_comments,submitted_at:new Date};await xn.submitMenteeFeedback(e),a(),n()}catch(e){console.error("Error submitting mentee feedback:",e),d({submit:"Failed to submit feedback. Please try again."})}finally{l(!1)}}},disabled:i,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Submitting...":"Submit Feedback"})]})]}):(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Feedback"}),(0,Pt.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"You are not authorized to provide feedback for this session."})]})},fR=Un("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),gR=Un("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),yR=e=>{let{onEventClick:t}=e;const[n,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[o,l]=(0,r.useState)(new Date),{userData:c}=Rt();(0,r.useEffect)(()=>{(async()=>{if(null!==c&&void 0!==c&&c.id)try{i(!0);const e=(await xn.getSessionsByUser(c.id)).map(e=>({id:e.id,type:"pair_session",title:"Pair Programming: ".concat(e.topic),description:e.description,start_date:e.scheduled_date||new Date,end_date:e.scheduled_date||new Date,user_id:c.id,session_id:e.id,status:"completed"===e.status?"completed":"cancelled"===e.status?"cancelled":"scheduled",priority:e.priority}));a(e)}catch(e){console.error("Error fetching calendar events:",e)}finally{i(!1)}})()},[null===c||void 0===c?void 0:c.id]);const d=e=>{l(t=>{const n=new Date(t);return"prev"===e?n.setMonth(n.getMonth()-1):n.setMonth(n.getMonth()+1),n})},u=(e=>{const t=e.getFullYear(),n=e.getMonth(),r=new Date(t,n,1),a=new Date(t,n+1,0).getDate(),s=r.getDay(),i=[];for(let o=0;o<s;o++)i.push(null);for(let o=1;o<=a;o++)i.push(new Date(t,n,o));return i})(o),h=e=>{switch(e){case"pair_session":return"bg-blue-100 text-blue-800 border-blue-200";case"leave":return"bg-red-100 text-red-800 border-red-200";case"goal_deadline":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"reflection_deadline":return"bg-purple-100 text-purple-800 border-purple-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},m=e=>{switch(e){case"urgent":return"ring-2 ring-red-400";case"high":return"ring-2 ring-orange-400";case"medium":return"ring-2 ring-yellow-400";case"low":return"ring-2 ring-green-400";default:return""}};return s?(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-center",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,Pt.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading calendar..."})]})}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,Pt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pt.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()]," ",o.getFullYear()]}),(0,Pt.jsx)("button",{onClick:()=>{l(new Date)},className:"text-sm text-primary-600 hover:text-primary-800 font-medium",children:"Today"})]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("button",{onClick:()=>d("prev"),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md",children:(0,Pt.jsx)(fR,{className:"h-5 w-5"})}),(0,Pt.jsx)("button",{onClick:()=>d("next"),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md",children:(0,Pt.jsx)(gR,{className:"h-5 w-5"})})]})]})}),(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,Pt.jsx)("div",{className:"p-2 text-center text-sm font-medium text-gray-500",children:e},e))}),(0,Pt.jsx)("div",{className:"grid grid-cols-7 gap-1",children:u.map((e,r)=>{if(!e)return(0,Pt.jsx)("div",{className:"h-24 bg-gray-50 rounded-md"},r);const a=(e=>n.filter(t=>!!t.start_date&&new Date(t.start_date).toDateString()===e.toDateString()))(e),s=e.toDateString()===(new Date).toDateString(),i=e<new Date&&!s;return(0,Pt.jsxs)("div",{className:"h-24 p-1 border rounded-md ".concat(s?"bg-primary-50 border-primary-200":i?"bg-gray-50 border-gray-200":"bg-white border-gray-200 hover:bg-gray-50"),children:[(0,Pt.jsx)("div",{className:"text-sm font-medium mb-1 ".concat(s?"text-primary-700":i?"text-gray-400":"text-gray-900"),children:e.getDate()}),(0,Pt.jsxs)("div",{className:"space-y-1",children:[a.slice(0,2).map((e,n)=>(0,Pt.jsx)("div",{onClick:()=>{null===t||void 0===t||t(e)},className:"text-xs p-1 rounded border ".concat(h(e.type)," ").concat(m(e.priority)," truncate cursor-pointer hover:opacity-80 transition-opacity"),title:e.title,children:e.title},n)),a.length>2&&(0,Pt.jsxs)("div",{className:"text-xs text-gray-500 text-center",children:["+",a.length-2," more"]})]})]},r)})})]}),(0,Pt.jsxs)("div",{className:"border-t border-gray-200 p-6",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upcoming Events"}),0===n.length?(0,Pt.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No upcoming events"}):(0,Pt.jsx)("div",{className:"space-y-3",children:n.filter(e=>e.start_date&&new Date(e.start_date)>=new Date).sort((e,t)=>new Date(e.start_date).getTime()-new Date(t.start_date).getTime()).slice(0,5).map((e,n)=>(0,Pt.jsxs)("div",{onClick:()=>null===t||void 0===t?void 0:t(e),className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0 w-3 h-3 rounded-full mt-1.5 ".concat("pair_session"===e.type?"bg-blue-500":"leave"===e.type?"bg-red-500":"goal_deadline"===e.type?"bg-yellow-500":"bg-purple-500")}),(0,Pt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,Pt.jsx)(Bn,{className:"h-3 w-3 mr-1"}),e.start_date?new Date(e.start_date).toLocaleDateString():"TBD"]}),e.start_date&&(0,Pt.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,Pt.jsx)(la,{className:"h-3 w-3 mr-1"}),new Date(e.start_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.description&&(0,Pt.jsx)("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:e.description})]}),(0,Pt.jsx)("div",{className:"flex-shrink-0 px-2 py-1 text-xs font-medium rounded-full ".concat("scheduled"===e.status?"bg-green-100 text-green-800":"completed"===e.status?"bg-blue-100 text-blue-800":"cancelled"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.status})]},n))})]})]})},xR=Un("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),vR=Un("medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),bR=()=>{const[e,t]=(0,r.useState)({mentors:[],mentees:[]}),[n,a]=(0,r.useState)(!0),[s,i]=(0,r.useState)("mentors");(0,r.useEffect)(()=>{(async()=>{try{a(!0),t({mentors:[],mentees:[]})}catch(e){console.error("Error fetching leaderboard data:",e)}finally{a(!1)}})()},[]);const o=e=>{switch(e){case 1:return(0,Pt.jsx)(xR,{className:"h-5 w-5 text-yellow-500"});case 2:return(0,Pt.jsx)(vR,{className:"h-5 w-5 text-gray-400"});case 3:return(0,Pt.jsx)($l,{className:"h-5 w-5 text-amber-600"});default:return(0,Pt.jsxs)("span",{className:"text-sm font-medium text-gray-500",children:["#",e]})}},l=e=>{switch(e){case 1:return"bg-yellow-100 text-yellow-800 border-yellow-200";case 2:return"bg-gray-100 text-gray-800 border-gray-200";case 3:return"bg-amber-100 text-amber-800 border-amber-200";default:return"bg-gray-50 text-gray-700 border-gray-200"}},c=(e,t)=>e&&0!==e.length?(0,Pt.jsx)("div",{className:"space-y-4",children:e.map((e,n)=>(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 p-4 rounded-lg border ".concat(e.rank<=3?"bg-gradient-to-r from-white to-gray-50 border-gray-300":"bg-white border-gray-200"),children:[(0,Pt.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full border-2 ".concat(l(e.rank)),children:o(e.rank)}),(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:(0,Pt.jsx)("span",{className:"text-sm font-medium text-primary-700",children:(e.mentor_name||e.mentee_name||"U").charAt(0).toUpperCase()})})}),(0,Pt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Pt.jsx)("h4",{className:"text-sm font-medium text-gray-900 truncate",children:e.mentor_name||e.mentee_name||"Unknown User"}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,Pt.jsx)(er,{className:"h-3 w-3 mr-1"}),e.total_sessions||0," sessions"]}),(0,Pt.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,Pt.jsx)($n,{className:"h-3 w-3 mr-1"}),e.sessions_this_week||0," this week"]}),"mentors"===t&&e.average_rating&&(0,Pt.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,Pt.jsx)(ha,{className:"h-3 w-3 mr-1"}),e.average_rating.toFixed(1)," avg rating"]}),"mentees"===t&&e.average_self_rating&&(0,Pt.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,Pt.jsx)(ha,{className:"h-3 w-3 mr-1"}),e.average_self_rating.toFixed(1)," self rating"]})]})]}),(0,Pt.jsxs)("div",{className:"text-right",children:[(0,Pt.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:[e.rank<=3&&"\ud83c\udfc6 ","mentors"===t?e.mentees_helped||0:e.goals_achieved||0]}),(0,Pt.jsx)("div",{className:"text-xs text-gray-500",children:"mentors"===t?"mentees helped":"goals achieved"})]})]},e.rank||n+1))}):(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(er,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pt.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["No ",t," data available"]}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"Leaderboard data will appear as sessions are completed and rated."})]});return n?(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-center",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,Pt.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading leaderboard..."})]})}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Leaderboard"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Top performers in pair programming sessions"})]}),(0,Pt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pt.jsxs)("nav",{className:"flex space-x-8",children:[(0,Pt.jsx)("button",{onClick:()=>i("mentors"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("mentors"===s?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Top Mentors"}),(0,Pt.jsx)("button",{onClick:()=>i("mentees"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("mentees"===s?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Top Mentees"})]})}),(0,Pt.jsx)("div",{className:"p-6",children:"mentors"===s?c(e.mentors,"mentors"):c(e.mentees,"mentees")}),(0,Pt.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(xR,{className:"h-4 w-4 text-yellow-500 mr-1"}),(0,Pt.jsx)("span",{children:"1st Place"})]}),(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(vR,{className:"h-4 w-4 text-gray-400 mr-1"}),(0,Pt.jsx)("span",{children:"2nd Place"})]}),(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)($l,{className:"h-4 w-4 text-amber-600 mr-1"}),(0,Pt.jsx)("span",{children:"3rd Place"})]})]}),(0,Pt.jsx)("div",{className:"text-xs",children:"Rankings updated daily"})]})})]})},wR=()=>{const{userData:e}=Rt(),[t,n]=(0,r.useState)("overview"),[a,s]=(0,r.useState)(null),[i,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)("mentee"),[d,u]=(0,r.useState)({can_view_all_sessions:!1,can_manage_leaves:!1,can_reassign_sessions:!1,can_view_analytics:!1,can_manage_goals:!1,viewable_users:"self_only"}),[h,m]=(0,r.useState)(!1),[p,f]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[x,v]=(0,r.useState)(null),b=jr(h,()=>m(!1)),w=jr(p,()=>f(!1)),j=jr(g,()=>y(!1));(0,r.useEffect)(()=>{if(!e)return;let t="mentee";e.isSuperMentor?t="super_mentor":e.isMentor?t="mentor":"academic_associate"===e.role?t="academic_associate":"admin"===e.role&&(t="admin"),c(t);const n={can_view_all_sessions:["admin","academic_associate"].includes(t),can_manage_leaves:["admin","mentor","academic_associate"].includes(t),can_reassign_sessions:["admin","academic_associate"].includes(t),can_view_analytics:["admin","academic_associate"].includes(t),can_manage_goals:["admin","academic_associate","mentor"].includes(t),viewable_users:"admin"===t?"all":"mentor"===t?"mentees_only":"self_only"};u(n)},[e]);const N=(0,r.useCallback)(async()=>{if(e)try{o(!0);const t=await xn.getUserStats(e.id,"mentee"===l?"mentee":"mentor");let n=[];n="all"===d.viewable_users?await xn.getPendingSessions():"mentees_only"===d.viewable_users?await xn.getSessionsByUser(e.id,"mentor"):await xn.getSessionsByUser(e.id,"all"),console.log("[DEBUG] All fetched sessions for user",null===e||void 0===e?void 0:e.id,n);const r=new Date;r.setHours(0,0,0,0);const a=["pending","assigned","scheduled","in_progress"],i=n.filter(e=>{if(!e.scheduled_date)return!1;return new Date(e.scheduled_date)>=r&&a.includes(e.status)}).sort((e,t)=>new Date(e.scheduled_date).getTime()-new Date(t.scheduled_date).getTime()),c=n.filter(e=>["completed","cancelled"].includes(e.status)).sort((e,t)=>{const n="completed"===e.status?new Date(e.completed_at||0):new Date(e.cancelled_at||0);return("completed"===t.status?new Date(t.completed_at||0):new Date(t.cancelled_at||0)).getTime()-n.getTime()}),u=i.filter(e=>{if(!e.scheduled_date)return!1;const t=new Date(e.scheduled_date);return t>=r&&t<new Date(r.getTime()+864e5)}),h=n.filter(e=>"pending"===e.status&&!e.mentor_id),m=await vn.getLeavesToday(),p={mentors:[],mentees:[]},f=n.map(e=>({id:e.id,type:"pair_session",title:"Pair Programming: ".concat(e.topic),description:e.description,start_date:e.scheduled_date||new Date,user_id:e.student_id,session_id:e.id,status:"scheduled"===e.status||"in_progress"===e.status?"scheduled":"completed"===e.status?"completed":"cancelled"===e.status?"cancelled":"scheduled",priority:e.priority}));s({user_stats:t,todays_sessions:u,upcoming_sessions:i,pending_requests:h,recent_completed:c,leaderboard:p,calendar_events:f,leaves_today:m})}catch(t){console.error("Error loading dashboard data:",t)}finally{o(!1)}},[e,l,d]);(0,r.useEffect)(()=>{N()},[N]);const _=e=>{switch(e){case"completed":return(0,Pt.jsx)(qn,{className:"h-4 w-4 text-green-500"});case"in_progress":return(0,Pt.jsx)(la,{className:"h-4 w-4 text-blue-500"});case"pending":return(0,Pt.jsx)(Hn,{className:"h-4 w-4 text-yellow-500"});case"cancelled":return(0,Pt.jsx)(oR,{className:"h-4 w-4 text-red-500"});default:return(0,Pt.jsx)(la,{className:"h-4 w-4 text-gray-500"})}},S=e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return i?(0,Pt.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a?(0,Pt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Pt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,Pt.jsx)("div",{className:"mb-8",children:(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"min-w-0",children:[(0,Pt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 truncate",children:"Pair Programming"}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-1",children:"Collaborate, learn, and grow together"})]}),(0,Pt.jsxs)("button",{onClick:()=>m(!0),className:"mt-4 sm:mt-0 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 flex-shrink-0",children:[(0,Pt.jsx)(uR,{className:"h-4 w-4 mr-2"}),"Request Session"]})]})}),(0,Pt.jsx)("div",{className:"mb-8",children:(0,Pt.jsx)("nav",{className:"flex flex-wrap gap-2",children:[{id:"overview",label:"Overview",icon:$n},{id:"sessions",label:"My Sessions",icon:er},{id:"calendar",label:"Calendar",icon:Bn},{id:"leaderboard",label:"Leaderboard",icon:$n}].map(e=>(0,Pt.jsxs)("button",{onClick:()=>n(e.id),className:"w-full sm:w-auto text-center flex items-center justify-center sm:justify-start px-3 py-2 border-b-2 font-medium text-sm ".concat(t===e.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,Pt.jsx)(e.icon,{className:"h-4 w-4 mr-2"}),e.label]},e.id))})}),"overview"===t&&(0,Pt.jsxs)("div",{className:"space-y-8",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(er,{className:"h-8 w-8 text-blue-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Sessions"}),(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:a.user_stats.total_sessions_all_time})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(la,{className:"h-8 w-8 text-green-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"This Week"}),(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:a.user_stats.sessions_this_week})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(Hn,{className:"h-8 w-8 text-yellow-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:a.user_stats.pending_sessions})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0",children:(0,Pt.jsx)(Bn,{className:"h-8 w-8 text-purple-600"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Today"}),(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:a.todays_sessions.length})]})]})})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,Pt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Today's Sessions"})}),(0,Pt.jsx)("div",{className:"p-6",children:0===a.todays_sessions.length?(0,Pt.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No sessions scheduled for today"}):(0,Pt.jsx)("div",{className:"space-y-4",children:a.todays_sessions.map(e=>(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 min-w-0",children:[_(e.status),(0,Pt.jsxs)("div",{className:"min-w-0",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.topic}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 truncate",children:[e.scheduled_time," \u2022 ","mentee"===l?"Mentor":"Mentee",": ",(0,Pt.jsx)("span",{className:"font-mono break-words",children:e.mentor_id||e.student_id})]})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 mt-3 sm:mt-0",children:[(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(S(e.status)),children:e.status}),(0,Pt.jsx)("button",{onClick:()=>{v(e),f(!0)},className:"text-primary-600 hover:text-primary-800 text-sm font-medium flex-shrink-0",children:"View"})]})]},e.id))})})]}),d.can_reassign_sessions&&a.pending_requests.length>0&&(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,Pt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Open Requests"})}),(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)("div",{className:"space-y-4",children:a.pending_requests.map(t=>(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-yellow-500"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:t.topic}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:t.description}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-500",children:["Requested ",new Date(t.created_at).toLocaleDateString()]})]})]}),(0,Pt.jsx)("button",{onClick:()=>(async t=>{if(e)try{await xn.assignMentorToSession(t.id,e.id),await N()}catch(n){console.error("Error taking session:",n)}})(t),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Take Session"})]},t.id))})})]})]}),"sessions"===t&&(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Upcoming Sessions"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Sessions scheduled for future dates"})]}),(0,Pt.jsx)("div",{className:"p-6",children:0===a.upcoming_sessions.length?(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)(Bn,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"No upcoming sessions scheduled"}),(0,Pt.jsxs)("button",{onClick:()=>m(!0),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-primary-700 bg-primary-100 hover:bg-primary-200",children:[(0,Pt.jsx)(uR,{className:"h-4 w-4 mr-2"}),"Request a Session"]})]}):(0,Pt.jsx)("div",{className:"space-y-3",children:a.upcoming_sessions.map(e=>(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-primary-300 hover:shadow-sm transition-all",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[_(e.status),(0,Pt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.topic}),e.description&&(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1 truncate",children:e.description}),(0,Pt.jsxs)("div",{className:"flex flex-wrap items-center space-x-4 mt-2 text-sm text-gray-500",children:[e.scheduled_date&&(0,Pt.jsxs)("span",{className:"flex items-center",children:[(0,Pt.jsx)(Bn,{className:"h-4 w-4 mr-1"}),new Date(e.scheduled_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),e.scheduled_time&&(0,Pt.jsxs)("span",{className:"flex items-center",children:[(0,Pt.jsx)(la,{className:"h-4 w-4 mr-1"}),e.scheduled_time]}),(0,Pt.jsxs)("span",{className:"truncate",children:["mentee"===l?"Mentor":"Mentee",": ",(0,Pt.jsx)("span",{className:"font-mono break-words",children:e.mentor_id||e.student_id})]})]})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-3 mt-3 sm:mt-0",children:[(0,Pt.jsx)("span",{className:"px-3 py-1 text-xs font-medium rounded-full ".concat(S(e.status)),children:e.status}),(0,Pt.jsx)("button",{onClick:()=>{v(e),f(!0)},className:"text-primary-600 hover:text-primary-800 text-sm font-medium px-3 py-1 hover:bg-primary-50 rounded flex-shrink-0",children:"View Details"})]})]},e.id))})})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Past Sessions"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Completed and cancelled sessions"})]}),(0,Pt.jsx)("div",{className:"p-6",children:0===a.recent_completed.length?(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)(qn,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"No past sessions yet"})]}):(0,Pt.jsx)("div",{className:"space-y-3",children:a.recent_completed.map(e=>(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition-all",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[_(e.status),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:e.topic}),e.description&&(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500",children:[e.completed_at&&(0,Pt.jsxs)("span",{className:"flex items-center",children:[(0,Pt.jsx)(qn,{className:"h-4 w-4 mr-1"}),"Completed ",new Date(e.completed_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),e.cancelled_at&&(0,Pt.jsxs)("span",{className:"flex items-center",children:[(0,Pt.jsx)(oR,{className:"h-4 w-4 mr-1"}),"Cancelled ",new Date(e.cancelled_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),(0,Pt.jsxs)("span",{children:["mentee"===l?"Mentor":"Mentee",": ",e.mentor_id||e.student_id]})]}),e.notes&&(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-2 italic",children:['"',e.notes,'"']})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)("span",{className:"px-3 py-1 text-xs font-medium rounded-full ".concat(S(e.status)),children:e.status}),(0,Pt.jsx)("button",{onClick:()=>{v(e),f(!0)},className:"text-gray-600 hover:text-gray-800 text-sm font-medium px-3 py-1 hover:bg-gray-50 rounded",children:"View Details"})]})]},e.id))})})]})]}),"calendar"===t&&(0,Pt.jsx)(yR,{onEventClick:e=>{if(a&&e.session_id){const t=a.upcoming_sessions.find(t=>t.id===e.session_id)||a.todays_sessions.find(t=>t.id===e.session_id)||a.recent_completed.find(t=>t.id===e.session_id);t&&(v(t),f(!0))}}}),"leaderboard"===t&&(0,Pt.jsx)(bR,{})]}),h&&(0,Pt.jsx)("div",{ref:b.modalRef,className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:b.handleOutsideClick,children:(0,Pt.jsx)("div",{ref:b.contentRef,className:"bg-white rounded-lg max-w-md w-full",onClick:b.handleContentClick,children:(0,Pt.jsx)(hR,{onClose:()=>m(!1),onSuccess:N})})}),p&&x&&(0,Pt.jsx)("div",{ref:w.modalRef,className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:w.handleOutsideClick,children:(0,Pt.jsx)("div",{ref:w.contentRef,className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:w.handleContentClick,children:(0,Pt.jsx)(mR,{session:x,onClose:()=>f(!1),onFeedback:()=>{f(!1),y(!0)}})})}),g&&x&&(0,Pt.jsx)("div",{ref:j.modalRef,className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:j.handleOutsideClick,children:(0,Pt.jsx)("div",{ref:j.contentRef,className:"bg-white rounded-lg max-w-2xl w-full",onClick:j.handleContentClick,children:(0,Pt.jsx)(pR,{session:x,onClose:()=>y(!1),onSuccess:N})})})]}):(0,Pt.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Unable to load dashboard"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Please try refreshing the page"})]})})},jR=()=>{const{userData:e}=Rt(),[t,n]=(0,r.useState)([]),[a,s]=(0,r.useState)(!0),[i,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{s(!0);const e=await on.getAllPhases(),t=await fn.getAllPhaseTimelines(),r=new Map(t.map(e=>[e.phaseId,e])),a=e.sort((e,t)=>-1===e.order&&-1===t.order?0:-1===e.order?1:-1===t.order?-1:e.order-t.order),i=a.map(e=>{const t=r.get(e.id);return{name:e.name,expectedDays:(null===t||void 0===t?void 0:t.expectedDays)||null,isStandalone:(null===t||void 0===t?void 0:t.isStandalone)||!1}});n(i)}catch(e){console.error("Error loading phases:",e)}finally{s(!1)}})()},[]);return a?(0,Pt.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,Pt.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading phases..."})]}):(0,Pt.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold",children:"Phase Timeline Management"}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-1",children:"Set expected completion days for each learning phase."})]}),c?(0,Pt.jsxs)("div",{className:"flex space-x-2",children:[(0,Pt.jsx)("button",{onClick:()=>d(!1),disabled:i,className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-gray-700 disabled:opacity-50",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{if(e)try{l(!0);const n=await on.getAllPhases(),r=new Map(n.map(e=>[e.name,e.id])),a=t.map(t=>{const n=r.get(t.name);if(!n)throw new Error("Phase not found: ".concat(t.name));return{phaseId:n,phaseName:t.name,expectedDays:t.expectedDays,isStandalone:t.isStandalone,updatedBy:e.id}});await fn.savePhaseTimelines(a,e.id),alert("Phase timeline saved successfully!")}catch(n){console.error("Error saving phase timeline:",n),alert("Error saving phase timeline. Please try again.")}finally{l(!1)}else alert("User not authenticated")},disabled:i,className:"bg-primary-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-primary-700 disabled:opacity-50",children:i?"Saving...":"Save Changes"})]}):(0,Pt.jsx)("button",{onClick:()=>d(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700",children:"Edit Timeline"})]}),(0,Pt.jsxs)("table",{className:"w-full border rounded-lg mb-6",children:[(0,Pt.jsx)("thead",{children:(0,Pt.jsxs)("tr",{className:"bg-gray-100",children:[(0,Pt.jsx)("th",{className:"py-2 px-4 text-left",children:"Phase Name"}),(0,Pt.jsx)("th",{className:"py-2 px-4 text-left",children:"Expected Days"}),(0,Pt.jsx)("th",{className:"py-2 px-4 text-left",children:"Standalone"})]})}),(0,Pt.jsx)("tbody",{children:t.map((e,t)=>{var r;return(0,Pt.jsxs)("tr",{className:"border-t",children:[(0,Pt.jsx)("td",{className:"py-2 px-4",children:e.name}),(0,Pt.jsx)("td",{className:"py-2 px-4",children:c?(0,Pt.jsx)("input",{type:"number",min:"0",value:null!==(r=e.expectedDays)&&void 0!==r?r:"",disabled:e.isStandalone,onChange:e=>((e,t)=>{const r=""===t?null:Math.max(0,parseInt(t));n(t=>t.map((t,n)=>n===e?(0,o.A)((0,o.A)({},t),{},{expectedDays:r}):t))})(t,e.target.value),className:"border rounded px-2 py-1 w-24"}):(0,Pt.jsx)("span",{className:e.expectedDays?"text-gray-900":"text-gray-400",children:e.expectedDays?"".concat(e.expectedDays," days"):"Not set"})}),(0,Pt.jsx)("td",{className:"py-2 px-4",children:c?(0,Pt.jsx)("input",{type:"checkbox",checked:e.isStandalone,onChange:e=>((e,t)=>{n(n=>n.map((n,r)=>r===e?(0,o.A)((0,o.A)({},n),{},{isStandalone:t,expectedDays:t?null:n.expectedDays}):n))})(t,e.target.checked)}):(0,Pt.jsx)("span",{className:e.isStandalone?"text-green-600":"text-gray-400",children:e.isStandalone?"Yes":"No"})})]},e.name)})})]})]})},NR=[{name:"Rahul Mentor",email:"rahul.mentor@navgurukul.org",role:"mentor",campus:"Dharamshala",house:"Bageshree"},{name:"Priya Mentor",email:"priya.mentor@navgurukul.org",role:"mentor",campus:"Dharamshala",house:"Malhar"}],_R=["Bageshree","Malhar","Bhairav","Yaman","Kafi"],SR=["Amit","Neha","Rohan","Sneha","Vikram","Anjali","Deepak","Pooja","Rahul","Kavita","Arjun","Meera","Sanjay","Divya","Karan","Nisha","Raj","Simran","Varun","Aisha","Aditya","Riya","Sameer","Tanvi","Vivek"].map((e,t)=>({name:"".concat(e," Student"),email:"".concat(e.toLowerCase(),".student@navgurukul.org"),campus:"Dharamshala",house:_R[t%_R.length]})),kR=["Complete React Tutorial Part 1","Solve 5 DSA problems on Arrays","Design the login page UI","Refactor the backend API","Learn about Firestore Security Rules"],ER={workedWell:"I was able to focus for 2 hours straight.",howAchieved:"By turning off notifications and using the Pomodoro technique.",keyLearning:"Understanding how useEffect dependency array works.",challenges:"Struggled with solving the 3rd DSA problem."};class AR{static async seedUsersAndData(){try{console.log("\ud83c\udf31 Starting user and data seeding...");const e=await on.getAllPhases();if(0===e.length)return console.warn("\u26a0\ufe0f No phases found. Please run data seeding first."),!1;const t=e[0],n=await ln.getTopicsByPhase(t.id);if(0===n.length)return console.warn("\u26a0\ufe0f No topics found for the first phase."),!1;const r=[];for(const a of NR){let e=await _t.UserService.getUserByEmail(a.email);if(e)console.log("\u2139\ufe0f Mentor already exists: ".concat(a.name));else{const t=await _t.UserService.createUser({name:a.name,email:a.email,role:a.role,campus:a.campus,house:a.house,created_at:new Date,updated_at:new Date,isMentor:!0,isAdmin:!1});e=await _t.UserService.getUserById(t),console.log("\u2705 Created mentor: ".concat(a.name))}e&&r.push(e)}for(let a=0;a<SR.length;a++){const e=SR[a];let s=await _t.UserService.getUserByEmail(e.email);const i=r[a%r.length];if(s)s.mentor_id||(await _t.UserService.updateUser(s.id,{mentor_id:i.id}),console.log("Updated student ".concat(s.name," with mentor ").concat(i.name))),console.log("\u2139\ufe0f Student already exists: ".concat(e.name));else{const n=await _t.UserService.createUser({name:e.name,email:e.email,campus:e.campus,house:e.house,mentor_id:i.id,current_phase_id:t.id,current_phase_name:t.name,created_at:new Date,updated_at:new Date,isAdmin:!1});s=await _t.UserService.getUserById(n),console.log("\u2705 Created student: ".concat(e.name," (Assigned to: ").concat(i.name,")"))}s&&await this.seedStudentActivity(s,t.id,n,i.id)}return console.log("\u2728 User and data seeding completed successfully!"),!0}catch(e){return console.error("\u274c Error seeding users and data:",e),!1}}static async seedStudentActivity(e,t,n,r){const a=new Date;for(let s=0;s<3;s++){const i=new Date(a);i.setDate(a.getDate()-s);const l=n[Math.floor(Math.random()*n.length)],c=kR[Math.floor(Math.random()*kR.length)],d=new Date(i);d.setHours(9,0,0,0);const u=await cn.createGoal((0,o.A)({student_id:e.id,phase_id:t,topic_id:l.id,goal_text:c,target_percentage:100,status:0===s?"pending":"approved",created_at:d,updated_at:d},s>0?{reviewed_by:r,reviewed_at:new Date(i.setHours(10,0,0,0)),mentor_comment:"Good goal, keep it up!"}:{}));if(await cn.updateGoal(u,{created_at:d}),s>0){const n=new Date(i);n.setHours(18,0,0,0);const a=await dn.createReflection({student_id:e.id,goal_id:u,phase_id:t,topic_id:l.id,reflection_answers:ER,achieved_percentage:80+Math.floor(20*Math.random()),status:"reviewed",mentor_notes:"Good progress.",mentor_assessment:"on_track",reviewed_by:r,reviewed_at:new Date(i.setHours(19,0,0,0)),feedback_given_at:new Date(i.setHours(19,0,0,0))});await dn.updateReflection(a,{created_at:n})}}}}const CR=Un("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),DR=Un("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),TR=Un("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),OR=Un("shield-off",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]),PR=Un("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),IR=Un("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),RR=e=>{let{className:t=""}=e;const{userData:n}=Rt(),[a,s]=(0,r.useState)(null),[i,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)(new Date),[d,u]=(0,r.useState)((null===n||void 0===n?void 0:n.campus)||"all"),[h,m]=(0,r.useState)([]),[p,f]=(0,r.useState)(""),[g,y]=(0,r.useState)(!1),[x,v]=(0,r.useState)(!1),[b,w]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e;return(async()=>{o(!0);try{const t=await Sn.getDailyStats(l,"all"===d?void 0:d);s(t),e=Sn.setupRealtimeAttendanceTracking(l,"all"===d?void 0:d,e=>{s(e)})}catch(t){console.error("Error setting up attendance tracking:",t)}finally{o(!1)}})(),()=>{e&&e()}},[l,d]);const j=(0,r.useCallback)(async()=>{v(!0);try{const e="all"===d?null===n||void 0===n?void 0:n.campus:d,t=await Sn.getMenteesList(e,p);m(t)}catch(e){console.error("Error loading mentees:",e)}finally{v(!1)}},[d,p,null===n||void 0===n?void 0:n.campus]);(0,r.useEffect)(()=>{g&&j()},[g,j]);const N=async e=>{try{w(e||"all"),await kn.triggerManualReport("all"===e?void 0:e),alert("\u2705 Attendance report sent to Discord for ".concat(e||"All Campuses","!"))}catch(t){console.error("Error sending Discord report:",t),alert("\u274c Failed to send report: ".concat(t instanceof Error?t.message:"Unknown error"))}finally{w(null)}};if(i&&!a)return(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow ".concat(t),children:(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsxs)("div",{className:"animate-pulse",children:[(0,Pt.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-6"}),(0,Pt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((e,t)=>(0,Pt.jsx)("div",{className:"h-24 bg-gray-200 rounded"},t))})]})})});const _=a?[{title:"Total Students",value:a.totalActiveStudents,icon:er,color:"bg-blue-100 text-blue-800",subtext:"".concat(a.studentsOnLeave," on leave")},{title:"Goals Approved",value:a.studentsWithApprovedGoals,icon:qn,color:"bg-green-100 text-green-800",percentage:a.goalApprovalRate,subtext:"".concat(a.goalApprovalRate.toFixed(1),"% approval rate")},{title:"Reflections Submitted",value:a.studentsWithSubmittedReflections,icon:IR,color:"bg-purple-100 text-purple-800",percentage:a.reflectionSubmissionRate,subtext:"".concat(a.reflectionSubmissionRate.toFixed(1),"% submission rate")},{title:"Students Present",value:a.studentsPresent,icon:GI,color:"bg-emerald-100 text-emerald-800",percentage:a.attendanceRate,subtext:"".concat(a.attendanceRate.toFixed(1),"% attendance rate")}]:[];return(0,Pt.jsxs)("div",{className:"space-y-6 ".concat(t),children:[(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Pt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,Pt.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[(0,Pt.jsx)(Bn,{className:"mr-2 h-5 w-5"}),"Daily Attendance Tracking"]}),(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("label",{htmlFor:"date-picker",className:"sr-only",children:"Select Date"}),(0,Pt.jsx)("input",{id:"date-picker",type:"date",value:(e=>e.toISOString().split("T")[0])(l),onChange:e=>{c(new Date(e.target.value))},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]}),(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("label",{htmlFor:"campus-filter",className:"sr-only",children:"Select Campus"}),(0,Pt.jsx)("select",{id:"campus-filter",value:d,onChange:e=>{u(e.target.value)},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",children:["all","Dharamshala","Dantewada","Jashpur","Raigarh","Pune","Sarjapur","Kishanganj","Eternal"].map(e=>(0,Pt.jsx)("option",{value:e,children:"all"===e?"All Campuses":e},e))})]})]})]})}),(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:_.map((e,t)=>{const n=e.icon;return(0,Pt.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"rounded-md p-2 ".concat(e.color),children:(0,Pt.jsx)(n,{className:"h-5 w-5"})}),(0,Pt.jsxs)("div",{className:"ml-4 flex-1 min-w-0",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-600 truncate",children:e.title}),(0,Pt.jsxs)("div",{className:"flex items-baseline",children:[(0,Pt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:e.value}),void 0!==e.percentage&&(0,Pt.jsxs)("p",{className:"ml-2 text-sm text-gray-500",children:["(",e.percentage.toFixed(1),"%)"]})]}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mt-1 truncate",children:e.subtext})]})]})},t)})}),a&&(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,Pt.jsx)("span",{children:"Goal Approval Progress"}),(0,Pt.jsxs)("span",{children:[a.goalApprovalRate.toFixed(1),"%"]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(a.goalApprovalRate,100),"%")}})})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,Pt.jsx)("span",{children:"Overall Attendance"}),(0,Pt.jsxs)("span",{children:[a.attendanceRate.toFixed(1),"%"]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"bg-emerald-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(a.attendanceRate,100),"%")}})})]})]}),(0,Pt.jsxs)("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[(0,Pt.jsxs)("h4",{className:"text-sm font-medium text-gray-900 mb-4 flex items-center",children:[(0,Pt.jsx)(aR,{className:"mr-2 h-4 w-4"}),"Send Attendance Report to Discord"]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:[(0,Pt.jsx)("button",{onClick:()=>N(),disabled:null!==b,className:"px-4 py-2 rounded-lg font-medium transition-colors text-sm ".concat("all"===b?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:"all"===b?"Sending...":"All Campuses"}),["Dharamshala","Dantewada","Jashpur","Raigarh","Pune","Sarjapur","Kishanganj","Eternal"].map(e=>(0,Pt.jsx)("button",{onClick:()=>N(e),disabled:null!==b,className:"px-4 py-2 rounded-lg font-medium transition-colors text-sm ".concat(b===e?"bg-gray-400 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700 text-white"),children:b===e?"Sending...":e},e))]}),(0,Pt.jsx)("p",{className:"mt-3 text-xs text-gray-500",children:"\ud83d\udca1 Attendance reports are automatically sent at 10:00 AM daily. Use these buttons to send reports manually."})]})]})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Pt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[(0,Pt.jsx)(er,{className:"mr-2 h-5 w-5"}),"My Mentees (Admin Override)"]}),(0,Pt.jsxs)("button",{onClick:()=>y(!g),className:"px-4 py-2 text-sm font-medium text-primary-700 bg-primary-100 rounded-lg hover:bg-primary-200 transition-colors",children:[g?"Hide":"Show"," Mentees"]})]})}),g&&(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsx)("div",{className:"mb-4",children:(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)($I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search mentees by name or email...",value:p,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})}),x?(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),(0,Pt.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading mentees..."})]}):(0,Pt.jsx)("div",{className:"space-y-4",children:0===h.length?(0,Pt.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No mentees found."}):h.map(e=>{var t,n;return(0,Pt.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pt.jsx)("span",{className:"text-primary-700 font-medium",children:(null===(t=e.student.name)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase())||"S"})}),(0,Pt.jsxs)("div",{className:"ml-4",children:[(0,Pt.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:e.student.name}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:e.student.email}),e.mentor&&(0,Pt.jsxs)("p",{className:"text-xs text-gray-400",children:["Mentor: ",e.mentor.name]})]})]}),(0,Pt.jsxs)("div",{className:"text-right",children:[(0,Pt.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.attendanceRate.toFixed(1),"% Attendance"]}),(0,Pt.jsxs)("div",{className:"text-xs text-gray-500",children:[e.recentGoals.length," goals, ",e.recentReflections.length," reflections"]})]})]})},e.student.id)})})]})]})]})},MR=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!0),[s,i]=(0,r.useState)(""),[l,c]=(0,r.useState)("all"),[d,u]=(0,r.useState)(null),[h,m]=(0,r.useState)(null),[p,f]=(0,r.useState)(null),[g,y]=(0,r.useState)("active"),[x,v]=(0,r.useState)(!1),[b,w]=(0,r.useState)("student"),[j,N]=(0,r.useState)(null),[_,S]=(0,r.useState)(""),[k,E]=(0,r.useState)("");(0,r.useEffect)(()=>{A()},[]);const A=async()=>{try{a(!0);const e=await mn.getAllUsers();t(e)}catch(e){console.error("Error loading users:",e)}finally{a(!1)}},C=e=>{switch(e){case"active":default:return(0,Pt.jsx)(qn,{className:"h-4 w-4 text-green-500"});case"inactive":return(0,Pt.jsx)(oR,{className:"h-4 w-4 text-gray-500"});case"dropout":return(0,Pt.jsx)(CR,{className:"h-4 w-4 text-red-500"});case"placed":return(0,Pt.jsx)($l,{className:"h-4 w-4 text-purple-500"});case"on_leave":return(0,Pt.jsx)(la,{className:"h-4 w-4 text-orange-500"});case"kitchen_leave":return(0,Pt.jsx)(la,{className:"h-4 w-4 text-blue-500"});case"unapproved_leave":return(0,Pt.jsx)(la,{className:"h-4 w-4 text-red-600"})}},D=e=>{switch(e){case"active":default:return"Active";case"inactive":return"Inactive";case"dropout":return"Dropout";case"placed":return"Placed";case"on_leave":return"On Leave";case"kitchen_leave":return"Kitchen Leave";case"unapproved_leave":return"Unapproved Leave"}},T=e=>{switch(e){case"active":default:return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"dropout":return"bg-red-100 text-red-800";case"placed":return"bg-purple-100 text-purple-800";case"on_leave":return"bg-orange-100 text-orange-800";case"kitchen_leave":return"bg-blue-100 text-blue-800";case"unapproved_leave":return"bg-red-100 text-red-900"}},O=e=>{switch(e){case"admin":return(0,Pt.jsx)(DR,{className:"h-3 w-3 mr-1"});case"academic_associate":return(0,Pt.jsx)(KI,{className:"h-3 w-3 mr-1"});case"super_mentor":return(0,Pt.jsx)(TR,{className:"h-3 w-3 mr-1"});case"mentor":return(0,Pt.jsx)(GI,{className:"h-3 w-3 mr-1"});default:return(0,Pt.jsx)(er,{className:"h-3 w-3 mr-1"})}},P=e=>{switch(e){case"admin":return"Admin";case"academic_associate":return"Academic Associate";case"super_mentor":return"Super Mentor";case"mentor":return"Mentor";default:return"Student"}},I=e=>{switch(e){case"admin":return"bg-red-100 text-red-800";case"academic_associate":return"bg-blue-100 text-blue-800";case"super_mentor":return"bg-purple-100 text-purple-800";case"mentor":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},R=e.filter(e=>{var t,n;const r=!s||(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(s.toLowerCase()))||(null===(n=e.email)||void 0===n?void 0:n.toLowerCase().includes(s.toLowerCase())),a="all"===l||"admin"===l&&e.isAdmin||"student"===l&&!e.isAdmin||"no_mentor"===l&&!e.isAdmin&&!e.mentor_id||"inactive"===l&&"inactive"===e.status||"dropout"===l&&"dropout"===e.status||"placed"===l&&"placed"===e.status;return r&&a}),M={total:e.length,admins:e.filter(e=>e.isAdmin).length,students:e.filter(e=>!e.isAdmin).length,withoutMentor:e.filter(e=>!e.isAdmin&&!e.mentor_id).length,active:e.filter(e=>!e.status||"active"===e.status).length,inactive:e.filter(e=>"inactive"===e.status).length,dropout:e.filter(e=>"dropout"===e.status).length,placed:e.filter(e=>"placed"===e.status).length};return n?(0,Pt.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Total Users"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.total})]}),(0,Pt.jsx)(er,{className:"h-8 w-8 text-blue-500"})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Admins"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.admins})]}),(0,Pt.jsx)(nr,{className:"h-8 w-8 text-purple-500"})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Students"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.students})]}),(0,Pt.jsx)(GI,{className:"h-8 w-8 text-green-500"})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"No Mentor"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.withoutMentor})]}),(0,Pt.jsx)(Hn,{className:"h-8 w-8 text-orange-500"})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Active"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.active})]}),(0,Pt.jsx)(qn,{className:"h-8 w-8 text-green-500"})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Placed"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.placed})]}),(0,Pt.jsx)($l,{className:"h-8 w-8 text-purple-500"})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Dropout"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:M.dropout})]}),(0,Pt.jsx)(CR,{className:"h-8 w-8 text-red-500"})]})})]}),(0,Pt.jsx)(RR,{}),_&&(0,Pt.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex",children:[(0,Pt.jsx)(qn,{className:"h-5 w-5 text-green-400"}),(0,Pt.jsx)("div",{className:"ml-3",children:(0,Pt.jsx)("p",{className:"text-sm font-medium text-green-800",children:_})})]})}),k&&(0,Pt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex",children:[(0,Pt.jsx)(oR,{className:"h-5 w-5 text-red-400"}),(0,Pt.jsx)("div",{className:"ml-3",children:(0,Pt.jsx)("p",{className:"text-sm font-medium text-red-800",children:k})})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,Pt.jsx)("div",{className:"flex-1",children:(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)($I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:s,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})}),(0,Pt.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,Pt.jsx)("button",{onClick:()=>c("all"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat("all"===l?"bg-primary-100 text-primary-700 border border-primary-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"All"}),(0,Pt.jsx)("button",{onClick:()=>c("admin"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat("admin"===l?"bg-primary-100 text-primary-700 border border-primary-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Admins"}),(0,Pt.jsx)("button",{onClick:()=>c("student"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat("student"===l?"bg-primary-100 text-primary-700 border border-primary-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Students"}),(0,Pt.jsx)("button",{onClick:()=>c("no_mentor"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat("no_mentor"===l?"bg-primary-100 text-primary-700 border border-primary-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"No Mentor"}),(0,Pt.jsx)("button",{onClick:()=>c("inactive"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat("inactive"===l?"bg-primary-100 text-primary-700 border border-primary-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Inactive"}),(0,Pt.jsx)("button",{onClick:()=>c("dropout"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat("dropout"===l?"bg-primary-100 text-primary-700 border border-primary-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Dropout"}),(0,Pt.jsx)("button",{onClick:()=>c("placed"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat("placed"===l?"bg-primary-100 text-primary-700 border border-primary-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Placed"})]})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,Pt.jsx)("div",{className:"overflow-x-auto",children:(0,Pt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mentor Status"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Pt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===R.length?(0,Pt.jsx)("tr",{children:(0,Pt.jsx)("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"No users found"})}):R.map(n=>{var r,a;return(0,Pt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,Pt.jsx)("span",{className:"text-primary-700 font-medium",children:(null===(r=n.name)||void 0===r||null===(a=r.charAt(0))||void 0===a?void 0:a.toUpperCase())||"U"})}),(0,Pt.jsx)("div",{className:"ml-4",children:(0,Pt.jsx)("div",{className:"text-sm font-medium text-gray-900",children:n.name||"Unknown"})})]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[(0,Pt.jsx)(ir,{className:"h-4 w-4 text-gray-400 mr-2"}),n.email]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsx)("div",{className:"flex items-center",children:(0,Pt.jsxs)("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(I(n.role)),children:[O(n.role),P(n.role)]})})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(T(n.status||"active")),children:[C(n.status||"active"),(0,Pt.jsx)("span",{className:"ml-1",children:D(n.status||"active")})]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.mentor_id?(0,Pt.jsx)("span",{className:"text-green-600",children:"Has Mentor"}):n.isAdmin?(0,Pt.jsx)("span",{className:"text-gray-400",children:"N/A"}):(0,Pt.jsx)("span",{className:"text-orange-600",children:"No Mentor"})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,Pt.jsx)(Bn,{className:"h-4 w-4 text-gray-400 mr-2"}),n.created_at?new Date(n.created_at).toLocaleDateString():"N/A"]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,Pt.jsxs)("div",{className:"flex space-x-2",children:[(0,Pt.jsx)("button",{onClick:()=>(async(n,r)=>{try{u(n),await mn.updateUserAdminStatus(n,!r),t(e.map(e=>e.id===n?(0,o.A)((0,o.A)({},e),{},{isAdmin:!r}):e))}catch(a){console.error("Error updating admin status:",a),alert("Failed to update admin status")}finally{u(null)}})(n.id,n.isAdmin||!1),disabled:d===n.id,className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium transition-colors ".concat(n.isAdmin?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"," ").concat(d===n.id?"opacity-50 cursor-not-allowed":""),title:n.isAdmin?"Remove admin privileges":"Grant admin privileges",children:d===n.id?(0,Pt.jsx)("span",{className:"inline-block animate-spin rounded-full h-3 w-3 border-b-2 border-current"}):n.isAdmin?(0,Pt.jsx)(OR,{className:"h-3 w-3"}):(0,Pt.jsx)(nr,{className:"h-3 w-3"})}),(0,Pt.jsx)("button",{onClick:()=>(e=>{N(e),w(e.role),v(!0)})(n),disabled:d===n.id,className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-700 hover:bg-purple-200 transition-colors disabled:opacity-50",title:"Change Role",children:(0,Pt.jsx)(TR,{className:"h-3 w-3"})}),(0,Pt.jsx)("button",{onClick:()=>f(n.id),disabled:d===n.id,className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors disabled:opacity-50",title:"Change user status",children:C(n.status||"active")}),(0,Pt.jsx)("button",{onClick:()=>m(n.id),disabled:d===n.id,className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-700 hover:bg-red-200 transition-colors disabled:opacity-50",title:"Delete user",children:(0,Pt.jsx)(PR,{className:"h-3 w-3"})})]})})]},n.id)})})]})})}),(0,Pt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-blue-600 mr-2 flex-shrink-0 mt-0.5"}),(0,Pt.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,Pt.jsx)("p",{className:"font-medium mb-1",children:"User Management Tips:"}),(0,Pt.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[(0,Pt.jsx)("li",{children:"Admins have full access to all features including user management and reports"}),(0,Pt.jsx)("li",{children:"Students can access goals, reflections, and mentor dashboards"}),(0,Pt.jsx)("li",{children:'Use the "Mentor Assignment" tab to assign mentors to students'}),(0,Pt.jsx)("li",{children:"Students without mentors won't receive feedback on their reflections"})]})]})]})}),h&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete User"}),(0,Pt.jsx)("button",{onClick:()=>m(null),className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(oR,{className:"h-5 w-5"})})]}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to delete this user? This will set their status to inactive."}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Pt.jsx)("button",{onClick:()=>m(null),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:()=>h&&(async n=>{try{u(n),await mn.deleteUser(n),t(e.map(e=>e.id===n?(0,o.A)((0,o.A)({},e),{},{status:"inactive"}):e)),m(null)}catch(r){console.error("Error deleting user:",r),alert("Failed to delete user")}finally{u(null)}})(h),disabled:null!==d,className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:d?"Deleting...":"Delete User"})]})]})}),p&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Update User Status"}),(0,Pt.jsx)("button",{onClick:()=>f(null),className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(oR,{className:"h-5 w-5"})})]}),(0,Pt.jsxs)("div",{className:"mb-4",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Status"}),(0,Pt.jsxs)("select",{value:g,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[(0,Pt.jsx)("option",{value:"active",children:"Active"}),(0,Pt.jsx)("option",{value:"inactive",children:"Inactive"}),(0,Pt.jsx)("option",{value:"dropout",children:"Dropout"}),(0,Pt.jsx)("option",{value:"placed",children:"Placed"}),(0,Pt.jsx)("option",{value:"on_leave",children:"On Leave"}),(0,Pt.jsx)("option",{value:"kitchen_leave",children:"Kitchen Leave"}),(0,Pt.jsx)("option",{value:"unapproved_leave",children:"Unapproved Leave"})]})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Pt.jsx)("button",{onClick:()=>f(null),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:()=>p&&(async(n,r)=>{try{u(n),await mn.updateUserStatus(n,r),t(e.map(e=>{if(e.id===n){const t=(0,o.A)((0,o.A)({},e),{},{status:r});return t.unapproved_leave_start="unapproved_leave"===r?new Date:void 0,t}return e})),f(null)}catch(a){console.error("Error updating user status:",a),alert("Failed to update user status")}finally{u(null)}})(p,g),disabled:null!==d,className:"px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:d?"Updating...":"Update Status"})]})]})}),x&&j&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Pt.jsx)(TR,{className:"h-6 w-6 text-purple-600 mr-2"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Change User Role"})]}),(0,Pt.jsxs)("div",{className:"mb-4",children:[(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,Pt.jsx)("strong",{children:"User:"})," ",j.name," (",j.email,")"]}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:[(0,Pt.jsx)("strong",{children:"Current Role:"})," ",P(j.role)]}),(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Role"}),(0,Pt.jsxs)("select",{value:b,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,Pt.jsx)("option",{value:"student",children:"Student - Learning access, goal setting, reflections"}),(0,Pt.jsx)("option",{value:"mentor",children:"Mentor - Student mentoring and feedback"}),(0,Pt.jsx)("option",{value:"super_mentor",children:"Super Mentor - Mentor management and advanced mentoring"}),(0,Pt.jsx)("option",{value:"academic_associate",children:"Academic Associate - Admin access without backend management"}),(0,Pt.jsx)("option",{value:"admin",children:"Admin - Full system access, user management, backend operations"})]}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:(e=>{switch(e){case"admin":return"Full system access, user management, backend operations";case"academic_associate":return"Admin access without backend management";case"super_mentor":return"Mentor management and advanced mentoring";case"mentor":return"Student mentoring and feedback";case"student":return"Learning access, goal setting, reflections";default:return"Standard student access"}})(b)})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Pt.jsx)("button",{onClick:()=>{N(null),w("student"),v(!1)},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:()=>j&&(async(n,r)=>{try{u(n),await mn.updateUserRole(n,r),t(e.map(e=>e.id===n?(0,o.A)((0,o.A)({},e),{},{role:r}):e)),v(!1),N(null),w("student"),S("User role updated successfully"),setTimeout(()=>S(""),3e3)}catch(a){console.error("Error updating user role:",a),E("Failed to update user role"),setTimeout(()=>E(""),3e3)}finally{u(null)}})(j.id,b),disabled:null!==d,className:"px-4 py-2 text-white bg-purple-600 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:d?"Updating...":"Update Role"})]})]})})]})},LR=()=>{const{userData:e}=Rt(),[t,n]=(0,r.useState)([]),[a,s]=(0,r.useState)(!0),[i,l]=(0,r.useState)(null),[c,d]=(0,r.useState)({}),[u,h]=(0,r.useState)(""),[m,p]=(0,r.useState)("");(0,r.useEffect)(()=>{f()},[]);const f=async()=>{try{console.log("Loading pending mentor requests..."),s(!0);const e=await pn.getPendingMentorRequests();console.log("Loaded pending requests:",e);const t=e.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime());n(t)}catch(e){console.error("Error loading requests:",e),p("Failed to load mentor change requests")}finally{s(!1)}},g=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return a?(0,Pt.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Pt.jsx)(Fl,{className:"h-8 w-8 text-primary-600 animate-spin"})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Mentor Change Requests"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Review and approve student mentor change requests"})]}),u&&(0,Pt.jsxs)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center space-x-2",children:[(0,Pt.jsx)(qn,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:u})]}),m&&(0,Pt.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg flex items-center space-x-2",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:m})]}),0===t.length?(0,Pt.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)(la,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Pending Requests"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"All mentor change requests have been processed"})]}):(0,Pt.jsx)("div",{className:"space-y-4",children:t.map(t=>(0,Pt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[(0,Pt.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,Pt.jsx)(GI,{className:"h-5 w-5 text-primary-600"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:t.student_name}),(0,Pt.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded",children:"Pending"})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:t.student_email}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-500",children:["Requested on ",g(t.created_at)]})]})}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,Pt.jsx)(er,{className:"h-4 w-4 text-gray-500"}),(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-600",children:"Current Mentor"})]}),t.current_mentor_name?(0,Pt.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:t.current_mentor_name}):(0,Pt.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No mentor assigned"})]}),(0,Pt.jsxs)("div",{className:"bg-primary-50 rounded-lg p-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,Pt.jsx)(GI,{className:"h-4 w-4 text-primary-600"}),(0,Pt.jsx)("p",{className:"text-xs font-medium text-primary-900",children:"Requested Mentor"})]}),(0,Pt.jsx)("p",{className:"text-sm font-semibold text-primary-900",children:t.requested_mentor_name})]})]}),t.reason&&(0,Pt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:(0,Pt.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,Pt.jsx)(pa,{className:"h-4 w-4 text-blue-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-blue-900 mb-1",children:"Student's Reason:"}),(0,Pt.jsx)("p",{className:"text-sm text-blue-800",children:t.reason})]})]})}),(0,Pt.jsxs)("div",{className:"mb-4",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes (optional)"}),(0,Pt.jsx)("textarea",{value:c[t.id]||"",onChange:e=>d((0,o.A)((0,o.A)({},c),{},{[t.id]:e.target.value})),placeholder:"Add notes about this decision...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none text-sm"})]}),(0,Pt.jsxs)("div",{className:"flex items-center justify-end space-x-3",children:[(0,Pt.jsxs)("button",{onClick:()=>(async t=>{if(null!==e&&void 0!==e&&e.id)try{l(t),p(""),h("");const n="admin"===e.role||"super_mentor"===e.role||"academic_associate"===e.role?e.role:"admin";await pn.rejectMentorRequest(t,e.id,n,c[t]),h("Mentor change request rejected"),await f(),setTimeout(()=>h(""),3e3)}catch(n){console.error("Error rejecting request:",n),p(n.message||"Failed to reject mentor change request")}finally{l(null)}})(t.id),disabled:i===t.id,className:"px-4 py-2 border border-red-300 text-red-700 rounded-lg hover:bg-red-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[i===t.id?(0,Pt.jsx)(Fl,{className:"h-4 w-4 animate-spin"}):(0,Pt.jsx)(oR,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Reject"})]}),(0,Pt.jsxs)("button",{onClick:()=>(async t=>{if(null!==e&&void 0!==e&&e.id)try{console.log("Starting approval process for request:",t),l(t),p(""),h("");const n="admin"===e.role||"super_mentor"===e.role||"academic_associate"===e.role?e.role:"admin";console.log("Approving request with data:",{requestId:t,adminId:e.id,role:n,hasNotes:!!c[t]}),await pn.approveMentorRequest(t,e.id,n,c[t]),console.log("Request approved successfully"),h("Mentor change request approved successfully"),await f(),setTimeout(()=>h(""),3e3)}catch(n){console.error("Error approving request:",n),p(n.message||"Failed to approve mentor change request")}finally{l(null)}})(t.id),disabled:i===t.id,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[i===t.id?(0,Pt.jsx)(Fl,{className:"h-4 w-4 animate-spin"}):(0,Pt.jsx)(qn,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Approve"})]})]})]},t.id))}),(0,Pt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-blue-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,Pt.jsx)("p",{className:"font-medium mb-1",children:"Approval Guidelines:"}),(0,Pt.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,Pt.jsx)("li",{children:"Check if the requested mentor has available capacity"}),(0,Pt.jsx)("li",{children:"Consider the student's reason for requesting the change"}),(0,Pt.jsx)("li",{children:"Approving will immediately assign the new mentor"}),(0,Pt.jsx)("li",{children:"Rejecting will clear the pending request status"})]})]})]})})]})},FR=()=>{const[e,t]=(0,r.useState)([]),[a,s]=(0,r.useState)(null),[i,l]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[u,h]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1),[f,g]=(0,r.useState)(""),[y,x]=(0,r.useState)(""),[v,b]=(0,r.useState)("all"),[w,j]=(0,r.useState)(null),[N,_]=(0,r.useState)(!1),[S,k]=(0,r.useState)(0);(0,r.useEffect)(()=>{A(),E()},[]);const E=async()=>{try{const e=await pn.getPendingMentorRequests();k(e.length)}catch(e){console.error("Error loading pending requests:",e),k(0)}},A=async()=>{try{d(!0);const e=await mn.getAllUsers(),n=await on.getAllPhases();console.log("\ud83d\udcca Total users loaded:",e.length);const r=await Promise.all(e.filter(e=>{const t=e.role||"student",n="student"===t||"mentee"===t,r=!e.isAdmin,a=n||r&&!["admin","academic_associate"].includes(t);return a||console.log("\u2298 Filtering out user: ".concat(e.name," (role: ").concat(t,", isAdmin: ").concat(e.isAdmin,")")),a}).map(async e=>{const t=await mn.getStudentCurrentPhase(e.id),r=t?n.find(e=>e.id===t):null;return{id:e.id,name:e.name,email:e.email,mentor_id:e.mentor_id,currentPhaseName:(null===r||void 0===r?void 0:r.name)||"Not Started",currentPhaseOrder:(null===r||void 0===r?void 0:r.order)||0}}));console.log("\u2705 Students loaded for assignment:",r.length),console.log("\ud83d\udcdd Students breakdown:",{withMentor:r.filter(e=>e.mentor_id).length,withoutMentor:r.filter(e=>!e.mentor_id).length}),t(r)}catch(e){console.error("\u274c Error loading students:",e)}finally{d(!1)}},C=e.filter(e=>{const t=f.toLowerCase(),n=(e.name||"").toLowerCase(),r=(e.email||"").toLowerCase(),a=""===f||n.includes(t)||r.includes(t);let s=!0;return"with_mentor"===v&&(s=!!e.mentor_id),"without_mentor"===v&&(s=!e.mentor_id),a&&s}),D={total:e.length,withMentor:e.filter(e=>e.mentor_id).length,withoutMentor:e.filter(e=>!e.mentor_id).length},T=y.toLowerCase(),O=i.filter(e=>{const t=(e.name||"").toLowerCase(),n=(e.email||"").toLowerCase(),r=(e.currentPhaseName||"").toLowerCase();return(""===y||(t.includes(T)||n.includes(T)||r.includes(T)))&&(!w||e.house===w)}),P=0===O.length;return c?(0,Pt.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Total Students"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:D.total})]}),(0,Pt.jsx)(er,{className:"h-8 w-8 text-blue-500"})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"With Mentor"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:D.withMentor})]}),(0,Pt.jsx)(qn,{className:"h-8 w-8 text-green-500"})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Need Mentor"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:D.withoutMentor})]}),(0,Pt.jsx)(Hn,{className:"h-8 w-8 text-orange-500"})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>_(!0),children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Mentor Requests"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:S})]}),(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)(WI,{className:"h-8 w-8 text-purple-500"}),S>0&&(0,Pt.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:S>9?"9+":S})]})]})})]}),N&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Mentor Change Requests"}),(0,Pt.jsx)("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsx)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:(0,Pt.jsx)(LR,{})})]})}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Pt.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Student"}),(0,Pt.jsxs)("button",{onClick:async()=>{console.log("\ud83d\udd04 Refreshing user cache...");const{queryCache:e}=await Promise.resolve().then(n.bind(n,9390));e.invalidate("all-users"),await A(),await E(),console.log("\u2705 Cache refreshed and data reloaded")},className:"flex items-center space-x-2 px-3 py-2 text-sm bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",title:"Refresh user list and clear cache",children:[(0,Pt.jsx)($n,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Refresh"})]})]}),(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)($I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search students...",value:f,onChange:e=>g(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),(0,Pt.jsxs)("div",{className:"flex gap-2",children:[(0,Pt.jsx)("button",{onClick:()=>b("all"),className:"flex-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ".concat("all"===v?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"All"}),(0,Pt.jsx)("button",{onClick:()=>b("without_mentor"),className:"flex-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ".concat("without_mentor"===v?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"No Mentor"}),(0,Pt.jsx)("button",{onClick:()=>b("with_mentor"),className:"flex-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ".concat("with_mentor"===v?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Has Mentor"})]})]})]}),(0,Pt.jsx)("div",{className:"divide-y divide-gray-200 max-h-[600px] overflow-y-auto",children:0===C.length?(0,Pt.jsx)("div",{className:"p-8 text-center text-gray-500",children:"No students found"}):C.map(e=>(0,Pt.jsx)("div",{onClick:()=>(async e=>{s(e),h(!0);try{const t=await mn.getSuggestedMentors(e.id);l(t)}catch(t){console.error("Error loading suggested mentors:",t)}finally{h(!1)}})(e),className:"p-4 cursor-pointer transition-colors ".concat((null===a||void 0===a?void 0:a.id)===e.id?"bg-primary-50 border-l-4 border-primary-600":"hover:bg-gray-50"),children:(0,Pt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),!e.mentor_id&&(0,Pt.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800",children:"No Mentor"})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:e.email}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,Pt.jsx)($n,{className:"h-4 w-4 text-gray-400"}),(0,Pt.jsx)("span",{className:"text-sm text-gray-600",children:e.currentPhaseName})]})]}),(0,Pt.jsx)(QI,{className:"h-5 w-5 text-gray-400 flex-shrink-0 ml-2"})]})},e.id))})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Pt.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a?"Suggested Mentors for ".concat(a.name):"Select a student to see suggested mentors"}),a&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Student is currently in: ",(0,Pt.jsx)("span",{className:"font-medium",children:a.currentPhaseName})]}),(0,Pt.jsxs)("div",{className:"space-y-3 mt-3",children:[(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)($I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search mentors...",value:y,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),(0,Pt.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,Pt.jsx)("button",{onClick:()=>j(null),className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ".concat(null===w?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-100"),children:"All Houses"}),["Bageshree","Malhar","Bhairav"].map(e=>(0,Pt.jsx)("button",{onClick:()=>j(e),className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ".concat(w===e?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-100"),children:e},e))]})]})]})]}),(0,Pt.jsx)("div",{className:"divide-y divide-gray-200 max-h-[600px] overflow-y-auto",children:a?u?(0,Pt.jsx)("div",{className:"p-8 flex items-center justify-center",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):P?(0,Pt.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,Pt.jsx)(Hn,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),(0,Pt.jsx)("p",{children:y?"No mentors found matching your search":"No mentors available for this student"})]}):O.map(n=>(0,Pt.jsx)("div",{className:"p-4 hover:bg-gray-50",children:(0,Pt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)("h4",{className:"font-medium text-gray-900",children:n.name}),n.currentPhaseOrder>(a.currentPhaseOrder||0)&&(0,Pt.jsx)("span",{title:"Advanced student",children:(0,Pt.jsx)($l,{className:"h-4 w-4 text-yellow-500"})})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:n.email}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,Pt.jsx)($n,{className:"h-4 w-4 text-green-500"}),(0,Pt.jsx)("span",{className:"text-sm font-medium text-green-600",children:n.currentPhaseName}),n.currentPhaseOrder>(a.currentPhaseOrder||0)&&(0,Pt.jsxs)("span",{className:"text-xs text-gray-500",children:["(",n.currentPhaseOrder-(a.currentPhaseOrder||0)," phase",n.currentPhaseOrder-(a.currentPhaseOrder||0)>1?"s":""," ahead)"]})]})]}),(0,Pt.jsx)("button",{onClick:()=>(async n=>{if(a)try{p(!0),await mn.assignMentor(a.id,n),t(e.map(e=>e.id===a.id?(0,o.A)((0,o.A)({},e),{},{mentor_id:n}):e)),s((0,o.A)((0,o.A)({},a),{},{mentor_id:n})),alert("Mentor assigned successfully!")}catch(r){console.error("Error assigning mentor:",r),alert("Failed to assign mentor")}finally{p(!1)}})(n.id),disabled:m||a.mentor_id===n.id,className:"ml-4 px-4 py-2 rounded-lg font-medium transition-colors flex-shrink-0 ".concat(a.mentor_id===n.id?"bg-green-100 text-green-700 cursor-default":"bg-primary-600 text-white hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed"),children:m?(0,Pt.jsx)("span",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):a.mentor_id===n.id?(0,Pt.jsxs)("span",{className:"flex items-center",children:[(0,Pt.jsx)(GI,{className:"h-4 w-4 mr-1"}),"Assigned"]}):"Assign"})]})},n.id)):(0,Pt.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,Pt.jsx)(er,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),(0,Pt.jsx)("p",{children:"Select a student from the list to see mentor suggestions"})]})})]})]}),(0,Pt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-blue-600 mr-2 flex-shrink-0 mt-0.5"}),(0,Pt.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,Pt.jsx)("p",{className:"font-medium mb-1",children:"Mentor Assignment Logic:"}),(0,Pt.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[(0,Pt.jsx)("li",{children:"Mentors are suggested based on their current learning phase"}),(0,Pt.jsx)("li",{children:"Students in the same or higher phases are shown as potential mentors"}),(0,Pt.jsx)("li",{children:"More advanced students (higher phases) are listed first"}),(0,Pt.jsxs)("li",{children:["Students with ",(0,Pt.jsx)($l,{className:"h-3 w-3 inline text-yellow-500"})," are ahead in their learning journey"]}),(0,Pt.jsx)("li",{children:"Mentors will review goals and provide feedback to their assigned students"})]})]})]})})]})},UR=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(""),[s,i]=(0,r.useState)(!0),[o,l]=(0,r.useState)(null);(0,r.useEffect)(()=>{try{console.log("Loading curriculum admin panel..."),i(!0),l(null);const e=Bl.initialPhases.map(e=>({name:e.name,order:e.order,isSenior:e.isSenior||!1,topics:(Bl.detailedTopics[e.name]||[]).map(e=>({name:e.name,order:e.order,deliverable:e.deliverable,description:e.description||"",isEdited:!1})),isEdited:!1}));e.sort((e,t)=>(e.isSenior?1:0)!==(t.isSenior?1:0)?(e.isSenior?1:0)-(t.isSenior?1:0):e.order-t.order),console.log("Loaded phases:",e.length),t(e),i(!1),console.log("Curriculum admin panel loaded successfully")}catch(e){console.error("Error loading phases:",e),l("Failed to load curriculum phases. See console for details."),i(!1)}},[]);const c=(n,r,a)=>{const s=[...e];"name"===r&&"string"===typeof a?s[n].name=a:"order"===r&&"number"===typeof a?s[n].order=a:"topics"===r&&Array.isArray(a)&&(s[n].topics=a),s[n].isEdited=!0,t(s)},d=(n,r,a,s)=>{const i=[...e],o=i[n].topics[r];o&&("name"===a&&"string"===typeof s?o.name=s:"order"===a&&"number"===typeof s?o.order=s:"deliverable"===a&&"string"===typeof s?o.deliverable=s:"description"===a&&"string"===typeof s&&(o.description=s),o.isEdited=!0,i[n].isEdited=!0,t(i))};return(0,Pt.jsxs)("div",{className:"p-6 bg-white rounded shadow",children:[(0,Pt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Curriculum Admin Panel"}),s?(0,Pt.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mb-4"}),(0,Pt.jsx)("span",{className:"text-gray-600",children:"Loading curriculum phases..."})]}):o?(0,Pt.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:[(0,Pt.jsx)("strong",{className:"font-bold",children:"Error:"}),(0,Pt.jsxs)("span",{className:"block sm:inline",children:[" ",o]})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("button",{className:"mb-4 px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>{t([...e,{name:"",order:e.length+1,isSenior:!1,topics:[],isEdited:!0}])},children:"Add Phase"}),(0,Pt.jsx)("button",{className:"mb-4 ml-2 px-4 py-2 bg-green-600 text-white rounded",onClick:()=>{let t="Phase,Phase Order,IsSenior,Topic,Topic Order,Deliverable,Description\n";e.forEach(e=>{e.topics.forEach(n=>{t+="".concat(e.name,",").concat(e.order,",").concat(e.isSenior?"true":"false",",").concat(n.name,",").concat(n.order,",").concat(n.deliverable,",").concat(n.description,"\n")})}),a(t);const n=new Blob([t],{type:"text/csv"}),r=window.URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download="curriculum.csv",s.click(),window.URL.revokeObjectURL(r)},children:"Export to CSV"}),(0,Pt.jsx)("input",{type:"file",accept:".csv",className:"mb-4 ml-2",onChange:n=>{var r;const a=null===(r=n.target.files)||void 0===r?void 0:r[0];if(!a)return;const s=new FileReader;s.onload=n=>{var r;const a=(null===(r=n.target)||void 0===r?void 0:r.result).split("\n").slice(1),s=[...e];a.forEach(e=>{if(!e.trim())return;const t=e.split(",");let n=t[0]||"",r=t[1]?Number(t[1]):s.length+1,a=!1,i="",o=0,l="",c="";t.length>=7?(a="true"===(t[2]||"").toLowerCase(),i=t[3]||"",o=t[4]?Number(t[4]):1,l=t[5]||"",c=t[6]||""):(n=t[0]||"",r=t[1]?Number(t[1]):s.length+1,i=t[2]||"",o=t[3]?Number(t[3]):1,l=t[4]||"",c=t[5]||"");let d=s.find(e=>e.name===n);d||(d={name:n,order:Number(r),topics:[],isEdited:!1,isSenior:a},s.push(d)),d.topics.find(e=>e.name===i)||d.topics.push({name:i,order:Number(o),deliverable:l,description:c,isEdited:!1})}),s.sort((e,t)=>(e.isSenior?1:0)!==(t.isSenior?1:0)?(e.isSenior?1:0)-(t.isSenior?1:0):e.order-t.order),t(s)},s.readAsText(a)}}),(0,Pt.jsx)("div",{className:"overflow-x-auto",children:(0,Pt.jsxs)("table",{className:"min-w-full border",children:[(0,Pt.jsx)("thead",{children:(0,Pt.jsxs)("tr",{className:"bg-gray-100",children:[(0,Pt.jsx)("th",{className:"border px-2 py-1",children:"Phase"}),(0,Pt.jsx)("th",{className:"border px-2 py-1",children:"Order"}),(0,Pt.jsx)("th",{className:"border px-2 py-1",children:"Topics"}),(0,Pt.jsx)("th",{className:"border px-2 py-1",children:"Actions"})]})}),(0,Pt.jsx)("tbody",{children:e.map((n,r)=>(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("td",{className:"border px-2 py-1",children:(0,Pt.jsx)("input",{value:n.name,onChange:e=>c(r,"name",e.target.value),className:"w-32 border rounded px-1"})}),(0,Pt.jsx)("td",{className:"border px-2 py-1",children:(0,Pt.jsx)("input",{type:"number",value:n.order,onChange:e=>c(r,"order",Number(e.target.value)),className:"w-16 border rounded px-1"})}),(0,Pt.jsx)("td",{className:"border px-2 py-1",children:(0,Pt.jsxs)("table",{className:"border",children:[(0,Pt.jsx)("thead",{children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"border px-1",children:"Topic"}),(0,Pt.jsx)("th",{className:"border px-1",children:"Order"}),(0,Pt.jsx)("th",{className:"border px-1",children:"Deliverable"}),(0,Pt.jsx)("th",{className:"border px-1",children:"Description"}),(0,Pt.jsx)("th",{className:"border px-1",children:"Actions"})]})}),(0,Pt.jsxs)("tbody",{children:[n.topics.map((e,t)=>(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("td",{className:"border px-1",children:(0,Pt.jsx)("input",{value:e.name,onChange:e=>d(r,t,"name",e.target.value),className:"w-24 border rounded px-1"})}),(0,Pt.jsx)("td",{className:"border px-1",children:(0,Pt.jsx)("input",{type:"number",value:e.order,onChange:e=>d(r,t,"order",Number(e.target.value)),className:"w-12 border rounded px-1"})}),(0,Pt.jsx)("td",{className:"border px-1",children:(0,Pt.jsx)("input",{value:e.deliverable,onChange:e=>d(r,t,"deliverable",e.target.value),className:"w-24 border rounded px-1"})}),(0,Pt.jsx)("td",{className:"border px-1",children:(0,Pt.jsx)("input",{value:e.description,onChange:e=>d(r,t,"description",e.target.value),className:"w-32 border rounded px-1"})}),(0,Pt.jsx)("td",{className:"border px-1"})]},t)),(0,Pt.jsx)("tr",{children:(0,Pt.jsx)("td",{colSpan:5,className:"border px-1 text-center",children:(0,Pt.jsx)("button",{className:"px-2 py-1 bg-blue-500 text-white rounded",onClick:()=>(n=>{const r=[...e];r[n].topics.push({name:"",order:r[n].topics.length+1,deliverable:"",description:"",isEdited:!0}),r[n].isEdited=!0,t(r)})(r),children:"Add Topic"})})})]})]})}),(0,Pt.jsx)("td",{className:"border px-2 py-1"})]},r))})]})}),n&&(0,Pt.jsxs)("div",{className:"mt-4",children:[(0,Pt.jsx)("h3",{className:"font-bold",children:"CSV Preview:"}),(0,Pt.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs max-h-40 overflow-auto",children:n})]})]})]})},BR=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!0),[s,i]=(0,r.useState)(""),[o,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(""),[u,h]=(0,r.useState)("");(0,r.useEffect)(()=>{m()},[]);const m=async()=>{try{a(!0);const e=await _t.UserService.getAll("users");t(e)}catch(e){console.error("Error loading users:",e),h("Failed to load users")}finally{a(!1)}},p=async(e,t)=>{try{h(""),d(""),await _t.UserService.updateUser(e,{isSuperMentor:!t,isMentor:!t,max_mentees:t?2:void 0}),d("Super mentor status ".concat(t?"disabled":"enabled"," successfully")),await m(),setTimeout(()=>d(""),3e3)}catch(n){console.error("Error updating super mentor status:",n),h("Failed to update super mentor status")}},f=async(e,t)=>{try{h(""),d(""),await _t.UserService.updateUser(e,{max_mentees:t||void 0}),d("Mentee limit updated successfully"),await m(),setTimeout(()=>d(""),3e3)}catch(n){console.error("Error updating max mentees:",n),h("Failed to update mentee limit")}},g=e.filter(e=>{const t=(e.name||"").toString().toLowerCase(),n=(e.email||"").toString().toLowerCase(),r=s.toLowerCase();return t.includes(r)||n.includes(r)}).filter(e=>!o||e.isMentor),y=g.filter(e=>e.isSuperMentor),x=g.filter(e=>!e.isSuperMentor);return n?(0,Pt.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Super Mentor Management"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Manage mentors who can have unlimited mentees"})]}),c&&(0,Pt.jsxs)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center space-x-2",children:[(0,Pt.jsx)(qn,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:c})]}),u&&(0,Pt.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg flex items-center space-x-2",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5"}),(0,Pt.jsx)("span",{children:u})]}),(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)($I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search users by name or email...",value:s,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("input",{type:"checkbox",id:"mentorsOnly",checked:o,onChange:e=>l(e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,Pt.jsx)("label",{htmlFor:"mentorsOnly",className:"text-sm text-gray-700",children:"Show mentors only"})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,Pt.jsx)(ha,{className:"h-5 w-5 text-yellow-500"}),(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Super Mentors (",y.length,")"]})]}),0===y.length?(0,Pt.jsx)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:(0,Pt.jsx)("p",{className:"text-gray-600",children:"No super mentors assigned yet"})}):(0,Pt.jsx)("div",{className:"space-y-3",children:y.map(e=>(0,Pt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)(ha,{className:"h-4 w-4 text-yellow-500"}),(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:e.name})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:e.email})]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pt.jsxs)("div",{className:"text-right",children:[(0,Pt.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Max Mentees"}),(0,Pt.jsx)("input",{type:"number",min:"0",placeholder:"Unlimited",value:e.max_mentees||"",onChange:t=>{const n=parseInt(t.target.value);!isNaN(n)&&n>=0&&f(e.id,n)},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,Pt.jsx)("button",{onClick:()=>p(e.id,!0),className:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"Remove Status"})]})]})},e.id))})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["All Users (",x.length,")"]}),0===x.length?(0,Pt.jsx)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:(0,Pt.jsx)("p",{className:"text-gray-600",children:"No users found"})}):(0,Pt.jsx)("div",{className:"space-y-3",children:x.map(e=>(0,Pt.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),e.isMentor&&(0,Pt.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded",children:"Mentor"})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Mentee limit: ",e.max_mentees||2]})]}),(0,Pt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Pt.jsxs)("div",{className:"text-right",children:[(0,Pt.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Max Mentees"}),(0,Pt.jsx)("input",{type:"number",min:"0",value:e.max_mentees||2,onChange:t=>{const n=parseInt(t.target.value);!isNaN(n)&&n>=0&&f(e.id,n)},className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,Pt.jsxs)("button",{onClick:()=>p(e.id,!1),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors text-sm font-medium flex items-center space-x-2",children:[(0,Pt.jsx)(ha,{className:"h-4 w-4"}),(0,Pt.jsx)("span",{children:"Make Super Mentor"})]})]})]})},e.id))})]}),(0,Pt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-blue-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,Pt.jsx)("p",{className:"font-medium mb-1",children:"About Super Mentors:"}),(0,Pt.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,Pt.jsx)("li",{children:"Super mentors can have unlimited mentees by default"}),(0,Pt.jsx)("li",{children:"You can override the max mentees limit for any mentor"}),(0,Pt.jsx)("li",{children:"Regular mentors have a default limit of 2 mentees"}),(0,Pt.jsx)("li",{children:"Setting a specific number overrides the default limits"})]})]})]})})]})},zR=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!0),[s,i]=(0,r.useState)("");(0,r.useEffect)(()=>{l()},[]);const l=async()=>{a(!0),i("");try{const e=await lr.getAllReports();t(e)}catch(e){console.error("Error loading reports:",e),i("Failed to load reports. Please try again.")}finally{a(!1)}},c=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Bug/Feature Reports"}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-2 sm:mt-0",children:[e.length," total report",1!==e.length?"s":""]})]}),s&&(0,Pt.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:s}),n?(0,Pt.jsxs)("div",{className:"bg-white rounded-lg border p-8 text-center",children:[(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-2"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Loading reports..."})]}):0===e.length?(0,Pt.jsxs)("div",{className:"bg-white rounded-lg border p-8 text-center",children:[(0,Pt.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\ud83d\udcdd"}),(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No reports yet"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"User feedback and bug reports will appear here"})]}):(0,Pt.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg border shadow-sm",children:(0,Pt.jsxs)("table",{className:"min-w-full",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,Pt.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,Pt.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell",children:"Console Logs"}),(0,Pt.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell",children:"Submitted At"}),(0,Pt.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Pt.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),(0,Pt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(n=>(0,Pt.jsxs)("tr",{className:n.reviewed?"bg-green-50":"hover:bg-gray-50",children:[(0,Pt.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:n.userName||"Anonymous"}),(0,Pt.jsx)("td",{className:"px-3 py-4 text-sm text-gray-900 max-w-xs truncate",children:n.description}),(0,Pt.jsx)("td",{className:"px-3 py-4 text-sm text-gray-500 hidden sm:table-cell max-w-xs truncate",children:n.consoleLogs||"-"}),(0,Pt.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-500 hidden md:table-cell",children:c(n.submittedAt)}),(0,Pt.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,Pt.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(n.reviewed?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:n.reviewed?"Reviewed":"Pending"})}),(0,Pt.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm",children:!n.reviewed&&n.id&&(0,Pt.jsx)("button",{onClick:()=>(async n=>{try{await lr.markAsReviewed(n),t(e.map(e=>e.id===n?(0,o.A)((0,o.A)({},e),{},{reviewed:!0}):e))}catch(r){console.error("Error marking as reviewed:",r),i("Failed to update report status.")}})(n.id),className:"px-3 py-1 bg-primary-600 text-white rounded-md hover:bg-primary-700 text-xs font-medium transition-colors",children:"Mark Reviewed"})})]},n.id))})]})})]})},qR=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(0),[o,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)([]),[m,p]=(0,r.useState)(null),[f,g]=(0,r.useState)(null),[y,x]=(0,r.useState)(null),v=(0,r.useCallback)(async()=>{try{d(!0),await zl.recalculatePhaseCounts(),window.location.reload()}catch(e){console.error("Error recalculating counts:",e),alert("Failed to recalculate counts. Check console for details.")}finally{d(!1)}},[]),b=(0,r.useCallback)(async()=>{try{const[e,t]=await Promise.all([cn.getAllGoals(),_t.UserService.getAll(_t.I.USERS)]),n=t.filter(e=>!e.isAdmin),r=new Set(n.map(e=>e.id)),a=new Map(n.map(e=>[e.id,e.name||"Unknown Student"])),s=e.filter(e=>r.has(e.student_id)),i=new Map;s.forEach(e=>{const t=n.find(t=>t.id===e.student_id),r=e.created_at?new Date(e.created_at):null,a=t&&t.campus_joining_date?new Date(t.campus_joining_date):new Date,s=r||a;i.has(e.student_id)||i.set(e.student_id,new Map);const o=i.get(e.student_id);if(o.has(e.phase_id)){s<o.get(e.phase_id)&&o.set(e.phase_id,s)}else o.set(e.phase_id,s)});const o=[];return s.forEach(e=>{var t,r;const s=n.find(t=>t.id===e.student_id),l=e.created_at?new Date(e.created_at):null,c=s&&s.campus_joining_date?new Date(s.campus_joining_date):new Date,d=l||c,u=(null===(t=i.get(e.student_id))||void 0===t?void 0:t.get(e.phase_id))||d,h=new Date,m=new Date(u);m.setHours(0,0,0,0);const p=new Date(h);p.setHours(0,0,0,0);const f=Math.floor((p.getTime()-m.getTime())/864e5),g=Math.max(1,f);null!==(r=a.get(e.student_id))&&void 0!==r&&r.includes("experimental")&&console.log("Debug - experimental user goal:",{studentName:a.get(e.student_id),goalId:e.id,goalCreatedAt:l?l.toISOString():"null",phaseStartDate:u.toISOString(),now:h.toISOString(),daysSpent:g,phaseId:e.phase_id,topicId:e.topic_id}),o.push({studentId:e.student_id,studentName:a.get(e.student_id)||"Unknown Student",phaseId:e.phase_id,topicId:e.topic_id,daysSpent:g,earliestGoalDate:u})}),o}catch(e){return console.error("Error calculating student stats:",e),[]}},[]),w=(0,r.useCallback)(async()=>{try{l(!0);const[e,n,r]=await Promise.all([b(),on.getAllPhases(),ln.getAll(_t.I.TOPICS)]),s=new Set(e.map(e=>e.studentId));i(s.size);const o=new Map;e.forEach(e=>{o.has(e.phaseId)||o.set(e.phaseId,[]),o.get(e.phaseId).push(e)});const c=new Map;r.forEach(e=>{c.has(e.phase_id)||c.set(e.phase_id,[]),c.get(e.phase_id).push(e)});const d=n.sort((e,t)=>e.order-t.order),u=d.filter(e=>e.order<9),m=d.filter(e=>e.order>=9),p=[];u.forEach(e=>{const t=o.get(e.id)||[],n=c.get(e.id)||[],r=new Set(t.map(e=>e.studentId)),a=t.reduce((e,t)=>e+t.daysSpent,0),s=t.length>0?Math.round(a/t.length):0,i=[];n.forEach(e=>{const n=t.filter(t=>t.topicId===e.id),r=new Set(n.map(e=>e.studentId)),a=n.reduce((e,t)=>e+t.daysSpent,0),s=n.length>0?Math.round(a/n.length):0;i.push({topicId:e.id,topicName:e.name,studentCount:r.size,averageDaysSpent:s})}),p.push({phaseId:e.id,phaseName:e.name,totalStudents:r.size,averageDaysSpent:s,topics:i,order:e.order,activeStudentsCount:e.active_students_count||0,completedStudentsCount:e.completed_students_count||0})});const f=[];m.forEach(e=>{const t=o.get(e.id)||[],n=c.get(e.id)||[],r=new Set(t.map(e=>e.studentId)),a=t.reduce((e,t)=>e+t.daysSpent,0),s=t.length>0?Math.round(a/t.length):0,i=[];n.forEach(e=>{const n=t.filter(t=>t.topicId===e.id),r=new Set(n.map(e=>e.studentId)),a=n.reduce((e,t)=>e+t.daysSpent,0),s=n.length>0?Math.round(a/n.length):0;i.push({topicId:e.id,topicName:e.name,studentCount:r.size,averageDaysSpent:s})}),f.push({phaseId:e.id,phaseName:e.name,totalStudents:r.size,averageDaysSpent:s,topics:i,order:e.order,activeStudentsCount:e.active_students_count||0,completedStudentsCount:e.completed_students_count||0})}),t(p),a(f),h(e)}catch(e){console.error("Error loading tracking data:",e)}finally{l(!1)}},[b]),j=(0,r.useCallback)(async(e,t,n)=>{const r=u.filter(t=>t.topicId===e),a=(await _t.UserService.getAll(_t.I.USERS)).filter(e=>!e.isAdmin),s=new Map(a.map(e=>[e.id,e])),i=new Map;r.forEach(e=>{const t=i.get(e.studentId),n=s.get(e.studentId),r=e.earliestGoalDate?new Date(e.earliestGoalDate):null!==n&&void 0!==n&&n.campus_joining_date?new Date(n.campus_joining_date):new Date;t?(t.totalDays=Math.max(t.totalDays,e.daysSpent),t.goalCount+=1,e.earliestGoalDate>t.latestActivity&&(t.latestActivity=e.earliestGoalDate),r<t.startDate&&(t.startDate=r)):i.set(e.studentId,{studentName:e.studentName,totalDays:e.daysSpent,goalCount:1,latestActivity:e.earliestGoalDate,startDate:r})});const o=Array.from(i.values()).sort((e,t)=>t.totalDays-e.totalDays);p({topicId:e,topicName:t,students:o}),p({topicId:e,topicName:t,students:o})},[u]),N=(0,r.useCallback)(async(e,t,n)=>{try{const r=(await cn.getGoalsByTopicAndStudent(n,e)).map(e=>({id:e.id,goal_text:e.goal_text||"No goal text",created_at:e.created_at,status:e.status||"pending"}));g({studentName:t,goals:r})}catch(r){console.error("Error fetching student goals:",r)}},[]),_=(0,r.useCallback)(async(e,t)=>{try{const n=await on.getAllPhases(),r=new Map(n.map(e=>[e.id,{name:e.name,order:e.order}])),a=u.filter(t=>t.studentId===e),s=new Map;a.forEach(e=>{const t=r.get(e.phaseId);if(t)if(s.has(e.phaseId)){const t=s.get(e.phaseId);t.daysSpent=Math.max(t.daysSpent,e.daysSpent),t.topicCount+=1}else s.set(e.phaseId,{daysSpent:e.daysSpent,topicCount:1,order:t.order})});const i=Array.from(s.entries()).map(e=>{var t;let[n,a]=e;return{phaseId:n,phaseName:(null===(t=r.get(n))||void 0===t?void 0:t.name)||"Unknown Phase",daysSpent:a.daysSpent,topicCount:a.topicCount,order:a.order}}).sort((e,t)=>e.order>=9&&t.order<9?1:t.order>=9&&e.order<9?-1:e.order-t.order);x({studentId:e,studentName:t,phases:i})}catch(n){console.error("Error fetching student phase data:",n)}},[u]);return(0,r.useEffect)(()=>{w()},[w]),o?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"text-lg",children:"Loading journey tracking data..."})}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold",children:"Student Journey Tracking"}),(0,Pt.jsx)("p",{className:"text-muted-foreground",children:"Track student progress across curriculum phases and topics"})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Pt.jsxs)("button",{onClick:v,disabled:c,className:"inline-flex items-center px-4 py-2 rounded-md text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 mr-2 ".concat(c?"animate-spin":"")}),c?"Recalculating...":"Recalculate Counts"]}),(0,Pt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800",children:[(0,Pt.jsx)(er,{className:"h-4 w-4 mr-2"}),s," Active Students"]})]})]}),(0,Pt.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>{const t=s>0?Math.round(e.totalStudents/s*100):0;return(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 flex flex-col",children:[(0,Pt.jsxs)("div",{className:"p-6 pb-3",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,Pt.jsx)(Yn,{className:"h-5 w-5 text-blue-600"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.phaseName})]}),(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Active students in phase"}),(0,Pt.jsxs)("span",{className:"font-medium text-gray-900",children:[t,"% of active students"]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(t,"%")}})})]})]}),(0,Pt.jsxs)("div",{className:"flex-1 p-6 pt-0 space-y-4",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,Pt.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[(0,Pt.jsx)("div",{className:"text-xs text-green-600 font-medium mb-1",children:"Active"}),(0,Pt.jsx)("div",{className:"text-2xl font-bold text-green-700",children:e.activeStudentsCount||0}),(0,Pt.jsx)("div",{className:"text-xs text-green-600",children:"Currently working"})]}),(0,Pt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,Pt.jsx)("div",{className:"text-xs text-blue-600 font-medium mb-1",children:"Completed"}),(0,Pt.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:e.completedStudentsCount||0}),(0,Pt.jsx)("div",{className:"text-xs text-blue-600",children:"Moved to next phase"})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,Pt.jsx)(la,{className:"h-4 w-4 text-gray-500"}),(0,Pt.jsx)("span",{className:"text-gray-600",children:"Average days spent:"}),(0,Pt.jsxs)("span",{className:"font-medium text-gray-900",children:[e.averageDaysSpent," days"]})]}),(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("h4",{className:"text-sm font-medium flex items-center gap-2 text-gray-900",children:[(0,Pt.jsx)(ma,{className:"h-4 w-4"}),"Topics"]}),(0,Pt.jsx)("div",{className:"grid gap-2",children:e.topics.map(t=>(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md text-sm border border-gray-100 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>j(t.topicId,t.topicName,e.phaseId),children:[(0,Pt.jsx)("span",{className:"text-gray-900 font-medium break-words pr-2",children:t.topicName}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 flex-shrink-0",children:[(0,Pt.jsxs)("span",{children:[t.studentCount," students"]}),(0,Pt.jsx)("span",{children:"\u2022"}),(0,Pt.jsxs)("span",{children:[t.averageDaysSpent,"d avg"]})]})]},t.topicId))})]})]})]},e.phaseId)})}),n.length>0&&(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsx)("div",{className:"h-px bg-gray-300 flex-1"}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 bg-white px-4",children:"Self Learning Space"}),(0,Pt.jsx)("div",{className:"h-px bg-gray-300 flex-1"})]}),(0,Pt.jsx)("p",{className:"text-muted-foreground text-center",children:"Standalone learning areas for personal development and career preparation"}),(0,Pt.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:n.map(e=>{const t=s>0?Math.round(e.totalStudents/s*100):0;return(0,Pt.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg shadow-md border border-purple-200 flex flex-col",children:[(0,Pt.jsxs)("div",{className:"p-6 pb-3",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,Pt.jsx)("div",{className:"h-5 w-5 rounded-full bg-purple-600 flex items-center justify-center",children:(0,Pt.jsx)("span",{className:"text-white text-xs font-bold",children:"S"})}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.phaseName})]}),(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Pt.jsx)("span",{className:"text-gray-600",children:"Students engaged"}),(0,Pt.jsxs)("span",{className:"font-medium text-gray-900",children:[t,"% of active students"]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(t,"%")}})})]})]}),(0,Pt.jsxs)("div",{className:"flex-1 p-6 pt-0 space-y-4",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,Pt.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[(0,Pt.jsx)("div",{className:"text-xs text-green-600 font-medium mb-1",children:"Active"}),(0,Pt.jsx)("div",{className:"text-2xl font-bold text-green-700",children:e.activeStudentsCount||0}),(0,Pt.jsx)("div",{className:"text-xs text-green-600",children:"Currently working"})]}),(0,Pt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,Pt.jsx)("div",{className:"text-xs text-blue-600 font-medium mb-1",children:"Completed"}),(0,Pt.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:e.completedStudentsCount||0}),(0,Pt.jsx)("div",{className:"text-xs text-blue-600",children:"Moved to next phase"})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,Pt.jsx)(la,{className:"h-4 w-4 text-gray-500"}),(0,Pt.jsx)("span",{className:"text-gray-600",children:"Average days spent:"}),(0,Pt.jsxs)("span",{className:"font-medium text-gray-900",children:[e.averageDaysSpent," days"]})]}),(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("h4",{className:"text-sm font-medium flex items-center gap-2 text-gray-900",children:[(0,Pt.jsx)(ma,{className:"h-4 w-4"}),"Learning Areas"]}),(0,Pt.jsx)("div",{className:"grid gap-2",children:e.topics.map(t=>(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-md text-sm border border-gray-100 cursor-pointer hover:bg-purple-50 transition-colors",onClick:()=>j(t.topicId,t.topicName,e.phaseId),children:[(0,Pt.jsx)("span",{className:"text-gray-900 font-medium break-words pr-2",children:t.topicName}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 flex-shrink-0",children:[(0,Pt.jsxs)("span",{children:[t.studentCount," students"]}),(0,Pt.jsx)("span",{children:"\u2022"}),(0,Pt.jsxs)("span",{children:[t.averageDaysSpent,"d avg"]})]})]},t.topicId))})]})]})]},e.phaseId)})})]}),0===e.length&&(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(Yn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,Pt.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No journey data available"}),(0,Pt.jsx)("p",{className:"text-muted-foreground",children:"Student goals and progress will appear here once they start their learning journey."})]})]}),m&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-hidden",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(ma,{className:"h-6 w-6 text-blue-600"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:m.topicName}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Student Progress Details"})]})]}),(0,Pt.jsx)("button",{onClick:()=>p(null),className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[(0,Pt.jsx)("div",{className:"mb-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,Pt.jsxs)("span",{children:["Total Students: ",m.students.length]}),(0,Pt.jsxs)("span",{children:["Average Days: ",m.students.length>0?Math.round(m.students.reduce((e,t)=>e+t.totalDays,0)/m.students.length):0," days"]})]})}),(0,Pt.jsx)("div",{className:"space-y-2",children:m.students.sort((e,t)=>t.totalDays-e.totalDays).map(e=>(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md border border-gray-100",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsx)("span",{className:"text-gray-900 font-medium cursor-pointer hover:text-blue-600 hover:underline transition-colors",onClick:t=>{t.stopPropagation();const n=u.find(t=>t.studentName===e.studentName);n&&_(n.studentId,e.studentName)},title:"Click to see phase breakdown",children:e.studentName}),(0,Pt.jsxs)("span",{className:"text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded cursor-pointer hover:bg-gray-300 transition-colors",onClick:t=>{t.stopPropagation();const n=u.find(t=>t.studentName===e.studentName&&t.topicId===m.topicId);n&&N(n.studentId,e.studentName,m.topicId)},children:[e.goalCount," goal",1!==e.goalCount?"s":""]})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Pt.jsx)("div",{className:"text-xs text-gray-500",children:(0,Pt.jsxs)("div",{children:["Started: ",e.startDate.toLocaleDateString()]})}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)(la,{className:"h-4 w-4 text-gray-500"}),(0,Pt.jsxs)("span",{className:"text-sm text-gray-600",children:[e.totalDays," days"]})]})]})]},e.studentName))}),0===m.students.length&&(0,Pt.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No students have started this topic yet."})]}),(0,Pt.jsx)("div",{className:"flex justify-end p-6 border-t bg-gray-50",children:(0,Pt.jsx)("button",{onClick:()=>p(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Close"})})]})}),y&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[80vh] overflow-hidden",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)(Yn,{className:"h-6 w-6 text-blue-600"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:y.studentName}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Days Spent in Each Phase"})]})]}),(0,Pt.jsx)("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[(0,Pt.jsx)("div",{className:"mb-4",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,Pt.jsxs)("span",{children:["Total Phases: ",y.phases.length]}),(0,Pt.jsxs)("span",{children:["Total Days: ",y.phases.reduce((e,t)=>e+t.daysSpent,0)," days"]})]})}),(0,Pt.jsx)("div",{className:"space-y-3",children:y.phases.map(e=>(0,Pt.jsxs)("div",{className:"p-4 rounded-lg border ".concat(e.order>=9?"bg-gradient-to-r from-purple-50 to-indigo-50 border-purple-200":"bg-gray-50 border-gray-200"),children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[e.order>=9?(0,Pt.jsx)("div",{className:"h-8 w-8 rounded-full bg-purple-600 flex items-center justify-center flex-shrink-0",children:(0,Pt.jsx)("span",{className:"text-white text-sm font-bold",children:"S"})}):(0,Pt.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0",children:(0,Pt.jsx)("span",{className:"text-white text-sm font-bold",children:e.order+1})}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:e.phaseName}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-500",children:[e.topicCount," topic",1!==e.topicCount?"s":"",e.order>=9&&" \u2022 Self Learning"]})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 bg-white px-4 py-2 rounded-full border border-gray-200",children:[(0,Pt.jsx)(la,{className:"h-5 w-5 text-blue-600"}),(0,Pt.jsx)("span",{className:"text-lg font-bold text-gray-900",children:e.daysSpent}),(0,Pt.jsx)("span",{className:"text-sm text-gray-600",children:"days"})]})]}),(0,Pt.jsx)("div",{className:"mt-3 bg-white rounded-md p-2",children:(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(e.order>=9?"bg-purple-600":"bg-blue-600"),style:{width:"".concat(Math.min(100,e.daysSpent/Math.max(...y.phases.map(e=>e.daysSpent))*100),"%")}})})})]},e.phaseId))}),0===y.phases.length&&(0,Pt.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No phase data available for this student."})]}),(0,Pt.jsx)("div",{className:"flex justify-end p-6 border-t bg-gray-50",children:(0,Pt.jsx)("button",{onClick:()=>x(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Close"})})]})}),f&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,Pt.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Goals for ",f.studentName]}),(0,Pt.jsx)("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[(0,Pt.jsx)("div",{className:"space-y-4",children:f.goals.map(e=>(0,Pt.jsx)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-100",children:(0,Pt.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("p",{className:"text-gray-900 font-medium mb-1",children:e.goal_text}),(0,Pt.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,Pt.jsxs)("span",{children:["Created: ",e.created_at.toLocaleDateString()]}),(0,Pt.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("approved"===e.status?"bg-green-100 text-green-800":"reviewed"===e.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:e.status})]})]})})},e.id))}),0===f.goals.length&&(0,Pt.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No goals found for this student."})]}),(0,Pt.jsx)("div",{className:"flex justify-end p-6 border-t bg-gray-50",children:(0,Pt.jsx)("button",{onClick:()=>g(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Close"})})]})})]})},VR=Un("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),HR=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!0),[s,i]=(0,r.useState)(null),[l,c]=(0,r.useState)({});(0,r.useEffect)(()=>{d()},[]);const d=async()=>{try{a(!0);const e=await _t.B.getAll(_t.I.MENTEE_REVIEW_CATEGORIES);t(e.sort((e,t)=>e.order-t.order))}catch(e){console.error("Error loading review categories:",e)}finally{a(!1)}},u=()=>{i(null),c({})},h=async()=>{if(s&&l.name)try{await _t.B.update(_t.I.MENTEE_REVIEW_CATEGORIES,s,(0,o.A)((0,o.A)({},l),{},{updated_at:new Date})),await d(),u()}catch(e){console.error("Error saving category:",e),alert("Failed to save category")}},m=async()=>{const e=[{name:"morning_exercise",label:"Morning Exercise",minLabel:"Needs to come regularly for morning exercise",midLabel:"Sometimes present in morning exercise",maxLabel:"Actively participate in morning exercise",order:1},{name:"communication",label:"Communication",minLabel:"Poor communication skills",midLabel:"Basic communication",maxLabel:"Excellent communicator",order:2},{name:"academic_effort",label:"Academic Effort",minLabel:"Minimal academic effort",midLabel:"Moderate effort",maxLabel:"Exceptional dedication",order:3},{name:"campus_contribution",label:"Campus Contribution",minLabel:"No campus involvement",midLabel:"Occasional participation",maxLabel:"Active campus leader",order:4},{name:"behavioural",label:"Behavioural",minLabel:"Disruptive behavior",midLabel:"Neutral behavior",maxLabel:"Exemplary conduct",order:5}];try{for(const t of e)await _t.B.create(_t.I.MENTEE_REVIEW_CATEGORIES,(0,o.A)((0,o.A)({},t),{},{created_at:new Date,updated_at:new Date}));await d()}catch(t){console.error("Error initializing categories:",t),alert("Failed to initialize categories")}};return n?(0,Pt.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Mentee Review Categories"}),0===e.length&&(0,Pt.jsx)("button",{onClick:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Initialize Default Categories"})]}),(0,Pt.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,Pt.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:s===e.id?(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name"}),(0,Pt.jsx)("input",{type:"text",value:l.name||"",onChange:e=>c(t=>(0,o.A)((0,o.A)({},t),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Label"}),(0,Pt.jsx)("input",{type:"text",value:l.label||"",onChange:e=>c(t=>(0,o.A)((0,o.A)({},t),{},{label:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"-2 Label (Needs Improvement)"}),(0,Pt.jsx)("input",{type:"text",value:l.minLabel||"",onChange:e=>c(t=>(0,o.A)((0,o.A)({},t),{},{minLabel:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"0 Label (Neutral)"}),(0,Pt.jsx)("input",{type:"text",value:l.midLabel||"",onChange:e=>c(t=>(0,o.A)((0,o.A)({},t),{},{midLabel:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"2 Label (Excellent)"}),(0,Pt.jsx)("input",{type:"text",value:l.maxLabel||"",onChange:e=>c(t=>(0,o.A)((0,o.A)({},t),{},{maxLabel:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Pt.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Pt.jsxs)("button",{onClick:u,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,Pt.jsx)(zn,{className:"h-4 w-4 mr-2 inline"}),"Cancel"]}),(0,Pt.jsxs)("button",{onClick:h,className:"px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:[(0,Pt.jsx)(VR,{className:"h-4 w-4 mr-2 inline"}),"Save"]})]})]}):(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:e.label}),(0,Pt.jsx)("button",{onClick:()=>(e=>{i(e.id),c((0,o.A)({},e))})(e),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Edit category",children:(0,Pt.jsx)(ql,{className:"h-4 w-4"})})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,Pt.jsxs)("div",{className:"bg-red-50 p-3 rounded-lg",children:[(0,Pt.jsx)("div",{className:"font-medium text-red-800 mb-1",children:"-2: Needs Improvement"}),(0,Pt.jsx)("div",{className:"text-red-600",children:e.minLabel})]}),(0,Pt.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[(0,Pt.jsx)("div",{className:"font-medium text-yellow-800 mb-1",children:"0: Neutral"}),(0,Pt.jsx)("div",{className:"text-yellow-600",children:e.midLabel})]}),(0,Pt.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,Pt.jsx)("div",{className:"font-medium text-green-800 mb-1",children:"2: Excellent"}),(0,Pt.jsx)("div",{className:"text-green-600",children:e.maxLabel})]})]})]})},e.id))}),0===e.length&&(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)("p",{className:"text-gray-500 mb-4",children:"No review categories configured yet."}),(0,Pt.jsx)("button",{onClick:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Initialize Default Categories"})]})]})},WR=Un("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]),GR=Un("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),KR=e=>{let{campus:t,onSave:n,onClose:a,editMode:s=!1}=e;const[i,o]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),[d,u]=(0,r.useState)([]),[h,m]=(0,r.useState)(""),[p,f]=(0,r.useState)(""),[g,y]=(0,r.useState)(""),[x,v]=(0,r.useState)(new Set),[b,w]=(0,r.useState)(!0),[j,N]=(0,r.useState)(!1),[_,S]=(0,r.useState)(null),[k,E]=(0,r.useState)(!1);(0,r.useEffect)(()=>{A()},[t]),(0,r.useEffect)(()=>{C()},[p,g,l]);const A=async()=>{try{w(!0),S(null);const e=(await _t.UserService.getAll("users")).filter(e=>e.campus===t),n=e.filter(e=>"academic_associate"===e.role),r=e.filter(e=>"academic_associate"!==e.role);o(n),c(r),u(r),console.log("\u2705 [AAAssignmentForm] Loaded ".concat(n.length," AAs and ").concat(r.length," students"))}catch(e){console.error("Error loading data:",e),S("Failed to load academic associates and students")}finally{w(!1)}},C=()=>{let e=[...l];p&&(e=e.filter(e=>e.house===p||e.house===p.replace("house_",""))),g&&(e=e.filter(e=>e.current_phase_name===g)),u(e)};return b?(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,Pt.jsx)(Fl,{className:"w-8 h-8 animate-spin text-blue-600"}),(0,Pt.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading..."})]})})}):(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,Pt.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,Pt.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:[s?"Edit":"Create"," Academic Associate Assignment"]}),(0,Pt.jsx)("button",{onClick:a,disabled:j,className:"text-gray-400 hover:text-gray-600",children:(0,Pt.jsx)(zn,{className:"h-6 w-6"})})]}),(0,Pt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),S(null),h)if(0!==x.size)try{N(!0);const e=Array.from(x);await n(h,e),E(!0),setTimeout(()=>{a()},1500)}catch(t){console.error("Error saving assignment:",t),S(t instanceof Error?t.message:"Failed to save assignment")}finally{N(!1)}else S("Please select at least one student");else S("Please select an Academic Associate")},className:"p-6 space-y-6",children:[k&&(0,Pt.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,Pt.jsx)(qn,{className:"w-5 h-5 text-green-600"}),(0,Pt.jsx)("p",{className:"text-green-700",children:"Assignment saved successfully!"})]}),_&&(0,Pt.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,Pt.jsx)(Hn,{className:"w-5 h-5 text-red-600"}),(0,Pt.jsx)("p",{className:"text-red-700",children:_})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Associate *"}),(0,Pt.jsxs)("select",{value:h,onChange:e=>m(e.target.value),disabled:j,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",children:[(0,Pt.jsx)("option",{value:"",children:"Select an Academic Associate..."}),i.map(e=>(0,Pt.jsxs)("option",{value:e.id,children:[e.name," (",e.email,")"]},e.id))]}),0===i.length&&(0,Pt.jsx)("p",{className:"mt-1 text-sm text-yellow-600",children:"No Academic Associates found in this campus"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Filter Students (Optional)"}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"House"}),(0,Pt.jsxs)("select",{value:p,onChange:e=>f(e.target.value),disabled:j,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",children:[(0,Pt.jsx)("option",{value:"",children:"All Houses"}),["house_A","house_B","house_C","house_D"].map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Phase"}),(0,Pt.jsxs)("select",{value:g,onChange:e=>y(e.target.value),disabled:j,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",children:[(0,Pt.jsx)("option",{value:"",children:"All Phases"}),["phase_1","phase_2","phase_3","phase_4","phase_5"].map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]})]})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Pt.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Select Students * (",x.size," selected)"]}),(0,Pt.jsx)("button",{type:"button",onClick:()=>{x.size===d.length?v(new Set):v(new Set(d.map(e=>e.id)))},disabled:j,className:"text-xs text-blue-600 hover:text-blue-700 font-medium disabled:text-gray-400",children:x.size===d.length?"Deselect All":"Select All"})]}),0===d.length?(0,Pt.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg text-center",children:(0,Pt.jsx)("p",{className:"text-gray-500 text-sm",children:"No students found matching the selected filters"})}):(0,Pt.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 max-h-60 overflow-y-auto space-y-2",children:d.map(e=>(0,Pt.jsxs)("label",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[(0,Pt.jsx)("input",{type:"checkbox",checked:x.has(e.id),onChange:()=>(e=>{const t=new Set(x);t.has(e)?t.delete(e):t.add(e),v(t)})(e.id),disabled:j,className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500 disabled:opacity-50"}),(0,Pt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.email})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.house&&(0,Pt.jsx)("span",{children:e.house}),e.current_phase_name&&(0,Pt.jsx)("span",{children:"\u2022"}),e.current_phase_name&&(0,Pt.jsx)("span",{children:e.current_phase_name})]})]},e.id))})]}),(0,Pt.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[(0,Pt.jsx)("button",{type:"button",onClick:a,disabled:j,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 disabled:bg-gray-100 transition-colors",children:"Cancel"}),(0,Pt.jsx)("button",{type:"submit",disabled:j||k,className:"flex-1 px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-colors",children:j?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Fl,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):"Save Assignment"})]})]})]})})},QR=e=>{let{academicAssociateId:t,refreshInterval:n=5e3}=e;const[a,s]=(0,r.useState)([]),[i,o]=(0,r.useState)(null),[l,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(null),h=(0,r.useCallback)(async()=>{if(!t)return s([]),o(null),void c(!1);try{u(null);const[e,n]=await Promise.all([an.getQueueForAA(t),an.getQueueStats(t)]),r=e.map(e=>({id:e.id,student_id:e.student_id,position:e.position,status:e.status,added_at:e.added_at,started_at:e.started_at,completed_at:e.completed_at,priority:e.priority}));s(r),o(n)}catch(e){console.error("Error loading queue:",e),u("Failed to load queue. Please try again."),s([]),o(null)}finally{c(!1)}},[t]);(0,r.useEffect)(()=>{h()},[h]),(0,r.useEffect)(()=>{if(n<=0||!t)return;const e=setInterval(h,n);return()=>clearInterval(e)},[n,t,h]);const m=e=>{if(!e.added_at)return"N/A";const t=new Date,n=new Date(e.added_at),r=t.getTime()-n.getTime(),a=Math.floor(r/6e4);if(a<1)return"< 1 min";if(a<60)return"".concat(a," min");const s=Math.floor(a/60),i=a%60;return"".concat(s,"h ").concat(i,"m")},p=e=>{if("in_progress"!==e.status||!e.started_at)return"N/A";const t=new Date,n=new Date(e.started_at),r=t.getTime()-n.getTime(),a=Math.floor(r/6e4);if(a<1)return"< 1 min";if(a<60)return"".concat(a," min");const s=Math.floor(a/60),i=a%60;return"".concat(s,"h ").concat(i,"m")};if(l)return(0,Pt.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg border border-gray-200",children:[(0,Pt.jsx)(Fl,{className:"w-8 h-8 text-blue-600 animate-spin mb-2"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Loading queue..."})]});if(d)return(0,Pt.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,Pt.jsx)("p",{className:"text-red-800 font-medium",children:d}),(0,Pt.jsx)("button",{onClick:h,className:"mt-2 px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]});if(!t)return(0,Pt.jsxs)("div",{className:"p-8 bg-gray-50 rounded-lg border border-gray-200 text-center",children:[(0,Pt.jsx)(er,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Select an Academic Associate to view their queue"})]});if(0===a.length)return(0,Pt.jsxs)("div",{className:"p-8 bg-gray-50 rounded-lg border border-gray-200 text-center",children:[(0,Pt.jsx)(la,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"No sessions in queue"})]});const f=a.find(e=>"in_progress"===e.status),g=a.filter(e=>"waiting"===e.status).length,y=null!==i&&void 0!==i&&i.avg_wait_time_minutes?"".concat(Math.round(i.avg_wait_time_minutes)," min"):"N/A";return(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,Pt.jsxs)("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:[(0,Pt.jsx)("p",{className:"text-xs text-blue-600 font-medium",children:"In Progress"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:f?1:0})]}),(0,Pt.jsxs)("div",{className:"bg-yellow-50 p-3 rounded border border-yellow-200",children:[(0,Pt.jsx)("p",{className:"text-xs text-yellow-600 font-medium",children:"Waiting"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:g})]}),(0,Pt.jsxs)("div",{className:"bg-green-50 p-3 rounded border border-green-200",children:[(0,Pt.jsx)("p",{className:"text-xs text-green-600 font-medium",children:"Completed"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-green-900",children:a.filter(e=>"completed"===e.status).length})]}),(0,Pt.jsxs)("div",{className:"bg-purple-50 p-3 rounded border border-purple-200",children:[(0,Pt.jsx)("p",{className:"text-xs text-purple-600 font-medium",children:"Avg Wait"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:y})]})]}),(0,Pt.jsx)("div",{className:"space-y-2",children:a.map((e,t)=>{const n=(e=>{switch(e){case"in_progress":return{icon:(0,Pt.jsx)(la,{className:"w-5 h-5 text-blue-600"}),badge:"bg-blue-100 text-blue-800",label:"In Progress"};case"waiting":return{icon:(0,Pt.jsx)(Hn,{className:"w-5 h-5 text-yellow-600"}),badge:"bg-yellow-100 text-yellow-800",label:"Waiting"};case"completed":return{icon:(0,Pt.jsx)(qn,{className:"w-5 h-5 text-green-600"}),badge:"bg-green-100 text-green-800",label:"Completed"};default:return{icon:(0,Pt.jsx)(Hn,{className:"w-5 h-5 text-gray-600"}),badge:"bg-gray-100 text-gray-800",label:e}}})(e.status),r="in_progress"===e.status,a="completed"===e.status;return(0,Pt.jsxs)("div",{className:"p-4 rounded border-2 transition-colors ".concat(r?"bg-blue-50 border-blue-400 shadow-md":a?"bg-gray-50 border-gray-300 opacity-70":"bg-white border-gray-300 hover:border-gray-400"),children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-white ".concat(r?"bg-blue-600":a?"bg-gray-400":"bg-yellow-500"),children:e.position}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900",children:e.student_name||"Student ".concat(e.student_id.substring(0,8))}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-500",children:["ID: ",e.student_id.substring(0,12),"..."]})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 rounded-full ".concat(n.badge),children:[n.icon,(0,Pt.jsx)("span",{className:"text-xs font-medium",children:n.label})]})]}),(0,Pt.jsxs)("div",{className:"flex gap-4 text-sm text-gray-600 ml-13",children:["waiting"===e.status&&(0,Pt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,Pt.jsx)(la,{className:"w-4 h-4"}),(0,Pt.jsxs)("span",{children:["Waiting: ",m(e)]})]}),"in_progress"===e.status&&(0,Pt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,Pt.jsx)(la,{className:"w-4 h-4 text-blue-600"}),(0,Pt.jsxs)("span",{className:"text-blue-600",children:["Duration: ",p(e)]})]}),"completed"===e.status&&e.completed_at&&(0,Pt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,Pt.jsx)(qn,{className:"w-4 h-4 text-green-600"}),(0,Pt.jsxs)("span",{className:"text-green-600",children:["Completed ",new Date(e.completed_at).toLocaleTimeString()]})]})]}),e.priority&&"medium"!==e.priority&&(0,Pt.jsx)("div",{className:"mt-2 inline-block",children:(0,Pt.jsxs)("span",{className:"text-xs px-2 py-1 rounded font-medium ".concat("high"===e.priority||"urgent"===e.priority?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"),children:[e.priority.charAt(0).toUpperCase()+e.priority.slice(1)," Priority"]})})]},e.id)})}),(0,Pt.jsx)("button",{onClick:h,disabled:l,className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded font-medium hover:bg-gray-300 disabled:opacity-50 transition-colors",children:l?"Refreshing...":"Refresh Queue"}),(0,Pt.jsxs)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-sm text-blue-700",children:[(0,Pt.jsx)("p",{className:"font-medium mb-1",children:"\u2139\ufe0f Queue Information"}),(0,Pt.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[(0,Pt.jsx)("li",{children:"Position 1 is next in line"}),(0,Pt.jsxs)("li",{children:["Auto-refreshes every ",n/1e3,"s"]}),(0,Pt.jsx)("li",{children:"Click an entry to manage (coming soon)"}),(0,Pt.jsx)("li",{children:"Completed entries shown for reference"})]})]})]})},YR=e=>{let{academicAssociateId:t}=e;const[n,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!1),[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),u=(0,r.useCallback)(async()=>{if(t)try{l(null);const e=(await an.getQueueForAA(t)).map(e=>({id:e.id,student_id:e.student_id,position:e.position,status:e.status,added_at:e.added_at,priority:e.priority}));a(e)}catch(e){console.error("Error loading queue:",e),l("Failed to load queue"),a([])}finally{i(!1)}else a([])},[t]);(0,r.useEffect)(()=>{u()},[u]);if(!t)return(0,Pt.jsxs)("div",{className:"p-8 bg-gray-50 rounded-lg border border-gray-200 text-center",children:[(0,Pt.jsx)(Hn,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Select an Academic Associate to manage their queue"})]});const h=n.filter(e=>"waiting"===e.status),m=n.filter(e=>"completed"===e.status);return(0,Pt.jsxs)("div",{className:"space-y-4",children:[o&&(0,Pt.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded flex items-center gap-2",children:[(0,Pt.jsx)(Hn,{className:"w-5 h-5 text-red-600"}),(0,Pt.jsx)("p",{className:"text-red-700",children:o})]}),c&&(0,Pt.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded flex items-center gap-2",children:[(0,Pt.jsx)(qI,{className:"w-5 h-5 text-green-600"}),(0,Pt.jsx)("p",{className:"text-green-700",children:c})]}),(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded border border-gray-200",children:[(0,Pt.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Queue Management"}),(0,Pt.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,Pt.jsxs)("button",{onClick:async()=>{if(window.confirm("This will remove all completed entries from the queue. This action cannot be undone."))try{i(!0),l(null),await an.clearCompletedForAA(t),d("Completed entries cleared"),await u(),setTimeout(()=>d(null),3e3)}catch(e){console.error("Error clearing completed:",e),l("Failed to clear completed entries")}finally{i(!1)}},disabled:s||0===m.length,className:"px-3 py-2 text-sm bg-orange-100 text-orange-700 rounded font-medium hover:bg-orange-200 disabled:opacity-50 transition-colors flex items-center gap-2",children:[(0,Pt.jsx)(PR,{className:"w-4 h-4"}),"Clear Completed (",m.length,")"]}),(0,Pt.jsx)("button",{onClick:u,disabled:s,className:"px-3 py-2 text-sm bg-gray-200 text-gray-700 rounded font-medium hover:bg-gray-300 disabled:opacity-50 transition-colors flex items-center gap-2",children:s?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Fl,{className:"w-4 h-4 animate-spin"}),"Refreshing..."]}):"Refresh"})]})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded border border-gray-200",children:[(0,Pt.jsx)("div",{className:"px-4 py-3 border-b border-gray-200 bg-yellow-50",children:(0,Pt.jsxs)("h4",{className:"font-semibold text-gray-900",children:["Waiting Queue (",h.length,")"]})}),0===h.length?(0,Pt.jsx)("div",{className:"p-8 text-center text-gray-500",children:(0,Pt.jsx)("p",{children:"No entries waiting in queue"})}):(0,Pt.jsx)("div",{className:"divide-y divide-gray-200",children:h.map(e=>(0,Pt.jsxs)("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,Pt.jsx)("div",{className:"w-10 h-10 rounded-full bg-yellow-500 text-white flex items-center justify-center font-bold flex-shrink-0",children:e.position}),(0,Pt.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.student_name||"Student ".concat(e.student_id.substring(0,8))}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:[e.student_id.substring(0,20),"..."]})]}),e.priority&&"medium"!==e.priority&&(0,Pt.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium flex-shrink-0 ".concat("high"===e.priority||"urgent"===e.priority?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"),children:e.priority})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[(0,Pt.jsx)("button",{onClick:()=>(async(e,t)=>{if(t<=1)return l("Cannot move further up"),void setTimeout(()=>l(null),3e3);try{i(!0),l(null),await an.reorderQueue(e,t-1),d("Queue updated"),await u(),setTimeout(()=>d(null),3e3)}catch(n){console.error("Error reordering queue:",n),l("Failed to reorder queue")}finally{i(!1)}})(e.id,e.position),disabled:s||e.position<=1,className:"p-2 text-blue-600 hover:bg-blue-100 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Move up in queue (higher priority)",children:(0,Pt.jsx)(fa,{className:"w-5 h-5"})}),(0,Pt.jsx)("button",{onClick:()=>(async(e,t)=>{if(t>=n.filter(e=>"waiting"===e.status).length)return l("Cannot move further down"),void setTimeout(()=>l(null),3e3);try{i(!0),l(null),await an.reorderQueue(e,t+1),d("Queue updated"),await u(),setTimeout(()=>d(null),3e3)}catch(r){console.error("Error reordering queue:",r),l("Failed to reorder queue")}finally{i(!1)}})(e.id,e.position),disabled:s||e.position>=h.length,className:"p-2 text-blue-600 hover:bg-blue-100 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Move down in queue (lower priority)",children:(0,Pt.jsx)(rr,{className:"w-5 h-5"})}),(0,Pt.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to remove this entry from the queue?"))try{i(!0),l(null),await an.removeFromQueue(e),d("Entry removed from queue"),await u(),setTimeout(()=>d(null),3e3)}catch(t){console.error("Error removing entry:",t),l("Failed to remove entry")}finally{i(!1)}})(e.id),disabled:s,className:"p-2 text-red-600 hover:bg-red-100 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Remove from queue",children:(0,Pt.jsx)(PR,{className:"w-5 h-5"})})]})]},e.id))})]}),m.length>0&&(0,Pt.jsxs)("div",{className:"bg-white rounded border border-gray-200",children:[(0,Pt.jsx)("div",{className:"px-4 py-3 border-b border-gray-200 bg-green-50",children:(0,Pt.jsxs)("h4",{className:"font-semibold text-gray-900",children:["Completed (",m.length,")"]})}),(0,Pt.jsxs)("div",{className:"divide-y divide-gray-200",children:[m.slice(0,5).map(e=>(0,Pt.jsx)("div",{className:"p-4 opacity-70 bg-gray-50",children:(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-500 text-white flex items-center justify-center font-bold flex-shrink-0",children:"\u2713"}),(0,Pt.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,Pt.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.student_name||"Student ".concat(e.student_id.substring(0,8))}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:[e.student_id.substring(0,20),"..."]})]})]})},e.id)),m.length>5&&(0,Pt.jsxs)("div",{className:"p-3 text-center text-gray-600 text-sm bg-gray-50",children:["+",m.length-5," more completed"]})]})]}),(0,Pt.jsxs)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-sm text-blue-700",children:[(0,Pt.jsx)("p",{className:"font-medium mb-1",children:"\ud83d\udccb Queue Manager Help"}),(0,Pt.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[(0,Pt.jsx)("li",{children:"Use \u2191\u2193 buttons to reorder queue (affects student wait time)"}),(0,Pt.jsx)("li",{children:"Use \ud83d\uddd1\ufe0f to remove entries completely"}),(0,Pt.jsx)("li",{children:"Position 1 = first in line (next session to start)"}),(0,Pt.jsx)("li",{children:"Completed entries can be cleared in bulk"}),(0,Pt.jsx)("li",{children:"All changes are logged in Firestore"})]})]})]})},$R=()=>{const[e,t]=(0,r.useState)([{id:"cs-1",campus:"Dharamshala",timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"12:00",break_end:"13:00",max_sessions_per_day:4,created_at:new Date,updated_at:new Date}]),[n,a]=(0,r.useState)(null),[s,i]=(0,r.useState)({}),[l,c]=(0,r.useState)("Dharamshala"),[d,u]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),[p,f]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[x,v]=(0,r.useState)("schedules"),[b,w]=(0,r.useState)(null),[j,N]=(0,r.useState)([]),[_,S]=(0,r.useState)("viewer"),k=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];(0,r.useEffect)(()=>{"academicAssociates"===x?(async()=>{try{f(!0);const e=await rn.getAssignments({campus:l});u(e);const t=await rn.getAcademicAssociatesSummary(l);m(t)}catch(e){console.error("Error loading AA assignments:",e)}finally{f(!1)}})():"queues"===x&&(async()=>{try{f(!0);const e=(await _t.UserService.getAll(_t.I.USERS)).filter(e=>"academic_associate"===e.role&&e.campus===l);N(e),!b&&e.length>0&&w(e[0].id)}catch(e){console.error("Error loading AA list:",e),N([])}finally{f(!1)}})()},[x,l,b]);const E=async()=>{try{f(!0);const e=await rn.getAssignments({campus:l});u(e);const t=await rn.getAcademicAssociatesSummary(l);m(t)}catch(e){console.error("Error loading AA assignments:",e)}finally{f(!1)}},A=()=>{i({campus:"",timezone:"Asia/Kolkata",working_days:["monday","tuesday","wednesday","thursday","friday"],start_time:"09:00",end_time:"18:00",break_start:"12:00",break_end:"13:00",max_sessions_per_day:4}),a("new")},C=()=>{if(s.campus){if("new"===n){const n={id:"cs-".concat(Date.now()),campus:s.campus,timezone:s.timezone||"Asia/Kolkata",working_days:s.working_days||[],start_time:s.start_time||"09:00",end_time:s.end_time||"18:00",break_start:s.break_start,break_end:s.break_end,max_sessions_per_day:s.max_sessions_per_day||4,created_at:new Date,updated_at:new Date};t([...e,n])}else n&&t(e.map(e=>e.id===n?(0,o.A)((0,o.A)({},s),{},{updated_at:new Date}):e));a(null)}else alert("Campus name is required")},D=()=>{a(null)};return n?(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-2xl",children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"new"===n?"Add Campus Schedule":"Edit Campus Schedule"}),(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Campus Name*"}),(0,Pt.jsx)("input",{type:"text",value:s.campus||"",onChange:e=>i((0,o.A)((0,o.A)({},s),{},{campus:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Dharamshala"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timezone"}),(0,Pt.jsx)("input",{type:"text",value:s.timezone||"",onChange:e=>i((0,o.A)((0,o.A)({},s),{},{timezone:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Asia/Kolkata"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Working Days"}),(0,Pt.jsx)("div",{className:"flex flex-wrap gap-2",children:k.map(e=>(0,Pt.jsx)("button",{onClick:()=>(e=>{const t=s.working_days||[],n=t.includes(e)?t.filter(t=>t!==e):[...t,e];i((0,o.A)((0,o.A)({},s),{},{working_days:n}))})(e),className:"px-3 py-2 rounded-md font-medium text-sm capitalize transition ".concat((s.working_days||[]).includes(e)?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:e.slice(0,3)},e))})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),(0,Pt.jsx)("input",{type:"time",value:s.start_time||"09:00",onChange:e=>i((0,o.A)((0,o.A)({},s),{},{start_time:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),(0,Pt.jsx)("input",{type:"time",value:s.end_time||"18:00",onChange:e=>i((0,o.A)((0,o.A)({},s),{},{end_time:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Break Start (Lunch)"}),(0,Pt.jsx)("input",{type:"time",value:s.break_start||"12:00",onChange:e=>i((0,o.A)((0,o.A)({},s),{},{break_start:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Break End"}),(0,Pt.jsx)("input",{type:"time",value:s.break_end||"13:00",onChange:e=>i((0,o.A)((0,o.A)({},s),{},{break_end:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Sessions Per Day"}),(0,Pt.jsx)("input",{type:"number",value:s.max_sessions_per_day||4,onChange:e=>i((0,o.A)((0,o.A)({},s),{},{max_sessions_per_day:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1"})]}),(0,Pt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3 flex gap-2",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,Pt.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,Pt.jsx)("p",{className:"font-medium",children:"Tips for Campus Schedule:"}),(0,Pt.jsxs)("ul",{className:"list-disc ml-5 mt-1 space-y-1",children:[(0,Pt.jsx)("li",{children:"Set working hours to match campus functioning time"}),(0,Pt.jsx)("li",{children:"Specify lunch and recreation break times"}),(0,Pt.jsx)("li",{children:"This schedule helps allocate pair programming sessions"})]})]})]}),(0,Pt.jsxs)("div",{className:"flex gap-3 justify-end pt-4",children:[(0,Pt.jsxs)("button",{onClick:D,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[(0,Pt.jsx)(zn,{className:"h-4 w-4"}),"Cancel"]}),(0,Pt.jsxs)("button",{onClick:C,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[(0,Pt.jsx)(VR,{className:"h-4 w-4"}),"Save"]})]})]})]}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsx)("div",{className:"flex justify-between items-center",children:(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Campus Administration"}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage schedules and academic associate assignments"})]})}),(0,Pt.jsxs)("div",{className:"flex gap-4 border-b border-gray-200",children:[(0,Pt.jsxs)("button",{onClick:()=>v("schedules"),className:"px-4 py-3 font-medium border-b-2 transition-colors ".concat("schedules"===x?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"),children:[(0,Pt.jsx)(la,{className:"h-5 w-5 inline mr-2"}),"Campus Schedules"]}),(0,Pt.jsxs)("button",{onClick:()=>v("academicAssociates"),className:"px-4 py-3 font-medium border-b-2 transition-colors ".concat("academicAssociates"===x?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"),children:[(0,Pt.jsx)(er,{className:"h-5 w-5 inline mr-2"}),"Academic Associates"]}),(0,Pt.jsxs)("button",{onClick:()=>v("queues"),className:"px-4 py-3 font-medium border-b-2 transition-colors ".concat("queues"===x?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"),children:[(0,Pt.jsx)(WR,{className:"h-5 w-5 inline mr-2"}),"Rolling Queues"]})]}),"schedules"===x&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"flex justify-end",children:(0,Pt.jsxs)("button",{onClick:A,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:[(0,Pt.jsx)(uR,{className:"h-5 w-5"}),"Add Campus Schedule"]})}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[e.map(n=>(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow p-5 hover:shadow-md transition",children:(0,Pt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:n.campus}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:n.timezone}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[(0,Pt.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-600 font-medium",children:"Working Hours"}),(0,Pt.jsxs)("p",{className:"font-semibold text-gray-900",children:[n.start_time," - ",n.end_time]})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-600 font-medium",children:"Lunch Break"}),(0,Pt.jsxs)("p",{className:"font-semibold text-gray-900",children:[n.break_start||"-"," - ",n.break_end||"-"]})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-600 font-medium",children:"Max Sessions/Day"}),(0,Pt.jsx)("p",{className:"font-semibold text-gray-900",children:n.max_sessions_per_day})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-600 font-medium",children:"Working Days"}),(0,Pt.jsxs)("p",{className:"font-semibold text-gray-900",children:[n.working_days.length,"/7"]})]})]}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-500 mt-4",children:["Updated: ",new Date(n.updated_at).toLocaleDateString()]})]}),(0,Pt.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,Pt.jsx)("button",{onClick:()=>(e=>{i(e),a(e.id)})(n),className:"p-2 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200",title:"Edit",children:(0,Pt.jsx)(GR,{className:"h-4 w-4"})}),(0,Pt.jsx)("button",{onClick:()=>{return r=n.id,void(window.confirm("Are you sure you want to delete this campus schedule?")&&t(e.filter(e=>e.id!==r)));var r},className:"p-2 bg-red-100 text-red-700 rounded-md hover:bg-red-200",title:"Delete",children:(0,Pt.jsx)(PR,{className:"h-4 w-4"})})]})]})},n.id)),0===e.length&&(0,Pt.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)(la,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-4",children:"No campus schedules configured yet."}),(0,Pt.jsxs)("button",{onClick:A,className:"inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:[(0,Pt.jsx)(uR,{className:"h-4 w-4"}),"Create First Campus Schedule"]})]})]})]}),"academicAssociates"===x&&(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,Pt.jsxs)("div",{className:"flex-1 max-w-xs",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Campus"}),(0,Pt.jsx)("select",{value:l,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:e.map(e=>(0,Pt.jsx)("option",{value:e.campus,children:e.campus},e.id))})]}),(0,Pt.jsxs)("button",{onClick:()=>y(!0),className:"mt-6 flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:[(0,Pt.jsx)(uR,{className:"h-5 w-5"}),"New Assignment"]})]}),p&&(0,Pt.jsxs)("div",{className:"text-center py-8",children:[(0,Pt.jsx)(Fl,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto"}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading assignments..."})]}),!p&&(0,Pt.jsx)(Pt.Fragment,{children:0===d.length?(0,Pt.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)(er,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pt.jsxs)("p",{className:"text-gray-600 mb-4",children:["No assignments yet for ",l]}),(0,Pt.jsxs)("button",{onClick:()=>y(!0),className:"inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:[(0,Pt.jsx)(uR,{className:"h-4 w-4"}),"Create First Assignment"]})]}):(0,Pt.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,Pt.jsxs)("table",{className:"w-full",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Academic Associate"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Students"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"House"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Phase"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Created"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-900",children:"Actions"})]})}),(0,Pt.jsx)("tbody",{className:"divide-y divide-gray-200",children:d.map(e=>{var t;const n=h.find(t=>t.academic_associate_id===e.academic_associate_id);return(0,Pt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pt.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:(null===n||void 0===n?void 0:n.name)||"N/A"}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:(0,Pt.jsxs)("span",{className:"inline-flex items-center justify-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(null===(t=e.student_ids)||void 0===t?void 0:t.length)||0," students"]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.house||"-"}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.phase||"-"}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(e.created_at).toLocaleDateString()}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-right text-sm",children:(0,Pt.jsxs)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this assignment?"))try{await rn.deleteAssignment(e),await E()}catch(t){console.error("Error deleting AA assignment:",t)}})(e.id),className:"inline-flex items-center gap-1 text-red-600 hover:text-red-700 hover:bg-red-50 px-2 py-1 rounded",children:[(0,Pt.jsx)(PR,{className:"h-4 w-4"}),"Delete"]})})]},e.id)})})]})})})]}),"queues"===x&&(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded border border-gray-200",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Campus"}),(0,Pt.jsxs)("select",{value:l,onChange:e=>{c(e.target.value),w(null)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,Pt.jsx)("option",{value:"Dharamshala",children:"Dharamshala"}),(0,Pt.jsx)("option",{value:"Palampur",children:"Palampur"}),(0,Pt.jsx)("option",{value:"Kangra",children:"Kangra"})]})]}),(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded border border-gray-200",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Academic Associate"}),p?(0,Pt.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,Pt.jsx)(Fl,{className:"w-5 h-5 animate-spin text-blue-600 mr-2"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Loading AAs..."})]}):0===j.length?(0,Pt.jsx)("p",{className:"text-gray-600 text-center py-4",children:"No Academic Associates found for this campus"}):(0,Pt.jsxs)("select",{value:b||"",onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,Pt.jsx)("option",{value:"",children:"Choose an AA..."}),j.map(e=>(0,Pt.jsx)("option",{value:e.id,children:e.name||e.email},e.id))]})]}),(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded border border-gray-200",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Queue View Mode"}),(0,Pt.jsxs)("div",{className:"flex gap-2",children:[(0,Pt.jsx)("button",{onClick:()=>S("viewer"),className:"flex-1 px-4 py-2 rounded font-medium transition-colors ".concat("viewer"===_?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Queue Viewer"}),(0,Pt.jsx)("button",{onClick:()=>S("manager"),className:"flex-1 px-4 py-2 rounded font-medium transition-colors ".concat("manager"===_?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Queue Manager"})]})]}),(0,Pt.jsx)("div",{className:"bg-white p-6 rounded border border-gray-200",children:"viewer"===_?(0,Pt.jsx)(QR,{academicAssociateId:b||"",refreshInterval:5e3}):(0,Pt.jsx)(YR,{academicAssociateId:b||""})})]}),g&&(0,Pt.jsx)(KR,{campus:l,onSave:async(e,t)=>{try{const n="admin-user-id";await rn.createAssignment(e,t,l,n),await E()}catch(n){throw console.error("Error saving AA assignment:",n),n}},onClose:()=>y(!1)})]})},JR=Un("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),XR=Un("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ZR=()=>{const[e,t]=(0,r.useState)(!1),[n,a]=(0,r.useState)(null),[s,i]=(0,r.useState)("");return(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"House Statistics Management"}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-2",children:"Calculate and cache house performance averages for the Journey page."})]}),(0,Pt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)(JR,{className:"h-5 w-5 text-blue-600 mt-0.5"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("h3",{className:"font-semibold text-blue-900 mb-1",children:"About House Statistics"}),(0,Pt.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1 list-disc list-inside",children:[(0,Pt.jsx)("li",{children:"House averages show how long students typically spend in each phase"}),(0,Pt.jsx)("li",{children:"Data is cached weekly to reduce Firestore reads (99% reduction!)"}),(0,Pt.jsx)("li",{children:"Students see these averages on their Journey page for comparison"}),(0,Pt.jsx)("li",{children:"Recalculation is computationally expensive - only run when needed"}),(0,Pt.jsx)("li",{children:"Stats are automatically used for the current week once calculated"})]})]})]})}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,Pt.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsx)("div",{className:"p-3 bg-purple-100 rounded-lg",children:(0,Pt.jsx)(Qn,{className:"h-6 w-6 text-purple-600"})}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Recalculate House Averages"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600",children:"Calculate performance averages for Bageshree, Malhar, and Bhairav"})]})]})}),(0,Pt.jsxs)("div",{className:"space-y-4",children:[n&&(0,Pt.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-lg ".concat("success"===n.type?"bg-green-50 border border-green-200":"error"===n.type?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"),children:["success"===n.type?(0,Pt.jsx)(XR,{className:"h-5 w-5 text-green-600 mt-0.5"}):"error"===n.type?(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-red-600 mt-0.5"}):(0,Pt.jsx)(JR,{className:"h-5 w-5 text-blue-600 mt-0.5"}),(0,Pt.jsx)("p",{className:"text-sm ".concat("success"===n.type?"text-green-800":"error"===n.type?"text-red-800":"text-blue-800"),children:n.text})]}),s&&(0,Pt.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsx)("div",{className:"animate-spin",children:(0,Pt.jsx)(Hl,{className:"h-5 w-5 text-gray-600"})}),(0,Pt.jsx)("p",{className:"text-sm text-gray-700 font-medium",children:s})]})}),(0,Pt.jsxs)("button",{onClick:async()=>{t(!0),a(null),i("Starting calculation...");try{const t=await on.getAllPhases();i("Loaded ".concat(t.length," phases. Starting house calculations..."));const n=["Bageshree","Malhar","Bhairav"],r={};for(const a of n){i("Calculating stats for ".concat(a,"..."));try{const e=await LI.calculateAndCacheHouseAverages(a,t);r[a]=e,i("\u2705 Completed ".concat(a," (").concat(e.length," phases)"))}catch(e){console.error("Error calculating ".concat(a,":"),e),r[a]={error:String(e)},i("\u274c Failed ".concat(a))}}const s=Object.values(r).reduce((e,t)=>e+(Array.isArray(t)?t.length:0),0);a({type:"success",text:"Successfully recalculated house statistics! Updated ".concat(s," phase averages across all houses.")}),i("")}catch(e){console.error("Error refreshing house stats:",e),a({type:"error",text:"Failed to refresh house statistics: ".concat(e instanceof Error?e.message:"Unknown error")}),i("")}finally{t(!1)}},disabled:e,className:"w-full flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-medium transition-all ".concat(e?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700 active:scale-95"),children:[(0,Pt.jsx)(Hl,{className:"h-5 w-5 ".concat(e?"animate-spin":"")}),e?"Calculating...":"Refresh House Statistics"]}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"This process may take 1-2 minutes. It will analyze all students across all phases."})]})]}),(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,Pt.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"Technical Details"}),(0,Pt.jsxs)("div",{className:"text-sm text-gray-700 space-y-1",children:[(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Calculation:"})," Analyzes goals and reflections for all students in each house"]}),(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Cache Duration:"})," One week (automatically uses current week data)"]}),(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Storage:"})," Results saved in ",(0,Pt.jsx)("code",{className:"bg-gray-200 px-1 rounded",children:"house_stats"})," collection"]}),(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Impact:"})," Reduces Journey page loads from ~10,000 reads to 3-5 reads (99.95% reduction)"]})]})]})]})},eM=Un("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),tM=Un("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),nM=e=>{let{filters:t,onSelectionChange:n}=e;const[a,s]=(0,r.useState)([]),[i,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)(new Set),[d,u]=(0,r.useState)("overdue"),[h,m]=(0,r.useState)("desc");(0,r.useEffect)(()=>{(async()=>{o(!0);try{const r=qt(),a=Ht(r),i=Wt(a),o=(0,kt.collection)(Nt.db,"users");let l=(0,kt.query)(o,(0,kt._M)("role","==","mentor"));null!==t&&void 0!==t&&t.campus&&"all"!==t.campus&&(l=(0,kt.query)(l,(0,kt._M)("campus","==",t.campus)));const c=await(0,kt.getDocs)(l),u=[];for(const t of c.docs){const a=t.data(),s=a.mentees||[],o=[];let l=0;for(const u of s){var e,n;const a=(null===(e=(await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",u)))).docs[0])||void 0===e||null===(n=e.data())||void 0===n?void 0:n.name)||"Unknown",s=(0,kt.collection)(Nt.db,"mentee_reviews"),c=(0,kt.query)(s,(0,kt._M)("reviewer_id","==",t.id),(0,kt._M)("reviewee_id","==",u),(0,kt._M)("week_start","==",r)),d=(await(0,kt.getDocs)(c)).size>0;d&&l++,o.push({id:u,name:a,reviewed:d,daysOverdue:d?void 0:i})}const c=s.length-l,d=i>0?c:0;let h="completed";d>0?h="overdue":c>0&&(h="pending"),u.push({id:t.id,name:a.name||"Unknown",email:a.email||"",campus:a.campus||"Unknown",house:a.house||"Unknown",mentees:s,reviewedCount:l,pendingCount:c,overdueCount:d,daysOverdue:i,status:h,menteeDetails:o})}const m=p(u,d,h);s(m)}catch(r){console.error("Error loading mentor data:",r)}finally{o(!1)}})()},[t]);const p=(e,t,n)=>{const r=[...e].sort((e,r)=>{let a=0;switch(t){case"name":a=e.name.localeCompare(r.name);break;case"overdue":a=e.overdueCount-r.overdueCount;break;case"completion":a=(e.mentees.length>0?e.reviewedCount/e.mentees.length:0)-(r.mentees.length>0?r.reviewedCount/r.mentees.length:0)}return"asc"===n?a:-a});return r},f=e=>{d===e?m("asc"===h?"desc":"asc"):(u(e),m("desc"))},g=e=>{switch(e){case"completed":return(0,Pt.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 flex items-center",children:[(0,Pt.jsx)(qn,{className:"h-3 w-3 mr-1"}),"Complete"]});case"pending":return(0,Pt.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800 flex items-center",children:[(0,Pt.jsx)(la,{className:"h-3 w-3 mr-1"}),"Pending"]});case"overdue":return(0,Pt.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800 flex items-center",children:[(0,Pt.jsx)(Hn,{className:"h-3 w-3 mr-1"}),"Overdue"]});default:return null}},y=e=>{switch(e){case"completed":return"bg-green-50";case"pending":return"bg-yellow-50";case"overdue":return"bg-red-50";default:return"bg-white"}};return i?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Pt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Mentor Compliance"}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[a.length," mentor",1!==a.length?"s":""," found"]})]}),(0,Pt.jsx)("div",{className:"overflow-x-auto",children:(0,Pt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>f("name"),children:(0,Pt.jsxs)("div",{className:"flex items-center",children:["Mentor Name","name"===d&&("asc"===h?(0,Pt.jsx)(fa,{className:"h-4 w-4 ml-1"}):(0,Pt.jsx)(rr,{className:"h-4 w-4 ml-1"}))]})}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Campus"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"# Mentees"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>f("completion"),children:(0,Pt.jsxs)("div",{className:"flex items-center",children:["Reviewed","completion"===d&&("asc"===h?(0,Pt.jsx)(fa,{className:"h-4 w-4 ml-1"}):(0,Pt.jsx)(rr,{className:"h-4 w-4 ml-1"}))]})}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pending"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>f("overdue"),children:(0,Pt.jsxs)("div",{className:"flex items-center",children:["Overdue","overdue"===d&&("asc"===h?(0,Pt.jsx)(fa,{className:"h-4 w-4 ml-1"}):(0,Pt.jsx)(rr,{className:"h-4 w-4 ml-1"}))]})}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Pt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,Pt.jsxs)(r.Fragment,{children:[(0,Pt.jsxs)("tr",{className:"".concat(y(e.status)," hover:bg-opacity-75 transition-colors"),children:[(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.mentees.length>0&&(0,Pt.jsx)("button",{onClick:()=>(e=>{const t=new Set(l);t.has(e)?t.delete(e):t.add(e),c(t)})(e.id),className:"text-gray-400 hover:text-gray-600",children:l.has(e.id)?(0,Pt.jsx)(fa,{className:"h-5 w-5"}):(0,Pt.jsx)(rr,{className:"h-5 w-5"})})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:g(e.status)}),(0,Pt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,Pt.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,Pt.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.campus}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.mentees.length}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsx)("span",{className:"text-sm font-semibold text-green-600",children:e.reviewedCount})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsx)("span",{className:"text-sm font-semibold text-yellow-600",children:e.pendingCount})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("span",{className:"text-sm font-semibold text-red-600",children:e.overdueCount}),e.overdueCount>0&&(0,Pt.jsxs)("span",{className:"text-xs text-red-500 ml-1",children:["(",e.daysOverdue,"d)"]})]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:"completed"!==e.status&&(0,Pt.jsxs)("button",{onClick:()=>{return t=e.id,void alert("Reminder will be sent to mentor ".concat(t));var t},className:"text-purple-600 hover:text-purple-900 flex items-center ml-auto",children:[(0,Pt.jsx)(aR,{className:"h-4 w-4 mr-1"}),"Remind"]})})]}),l.has(e.id)&&e.menteeDetails&&(0,Pt.jsx)("tr",{children:(0,Pt.jsx)("td",{colSpan:9,className:"px-6 py-4 bg-gray-50",children:(0,Pt.jsxs)("div",{className:"ml-8",children:[(0,Pt.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Mentee Details"}),(0,Pt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.menteeDetails.map(e=>(0,Pt.jsx)("div",{className:"p-3 rounded-lg border ".concat(e.reviewed?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(ar,{className:"h-4 w-4 mr-2 text-gray-600"}),(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name})]}),e.reviewed?(0,Pt.jsx)(qn,{className:"h-4 w-4 text-green-600"}):(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(Hn,{className:"h-4 w-4 text-red-600"}),e.daysOverdue&&e.daysOverdue>0&&(0,Pt.jsxs)("span",{className:"text-xs text-red-600 ml-1",children:[e.daysOverdue,"d"]})]})]})},e.id))})]})})})]},e.id))})]})}),0===a.length&&(0,Pt.jsx)("div",{className:"text-center py-12",children:(0,Pt.jsx)("p",{className:"text-gray-500",children:"No mentors found matching the current filters."})})]})},rM=e=>{let{filters:t}=e;const[n,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[o,l]=(0,r.useState)(new Set),[c,d]=(0,r.useState)("overdue"),[u,h]=(0,r.useState)("desc");(0,r.useEffect)(()=>{m()},[t]);const m=async()=>{i(!0);try{const i=qt(),d=Ht(i),h=Wt(d),m=(0,kt.collection)(Nt.db,"users");let f=(0,kt.query)(m);null!==t&&void 0!==t&&t.campus&&"all"!==t.campus&&(f=(0,kt.query)(f,(0,kt._M)("campus","==",t.campus)));const g=await(0,kt.getDocs)(f),y=[];for(const t of g.docs){const a=t.data(),c=t.id;if(!a.mentor_id)continue;let d="Unassigned";if(a.mentor_id){var e,n;d=(null===(e=(await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",a.mentor_id)))).docs[0])||void 0===e||null===(n=e.data())||void 0===n?void 0:n.name)||"Unknown Mentor"}const u=(0,kt.collection)(Nt.db,"mentor_reviews"),m=(0,kt.query)(u,(0,kt._M)("student_id","==",c),(0,kt._M)("mentor_id","==",a.mentor_id),(0,kt._M)("week_start","==",i)),p=(await(0,kt.getDocs)(m)).size>0,f=(0,kt.query)(u,(0,kt._M)("student_id","==",c),(0,kt._M)("mentor_id","==",a.mentor_id)),g=await(0,kt.getDocs)(f);let x,v,b;if(g.size>0){var r,s,o,l;const e=g.docs.map(e=>{const t=e.data();return{id:e.id,created_at:t.created_at,week_start:t.week_start,morning_exercise:t.morning_exercise,communication:t.communication,academic_effort:t.academic_effort,campus_contribution:t.campus_contribution,behavioural:t.behavioural,mentorship_level:t.mentorship_level}});e.sort((e,t)=>{var n,r,a,s;const i=(null===(n=e.created_at)||void 0===n||null===(r=n.toDate)||void 0===r?void 0:r.call(n))||new Date(0);return((null===(a=t.created_at)||void 0===a||null===(s=a.toDate)||void 0===s?void 0:s.call(a))||new Date(0)).getTime()-i.getTime()});const t=e[0];if(x=(null===(r=t.created_at)||void 0===r||null===(s=r.toDate)||void 0===s?void 0:s.call(r))||void 0,x){const e=(new Date).getTime()-x.getTime();v=Math.floor(e/864e5)}const n=[t.morning_exercise||0,t.communication||0,t.academic_effort||0,t.campus_contribution||0,t.behavioural||0,t.mentorship_level||0],a=n.reduce((e,t)=>e+t,0)/n.length;b={week_start:(null===(o=t.week_start)||void 0===o||null===(l=o.toDate)||void 0===l?void 0:l.call(o))||new Date,created_at:x||new Date,aggregateScore:Number(a.toFixed(2))}}let w="completed";p||(w=h>0?"overdue":"pending"),y.push({id:c,name:a.name||"Unknown",email:a.email||"",campus:a.campus||"Unknown",house:a.house||"Unknown",mentorId:a.mentor_id,mentorName:d,hasReviewedMentor:p,lastReviewDate:x,daysSinceLastReview:v,daysOverdue:p?0:h,status:w,reviewDetails:b})}const x=p(y,c,u);a(x)}catch(d){console.error("Error loading student data:",d)}finally{i(!1)}},p=(e,t,n)=>{const r=[...e].sort((e,r)=>{var a,s;let i=0;switch(t){case"name":i=e.name.localeCompare(r.name);break;case"overdue":i=e.daysOverdue-r.daysOverdue;break;case"lastReview":i=((null===(a=e.lastReviewDate)||void 0===a?void 0:a.getTime())||0)-((null===(s=r.lastReviewDate)||void 0===s?void 0:s.getTime())||0)}return"asc"===n?i:-i});return r},f=e=>{c===e?h("asc"===u?"desc":"asc"):(d(e),h("lastReview"===e?"asc":"desc"))},g=e=>{switch(e){case"completed":return(0,Pt.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 flex items-center",children:[(0,Pt.jsx)(qn,{className:"h-3 w-3 mr-1"}),"Complete"]});case"pending":return(0,Pt.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800 flex items-center",children:[(0,Pt.jsx)(la,{className:"h-3 w-3 mr-1"}),"Pending"]});case"overdue":return(0,Pt.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800 flex items-center",children:[(0,Pt.jsx)(Hn,{className:"h-3 w-3 mr-1"}),"Overdue"]});default:return null}},y=e=>{switch(e){case"completed":return"bg-green-50";case"pending":return"bg-yellow-50";case"overdue":return"bg-red-50";default:return"bg-white"}},x=e=>e?e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Never";return s?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Pt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Student Compliance"}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[n.length," student",1!==n.length?"s":""," found"]})]}),(0,Pt.jsx)("div",{className:"overflow-x-auto",children:(0,Pt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>f("name"),children:(0,Pt.jsxs)("div",{className:"flex items-center",children:["Student Name","name"===c&&("asc"===u?(0,Pt.jsx)(fa,{className:"h-4 w-4 ml-1"}):(0,Pt.jsx)(rr,{className:"h-4 w-4 ml-1"}))]})}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Campus"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mentor"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>f("lastReview"),children:(0,Pt.jsxs)("div",{className:"flex items-center",children:["Last Reviewed","lastReview"===c&&("asc"===u?(0,Pt.jsx)(fa,{className:"h-4 w-4 ml-1"}):(0,Pt.jsx)(rr,{className:"h-4 w-4 ml-1"}))]})}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Days Since"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>f("overdue"),children:(0,Pt.jsxs)("div",{className:"flex items-center",children:["Overdue","overdue"===c&&("asc"===u?(0,Pt.jsx)(fa,{className:"h-4 w-4 ml-1"}):(0,Pt.jsx)(rr,{className:"h-4 w-4 ml-1"}))]})}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Pt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(e=>(0,Pt.jsxs)(r.Fragment,{children:[(0,Pt.jsxs)("tr",{className:"".concat(y(e.status)," hover:bg-opacity-75 transition-colors"),children:[(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.reviewDetails&&(0,Pt.jsx)("button",{onClick:()=>(e=>{const t=new Set(o);t.has(e)?t.delete(e):t.add(e),l(t)})(e.id),className:"text-gray-400 hover:text-gray-600",children:o.has(e.id)?(0,Pt.jsx)(fa,{className:"h-5 w-5"}):(0,Pt.jsx)(rr,{className:"h-5 w-5"})})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:g(e.status)}),(0,Pt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,Pt.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,Pt.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.campus}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(ar,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,Pt.jsx)("span",{className:"text-sm text-gray-900",children:e.mentorName})]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:x(e.lastReviewDate)}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsx)("span",{className:"text-sm font-medium ".concat(e.daysSinceLastReview?e.daysSinceLastReview>14?"text-red-600":e.daysSinceLastReview>7?"text-yellow-600":"text-green-600":"text-gray-400"),children:void 0!==e.daysSinceLastReview?"".concat(e.daysSinceLastReview,"d"):"N/A"})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.daysOverdue>0?(0,Pt.jsxs)("span",{className:"text-sm font-semibold text-red-600",children:[e.daysOverdue,"d"]}):(0,Pt.jsx)("span",{className:"text-sm text-gray-400",children:"-"})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:"completed"!==e.status&&(0,Pt.jsxs)("button",{onClick:()=>{return t=e.id,void alert("Reminder will be sent to student ".concat(t));var t},className:"text-purple-600 hover:text-purple-900 flex items-center ml-auto",children:[(0,Pt.jsx)(aR,{className:"h-4 w-4 mr-1"}),"Remind"]})})]}),o.has(e.id)&&e.reviewDetails&&(0,Pt.jsx)("tr",{children:(0,Pt.jsx)("td",{colSpan:9,className:"px-6 py-4 bg-gray-50",children:(0,Pt.jsxs)("div",{className:"ml-8",children:[(0,Pt.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Latest Review Details"}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Pt.jsx)(Bn,{className:"h-4 w-4 mr-2 text-purple-600"}),(0,Pt.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Week Start"})]}),(0,Pt.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:x(e.reviewDetails.week_start)})]}),(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Pt.jsx)(qn,{className:"h-4 w-4 mr-2 text-green-600"}),(0,Pt.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Submitted On"})]}),(0,Pt.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:x(e.reviewDetails.created_at)})]}),(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Pt.jsx)($n,{className:"h-4 w-4 mr-2 text-blue-600"}),(0,Pt.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Aggregate Score"})]}),(0,Pt.jsxs)("p",{className:"text-sm font-semibold ".concat(e.reviewDetails.aggregateScore>=1?"text-green-600":e.reviewDetails.aggregateScore>=0?"text-yellow-600":"text-red-600"),children:[e.reviewDetails.aggregateScore>0?"+":"",e.reviewDetails.aggregateScore.toFixed(2)]})]})]})]})})})]},e.id))})]})}),0===n.length&&(0,Pt.jsx)("div",{className:"text-center py-12",children:(0,Pt.jsx)("p",{className:"text-gray-500",children:"No students found matching the current filters."})})]})},aM=Un("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),sM=Un("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),iM=Un("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),oM=e=>{let{viewType:t,userId:n,filters:a}=e;const[s,i]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(new Set),[u,h]=(0,r.useState)(!1),m={morning_exercise:"Morning Exercise",communication:"Communication",academic_effort:"Academic Effort",campus_contribution:"Campus Contribution",behavioural:"Behavioural",mentorship_level:"Mentorship Level"};(0,r.useEffect)(()=>{p()},[t,n,a]);const p=async()=>{l(!0);try{const e=qt(),r=[];"mentor"===t&&n?await f(n,e,r):"student"===t&&n?await g(n,e,r):await y(e,r),i(r)}catch(e){console.error("Error loading score breakdowns:",e)}finally{l(!1)}},f=async(e,t,n)=>{const r=(0,kt.collection)(Nt.db,"mentee_reviews"),a=(0,kt.query)(r,(0,kt._M)("reviewer_id","==",e),(0,kt._M)("week_start","==",t)),s=await(0,kt.getDocs)(a);for(const c of s.docs){var i,o,l;const a=c.data(),s=(null===(i=(await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",a.reviewee_id)))).docs[0])||void 0===i||null===(o=i.data())||void 0===o?void 0:o.name)||"Unknown",d=new Date(t);d.setDate(d.getDate()-7);const u=(0,kt.query)(r,(0,kt._M)("reviewer_id","==",e),(0,kt._M)("reviewee_id","==",a.reviewee_id),(0,kt._M)("week_start","==",d)),h=null===(l=(await(0,kt.getDocs)(u)).docs[0])||void 0===l?void 0:l.data(),m=await x(t),p=v(e,a.reviewer_name||"Mentor",a.reviewer_email||"",a.reviewee_id,s,a,h,m);n.push(p)}},g=async(e,t,n)=>{var r,a,s,i,o,l;const c=null===(r=(await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",e)))).docs[0])||void 0===r?void 0:r.data(),d=null===c||void 0===c?void 0:c.mentor_id;if(!d)return;const u=(0,kt.collection)(Nt.db,"mentee_reviews"),h=(0,kt.query)(u,(0,kt._M)("reviewer_id","==",d),(0,kt._M)("reviewee_id","==",e),(0,kt._M)("week_start","==",t)),m=await(0,kt.getDocs)(h);if(m.empty)return;const p=m.docs[0].data(),f=await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",d))),g=(null===(a=f.docs[0])||void 0===a||null===(s=a.data())||void 0===s?void 0:s.name)||"Unknown",y=(null===(i=f.docs[0])||void 0===i||null===(o=i.data())||void 0===o?void 0:o.email)||"",b=new Date(t);b.setDate(b.getDate()-7);const w=(0,kt.query)(u,(0,kt._M)("reviewer_id","==",d),(0,kt._M)("reviewee_id","==",e),(0,kt._M)("week_start","==",b)),j=null===(l=(await(0,kt.getDocs)(w)).docs[0])||void 0===l?void 0:l.data(),N=await x(t),_=v(d,g,y,e,(null===c||void 0===c?void 0:c.name)||"Student",p,j,N);n.push(_)},y=async(e,t)=>{const n=(0,kt.collection)(Nt.db,"mentee_reviews"),r=(0,kt.query)(n,(0,kt._M)("week_start","==",e)),a=await(0,kt.getDocs)(r),s=await x(e);for(const m of a.docs){var i,o,l,c,d,u,h;const r=m.data(),a=await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",r.reviewer_id))),p=await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",r.reviewee_id))),f=(null===(i=a.docs[0])||void 0===i||null===(o=i.data())||void 0===o?void 0:o.name)||"Unknown",g=(null===(l=a.docs[0])||void 0===l||null===(c=l.data())||void 0===c?void 0:c.email)||"",y=(null===(d=p.docs[0])||void 0===d||null===(u=d.data())||void 0===u?void 0:u.name)||"Unknown",x=new Date(e);x.setDate(x.getDate()-7);const b=(0,kt.query)(n,(0,kt._M)("reviewer_id","==",r.reviewer_id),(0,kt._M)("reviewee_id","==",r.reviewee_id),(0,kt._M)("week_start","==",x)),w=null===(h=(await(0,kt.getDocs)(b)).docs[0])||void 0===h?void 0:h.data(),j=v(r.reviewer_id,f,g,r.reviewee_id,y,r,w,s);t.push(j)}},x=async e=>{const t=(0,kt.collection)(Nt.db,"mentee_reviews"),n=(0,kt.query)(t,(0,kt._M)("week_start","==",e)),r=await(0,kt.getDocs)(n);if(r.empty)return{morning_exercise:0,communication:0,academic_effort:0,campus_contribution:0,behavioural:0,mentorship_level:0};const a={morning_exercise:0,communication:0,academic_effort:0,campus_contribution:0,behavioural:0,mentorship_level:0};r.docs.forEach(e=>{const t=e.data();a.morning_exercise+=t.morning_exercise||0,a.communication+=t.communication||0,a.academic_effort+=t.academic_effort||0,a.campus_contribution+=t.campus_contribution||0,a.behavioural+=t.behavioural||0,a.mentorship_level+=t.mentorship_level||0});const s=r.size;return{morning_exercise:a.morning_exercise/s,communication:a.communication/s,academic_effort:a.academic_effort/s,campus_contribution:a.campus_contribution/s,behavioural:a.behavioural/s,mentorship_level:a.mentorship_level/s}},v=(e,t,n,r,a,s,i,o)=>{var l,c;const d=[];let u=0;const h=[],p=[];Object.entries(m).forEach(e=>{let[t,n]=e;const r=s[t]||0,a=null===i||void 0===i?void 0:i[t],l=void 0!==a?r-a:void 0,c=o[t]||0,m=r-c;let f="average";f=r>=1.5?"excellent":r>=.5?"good":r>=-.5?"average":r>=-1.5?"poor":"critical";let g="stable";void 0!==l&&(l>.3?g="improving":l<-.3&&(g="declining")),(r<-1||void 0!==l&&l<-.5)&&(u++,p.push(n)),(r>=1.5||m>=.5)&&h.push(n),d.push({name:n,key:t,score:r,previousScore:a,change:l,campusAverage:c,vsAverage:m,status:f,trend:g})});const f=d.map(e=>e.score),g=f.reduce((e,t)=>e+t,0)/f.length,y=d.map(e=>e.previousScore).filter(e=>void 0!==e),x=y.length>0?y.reduce((e,t)=>e+t,0)/y.length:void 0;return{userId:e,userName:t,userEmail:n,revieweeId:r,revieweeName:a,weekStart:(null===(l=s.week_start)||void 0===l?void 0:l.toDate())||new Date,submittedAt:(null===(c=s.created_at)||void 0===c?void 0:c.toDate())||new Date,overallScore:Number(g.toFixed(2)),previousOverallScore:x?Number(x.toFixed(2)):void 0,criteria:d,notes:s.notes,hasRedFlags:u>0,redFlagCount:u,strengths:h,needsAttention:p}},b=e=>{switch(e){case"excellent":return(0,Pt.jsx)($l,{className:"h-4 w-4 text-green-600"});case"good":return(0,Pt.jsx)($n,{className:"h-4 w-4 text-green-500"});case"average":return(0,Pt.jsx)(aM,{className:"h-4 w-4 text-yellow-600"});case"poor":return(0,Pt.jsx)(sM,{className:"h-4 w-4 text-orange-600"});case"critical":return(0,Pt.jsx)(oa,{className:"h-4 w-4 text-red-600"})}},w=e=>{switch(e){case"excellent":return"text-green-600 font-semibold";case"good":return"text-green-500 font-medium";case"average":return"text-yellow-600";case"poor":return"text-orange-600 font-medium";case"critical":return"text-red-600 font-semibold"}},j=e=>e>0?"+".concat(e.toFixed(1)):e.toFixed(1);return o?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Pt.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,Pt.jsx)(iM,{className:"h-5 w-5 mr-2 text-purple-600"}),"Detailed Score Breakdown"]}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[s.length," review",1!==s.length?"s":""," found",s.filter(e=>e.hasRedFlags).length>0&&(0,Pt.jsxs)("span",{className:"ml-2 text-red-600 font-medium",children:["\u2022 ",s.filter(e=>e.hasRedFlags).length," with red flags"]})]})]}),(0,Pt.jsx)("button",{onClick:()=>{d(u?new Set:new Set(s.map(e=>e.revieweeId))),h(!u)},className:"px-4 py-2 text-sm font-medium text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-lg transition-colors flex items-center",children:u?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(fa,{className:"h-4 w-4 mr-1"}),"Collapse All"]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(rr,{className:"h-4 w-4 mr-1"}),"Expand All"]})})]})}),(0,Pt.jsx)("div",{className:"divide-y divide-gray-200",children:s.map(e=>(0,Pt.jsxs)("div",{className:"hover:bg-gray-50 transition-colors",children:[(0,Pt.jsxs)("div",{className:"p-6 cursor-pointer flex items-center justify-between",onClick:()=>(e=>{const t=new Set(c);t.has(e)?t.delete(e):t.add(e),d(t)})(e.revieweeId),children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,Pt.jsx)("button",{className:"text-gray-400 hover:text-gray-600",children:c.has(e.revieweeId)?(0,Pt.jsx)(fa,{className:"h-5 w-5"}):(0,Pt.jsx)(rr,{className:"h-5 w-5"})}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Pt.jsx)("h4",{className:"text-base font-semibold text-gray-900",children:e.revieweeName}),e.hasRedFlags&&(0,Pt.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800 flex items-center",children:[(0,Pt.jsx)(oa,{className:"h-3 w-3 mr-1"}),e.redFlagCount," Red Flag",e.redFlagCount>1?"s":""]})]}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Reviewed by ",e.userName," \u2022 Overall: ",j(e.overallScore),void 0!==e.previousOverallScore&&(0,Pt.jsxs)("span",{className:"ml-2",children:["(",e.overallScore>e.previousOverallScore?(0,Pt.jsxs)("span",{className:"text-green-600",children:["\u2191 +",(e.overallScore-e.previousOverallScore).toFixed(1)]}):e.overallScore<e.previousOverallScore?(0,Pt.jsxs)("span",{className:"text-red-600",children:["\u2193 ",(e.overallScore-e.previousOverallScore).toFixed(1)]}):(0,Pt.jsx)("span",{className:"text-gray-500",children:"Same"}),")"]})]})]})]}),(0,Pt.jsx)("div",{className:"text-right",children:(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:e.submittedAt.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})})]}),c.has(e.revieweeId)&&(0,Pt.jsxs)("div",{className:"px-6 pb-6 bg-gray-50",children:[(0,Pt.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,Pt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Criteria"}),(0,Pt.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Score"}),(0,Pt.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"vs Campus Avg"}),(0,Pt.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"vs Prev Week"}),(0,Pt.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),(0,Pt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.criteria.map(e=>{return(0,Pt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pt.jsx)("td",{className:"px-4 py-3",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[b(e.status),(0,Pt.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-900",children:e.name})]})}),(0,Pt.jsx)("td",{className:"px-4 py-3 text-center",children:(0,Pt.jsx)("span",{className:"text-sm font-semibold ".concat(w(e.status)),children:j(e.score)})}),(0,Pt.jsx)("td",{className:"px-4 py-3 text-center",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-center",children:[(0,Pt.jsx)("span",{className:"text-sm ".concat(e.vsAverage&&e.vsAverage>0?"text-green-600":e.vsAverage&&e.vsAverage<0?"text-red-600":"text-gray-500"),children:e.vsAverage?j(e.vsAverage):"\u2014"}),e.vsAverage&&e.vsAverage>0&&(0,Pt.jsx)($n,{className:"h-3 w-3 ml-1 text-green-600"}),e.vsAverage&&e.vsAverage<0&&(0,Pt.jsx)(sM,{className:"h-3 w-3 ml-1 text-red-600"})]})}),(0,Pt.jsx)("td",{className:"px-4 py-3 text-center",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-center",children:[(n=e.trend,e.change,"stable"===n?(0,Pt.jsx)(aM,{className:"h-3 w-3 text-gray-400"}):"improving"===n?(0,Pt.jsx)($n,{className:"h-3 w-3 text-green-600"}):(0,Pt.jsx)(sM,{className:"h-3 w-3 text-red-600"})),(0,Pt.jsx)("span",{className:"text-sm ml-1 ".concat("improving"===e.trend?"text-green-600":"declining"===e.trend?"text-red-600":"text-gray-500"),children:(t=e.change,void 0===t?"N/A":0===t?"Same":t>0?"+".concat(t.toFixed(1)):t.toFixed(1))})]})}),(0,Pt.jsx)("td",{className:"px-4 py-3 text-center",children:(0,Pt.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ".concat("excellent"===e.status?"bg-green-100 text-green-800":"good"===e.status?"bg-green-50 text-green-700":"average"===e.status?"bg-yellow-100 text-yellow-800":"poor"===e.status?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"),children:["excellent"===e.status&&"\ud83c\udf1f ","critical"===e.status&&"\ud83d\udea8 ",e.status.charAt(0).toUpperCase()+e.status.slice(1)]})})]},e.key);var t,n})})]})}),(0,Pt.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.strengths.length>0&&(0,Pt.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,Pt.jsxs)("h5",{className:"text-sm font-semibold text-green-900 flex items-center mb-2",children:[(0,Pt.jsx)($l,{className:"h-4 w-4 mr-2"}),"Strengths"]}),(0,Pt.jsx)("ul",{className:"space-y-1",children:e.strengths.map((e,t)=>(0,Pt.jsxs)("li",{className:"text-sm text-green-800",children:["\u2022 ",e]},t))})]}),e.needsAttention.length>0&&(0,Pt.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,Pt.jsxs)("h5",{className:"text-sm font-semibold text-red-900 flex items-center mb-2",children:[(0,Pt.jsx)(Hn,{className:"h-4 w-4 mr-2"}),"Needs Attention"]}),(0,Pt.jsx)("ul",{className:"space-y-1",children:e.needsAttention.map((e,t)=>(0,Pt.jsxs)("li",{className:"text-sm text-red-800",children:["\u2022 ",e]},t))})]})]}),e.notes&&(0,Pt.jsxs)("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,Pt.jsxs)("h5",{className:"text-sm font-semibold text-blue-900 flex items-center mb-2",children:[(0,Pt.jsx)(pa,{className:"h-4 w-4 mr-2"}),"Mentor Notes"]}),(0,Pt.jsx)("p",{className:"text-sm text-blue-800",children:e.notes})]})]})]},e.revieweeId))}),0===s.length&&(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(iM,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"No reviews found for the selected criteria."})]})]})},lM=e=>{let{filters:t,weeksToShow:n=8}=e;const[a,s]=(0,r.useState)([]),[i,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)({averageCompletionRate:0,improvingWeeks:0,decliningWeeks:0,criticalWeeks:0});(0,r.useEffect)(()=>{d()},[t,n]);const d=async()=>{o(!0);try{const e=qt(),t=[];for(let s=0;s<n;s++){const n=new Date(e);n.setDate(n.getDate()-7*s);const r=await u(n);t.push(r)}for(let n=0;n<t.length-1;n++){const e=t[n],r=t[n+1];e.change=e.completionRate-r.completionRate,e.change>5?e.trend="improving":e.change<-5?e.trend="declining":e.trend="stable"}const r=t.reduce((e,t)=>e+t.completionRate,0)/t.length,a=t.filter(e=>"improving"===e.trend).length,i=t.filter(e=>"declining"===e.trend).length,o=t.filter(e=>"critical"===e.status).length;c({averageCompletionRate:Number(r.toFixed(1)),improvingWeeks:a,decliningWeeks:i,criticalWeeks:o}),s(t)}catch(e){console.error("Error loading historical trends:",e)}finally{o(!1)}},u=async e=>{const n=new Date(e);n.setDate(n.getDate()+2),n.setHours(23,59,59,999);let r=0,a=0,s=0,i=0;const o=(0,kt.collection)(Nt.db,"users");let l=(0,kt.query)(o);null!==t&&void 0!==t&&t.campus&&"all"!==t.campus&&(l=(0,kt.query)(l,(0,kt._M)("campus","==",t.campus)));const c=(await(0,kt.getDocs)(l)).docs.map(e=>{const t=e.data();return{id:e.id,mentees:t.mentees,mentor_id:t.mentor_id}});for(const x of c){if("student"===(null===t||void 0===t?void 0:t.role))continue;if(!x.mentees||0===x.mentees.length)continue;const o=x.mentees;for(const t of o){r++;const o=(0,kt.collection)(Nt.db,"mentee_reviews"),l=(0,kt.query)(o,(0,kt._M)("reviewer_id","==",x.id),(0,kt._M)("reviewee_id","==",t),(0,kt._M)("week_start","==",e)),c=await(0,kt.getDocs)(l);if(c.size>0){var d,u;a++;((null===(d=c.docs[0].data().created_at)||void 0===d||null===(u=d.toDate)||void 0===u?void 0:u.call(d))||new Date)<=n?s++:i++}}}for(const x of c){if("mentor"===(null===t||void 0===t?void 0:t.role))continue;if(!x.mentor_id)continue;r++;const o=(0,kt.collection)(Nt.db,"mentor_reviews"),l=(0,kt.query)(o,(0,kt._M)("student_id","==",x.id),(0,kt._M)("mentor_id","==",x.mentor_id),(0,kt._M)("week_start","==",e)),c=await(0,kt.getDocs)(l);if(c.size>0){var h,m;a++;((null===(h=c.docs[0].data().created_at)||void 0===h||null===(m=h.toDate)||void 0===m?void 0:m.call(h))||new Date)<=n?s++:i++}}const p=r-a,f=r>0?a/r*100:0,g=r>0?s/r*100:0;let y="good";return y=f>=95?"excellent":f>=85?"good":f>=70?"warning":"critical",{weekStart:e,weekLabel:e.toLocaleDateString("en-US",{month:"short",day:"numeric"}),totalDue:r,completed:a,onTime:s,late:i,neverSubmitted:p,completionRate:Number(f.toFixed(1)),onTimeRate:Number(g.toFixed(1)),change:0,trend:"stable",status:y}},h=e=>{switch(e){case"excellent":return"bg-green-100 text-green-800";case"good":return"bg-blue-100 text-blue-800";case"warning":return"bg-yellow-100 text-yellow-800";case"critical":return"bg-red-100 text-red-800"}},m=e=>{switch(e){case"excellent":case"good":return(0,Pt.jsx)(qn,{className:"h-4 w-4"});case"warning":return(0,Pt.jsx)(oa,{className:"h-4 w-4"});case"critical":return(0,Pt.jsx)(oR,{className:"h-4 w-4"})}},p=e=>{switch(e){case"improving":return(0,Pt.jsx)($n,{className:"h-4 w-4 text-green-600"});case"declining":return(0,Pt.jsx)(sM,{className:"h-4 w-4 text-red-600"});case"stable":return(0,Pt.jsx)(aM,{className:"h-4 w-4 text-gray-400"})}};return i?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Pt.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,Pt.jsx)("div",{className:"flex items-center justify-between",children:(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,Pt.jsx)(Bn,{className:"h-5 w-5 mr-2 text-purple-600"}),"Historical Trends (",n," Weeks)"]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Week-by-week completion rate analysis"})]})})}),(0,Pt.jsx)("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:(0,Pt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase mb-1",children:"Avg Completion"}),(0,Pt.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[l.averageCompletionRate,"%"]})]}),(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase mb-1",children:"Improving"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-green-600",children:l.improvingWeeks})]}),(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase mb-1",children:"Declining"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-red-600",children:l.decliningWeeks})]}),(0,Pt.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,Pt.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase mb-1",children:"Critical Weeks"}),(0,Pt.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:l.criticalWeeks})]})]})}),(0,Pt.jsx)("div",{className:"overflow-x-auto",children:(0,Pt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Week Start"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Due"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Completed"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"On Time"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Late"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Never Submitted"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Completion Rate"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Change"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),(0,Pt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map((e,t)=>{return(0,Pt.jsxs)("tr",{className:"hover:bg-gray-50 ".concat(0===t?"bg-blue-50":""),children:[(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(Bn,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.weekLabel,0===t&&(0,Pt.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Current"})]}),(0,Pt.jsx)("div",{className:"text-xs text-gray-500",children:e.weekStart.toLocaleDateString("en-US",{year:"numeric"})})]})]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.totalDue})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,Pt.jsx)("span",{className:"text-sm font-semibold text-green-600",children:e.completed})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,Pt.jsx)("span",{className:"text-sm text-blue-600",children:e.onTime})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,Pt.jsx)("span",{className:"text-sm text-orange-600",children:e.late})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,Pt.jsx)("span",{className:"text-sm font-semibold text-red-600",children:e.neverSubmitted})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,Pt.jsxs)("span",{className:"text-sm font-semibold text-gray-900",children:[e.completionRate,"%"]}),(0,Pt.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.onTimeRate,"% on time)"]})]}),(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"h-2 rounded-full ".concat((n=e.completionRate,n>=95?"bg-green-500":n>=85?"bg-blue-500":n>=70?"bg-yellow-500":"bg-red-500")),style:{width:"".concat(e.completionRate,"%")}})})]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:t<a.length-1?(0,Pt.jsxs)("div",{className:"flex items-center justify-center",children:[p(e.trend),(0,Pt.jsxs)("span",{className:"text-sm font-medium ml-1 ".concat(e.change>0?"text-green-600":e.change<0?"text-red-600":"text-gray-500"),children:[e.change>0?"+":"",e.change.toFixed(1),"%"]})]}):(0,Pt.jsx)("span",{className:"text-xs text-gray-400",children:"\u2014"})}),(0,Pt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,Pt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-1 text-xs font-semibold rounded-full ".concat(h(e.status)),children:[m(e.status),(0,Pt.jsx)("span",{className:"ml-1",children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]})})]},e.weekLabel);var n})})]})}),l.decliningWeeks>=2&&(0,Pt.jsx)("div",{className:"p-4 bg-red-50 border-t border-red-200",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(oa,{className:"h-5 w-5 text-red-600 mr-3"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-semibold text-red-800",children:"Declining Trend Detected"}),(0,Pt.jsxs)("p",{className:"text-sm text-red-700 mt-1",children:[l.decliningWeeks," weeks show declining completion rates. Consider sending bulk reminders or investigating systemic issues."]})]})]})}),l.averageCompletionRate<85&&(0,Pt.jsx)("div",{className:"p-4 bg-yellow-50 border-t border-yellow-200",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(la,{className:"h-5 w-5 text-yellow-600 mr-3"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-semibold text-yellow-800",children:"Below Target Completion Rate"}),(0,Pt.jsxs)("p",{className:"text-sm text-yellow-700 mt-1",children:["Average completion rate (",l.averageCompletionRate,"%) is below the 85% target. Review notification settings and deadline enforcement."]})]})]})}),0===a.length&&(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(Bn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"No historical data available."})]})]})};var cM=["axis","item"],dM=(0,r.forwardRef)((e,t)=>r.createElement(Tk,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:cM,tooltipPayloadSearcher:bu,categoricalChartProps:e,ref:t}));const uM=Un("percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),hM=Un("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),mM=Un("gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]),pM=e=>{let{filters:t,weeksLookback:n=4}=e;const[a,s]=(0,r.useState)(!0),[i,l]=(0,r.useState)(null),[c,d]=(0,r.useState)([]),[u,h]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1),[f,g]=(0,r.useState)(null),[y,x]=(0,r.useState)([]);(0,r.useEffect)(()=>{v()},[t,n]);const v=async()=>{s(!0);try{var e,r,a;const s=qt(),i=(0,kt.collection)(Nt.db,"mentee_reviews"),c=(0,kt.collection)(Nt.db,"mentor_reviews"),u=(0,kt.query)(i,(0,kt._M)("week_start","==",s)),h=(0,kt.query)(c,(0,kt._M)("week_start","==",s)),[m,p]=await Promise.all([(0,kt.getDocs)(u),(0,kt.getDocs)(h)]),f=[];m.docs.forEach(e=>{const t=e.data();f.push((0,o.A)({id:e.id},t))}),p.docs.forEach(e=>{const t=e.data();f.push((0,o.A)({id:e.id},t))});let g=f;if(null!==t&&void 0!==t&&t.campus||null!==t&&void 0!==t&&t.house){const e=await(0,kt.getDocs)((0,kt.collection)(Nt.db,"users")),n={};e.docs.forEach(e=>n[e.id]=e.data()),g=f.filter(e=>{const r=n[e.reviewee_id]||n[e.reviewer_id];return!!r&&((!t.campus||r.campus===t.campus)&&(!t.house||r.house===t.house))})}const y=[];for(let e=1;e<=n;e++){const t=new Date(s);t.setDate(t.getDate()-7*e);const n=(0,kt.query)(i,(0,kt._M)("week_start","==",t)),r=(0,kt.query)(c,(0,kt._M)("week_start","==",t)),[a,l]=await Promise.all([(0,kt.getDocs)(n),(0,kt.getDocs)(r)]);a.docs.forEach(e=>y.push((0,o.A)({id:e.id},e.data()))),l.docs.forEach(e=>y.push((0,o.A)({id:e.id},e.data())))}const v=g.map(e=>({review:e,score:da(e)})),b={};v.forEach(e=>{let{review:t,score:n}=e;const r=t.reviewee_name||t.reviewee_id||"Unknown";b[t.reviewee_id]||(b[t.reviewee_id]={name:r,scores:[]}),b[t.reviewee_id].scores.push(n)});const w=Object.entries(b).map(e=>{let[t,n]=e;const r=n.scores.reduce((e,t)=>e+t,0)/n.scores.length;return{userId:t,name:n.name,averageScore:Math.round(10*r)/10,status:(a=r,a>=1.5?"Excellent":a>=.5?"Good":a>=-.5?"Needs Improvement":"Critical")};var a});w.sort((e,t)=>t.averageScore-e.averageScore);const j=w.slice(0,5),N=w.slice(-5).reverse(),_=[{key:"excellent",label:"Excellent (1.5 \u2013 2.0)",min:1.5,max:2.01,color:"#16a34a"},{key:"good",label:"Good (0.5 \u2013 1.49)",min:.5,max:1.5,color:"#2563eb"},{key:"needs_improvement",label:"Needs Improvement (-0.5 \u2013 0.49)",min:-.5,max:.5,color:"#d97706"},{key:"critical",label:"Critical (-2.0 \u2013 -0.51)",min:-2.01,max:-.5,color:"#dc2626"}],S=_.map(e=>({key:e.key,label:e.label,min:e.min,max:e.max,count:0,percentage:0,color:e.color}));v.forEach(e=>{let{score:t}=e;const n=S.find(e=>t>=e.min&&t<e.max);n&&(n.count+=1)});const k=v.length;S.forEach(e=>{e.percentage=0===k?0:Math.round(e.count/k*1e3)/10});const E=0===k?0:Math.round(v.reduce((e,t)=>e+t.score,0)/k*10)/10,A=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(0===e.length)return null;const n=qt(),r=e.filter(e=>Kt(new Date(e.week_start),n)),a=new Date(n);a.setDate(a.getDate()-7*t);const s=e.filter(e=>{const r=new Date(e.week_start);if(1===t)return Kt(r,a);{const e=new Date(a),t=new Date(n);return t.setDate(t.getDate()-7),r>=e&&r<=t}});if(0===r.length&&0===s.length)return null;const i=ua(r),o=ua(s),l=Math.round(10*(i-o))/10,c=0===o?0:Math.round(l/Math.abs(o)*100);let d,u;return Math.abs(l)<.2?(d="stable",u="\u2192"):l>0?(d="improving",u="\u2191"):(d="declining",u="\u2193"),{currentScore:i,previousScore:o,change:l,percentChange:c,trend:d,trendIcon:u}}([...g,...y]),C=y.map(e=>da(e)),D=_.map(e=>({key:e.key,label:e.label,min:e.min,max:e.max,count:0,percentage:0,color:e.color}));C.forEach(e=>{const t=D.find(t=>e>=t.min&&e<t.max);t&&(t.count+=1)});const T=C.length;D.forEach(e=>{e.percentage=0===T?0:Math.round(e.count/T*1e3)/10});const O=(null===(e=S.find(e=>"critical"===e.key))||void 0===e?void 0:e.count)||0,P=((null===(r=S.find(e=>"excellent"===e.key))||void 0===r?void 0:r.count)||0)+((null===(a=S.find(e=>"good"===e.key))||void 0===a?void 0:a.count)||0),I={totalReviews:k,averageScore:E,buckets:S,topPerformers:j,bottomPerformers:N,criticalCount:O,goodOrExcellentCount:P,trendLabel:A?A.trend:void 0,trendChange:A?A.change:void 0,trendPercent:A?A.percentChange:void 0,trendIcon:A?A.trendIcon:void 0,trendType:A?A.trend:void 0},R=w.filter(e=>e.averageScore<.5).map(e=>({userId:e.userId,name:e.name,score:e.averageScore}));l(I),d(D),x(R)}catch(BM){console.error("Error loading score distribution analytics:",BM),l(null)}finally{s(!1)}};return a?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Pt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,Pt.jsx)(iM,{className:"h-5 w-5 mr-2 text-purple-600"}),"Score Distribution Analytics"]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Current week review score distribution across all criteria averages."})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsx)("button",{onClick:()=>h(!u),className:"px-4 py-2 rounded-lg font-medium text-sm transition-colors flex items-center ".concat(u?"bg-purple-100 text-purple-700 hover:bg-purple-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),title:"Toggle between count and percentage view",children:u?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(uM,{className:"h-4 w-4 mr-1"}),"Percentage"]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(hM,{className:"h-4 w-4 mr-1"}),"Count"]})}),(0,Pt.jsxs)("button",{onClick:async()=>{if(0===y.length)return void alert("No low performers to send reminders to.");if(window.confirm("Send review reminders to ".concat(y.length," low performer").concat(y.length>1?"s":""," (score < 0.5)?\n\nThis will notify them to improve their review scores."))){p(!0),g(null);try{const e=await(0,kt.getDocs)((0,kt.collection)(Nt.db,"users")),t={};e.docs.forEach(e=>{t[e.id]=(0,o.A)({id:e.id},e.data())});let n=0,r=0;for(const a of y){const e=t[a.userId];if(!e){r++;continue}const s=[];if(e.isMentor){const t=(0,kt.collection)(Nt.db,"users"),n=(0,kt.query)(t,(0,kt._M)("mentor_id","==",e.id)),r=await(0,kt.getDocs)(n);for(const e of r.docs){const t=(0,o.A)({id:e.id},e.data());s.push({user_id:t.id,user_name:t.name,role:"mentee"})}}if(e.mentor_id){const t=await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",e.mentor_id)));if(!t.empty){const n=t.docs[0].data();s.push({user_id:e.mentor_id,user_name:n.name,role:"mentor"})}}if(0===s.length)continue;await Nn.sendReminder(e,"morning_reminder",s,void 0)?n++:r++}g("\u2705 Reminders sent to ".concat(n," user").concat(1!==n?"s":"").concat(r>0?" (".concat(r," failed)"):"")),setTimeout(()=>g(null),5e3)}catch(e){console.error("Error sending bulk reminders:",e),alert("Failed to send reminders. Please try again.")}finally{p(!1)}}},disabled:m||0===y.length,className:"px-4 py-2 rounded-lg font-medium text-sm transition-colors flex items-center ".concat(0===y.length||m?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-orange-500 text-white hover:bg-orange-600"),title:"Send reminders to ".concat(y.length," low performer").concat(1!==y.length?"s":""),children:[(0,Pt.jsx)(WI,{className:"h-4 w-4 mr-1"}),m?"Sending...":"Remind Low Performers (".concat(y.length,")")]})]})]}),f&&(0,Pt.jsx)("div",{className:"mt-4 bg-green-50 border border-green-200 rounded-lg p-3",children:(0,Pt.jsx)("p",{className:"text-sm text-green-800",children:f})})]}),i&&0!==i.totalReviews?(0,Pt.jsxs)("div",{className:"p-6 space-y-8",children:[(0,Pt.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,Pt.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-purple-700",children:"Avg Score"}),(0,Pt.jsx)(mM,{className:"h-4 w-4 text-purple-600"})]}),(0,Pt.jsx)("p",{className:"mt-2 text-2xl font-semibold text-purple-900",children:i.averageScore.toFixed(1)}),void 0!==i.trendChange&&(0,Pt.jsxs)("p",{className:"text-xs mt-1 flex items-center",children:[null!==i&&void 0!==i&&i.trendType?"improving"===i.trendType?(0,Pt.jsx)($n,{className:"h-5 w-5 text-green-600"}):"declining"===i.trendType?(0,Pt.jsx)(sM,{className:"h-5 w-5 text-red-600"}):(0,Pt.jsx)(aM,{className:"h-5 w-5 text-gray-400"}):(0,Pt.jsx)(aM,{className:"h-5 w-5 text-gray-400"}),(0,Pt.jsxs)("span",{className:"ml-1 ".concat("improving"===i.trendType?"text-green-600":"declining"===i.trendType?"text-red-600":"text-gray-600"),children:["Week ","improving"===i.trendType?"up":"declining"===i.trendType?"down":"stable"," ",i.trendChange>0?"+":"",i.trendChange.toFixed(1)]})]})]}),(0,Pt.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-green-700",children:"Good / Excellent"}),(0,Pt.jsx)($l,{className:"h-4 w-4 text-green-600"})]}),(0,Pt.jsx)("p",{className:"mt-2 text-2xl font-semibold text-green-900",children:i.goodOrExcellentCount}),(0,Pt.jsxs)("p",{className:"text-xs text-green-700 mt-1",children:[Math.round(i.goodOrExcellentCount/(i.totalReviews||1)*100),"% of reviews"]})]}),(0,Pt.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-red-700",children:"Critical"}),(0,Pt.jsx)(oa,{className:"h-4 w-4 text-red-600"})]}),(0,Pt.jsx)("p",{className:"mt-2 text-2xl font-semibold text-red-900",children:i.criticalCount}),(0,Pt.jsxs)("p",{className:"text-xs text-red-700 mt-1",children:[Math.round(i.criticalCount/(i.totalReviews||1)*100),"% require attention"]})]}),(0,Pt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"Total Reviews"}),(0,Pt.jsx)(er,{className:"h-4 w-4 text-blue-600"})]}),(0,Pt.jsx)("p",{className:"mt-2 text-2xl font-semibold text-blue-900",children:i.totalReviews}),(0,Pt.jsx)("p",{className:"text-xs text-blue-700 mt-1",children:"Current week coverage"})]})]}),i.criticalCount/i.totalReviews>.2&&(0,Pt.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(oa,{className:"h-5 w-5 text-red-600 mr-3"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-red-800",children:"High Critical Proportion"}),(0,Pt.jsxs)("p",{className:"text-xs text-red-700 mt-1",children:[Math.round(i.criticalCount/i.totalReviews*100),"% of reviews are in Critical range. Consider targeted interventions."]})]})]})}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,Pt.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Current Week Distribution"}),(0,Pt.jsx)("div",{className:"h-64",children:(0,Pt.jsx)(bc,{width:"100%",height:"100%",children:(0,Pt.jsxs)(dM,{data:i.buckets,margin:{top:10,right:10,left:0,bottom:0},children:[(0,Pt.jsx)(wA,{strokeDasharray:"3 3"}),(0,Pt.jsx)(PA,{dataKey:"label",tick:{fontSize:11}}),(0,Pt.jsx)(WA,{allowDecimals:!1,label:{value:u?"Percentage (%)":"Count",angle:-90,position:"insideLeft",style:{fontSize:12}}}),(0,Pt.jsx)(jT,{formatter:(e,t,n)=>u?["".concat(e,"%"),"Percentage"]:["".concat(e," reviews"),"Count"]}),(0,Pt.jsx)(ZP,{dataKey:u?"percentage":"count",children:i.buckets.map((e,t)=>(0,Pt.jsx)(fO,{fill:e.color},"cell-".concat(t)))})]})})})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,Pt.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["Last ",n," Weeks Aggregate Distribution"]}),(0,Pt.jsx)("div",{className:"h-48",children:(0,Pt.jsx)(bc,{width:"100%",height:"100%",children:(0,Pt.jsxs)(dM,{data:c,margin:{top:10,right:10,left:0,bottom:0},children:[(0,Pt.jsx)(PA,{dataKey:"label",tick:{fontSize:11}}),(0,Pt.jsx)(WA,{allowDecimals:!1,label:{value:u?"Percentage (%)":"Count",angle:-90,position:"insideLeft",style:{fontSize:12}}}),(0,Pt.jsx)(jT,{formatter:e=>u?["".concat(e,"%"),"Percentage"]:["".concat(e," reviews"),"Count"]}),(0,Pt.jsx)(ZP,{dataKey:u?"percentage":"count",children:c.map((e,t)=>(0,Pt.jsx)(fO,{fill:e.color},"cell-agg-".concat(t)))})]})})})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Pt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,Pt.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Performers"}),(0,Pt.jsxs)("ul",{className:"divide-y divide-gray-200",children:[i.topPerformers.map(e=>(0,Pt.jsxs)("li",{className:"py-2 flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:e.status})]}),(0,Pt.jsx)("span",{className:"text-sm font-semibold text-green-600",children:e.averageScore.toFixed(1)})]},e.userId)),0===i.topPerformers.length&&(0,Pt.jsx)("li",{className:"py-2 text-sm text-gray-500",children:"No data"})]})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,Pt.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Lowest Performers"}),(0,Pt.jsxs)("ul",{className:"divide-y divide-gray-200",children:[i.bottomPerformers.map(e=>(0,Pt.jsxs)("li",{className:"py-2 flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:e.status})]}),(0,Pt.jsx)("span",{className:"text-sm font-semibold text-red-600",children:e.averageScore.toFixed(1)})]},e.userId)),0===i.bottomPerformers.length&&(0,Pt.jsx)("li",{className:"py-2 text-sm text-gray-500",children:"No data"})]})]})]})]}):(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(iM,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"No review scores available for the current week."})]})]})},fM=Un("chart-no-axes-column",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]]),gM=e=>{let{filters:t,weeksLookback:n=4}=e;const{getCachedData:a}=Bt(),[s,i]=(0,r.useState)(!0),[o,l]=(0,r.useState)([]),[c,d]=(0,r.useState)([]),u={morning_exercise:"Morning Exercise",communication:"Communication",academic_effort:"Academic Effort",campus_contribution:"Campus Contribution",behavioural:"Behavioural",mentorship_level:"Mentorship Level"};(0,r.useEffect)(()=>{m()},[t,n]);const h=async()=>{try{const e=qt(),r=(0,kt.collection)(Nt.db,"mentee_reviews"),a=(0,kt.collection)(Nt.db,"mentor_reviews"),s=(0,kt.query)(r,(0,kt._M)("week_start","==",e)),i=(0,kt.query)(a,(0,kt._M)("week_start","==",e)),[o,l]=await Promise.all([(0,kt.getDocs)(s),(0,kt.getDocs)(i)]),c=new Date(e);c.setDate(c.getDate()-7*n);const d=(0,kt.query)(r,(0,kt._M)("week_start",">=",c),(0,kt._M)("week_start","<",e)),h=(0,kt.query)(a,(0,kt._M)("week_start",">=",c),(0,kt._M)("week_start","<",e)),[m,p]=await Promise.all([(0,kt.getDocs)(d),(0,kt.getDocs)(h)]),f=e=>null!==t&&void 0!==t&&t.campus||null!==t&&void 0!==t&&t.house?e.filter(e=>{const n=e.data();return(!t.campus||n.campus===t.campus)&&(!t.house||n.house===t.house)}):e,g=[...f(o.docs),...f(l.docs)],y=[...f(m.docs),...f(p.docs)],x=[],v=[];Object.entries(u).forEach(e=>{let[t,n]=e;const r=g.map(e=>e.data()[t]).filter(e=>"number"===typeof e),a=y.map(e=>e.data()[t]).filter(e=>"number"===typeof e);if(0===r.length)return;const s=r.reduce((e,t)=>e+t,0)/r.length,i=Math.max(...r),o=Math.min(...r),l=a.length>0?a.reduce((e,t)=>e+t,0)/a.length:s,c=s-l;let d,u="stable";c>.2?u="improving":c<-.2&&(u="declining"),d=s>=1.5?"excellent":s>=.5?"good":s>=-.5?"average":s>=-1.5?"poor":"critical",x.push({name:n,key:t,averageScore:Math.round(10*s)/10,highestScore:Math.round(10*i)/10,lowestScore:Math.round(10*o)/10,trend:u,trendChange:Math.round(10*c)/10,reviewCount:r.length,status:d}),"critical"===d?v.push("\ud83d\udea8 ".concat(n," is critical (avg: ").concat(s.toFixed(1),"). Requires immediate campus-wide intervention.")):"declining"===u&&c<-.3?v.push("\u26a0\ufe0f ".concat(n," declining significantly (-").concat(Math.abs(c).toFixed(1),"). Review campus policies.")):"excellent"===d&&"improving"===u&&v.push("\ud83c\udf1f ".concat(n," excelling (").concat(s.toFixed(1),") and improving. Share best practices!"))}),x.sort((e,t)=>t.averageScore-e.averageScore);const b=x.filter(e=>"excellent"===e.status).length,w=x.filter(e=>"critical"===e.status).length,j=x.filter(e=>"improving"===e.trend).length,N=x.filter(e=>"declining"===e.trend).length;return b===x.length?v.unshift("\ud83c\udf89 All criteria performing excellently! Outstanding campus performance."):w>x.length/2?v.unshift("\ud83d\udea8 URGENT: Majority of criteria critical. Campus-wide action plan needed."):j>N?v.unshift("\u2705 Positive trend: More criteria improving than declining."):N>j&&v.unshift("\u26a0\ufe0f Concern: More criteria declining. Review recent campus changes."),{performances:x,insights:v}}catch(e){throw console.error("Error loading criteria performance:",e),e}},m=async()=>{i(!0);try{const e=zt("criteria_performance",{campus:null===t||void 0===t?void 0:t.campus,house:null===t||void 0===t?void 0:t.house,weeksLookback:n}),r=await a(e,h,3e5);l(r.performances),d(r.insights)}catch(e){console.error("Error loading criteria performance:",e)}finally{i(!1)}},p=e=>{switch(e){case"excellent":return"bg-green-100 text-green-800 border-green-300";case"good":return"bg-blue-100 text-blue-800 border-blue-300";case"average":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"poor":return"bg-orange-100 text-orange-800 border-orange-300";case"critical":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},f=e=>"critical"===e.status?"Launch campus-wide initiative focusing on ".concat(e.name.toLowerCase(),". Consider workshops, mentorship programs, or policy changes."):"declining"===e.trend?"Investigate recent changes affecting ".concat(e.name.toLowerCase(),". Survey students and mentors for feedback."):"excellent"===e.status&&"improving"===e.trend?"Document and share successful strategies for ".concat(e.name.toLowerCase()," across other campuses."):"poor"===e.status?"Provide additional support and resources for ".concat(e.name.toLowerCase(),". Consider targeted interventions."):"Maintain current approach for ".concat(e.name.toLowerCase(),". Monitor for changes.");return s?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Pt.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,Pt.jsx)("div",{className:"flex items-center justify-between",children:(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,Pt.jsx)(fM,{className:"h-5 w-5 mr-2 text-purple-600"}),"Campus-Wide Criteria Performance"]}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Analysis of all review criteria across ",(null===t||void 0===t?void 0:t.campus)||"all campuses"]})]})})}),0===o.length?(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(fM,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"No criteria data available for analysis."})]}):(0,Pt.jsxs)("div",{className:"p-6 space-y-6",children:[c.length>0&&(0,Pt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,Pt.jsxs)("h4",{className:"text-sm font-semibold text-blue-900 flex items-center mb-3",children:[(0,Pt.jsx)(Yn,{className:"h-4 w-4 mr-2"}),"Key Insights & Recommendations"]}),(0,Pt.jsx)("ul",{className:"space-y-2",children:c.map((e,t)=>(0,Pt.jsxs)("li",{className:"text-sm text-blue-800 flex items-start",children:[(0,Pt.jsx)("span",{className:"mr-2",children:"\u2022"}),(0,Pt.jsx)("span",{children:e})]},t))})]}),(0,Pt.jsx)("div",{className:"overflow-x-auto",children:(0,Pt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Criteria"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Score"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Range"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trend"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reviews"})]})}),(0,Pt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(e=>{return(0,Pt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pt.jsx)("td",{className:"px-6 py-4",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:["excellent"===e.status&&(0,Pt.jsx)($l,{className:"h-4 w-4 text-green-600 mr-2"}),"critical"===e.status&&(0,Pt.jsx)(Hn,{className:"h-4 w-4 text-red-600 mr-2"}),(0,Pt.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name})]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-center",children:(0,Pt.jsxs)("span",{className:"text-sm font-semibold ".concat(e.averageScore>=1.5?"text-green-600":e.averageScore>=.5?"text-blue-600":e.averageScore>=-.5?"text-yellow-600":"text-red-600"),children:[e.averageScore>0?"+":"",e.averageScore.toFixed(1)]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-center",children:(0,Pt.jsxs)("span",{className:"text-xs text-gray-600",children:[e.lowestScore.toFixed(1)," to ",e.highestScore.toFixed(1)]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-center",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-center",children:[(t=e.trend,e.trendChange,"improving"===t?(0,Pt.jsx)($n,{className:"h-4 w-4 text-green-600"}):"declining"===t?(0,Pt.jsx)(sM,{className:"h-4 w-4 text-red-600"}):(0,Pt.jsx)(aM,{className:"h-4 w-4 text-gray-400"})),(0,Pt.jsxs)("span",{className:"ml-1 text-sm ".concat("improving"===e.trend?"text-green-600":"declining"===e.trend?"text-red-600":"text-gray-500"),children:[e.trendChange>0?"+":"",e.trendChange.toFixed(1)]})]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-center",children:(0,Pt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ".concat(p(e.status)),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-center text-sm text-gray-500",children:e.reviewCount})]},e.key);var t})})]})}),(0,Pt.jsxs)("div",{className:"space-y-4",children:[(0,Pt.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center",children:[(0,Pt.jsx)(sM,{className:"h-4 w-4 mr-2 text-purple-600"}),"Action Recommendations"]}),o.map(e=>(0,Pt.jsxs)("div",{className:"border rounded-lg p-4 ".concat("critical"===e.status?"border-red-300 bg-red-50":"excellent"===e.status?"border-green-300 bg-green-50":"border-gray-200 bg-gray-50"),children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pt.jsx)("span",{className:"font-medium text-gray-900",children:e.name}),(0,Pt.jsx)("span",{className:"text-xs font-semibold ".concat(p(e.status)," px-2 py-1 rounded"),children:e.status.toUpperCase()})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-700",children:f(e)})]},e.key))]})]})]})},yM=Un("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),xM=e=>{let{filters:t}=e;const[n,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[l,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(""),[h,m]=(0,r.useState)([]),[p,f]=(0,r.useState)(!1),[g,y]=(0,r.useState)(null);(0,r.useEffect)(()=>{x(),v()},[t]);const x=async()=>{i(!0);try{const n=qt(),r=(0,kt.collection)(Nt.db,"users"),s=await(0,kt.getDocs)(r),i=[];for(const a of s.docs){const r=a.data();if(null!==t&&void 0!==t&&t.campus&&r.campus!==t.campus)continue;if(null!==t&&void 0!==t&&t.house&&r.house!==t.house)continue;let s=0;if(r.isMentor&&r.mentees)for(const e of r.mentees){const t=(0,kt.query)((0,kt.collection)(Nt.db,"mentee_reviews"),(0,kt._M)("reviewer_id","==",a.id),(0,kt._M)("reviewee_id","==",e),(0,kt._M)("week_start","==",n));(await(0,kt.getDocs)(t)).empty&&s++}if(r.mentor_id){const e=(0,kt.query)((0,kt.collection)(Nt.db,"mentor_reviews"),(0,kt._M)("reviewer_id","==",a.id),(0,kt._M)("reviewee_id","==",r.mentor_id),(0,kt._M)("week_start","==",n));(await(0,kt.getDocs)(e)).empty&&s++}if(s>0){var e;const t=(0,kt.query)((0,kt.collection)(Nt.db,"review_reminders"),(0,kt._M)("user_id","==",a.id),(0,kt._M)("status","==","sent")),n=await(0,kt.getDocs)(t),o=n.docs.length>0?null===(e=n.docs[0].data().sent_at)||void 0===e?void 0:e.toDate():void 0;i.push({id:a.id,name:r.name||"Unknown",email:r.email||"",role:r.role||"student",pendingCount:s,lastReminder:o,selected:!1})}}a(i)}catch(n){console.error("Error loading users:",n)}finally{i(!1)}},v=async()=>{try{const e=(0,kt.collection)(Nt.db,"bulk_reminder_history"),t=(0,kt.query)(e),n=(await(0,kt.getDocs)(t)).docs.map(e=>{var t;const n=e.data();return{id:e.id,sentAt:(null===(t=n.sent_at)||void 0===t?void 0:t.toDate())||new Date,recipientCount:n.recipient_count||0,successCount:n.success_count||0,failureCount:n.failure_count||0,message:n.message||"Review reminder"}});n.sort((e,t)=>t.sentAt.getTime()-e.sentAt.getTime()),m(n.slice(0,10))}catch(e){console.error("Error loading reminder history:",e)}},b=n.filter(e=>e.selected).length;return s?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Pt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,Pt.jsx)(WI,{className:"h-5 w-5 mr-2 text-purple-600"}),"Bulk Reminder System"]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Select users and send review reminders"})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsxs)("button",{onClick:()=>f(!p),className:"px-4 py-2 rounded-lg font-medium text-sm transition-colors flex items-center bg-gray-100 text-gray-700 hover:bg-gray-200",children:[(0,Pt.jsx)(yM,{className:"h-4 w-4 mr-1"}),"History"]}),(0,Pt.jsxs)("button",{onClick:async()=>{const e=n.filter(e=>e.selected);if(0===e.length)return void alert("Please select at least one user.");if(window.confirm("Send reminders to ".concat(e.length," user").concat(e.length>1?"s":"","?"))){c(!0),y(null);try{const n=await(0,kt.getDocs)((0,kt.collection)(Nt.db,"users")),c={};n.docs.forEach(e=>{c[e.id]=(0,o.A)({id:e.id},e.data())});let u=0,h=0;for(const t of e){const e=c[t.id];if(!e){h++;continue}const n=[],a=qt(),o=e.mentees;if(e.isMentor&&o)for(const t of o){const i=(0,kt.query)((0,kt.collection)(Nt.db,"mentee_reviews"),(0,kt._M)("reviewer_id","==",e.id),(0,kt._M)("reviewee_id","==",t),(0,kt._M)("week_start","==",a));if((await(0,kt.getDocs)(i)).empty){var r,s;const e=(null===(r=(await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",t)))).docs[0])||void 0===r||null===(s=r.data())||void 0===s?void 0:s.name)||"Unknown";n.push({user_id:t,user_name:e,role:"mentee"})}}if(e.mentor_id){const t=(0,kt.query)((0,kt.collection)(Nt.db,"mentor_reviews"),(0,kt._M)("reviewer_id","==",e.id),(0,kt._M)("reviewee_id","==",e.mentor_id),(0,kt._M)("week_start","==",a));if((await(0,kt.getDocs)(t)).empty){var i,l;const t=(null===(i=(await(0,kt.getDocs)((0,kt.query)((0,kt.collection)(Nt.db,"users"),(0,kt._M)("__name__","==",e.mentor_id)))).docs[0])||void 0===i||null===(l=i.data())||void 0===l?void 0:l.name)||"Unknown";n.push({user_id:e.mentor_id,user_name:t,role:"mentor"})}}if(0===n.length)continue;await Nn.sendReminder(e,"morning_reminder",n,void 0)?u++:h++}await(0,kt.gS)((0,kt.collection)(Nt.db,"bulk_reminder_history"),{sent_at:kt.Timestamp.fromDate(new Date),recipient_count:e.length,success_count:u,failure_count:h,message:d||"Review reminder",filters:t||{}}),y("\u2705 Sent ".concat(u," reminder").concat(1!==u?"s":"").concat(h>0?" (".concat(h," failed)"):"")),a(e=>e.map(e=>(0,o.A)((0,o.A)({},e),{},{selected:!1}))),await v(),setTimeout(()=>y(null),5e3)}catch(u){console.error("Error sending bulk reminders:",u),alert("Failed to send reminders. Please try again.")}finally{c(!1)}}},disabled:l||0===b,className:"px-4 py-2 rounded-lg font-medium text-sm transition-colors flex items-center ".concat(0===b||l?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-orange-500 text-white hover:bg-orange-600"),children:[(0,Pt.jsx)(aR,{className:"h-4 w-4 mr-1"}),l?"Sending...":"Send to ".concat(b," Selected")]})]})]}),g&&(0,Pt.jsx)("div",{className:"mt-4 bg-green-50 border border-green-200 rounded-lg p-3",children:(0,Pt.jsx)("p",{className:"text-sm text-green-800",children:g})})]}),p&&h.length>0&&(0,Pt.jsxs)("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:[(0,Pt.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Recent Reminder History"}),(0,Pt.jsx)("div",{className:"space-y-2",children:h.map(e=>(0,Pt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-3 flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("p",{className:"text-sm text-gray-900",children:[e.sentAt.toLocaleDateString()," ",e.sentAt.toLocaleTimeString()]}),(0,Pt.jsxs)("p",{className:"text-xs text-gray-600",children:[e.recipientCount," recipients \u2022 ",e.successCount," sent \u2022 ",e.failureCount," failed"]})]}),(0,Pt.jsx)("div",{className:"flex items-center",children:0===e.failureCount?(0,Pt.jsx)(qn,{className:"h-5 w-5 text-green-600"}):(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-yellow-600"})})]},e.id))})]}),0===n.length?(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)(er,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"No users with pending reviews found."})]}):(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsxs)("div",{className:"mb-4",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Message (Optional)"}),(0,Pt.jsx)("textarea",{value:d,onChange:e=>u(e.target.value),placeholder:"Add a custom note to the reminder...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",rows:2})]}),(0,Pt.jsx)("div",{className:"overflow-x-auto",children:(0,Pt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Pt.jsx)("thead",{className:"bg-gray-50",children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{className:"px-4 py-3 text-left",children:(0,Pt.jsx)("input",{type:"checkbox",checked:n.length>0&&n.every(e=>e.selected),onChange:()=>{const e=n.every(e=>e.selected);a(t=>t.map(t=>(0,o.A)((0,o.A)({},t),{},{selected:!e})))},className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"})}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pending"}),(0,Pt.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Reminder"})]})}),(0,Pt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(e=>(0,Pt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Pt.jsx)("td",{className:"px-4 py-4",children:(0,Pt.jsx)("input",{type:"checkbox",checked:e.selected,onChange:()=>{return t=e.id,void a(e=>e.map(e=>e.id===t?(0,o.A)((0,o.A)({},e),{},{selected:!e.selected}):e));var t},className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"})}),(0,Pt.jsx)("td",{className:"px-6 py-4",children:(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,Pt.jsx)("p",{className:"text-xs text-gray-500",children:e.email})]})}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-center",children:(0,Pt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.role})}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-center",children:(0,Pt.jsx)("span",{className:"text-sm font-semibold text-orange-600",children:e.pendingCount})}),(0,Pt.jsx)("td",{className:"px-6 py-4 text-center text-xs text-gray-500",children:e.lastReminder?e.lastReminder.toLocaleDateString():"Never"})]},e.id))})]})})]})]})},vM=["Dantewada","Dharamshala","Eternal","Jashpur","Kishanganj","Pune","Raigarh","Sarjapura"],bM=["Bageshree","Malhar","Bhairav"],wM=()=>{const{getCachedData:e,invalidateCache:t}=Bt(),[n,a]=(0,r.useState)({totalUsers:0,completed:0,pending:0,overdue:0,completionRate:0}),[s,i]=(0,r.useState)({campus:"all",house:"all",role:"all",dateRange:"current_week"}),[l,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1),h=r.useCallback(async()=>{try{const t=(0,kt.collection)(Nt.db,"users");let n=(0,kt.query)(t,(0,kt._M)("role","in",["student","mentor"]));"all"!==s.role&&(n=(0,kt.query)(t,(0,kt._M)("role","==",s.role)));const r=await(0,kt.getDocs)(n),a=r.size,i=qt(),o=Ht(i),l=Wt(o);let c=0,d=0,u=0;for(const s of r.docs){const t=s.data();if("mentor"===t.role){var e;const n=(0,kt.collection)(Nt.db,"mentee_reviews"),r=(0,kt.query)(n,(0,kt._M)("reviewer_id","==",s.id),(0,kt._M)("week_start","==",i)),a=await(0,kt.getDocs)(r),o=(null===(e=t.mentees)||void 0===e?void 0:e.length)||0;a.size>=o&&o>0?c++:l>0?u++:d++}if("student"===t.role){const e=(0,kt.collection)(Nt.db,"mentor_reviews"),t=(0,kt.query)(e,(0,kt._M)("reviewer_id","==",s.id),(0,kt._M)("week_start","==",i));(await(0,kt.getDocs)(t)).size>0?c++:l>0?u++:d++}}return{totalUsers:a,completed:c,pending:d,overdue:u,completionRate:a>0?c/a*100:0}}catch(t){throw console.error("Error loading compliance data:",t),t}},[s]),m=r.useCallback(async function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c(!0);try{const r=zt("admin_compliance_stats",{role:s.role,campus:s.campus,house:s.house,dateRange:s.dateRange});n&&(console.log("[AdminReviewCompliance] Force refresh - clearing cache"),t(r));const i=await e(r,h,3e5);a(i)}catch(r){console.error("Error loading compliance data:",r)}finally{c(!1),u(!1)}},[s,e,t,h]);(0,r.useEffect)(()=>{m()},[m]);return l?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Review Compliance"}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-1",children:"Monitor review submission status across campus"})]}),(0,Pt.jsxs)("div",{className:"flex space-x-3",children:[(0,Pt.jsxs)("button",{onClick:()=>{u(!0),m(!0)},disabled:d,className:"flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[(0,Pt.jsx)(Hl,{className:"h-4 w-4 mr-2 ".concat(d?"animate-spin":"")}),"Refresh"]}),(0,Pt.jsxs)("button",{onClick:()=>{alert("Export functionality coming in next task!")},className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[(0,Pt.jsx)(eM,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Pt.jsx)(tM,{className:"h-5 w-5 text-gray-600 mr-2"}),(0,Pt.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Campus"}),(0,Pt.jsxs)("select",{value:s.campus,onChange:e=>i((0,o.A)((0,o.A)({},s),{},{campus:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,Pt.jsx)("option",{value:"all",children:"All Campuses"}),vM.map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"House"}),(0,Pt.jsxs)("select",{value:s.house,onChange:e=>i((0,o.A)((0,o.A)({},s),{},{house:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,Pt.jsx)("option",{value:"all",children:"All Houses"}),bM.map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),(0,Pt.jsxs)("select",{value:s.role,onChange:e=>i((0,o.A)((0,o.A)({},s),{},{role:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,Pt.jsx)("option",{value:"all",children:"All Roles"}),(0,Pt.jsx)("option",{value:"student",children:"Students"}),(0,Pt.jsx)("option",{value:"mentor",children:"Mentors"})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),(0,Pt.jsxs)("select",{value:s.dateRange,onChange:e=>i((0,o.A)((0,o.A)({},s),{},{dateRange:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,Pt.jsx)("option",{value:"current_week",children:"Current Week"}),(0,Pt.jsx)("option",{value:"last_4_weeks",children:"Last 4 Weeks"}),(0,Pt.jsx)("option",{value:"all_time",children:"All Time"})]})]})]})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Total Users"}),(0,Pt.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:n.totalUsers})]}),(0,Pt.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,Pt.jsx)(er,{className:"h-6 w-6 text-blue-600"})})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Completed"}),(0,Pt.jsx)("p",{className:"text-3xl font-bold text-green-600",children:n.completed})]}),(0,Pt.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,Pt.jsx)(qn,{className:"h-6 w-6 text-green-600"})})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Pending"}),(0,Pt.jsx)("p",{className:"text-3xl font-bold text-yellow-600",children:n.pending})]}),(0,Pt.jsx)("div",{className:"p-3 bg-yellow-100 rounded-lg",children:(0,Pt.jsx)(la,{className:"h-6 w-6 text-yellow-600"})})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Overdue"}),(0,Pt.jsx)("p",{className:"text-3xl font-bold text-red-600",children:n.overdue})]}),(0,Pt.jsx)("div",{className:"p-3 bg-red-100 rounded-lg",children:(0,Pt.jsx)(oa,{className:"h-6 w-6 text-red-600"})})]})}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Completion Rate"}),(0,Pt.jsxs)("p",{className:"text-3xl font-bold text-purple-600",children:[n.completionRate.toFixed(1),"%"]})]}),(0,Pt.jsx)("div",{className:"p-3 bg-purple-100 rounded-lg",children:(0,Pt.jsx)($n,{className:"h-6 w-6 text-purple-600"})})]}),(0,Pt.jsx)("div",{className:"mt-4",children:(0,Pt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Pt.jsx)("div",{className:"h-2 rounded-full transition-all ".concat(n.completionRate>=85?"bg-green-600":n.completionRate>=70?"bg-yellow-600":"bg-red-600"),style:{width:"".concat(n.completionRate,"%")}})})})]})]}),n.completionRate<85&&(0,Pt.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(oa,{className:"h-5 w-5 text-yellow-600 mr-3"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-yellow-800",children:"Low Completion Rate Alert"}),(0,Pt.jsxs)("p",{className:"text-sm text-yellow-700 mt-1",children:["Current completion rate is ",n.completionRate.toFixed(1),"%. Target is 85% or higher. Consider sending bulk reminders to pending users."]})]})]})}),n.overdue>0&&(0,Pt.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-lg",children:(0,Pt.jsxs)("div",{className:"flex items-center",children:[(0,Pt.jsx)(oa,{className:"h-5 w-5 text-red-600 mr-3"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{className:"text-sm font-medium text-red-800",children:"Overdue Reviews Detected"}),(0,Pt.jsxs)("p",{className:"text-sm text-red-700 mt-1",children:[n.overdue," user",n.overdue>1?"s have":" has"," overdue reviews. Send escalation reminders or follow up individually."]})]})]})}),(0,Pt.jsx)("div",{className:"mt-6",children:(0,Pt.jsx)(nM,{filters:s})}),(0,Pt.jsx)("div",{className:"mt-6",children:(0,Pt.jsx)(rM,{filters:s})}),(0,Pt.jsx)("div",{className:"mt-6",children:(0,Pt.jsx)(oM,{viewType:"all",filters:s})}),(0,Pt.jsx)("div",{className:"mt-6",children:(0,Pt.jsx)(lM,{filters:s,weeksToShow:8})}),(0,Pt.jsx)("div",{className:"mt-6",children:(0,Pt.jsx)(pM,{filters:s,weeksLookback:4})}),(0,Pt.jsx)("div",{className:"mt-6",children:(0,Pt.jsx)(gM,{filters:s,weeksLookback:4})}),(0,Pt.jsx)("div",{className:"mt-6",children:(0,Pt.jsx)(xM,{filters:s})})]})},jM=()=>{const{userData:e}=Rt(),[t,n]=(0,r.useState)([]),[a,s]=(0,r.useState)(new Map),[i,o]=(0,r.useState)(new Map),[l,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(null),[h,m]=(0,r.useState)(""),[p,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{g()},[]);const g=async()=>{try{c(!0);const[e,t,r]=await Promise.all([zl.getAllPendingApprovals(),on.getAllPhases(),_t.B.getAll(_t.I.USERS)]);n(e);const a=new Map(t.map(e=>[e.id,e])),i=new Map(r.map(e=>[e.id,e]));s(a),o(i)}catch(e){console.error("Error loading approval data:",e)}finally{c(!1)}};return l?(0,Pt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,Pt.jsx)("div",{className:"text-lg",children:"Loading approval requests..."})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,Pt.jsx)(Wl,{className:"h-6 w-6 text-blue-600"}),"Phase Approval Requests"]}),(0,Pt.jsx)("p",{className:"text-muted-foreground",children:"Review and approve student requests to access next phases"})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:[(0,Pt.jsx)(la,{className:"h-4 w-4"}),t.length," Pending"]})]}),0===t.length?(0,Pt.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border",children:[(0,Pt.jsx)(qn,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,Pt.jsx)("h3",{className:"text-lg font-medium mb-2",children:"All caught up!"}),(0,Pt.jsx)("p",{className:"text-muted-foreground",children:"No pending phase approval requests at the moment."})]}):(0,Pt.jsx)("div",{className:"grid gap-4",children:t.map(t=>{const n=i.get(t.student_id),r=a.get(t.current_phase_id),s=a.get(t.next_phase_id),o=d===t.id,l=p===t.id;return(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[(0,Pt.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:(null===n||void 0===n?void 0:n.name)||"Unknown Student"}),(0,Pt.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)("span",{className:"font-medium",children:"Current Phase:"}),(0,Pt.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded",children:(null===r||void 0===r?void 0:r.name)||"Unknown"})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)("span",{className:"font-medium",children:"Requesting:"}),(0,Pt.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded",children:(null===s||void 0===s?void 0:s.name)||"Unknown"})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)(la,{className:"h-4 w-4"}),(0,Pt.jsxs)("span",{children:["Requested: ",new Date(t.requested_at).toLocaleString()]})]})]})]})}),l?(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-md",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),(0,Pt.jsxs)("div",{className:"flex-1",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Rejection"}),(0,Pt.jsx)("textarea",{value:h,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",rows:3,placeholder:"Explain why this request is being rejected..."})]})]}),(0,Pt.jsxs)("div",{className:"flex gap-3",children:[(0,Pt.jsx)("button",{onClick:()=>{f(null),m("")},className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:()=>(async(e,t)=>{if(h.trim())try{u(e),await zl.rejectPhaseTransition(e,t,h),f(null),m(""),await g()}catch(n){console.error("Error rejecting phase transition:",n),alert("Failed to reject request")}finally{u(null)}else alert("Please provide a reason for rejection")})(t.id,(null===e||void 0===e?void 0:e.id)||""),className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:bg-gray-400",disabled:o||!h.trim(),children:o?"Processing...":"Confirm Rejection"})]})]}):(0,Pt.jsxs)("div",{className:"flex gap-3",children:[(0,Pt.jsxs)("button",{onClick:()=>(async(e,t)=>{try{u(e),await zl.approvePhaseTransition(e,t),await g()}catch(n){console.error("Error approving phase transition:",n),alert("Failed to approve request")}finally{u(null)}})(t.id,(null===e||void 0===e?void 0:e.id)||""),className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-gray-400 flex items-center justify-center gap-2",disabled:o,children:[(0,Pt.jsx)(qn,{className:"h-4 w-4"}),o?"Processing...":"Approve"]}),(0,Pt.jsxs)("button",{onClick:()=>f(t.id),className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:bg-gray-400 flex items-center justify-center gap-2",disabled:o,children:[(0,Pt.jsx)(oR,{className:"h-4 w-4"}),"Reject"]})]})]},t.id)})})]})},NM=Un("webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]),_M=Un("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),SM=["Dantewada","Dharamshala","Eternal","Jashpur","Kishanganj","Pune","Raigarh","Sarjapura"],kM=()=>{const{userData:e}=Rt(),[t,n]=(0,r.useState)({}),[a,s]=(0,r.useState)(null),[i,o]=(0,r.useState)(""),[l,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(null),[h,m]=(0,r.useState)(null),[p,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{g()},[]);const g=async()=>{try{c(!0);const e=await Et.getAllWebhooks(),t={};SM.forEach(n=>{const r=e.find(e=>e.campus===n);t[n]=r||null}),n(t)}catch(e){console.error("Error loading webhooks:",e),m("Failed to load webhooks")}finally{c(!1)}},y=e=>{var n;s(e),o((null===(n=t[e])||void 0===n?void 0:n.webhook_url)||""),m(null),f(null)},x=()=>{s(null),o(""),m(null),f(null)};return l?(0,Pt.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Pt.jsx)(Fl,{className:"h-8 w-8 animate-spin text-primary-600"})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsx)(NM,{className:"h-6 w-6 text-primary-600"}),(0,Pt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Campus Webhook Management"})]}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Configure webhook URLs for each campus to receive notifications and updates."}),p&&(0,Pt.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)(qn,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}),(0,Pt.jsx)("p",{className:"text-sm text-green-800",children:p})]})}),h&&(0,Pt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,Pt.jsx)("p",{className:"text-sm text-red-800",children:h})]})}),(0,Pt.jsx)("div",{className:"grid grid-cols-1 gap-4",children:SM.map(n=>{var r,l,c,h,p,v,b;return(0,Pt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-5 hover:shadow-md transition-shadow",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:n}),t[n]&&(0,Pt.jsx)("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:"Configured"})]}),a===n?(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{htmlFor:"webhook-".concat(n),className:"block text-sm font-medium text-gray-700 mb-2",children:"Webhook URL"}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)(_M,{className:"h-5 w-5 text-gray-400"}),(0,Pt.jsx)("input",{id:"webhook-".concat(n),type:"url",value:i,onChange:e=>o(e.target.value),placeholder:"https://hooks.example.com/webhook/...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)("button",{onClick:()=>(async n=>{if(i.trim()){try{new URL(i)}catch(BM){return void m("Please enter a valid URL")}if(null!==e&&void 0!==e&&e.id&&null!==e&&void 0!==e&&e.name)try{u(n),m(null),await Et.saveWebhook(n,i.trim(),e.id,e.name),Tt.clearWebhookCache(n),f("Webhook URL ".concat(t[n]?"updated":"saved"," successfully for ").concat(n)),await g(),s(null),o(""),setTimeout(()=>f(null),3e3)}catch(r){console.error("Error saving webhook:",r),m("Failed to save webhook URL")}finally{u(null)}else m("User information not available")}else m("Webhook URL cannot be empty")})(n),disabled:d===n,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d===n?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Fl,{className:"h-4 w-4 animate-spin"}),"Saving..."]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(VR,{className:"h-4 w-4"}),"Save"]})}),(0,Pt.jsx)("button",{onClick:x,disabled:d===n,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Cancel"})]})]}):(0,Pt.jsx)("div",{className:"space-y-3",children:t[n]?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("div",{className:"flex items-start gap-2 bg-gray-50 rounded p-3",children:[(0,Pt.jsx)(_M,{className:"h-4 w-4 text-gray-400 flex-shrink-0 mt-1"}),(0,Pt.jsx)("div",{className:"flex-1 min-w-0",children:(0,Pt.jsx)("p",{className:"text-sm text-gray-600 break-all",children:null===(r=t[n])||void 0===r?void 0:r.webhook_url})})]}),(0,Pt.jsxs)("div",{className:"flex flex-col gap-1 text-xs text-gray-500",children:[(null===(l=t[n])||void 0===l?void 0:l.updated_by_name)&&(0,Pt.jsxs)("p",{children:["Last updated by: ",null===(c=t[n])||void 0===c?void 0:c.updated_by_name]}),(null===(h=t[n])||void 0===h?void 0:h.updated_at)&&(0,Pt.jsxs)("p",{children:["Last updated: ",new Date(t[n].updated_at).toLocaleString()]}),!(null!==(p=t[n])&&void 0!==p&&p.updated_by_name)&&(null===(v=t[n])||void 0===v?void 0:v.created_by_name)&&(0,Pt.jsxs)("p",{children:["Created by: ",null===(b=t[n])||void 0===b?void 0:b.created_by_name]})]}),(0,Pt.jsx)("button",{onClick:()=>y(n),className:"px-4 py-2 bg-primary-100 text-primary-700 rounded-lg hover:bg-primary-200 transition-colors font-medium",children:"Update Webhook URL"})]}):(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsx)("p",{className:"text-sm text-gray-500",children:"No webhook configured for this campus"}),(0,Pt.jsx)("button",{onClick:()=>y(n),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium",children:"Add Webhook URL"})]})})]},n)})})]})};class EM{static async getAllAdminNotifications(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{const t=[],n=(0,kt.query)((0,kt.collection)(Nt.db,_t.I.WEBHOOK_CHANGE_NOTIFICATIONS),(0,kt.orderBy)("timestamp","desc"),(0,kt.limit)(e)),r=(await(0,kt.getDocs)(n)).docs.map(e=>{var t;const n=e.data();return{id:e.id,type:"webhook_change",title:"Webhook ".concat(n.change_type),message:"".concat(n.campus," webhook URL ").concat(n.change_type," by ").concat(n.changed_by_name),timestamp:(null===(t=n.timestamp)||void 0===t?void 0:t.toDate())||new Date,read_by:n.read_by||[],related_data:{campus:n.campus,change_type:n.change_type,changed_by_name:n.changed_by_name},created_by:n.changed_by}});t.push(...r);const a=(0,kt.query)((0,kt.collection)(Nt.db,_t.I.NOTIFICATIONS),(0,kt._M)("type","in",["leave_requested","leave_expired_admin"]),(0,kt.orderBy)("created_at","desc"),(0,kt.limit)(e)),s=(await(0,kt.getDocs)(a)).docs.map(e=>{var t;const n=e.data();return{id:e.id,type:n.type,title:n.title||"Leave Notification",message:n.message||"",timestamp:(null===(t=n.created_at)||void 0===t?void 0:t.toDate())||new Date,read_by:n.read_by||[],related_data:{related_leave_id:n.related_leave_id,user_id:n.user_id},user_id:n.user_id}});return t.push(...s),t.sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()),t.slice(0,e)}catch(t){throw console.error("Error fetching all admin notifications:",t),t}}static async getUserNotifications(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{const n=[],r=(0,kt.query)((0,kt.collection)(Nt.db,_t.I.NOTIFICATIONS),(0,kt._M)("user_id","==",e),(0,kt.orderBy)("created_at","desc"),(0,kt.limit)(t)),a=(await(0,kt.getDocs)(r)).docs.map(e=>{var t;const n=e.data();return{id:e.id,type:n.type,title:n.title||"Notification",message:n.message||"",timestamp:(null===(t=n.created_at)||void 0===t?void 0:t.toDate())||new Date,read_by:n.read_by||[],related_data:{related_leave_id:n.related_leave_id,user_id:n.user_id},user_id:n.user_id}});return n.push(...a),n.sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()),n.slice(0,t)}catch(n){throw console.error("Error fetching user notifications:",n),n}}static async markAsRead(e,t,n){try{let r;r="webhook_change"===n?_t.I.WEBHOOK_CHANGE_NOTIFICATIONS:_t.I.NOTIFICATIONS;const a=(0,kt.H9)(Nt.db,r,e);await(0,kt.mZ)(a,{read_by:(0,kt.hq)(t)})}catch(r){throw console.error("Error marking notification as read:",r),r}}static async getUnreadCountForAdmin(e){try{let t=0;const n=(0,kt.query)((0,kt.collection)(Nt.db,_t.I.WEBHOOK_CHANGE_NOTIFICATIONS),(0,kt.orderBy)("timestamp","desc"),(0,kt.limit)(100));(await(0,kt.getDocs)(n)).docs.forEach(n=>{(n.data().read_by||[]).includes(e)||t++});const r=(0,kt.query)((0,kt.collection)(Nt.db,_t.I.NOTIFICATIONS),(0,kt._M)("type","in",["leave_requested","leave_expired_admin"]),(0,kt.orderBy)("created_at","desc"),(0,kt.limit)(100));return(await(0,kt.getDocs)(r)).docs.forEach(n=>{(n.data().read_by||[]).includes(e)||t++}),t}catch(t){return console.error("Error getting unread count:",t),0}}static async getUnreadCountForUser(e){try{const t=(0,kt.query)((0,kt.collection)(Nt.db,_t.I.NOTIFICATIONS),(0,kt._M)("user_id","==",e),(0,kt.orderBy)("created_at","desc"),(0,kt.limit)(100)),n=await(0,kt.getDocs)(t);let r=0;return n.docs.forEach(t=>{(t.data().read_by||[]).includes(e)||r++}),r}catch(t){return console.error("Error getting unread count for user:",t),0}}}const AM=e=>{let{isOpen:t,onClose:n}=e;const{userData:a}=Rt(),[s,i]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(null),u=r.useCallback(async()=>{if(null!==a&&void 0!==a&&a.id)try{let e;l(!0),e="admin"===a.role||"academic_associate"===a.role?await EM.getAllAdminNotifications(50):await EM.getUserNotifications(a.id,50),i(e)}catch(e){console.error("Error loading notifications:",e),d("Failed to load notifications")}finally{l(!1)}},[a]);(0,r.useEffect)(()=>{t&&u()},[t,u]);const h=()=>null!==a&&void 0!==a&&a.id?s.filter(e=>!e.read_by||!e.read_by.includes(a.id)).length:0,m=e=>!(null===a||void 0===a||!a.id)&&(e.read_by&&e.read_by.includes(a.id)),p=e=>{switch(e){case"webhook_change":return(0,Pt.jsx)(NM,{className:"h-5 w-5"});case"leave_requested":return(0,Pt.jsx)(WI,{className:"h-5 w-5"});case"leave_approved":return(0,Pt.jsx)(GI,{className:"h-5 w-5"});case"leave_rejected":return(0,Pt.jsx)(CR,{className:"h-5 w-5"});case"leave_expired":case"leave_expired_admin":return(0,Pt.jsx)(la,{className:"h-5 w-5"});default:return(0,Pt.jsx)(IR,{className:"h-5 w-5"})}},f=(e,t)=>{if(t)return"text-gray-400";switch(e){case"webhook_change":return"text-purple-600";case"leave_requested":return"text-blue-600";case"leave_approved":return"text-green-600";case"leave_rejected":return"text-red-600";case"leave_expired":case"leave_expired_admin":return"text-orange-600";default:return"text-primary-600"}},g=e=>{switch(e){case"webhook_change":return"bg-purple-100 text-purple-800";case"leave_requested":return"bg-blue-100 text-blue-800";case"leave_approved":return"bg-green-100 text-green-800";case"leave_rejected":return"bg-red-100 text-red-800";case"leave_expired":case"leave_expired_admin":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},y=e=>{switch(e){case"webhook_change":return"Webhook";case"leave_requested":return"Leave Request";case"leave_approved":return"Leave Approved";case"leave_rejected":return"Leave Rejected";case"leave_expired":case"leave_expired_admin":return"Leave Expired";default:return"Notification"}};return t?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 z-40",onClick:n}),(0,Pt.jsxs)("div",{className:"fixed right-0 top-0 h-full w-full sm:w-96 bg-white shadow-2xl z-50 overflow-hidden flex flex-col",children:[(0,Pt.jsxs)("div",{className:"bg-primary-600 text-white p-4",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)(WI,{className:"h-5 w-5"}),(0,Pt.jsx)("h2",{className:"text-lg font-semibold",children:"Notifications"})]}),(0,Pt.jsx)("button",{onClick:n,className:"p-1 hover:bg-primary-700 rounded transition-colors",children:(0,Pt.jsx)(zn,{className:"h-5 w-5"})})]}),h()>0&&(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("p",{className:"text-sm text-primary-100",children:[h()," unread notification",1!==h()?"s":""]}),(0,Pt.jsx)("button",{onClick:async()=>{if(null!==a&&void 0!==a&&a.id)try{for(const e of s)m(e)||await EM.markAsRead(e.id,a.id,e.type);await u()}catch(e){console.error("Error marking all notifications as read:",e)}},className:"text-sm text-primary-100 hover:text-white underline",children:"Mark all as read"})]})]}),(0,Pt.jsx)("div",{className:"flex-1 overflow-y-auto",children:o?(0,Pt.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Pt.jsx)(Fl,{className:"h-8 w-8 animate-spin text-primary-600"})}):c?(0,Pt.jsx)("div",{className:"p-4",children:(0,Pt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)(Hn,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,Pt.jsx)("p",{className:"text-sm text-red-800",children:c})]})})}):0===s.length?(0,Pt.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[(0,Pt.jsx)(WI,{className:"h-12 w-12 text-gray-300 mb-3"}),(0,Pt.jsx)("p",{className:"text-gray-500 text-center",children:"No notifications yet"})]}):(0,Pt.jsx)("div",{className:"divide-y divide-gray-200",children:s.map(e=>{const t=m(e);return(0,Pt.jsx)("div",{className:"p-4 transition-colors ".concat(t?"bg-white":"bg-blue-50"),children:(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)("div",{className:"flex-shrink-0 mt-0.5 ".concat(f(e.type,t)),children:p(e.type)}),(0,Pt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,Pt.jsx)("div",{className:"flex-1",children:(0,Pt.jsx)("span",{className:"inline-block px-2 py-0.5 text-xs font-medium rounded ".concat(g(e.type)),children:y(e.type)})}),!t&&(0,Pt.jsx)("button",{onClick:()=>(async(e,t)=>{if(null!==a&&void 0!==a&&a.id)try{await EM.markAsRead(e,a.id,t),await u()}catch(n){console.error("Error marking notification as read:",n)}})(e.id,e.type),className:"p-1 hover:bg-gray-200 rounded transition-colors",title:"Mark as read",children:(0,Pt.jsx)(qI,{className:"h-4 w-4 text-gray-600"})})]}),(0,Pt.jsx)("p",{className:"text-sm mb-2 ".concat(t?"text-gray-600":"text-gray-900 font-medium"),children:e.title}),(0,Pt.jsx)("p",{className:"text-sm mb-2 ".concat(t?"text-gray-500":"text-gray-700"),children:e.message}),"webhook_change"===e.type&&e.related_data&&(0,Pt.jsx)(Pt.Fragment,{children:e.related_data.old_webhook_url&&(0,Pt.jsxs)("div",{className:"mb-2",children:[(0,Pt.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Previous URL:"}),(0,Pt.jsx)("p",{className:"text-xs text-gray-600 bg-gray-100 rounded p-2 break-all",children:e.related_data.old_webhook_url})]})}),(0,Pt.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.timestamp).toLocaleString()})]})]})},e.id)})})})]})]}):null},CM=()=>{const{userData:e}=Rt(),[t,n]=(0,r.useState)(0),[a,s]=(0,r.useState)(!1),i=r.useCallback(async()=>{if(null!==e&&void 0!==e&&e.id)try{let t=0;t="admin"===e.role||"academic_associate"===e.role?await EM.getUnreadCountForAdmin(e.id):await EM.getUnreadCountForUser(e.id),n(t)}catch(t){console.error("Error loading unread count:",t)}},[e]);(0,r.useEffect)(()=>{i();const e=setInterval(i,3e4);return()=>clearInterval(e)},[i]);return(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("button",{onClick:()=>{s(!0)},className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",title:"Notifications",children:[(0,Pt.jsx)(WI,{className:"h-5 w-5"}),t>0&&(0,Pt.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold px-1.5 py-0.5 rounded-full min-w-[20px] text-center",children:t>99?"99+":t})]}),(0,Pt.jsx)(AM,{isOpen:a,onClose:()=>{s(!1),i()}})]})},DM=e=>{let{adminId:t,adminName:n}=e;const[a,s]=(0,r.useState)([]),[i,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)("pending"),[d,u]=(0,r.useState)(null),[h,m]=(0,r.useState)(!1),[p,f]=(0,r.useState)(""),[g,y]=(0,r.useState)(!1),x=r.useCallback(async()=>{o(!0);try{const e=await Dn.getAllLeaves();s(e)}catch(e){console.error("Error loading leaves:",e)}finally{o(!1)}},[]);(0,r.useEffect)(()=>{x()},[x]);const v=e=>{const t={pending:(0,Pt.jsx)(la,{size:16}),approved:(0,Pt.jsx)(qn,{size:16}),rejected:(0,Pt.jsx)(oR,{size:16}),expired:(0,Pt.jsx)(Hn,{size:16})};return(0,Pt.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium border ".concat({pending:"bg-yellow-100 text-yellow-800 border-yellow-200",approved:"bg-green-100 text-green-800 border-green-200",rejected:"bg-red-100 text-red-800 border-red-200",expired:"bg-gray-100 text-gray-800 border-gray-200"}[e]),children:[t[e],e.charAt(0).toUpperCase()+e.slice(1)]})},b=e=>"kitchen_leave"===e?"Kitchen Leave":"On Leave",w=e=>{const t="kitchen_leave"===e;return(0,Pt.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ".concat(t?"bg-amber-100 text-amber-800":"bg-blue-100 text-blue-800"),children:b(e)})},j=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),N=(e,t)=>{const n=new Date(e),r=new Date(t);return n.toDateString()===r.toDateString()?j(n):"".concat(j(n)," - ").concat(j(r))},_=(e,t)=>{const n=new Date(e),r=new Date(t),a=Math.ceil((r.getTime()-n.getTime())/864e5)+1;return 1===a?"1 day":"".concat(a," days")},S=a.filter(e=>"all"===l||e.status===l),k=a.filter(e=>"pending"===e.status).length;return i?(0,Pt.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Leave Management"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage all leave requests from users"})]}),k>0&&(0,Pt.jsxs)("div",{className:"bg-yellow-100 text-yellow-800 px-4 py-2 rounded-lg font-medium",children:[k," Pending ",1===k?"Request":"Requests"]})]}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-2",children:(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)(tM,{size:20,className:"text-gray-400 ml-2"}),["all","pending","approved","rejected","expired"].map(e=>{const t="all"===e?a.length:a.filter(t=>t.status===e).length;return(0,Pt.jsxs)("button",{onClick:()=>c(e),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(l===e?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"),children:[e.charAt(0).toUpperCase()+e.slice(1),(0,Pt.jsxs)("span",{className:"ml-2 ".concat(l===e?"text-blue-200":"text-gray-400"),children:["(",t,")"]})]},e)})]})}),(0,Pt.jsx)("div",{className:"bg-white rounded-lg border border-gray-200",children:0===S.length?(0,Pt.jsxs)("div",{className:"p-8 text-center",children:[(0,Pt.jsx)(Bn,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,Pt.jsxs)("p",{className:"text-gray-600",children:["No ","all"!==l&&l," leave requests found"]})]}):(0,Pt.jsx)("div",{className:"divide-y divide-gray-200",children:S.map(e=>(0,Pt.jsxs)("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)("div",{className:"bg-blue-100 p-2 rounded-lg",children:(0,Pt.jsx)(ar,{size:24,className:"text-blue-600"})}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"font-semibold text-gray-900",children:e.user_name}),(0,Pt.jsx)("div",{className:"text-sm text-gray-600",children:e.user_email})]})]}),(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[w(e.leave_type),v(e.status)]})]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)(Bn,{className:"text-gray-400 mt-1",size:20}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Duration"}),(0,Pt.jsx)("div",{className:"font-medium text-gray-900",children:N(e.start_date,e.end_date)}),(0,Pt.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:_(e.start_date,e.end_date)})]})]}),e.reason&&(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)(Hn,{className:"text-gray-400 mt-1",size:20}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Reason"}),(0,Pt.jsx)("div",{className:"text-sm text-gray-900",children:e.reason})]})]})]}),"approved"===e.status&&e.approved_by_name&&(0,Pt.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800",children:[(0,Pt.jsx)(qn,{size:16,className:"inline mr-1"}),"Approved by ",e.approved_by_name," on ",j(e.approved_at)]}),"rejected"===e.status&&(0,Pt.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,Pt.jsxs)("div",{className:"text-sm text-red-800 mb-2",children:[(0,Pt.jsx)(oR,{size:16,className:"inline mr-1"}),"Rejected by ",e.rejected_by_name," on ",j(e.rejected_at)]}),e.rejection_reason&&(0,Pt.jsxs)("div",{className:"text-xs text-red-700 ml-5",children:["Reason: ",e.rejection_reason]})]}),"pending"===e.status&&(0,Pt.jsxs)("div",{className:"flex items-center gap-3 mt-4 pt-4 border-t border-gray-200",children:[(0,Pt.jsxs)("button",{onClick:()=>(async e=>{if(window.confirm("Approve leave request for ".concat(e.user_name,"?"))){y(!0);try{await Dn.approveLeave(e.id,t,n),await x(),alert("Leave request approved successfully!")}catch(r){console.error("Error approving leave:",r),alert("Failed to approve leave: "+r.message)}finally{y(!1)}}})(e),disabled:g,className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[(0,Pt.jsx)(qn,{size:18}),"Approve"]}),(0,Pt.jsxs)("button",{onClick:()=>(e=>{u(e),m(!0)})(e),disabled:g,className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:[(0,Pt.jsx)(oR,{size:18}),"Reject"]})]}),(0,Pt.jsx)("div",{className:"mt-3 flex items-center gap-4 text-xs text-gray-500",children:(0,Pt.jsxs)("span",{children:["Requested on ",j(e.created_at)]})})]},e.id))})}),h&&d&&(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[(0,Pt.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,Pt.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Reject Leave Request"})}),(0,Pt.jsxs)("div",{className:"p-6 space-y-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["User: ",(0,Pt.jsx)("strong",{children:d.user_name})]}),(0,Pt.jsxs)("p",{className:"text-sm text-gray-600",children:["Duration: ",(0,Pt.jsx)("strong",{children:N(d.start_date,d.end_date)})]})]}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rejection Reason (Optional)"}),(0,Pt.jsx)("textarea",{value:p,onChange:e=>f(e.target.value),placeholder:"Provide a reason for rejection...",rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"})]})]}),(0,Pt.jsxs)("div",{className:"p-6 border-t border-gray-200 flex gap-3",children:[(0,Pt.jsx)("button",{onClick:()=>{m(!1),u(null),f("")},disabled:g,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{if(d){y(!0);try{await Dn.rejectLeave(d.id,t,n,p||"No reason provided"),await x(),m(!1),u(null),f(""),alert("Leave request rejected successfully!")}catch(e){console.error("Error rejecting leave:",e),alert("Failed to reject leave: "+e.message)}finally{y(!1)}}},disabled:g,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:g?"Rejecting...":"Confirm Reject"})]})]})})]})},TM=()=>{const e=he(),{userData:t}=Rt(),[n]=(0,r.useState)(!1),[a,s]=(0,r.useState)(!1),i=r.useMemo(()=>{const e=[{id:"overview",label:"Overview"},{id:"user-management",label:"User Management"},{id:"reports",label:"Reports"}];return"academic_associate"!==(null===t||void 0===t?void 0:t.role)&&e.push({id:"backend",label:"Backend Management"}),e},[null===t||void 0===t?void 0:t.role]),o=r.useMemo(()=>({overview:[],"user-management":[{id:"users",label:"User Management"},{id:"mentors",label:"Mentor Management"},{id:"super-mentors",label:"Super Mentors"},{id:"phase-approvals",label:"Phase Approvals"},{id:"leave-management",label:"Leave Management"}],reports:[{id:"reports",label:"Overview"},{id:"review-compliance",label:"Review Compliance"},{id:"journey-tracking",label:"Journey Tracking"},{id:"phase-timeline",label:"Phase Timeline"},{id:"attendance",label:"Attendance Dashboard"},{id:"campus-schedules",label:"Campus Schedules"},{id:"house-stats",label:"House Statistics"}],backend:[{id:"curriculum",label:"Curriculum"},{id:"database",label:"Database Operations"},{id:"bug-reports",label:"Bug Reports"},{id:"mentee-reviews",label:"Mentee Review Categories"},{id:"webhooks",label:"Campus Webhooks"}]}),[]),[l,c]=(0,r.useState)(()=>localStorage.getItem("admin-main-tab")||"overview"),[d,u]=(0,r.useState)(()=>localStorage.getItem("admin-sub-tab")||"overview");(0,r.useEffect)(()=>{var e,t;const n=(null===(e=o[l])||void 0===e||null===(t=e[0])||void 0===t?void 0:t.id)||"overview";u(n),localStorage.setItem("admin-sub-tab",n)},[l,o]),(0,r.useEffect)(()=>{"academic_associate"===(null===t||void 0===t?void 0:t.role)&&"backend"===l&&(c("overview"),localStorage.setItem("admin-main-tab","overview"))},[null===t||void 0===t?void 0:t.role,l]);return n?(0,Pt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,Pt.jsxs)("div",{className:"min-h-screen bg-gray-50 p-8",children:[(0,Pt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Pt.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,Pt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Pt.jsx)(CM,{}),(0,Pt.jsxs)("button",{onClick:()=>e("/student/dashboard"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-sm",children:[(0,Pt.jsxs)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,Pt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),(0,Pt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"})]}),(0,Pt.jsx)("span",{children:"Learners Dashboard"})]})]})]}),(0,Pt.jsx)("nav",{className:"flex space-x-4 mb-4",children:i.map(e=>(0,Pt.jsx)("button",{onClick:()=>{return t=e.id,c(t),void localStorage.setItem("admin-main-tab",t);var t},className:"px-4 py-2 rounded-lg font-medium text-sm transition-colors ".concat(l===e.id?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-primary-50"),title:"".concat(e.label," - ").concat("user_management"===e.id?"Manage users, roles, and permissions":"backend_management"===e.id?"System configuration and data management":"View and analyze system data"),children:e.label},e.id))}),o[l].length>0&&(0,Pt.jsx)("nav",{className:"flex space-x-2 mb-6",children:o[l].map(e=>(0,Pt.jsx)("button",{onClick:()=>{return t=e.id,u(t),void localStorage.setItem("admin-sub-tab",t);var t},className:"px-3 py-1 rounded font-medium text-xs transition-colors ".concat(d===e.id?"bg-primary-100 text-primary-700":"bg-gray-50 text-gray-600 hover:bg-primary-50"),children:e.label},e.id))}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:["overview"===l&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"System Overview"})}),"user-management"===l&&"users"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(MR,{})}),"user-management"===l&&"mentors"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(FR,{})}),"user-management"===l&&"super-mentors"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(BR,{})}),"user-management"===l&&"phase-approvals"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(jM,{})}),"user-management"===l&&"leave-management"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(DM,{adminId:(null===t||void 0===t?void 0:t.id)||"",adminName:(null===t||void 0===t?void 0:t.name)||(null===t||void 0===t?void 0:t.display_name)||"Admin"})}),"reports"===l&&"reports"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Reports Coming Soon"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"Detailed analytics and student reports will be available here"})]})}),"reports"===l&&"review-compliance"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(wM,{})}),"reports"===l&&"journey-tracking"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(qR,{})}),"reports"===l&&"phase-timeline"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(jR,{})}),"backend"===l&&"curriculum"===d&&"academic_associate"!==(null===t||void 0===t?void 0:t.role)&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(UR,{})}),"backend"===l&&"database"===d&&"academic_associate"!==(null===t||void 0===t?void 0:t.role)&&(0,Pt.jsxs)("div",{className:"p-6",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Database Operations"}),(0,Pt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Curriculum Data Management"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-4",children:"Initialize the unified Induction curriculum with all 25 activities:"}),(0,Pt.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-md",children:(0,Pt.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,Pt.jsxs)("li",{children:["\u2022 ",(0,Pt.jsx)("strong",{children:"1 Phase:"}),' "Induction: Life Skills & Learning" (30 days)']}),(0,Pt.jsxs)("li",{children:["\u2022 ",(0,Pt.jsx)("strong",{children:"18 Life Skills:"})," LS0-LS8 + 7 English sub-quests + 2 bonus quests"]}),(0,Pt.jsxs)("li",{children:["\u2022 ",(0,Pt.jsx)("strong",{children:"8 Learning Quests:"})," LE1-LE8 covering learning methodology to portfolio"]}),(0,Pt.jsxs)("li",{children:["\u2022 ",(0,Pt.jsx)("strong",{children:"Total:"})," 25 trackable activities with detailed descriptions"]})]})}),(0,Pt.jsx)("button",{onClick:async()=>{s(!0);try{console.log("\ud83c\udf31 Starting curriculum data seeding..."),await hi.seedInitialData(),console.log("\u2705 Curriculum data seeded successfully!"),alert('\u2705 Curriculum data has been successfully seeded to Firestore!\n\nAll 25 activities in the unified "Induction: Life Skills & Learning" phase have been created.')}catch(e){console.error("\u274c Error seeding curriculum data:",e),alert("\u274c Failed to seed curriculum data. Check console for details.\n\nError: "+e.message)}finally{s(!1)}},disabled:a,className:"px-4 py-2 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(a?"bg-gray-400 text-gray-700 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:a?"Seeding Data...":"Seed Curriculum Data"}),(0,Pt.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,Pt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"User Data Management"}),(0,Pt.jsx)("p",{className:"text-gray-600 mb-4",children:"Create dummy users (Mentors and Students) and generate activity data for testing."}),(0,Pt.jsx)("button",{onClick:async()=>{s(!0);try{console.log("\ud83c\udf31 Starting user data seeding..."),await AR.seedUsersAndData(),alert("\u2705 Dummy users and data seeded successfully!")}catch(e){console.error("\u274c Error seeding user data:",e),alert("\u274c Failed to seed user data. Check console for details.")}finally{s(!1)}},disabled:a,className:"px-4 py-2 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 ".concat(a?"bg-gray-400 text-gray-700 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"),children:a?"Seeding Users...":"Seed Dummy Users & Data"})]}),(0,Pt.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,Pt.jsxs)("p",{className:"text-red-600 mb-2 text-sm",children:["\u26a0\ufe0f ",(0,Pt.jsx)("strong",{children:"Clean Up Old Data:"})," Remove existing curriculum data before seeding new data."]}),(0,Pt.jsx)("button",{onClick:async()=>{if(confirm("\u26a0\ufe0f This will DELETE ALL existing curriculum data in Firebase!\n\nThis includes all phases and topics. Are you sure you want to continue?")){s(!0);try{console.log("\ud83e\uddf9 Starting curriculum data cleanup..."),await hi.cleanupCurriculumData(),console.log("\u2705 Curriculum data cleaned up successfully!"),alert("\u2705 All old curriculum data has been removed from Firebase!\n\nYou can now seed the new unified curriculum data.")}catch(e){console.error("\u274c Error cleaning up curriculum data:",e),alert("\u274c Failed to clean up curriculum data. Check console for details.\n\nError: "+e.message)}finally{s(!1)}}},disabled:a,className:"px-4 py-2 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 ".concat(a?"bg-gray-400 text-gray-700 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"),children:a?"Cleaning Up...":"Clean Up Old Data"}),(0,Pt.jsx)("button",{onClick:async()=>{if(confirm("\ud83d\udd04 This will CLEAN UP old data and SEED the new unified curriculum!\n\nThis includes:\n1. Delete all existing phases and topics\n2. Create the new unified Induction phase with 25 activities\n\nProceed?")){s(!0);try{console.log("\ud83d\udd04 Starting clean & seed process..."),console.log("\ud83e\uddf9 Step 1: Cleaning up old data..."),await hi.cleanupCurriculumData(),console.log("\u2705 Old data cleaned up"),console.log("\ud83c\udf31 Step 2: Seeding new curriculum..."),await hi.seedInitialData(),console.log("\u2705 New curriculum seeded"),alert("\ud83c\udf89 SUCCESS!\n\n\u2705 Old curriculum data cleaned up\n\u2705 New unified curriculum with 25 activities created\n\nStudents will now see the updated curriculum!")}catch(e){console.error("\u274c Error during clean & seed process:",e),alert("\u274c Failed during clean & seed process. Check console for details.\n\nError: "+e.message)}finally{s(!1)}}},disabled:a,className:"ml-2 px-4 py-2 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 ".concat(a?"bg-gray-400 text-gray-700 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:a?"Processing...":"\ud83d\udd04 Clean & Seed New Data"})]})]})]}),"reports"===l&&"attendance"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(RR,{})}),"reports"===l&&"campus-schedules"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)($R,{})}),"reports"===l&&"house-stats"===d&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(ZR,{})}),"backend"===l&&"bug-reports"===d&&"academic_associate"!==(null===t||void 0===t?void 0:t.role)&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(zR,{})}),"backend"===l&&"mentee-reviews"===d&&"academic_associate"!==(null===t||void 0===t?void 0:t.role)&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(HR,{})}),"backend"===l&&"webhooks"===d&&"academic_associate"!==(null===t||void 0===t?void 0:t.role)&&(0,Pt.jsx)("div",{className:"p-6",children:(0,Pt.jsx)(kM,{})})]})]})},OM=e=>{let{isOpen:t,onClose:n,userId:a,onSuccess:s}=e;const[i,o]=(0,r.useState)("kitchen_leave"),[l,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(""),[h,m]=(0,r.useState)(""),[p,f]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[x,v]=(0,r.useState)("");if(!t)return null;const b=e=>{o(e),m(""),v(""),"kitchen_leave"===e&&u(l)},w=()=>{o("kitchen_leave"),c(""),u(""),m(""),v(""),f(!1),n()},j=e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"})};return(0,Pt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Pt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,Pt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Request Leave"}),(0,Pt.jsx)("button",{onClick:w,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,Pt.jsx)(zn,{size:24})})]}),p&&(0,Pt.jsx)("div",{className:"absolute inset-0 bg-white bg-opacity-95 flex items-center justify-center p-6 rounded-lg",children:(0,Pt.jsxs)("div",{className:"bg-white border-2 border-blue-500 rounded-lg p-6 max-w-sm",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Confirm Leave Request"}),(0,Pt.jsxs)("div",{className:"space-y-2 mb-6 text-sm text-gray-700",children:[(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Leave Type:"})," ","kitchen_leave"===i?"Kitchen Leave":"On Leave"]}),(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Start Date:"})," ",j(l)]}),(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"End Date:"})," ",j(d||l)]}),h&&(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Reason:"})," ",h]}),(0,Pt.jsxs)("p",{className:"text-blue-600 mt-4",children:[(0,Pt.jsx)(Hn,{size:16,className:"inline mr-1"}),"Your request requires approval from admin or academic associate"]}),"kitchen_leave"===i&&(0,Pt.jsxs)("p",{className:"text-amber-600 mt-2",children:[(0,Pt.jsx)(Hn,{size:16,className:"inline mr-1"}),"Once approved, your status will automatically change to active at 11:59 PM"]})]}),(0,Pt.jsxs)("div",{className:"flex gap-3",children:[(0,Pt.jsx)("button",{onClick:()=>f(!1),disabled:g,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{y(!0),v("");try{const e=new Date(l),t=new Date(d||l);await Dn.createLeaveRequest(a,i,e,t,h||void 0),f(!1),s(),w()}catch(e){v(e.message||"Failed to submit leave request"),f(!1)}finally{y(!1)}},disabled:g,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:g?"Submitting...":"Confirm"})]})]})}),(0,Pt.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),v(""),!l)return void v("Please select start date");if("on_leave"===i&&!d)return void v("Please select end date");if("on_leave"===i&&!h.trim())return void v("Reason is mandatory for on leave");const t=new Date(l);new Date(d||l)<t?v("End date cannot be before start date"):f(!0)},className:"p-6 space-y-6",children:[x&&(0,Pt.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-start gap-2",children:[(0,Pt.jsx)(Hn,{size:20,className:"flex-shrink-0 mt-0.5"}),(0,Pt.jsx)("span",{className:"text-sm",children:x})]}),(0,Pt.jsxs)("div",{className:"space-y-3",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Leave Type"}),(0,Pt.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Pt.jsxs)("button",{type:"button",onClick:()=>b("kitchen_leave"),className:"p-4 border-2 rounded-lg transition-all ".concat("kitchen_leave"===i?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:[(0,Pt.jsx)("div",{className:"font-semibold",children:"Kitchen Leave"}),(0,Pt.jsx)("div",{className:"text-xs mt-1 opacity-75",children:"Single day, needs approval"})]}),(0,Pt.jsxs)("button",{type:"button",onClick:()=>b("on_leave"),className:"p-4 border-2 rounded-lg transition-all ".concat("on_leave"===i?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:[(0,Pt.jsx)("div",{className:"font-semibold",children:"On Leave"}),(0,Pt.jsx)("div",{className:"text-xs mt-1 opacity-75",children:"Range, needs approval"})]})]})]}),(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"kitchen_leave"===i?"Date":"Start Date"}),(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)("input",{type:"date",value:l,onChange:e=>(e=>{c(e),"kitchen_leave"===i&&u(e)})(e.target.value),min:(new Date).toISOString().split("T")[0],required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,Pt.jsx)(Bn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",size:20})]})]}),"on_leave"===i&&(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),(0,Pt.jsxs)("div",{className:"relative",children:[(0,Pt.jsx)("input",{type:"date",value:d,onChange:e=>u(e.target.value),min:l||(new Date).toISOString().split("T")[0],required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,Pt.jsx)(Bn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",size:20})]})]}),(0,Pt.jsxs)("div",{className:"space-y-2",children:[(0,Pt.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Reason ","on_leave"===i&&(0,Pt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Pt.jsx)("textarea",{value:h,onChange:e=>m(e.target.value),required:"on_leave"===i,placeholder:"on_leave"===i?"Please provide a reason for your leave...":"Optional",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),(0,Pt.jsxs)("div",{className:"p-4 rounded-lg ".concat("kitchen_leave"===i?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"),children:[(0,Pt.jsx)("h4",{className:"font-semibold text-sm mb-2",children:"kitchen_leave"===i?"Kitchen Leave Info":"On Leave Info"}),(0,Pt.jsx)("ul",{className:"text-xs space-y-1 text-gray-700",children:"kitchen_leave"===i?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("li",{children:"\u2022 Can only be selected for one day"}),(0,Pt.jsx)("li",{children:"\u2022 Requires approval from admin or academic associate"}),(0,Pt.jsx)("li",{children:"\u2022 Once approved, automatically ends at 11:59 PM"}),(0,Pt.jsx)("li",{children:"\u2022 Apply again for next day if needed"})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("li",{children:"\u2022 Can select a date range"}),(0,Pt.jsx)("li",{children:"\u2022 Requires approval from admin or academic associate"}),(0,Pt.jsx)("li",{children:"\u2022 Reason is mandatory"}),(0,Pt.jsx)("li",{children:"\u2022 You'll be notified when leave expires"})]})})]}),(0,Pt.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,Pt.jsx)("button",{type:"button",onClick:w,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,Pt.jsx)("button",{type:"submit",disabled:g,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:"Submit Request"})]})]})]})})},PM=e=>{let{userId:t}=e;const[n,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[o,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[u,h]=(0,r.useState)([]),[m,p]=(0,r.useState)([]),f=r.useCallback(async()=>{i(!0);try{const e=await Dn.getUserLeaves(t);a(e);const n=new Date;n.setHours(0,0,0,0);const r=e.find(e=>{if("approved"!==e.status)return!1;const t=new Date(e.start_date),r=new Date(e.end_date);return t.setHours(0,0,0,0),r.setHours(23,59,59,999),n>=t&&n<=r});d(r||null);const s=e.filter(e=>"pending"===e.status);h(s);const i=e.filter(e=>{if("approved"!==e.status)return!1;const t=new Date(e.start_date);return t.setHours(0,0,0,0),t>n});p(i)}catch(e){console.error("Error loading leaves:",e)}finally{i(!1)}},[t]);(0,r.useEffect)(()=>{f()},[f]);const g=e=>{const t={pending:(0,Pt.jsx)(la,{size:16}),approved:(0,Pt.jsx)(qn,{size:16}),rejected:(0,Pt.jsx)(oR,{size:16}),expired:(0,Pt.jsx)(Hn,{size:16})};return(0,Pt.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium border ".concat({pending:"bg-yellow-100 text-yellow-800 border-yellow-200",approved:"bg-green-100 text-green-800 border-green-200",rejected:"bg-red-100 text-red-800 border-red-200",expired:"bg-gray-100 text-gray-800 border-gray-200"}[e]),children:[t[e],e.charAt(0).toUpperCase()+e.slice(1)]})},y=e=>"kitchen_leave"===e?"Kitchen Leave":"On Leave",x=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),v=(e,t)=>{const n=new Date(e),r=new Date(t);return n.toDateString()===r.toDateString()?x(n):"".concat(x(n)," - ").concat(x(r))},b=(e,t)=>{const n=new Date(e),r=new Date(t),a=Math.ceil((r.getTime()-n.getTime())/864e5)+1;return 1===a?"1 day":"".concat(a," days")};return s?(0,Pt.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,Pt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,Pt.jsxs)("div",{className:"space-y-6",children:[(0,Pt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Leave Management"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage your kitchen leave and on leave requests"})]}),(0,Pt.jsxs)("button",{onClick:()=>l(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,Pt.jsx)(uR,{size:20}),"Request Leave"]})]}),c&&(0,Pt.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border-2 border-blue-300 rounded-lg p-6",children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Active Leave"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:y(c.leave_type)})]}),g(c.status)]}),(0,Pt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)(Bn,{className:"text-blue-600 mt-1",size:20}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Duration"}),(0,Pt.jsx)("div",{className:"font-medium text-gray-900",children:v(c.start_date,c.end_date)}),(0,Pt.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:b(c.start_date,c.end_date)})]})]}),c.reason&&(0,Pt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Pt.jsx)(Hn,{className:"text-blue-600 mt-1",size:20}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Reason"}),(0,Pt.jsx)("div",{className:"text-sm text-gray-900",children:c.reason})]})]})]}),"pending"===c.status&&(0,Pt.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,Pt.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,Pt.jsx)(la,{size:16,className:"inline mr-1"}),"Your leave request is pending approval from admin or academic associate."]})}),"approved"===c.status&&"kitchen_leave"===c.leave_type&&(0,Pt.jsx)("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,Pt.jsxs)("p",{className:"text-sm text-amber-800",children:[(0,Pt.jsx)(Hn,{size:16,className:"inline mr-1"}),"Your status will automatically change to active at 11:59 PM today."]})})]}),u.length>0&&(0,Pt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)(la,{className:"text-yellow-600",size:20}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Pending Approval"}),(0,Pt.jsxs)("span",{className:"ml-auto bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:[u.length," ",1===u.length?"request":"requests"]})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Leave requests awaiting approval"})]}),(0,Pt.jsx)("div",{className:"divide-y divide-gray-200",children:u.map(e=>(0,Pt.jsxs)("div",{className:"p-6 bg-yellow-50/50",children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"font-medium text-gray-900",children:y(e.leave_type)}),(0,Pt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:v(e.start_date,e.end_date)})]}),g(e.status)]}),e.reason&&(0,Pt.jsxs)("div",{className:"mt-3 p-3 bg-white rounded-lg border border-gray-200",children:[(0,Pt.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Reason"}),(0,Pt.jsx)("div",{className:"text-sm text-gray-900",children:e.reason})]}),(0,Pt.jsxs)("div",{className:"mt-3 flex items-center gap-4 text-xs text-gray-500",children:[(0,Pt.jsxs)("span",{children:["Duration: ",b(e.start_date,e.end_date)]}),(0,Pt.jsx)("span",{children:"\u2022"}),(0,Pt.jsxs)("span",{children:["Requested on ",x(e.created_at)]})]})]},e.id))})]}),m.length>0&&(0,Pt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Pt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Pt.jsx)(Bn,{className:"text-blue-600",size:20}),(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Upcoming Leaves"}),(0,Pt.jsxs)("span",{className:"ml-auto bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:[m.length," ",1===m.length?"leave":"leaves"]})]}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Approved leaves starting in the future"})]}),(0,Pt.jsx)("div",{className:"divide-y divide-gray-200",children:m.map(e=>(0,Pt.jsxs)("div",{className:"p-6 bg-blue-50/30",children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"font-medium text-gray-900",children:y(e.leave_type)}),(0,Pt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:v(e.start_date,e.end_date)})]}),g(e.status)]}),e.reason&&(0,Pt.jsxs)("div",{className:"mt-3 p-3 bg-white rounded-lg border border-gray-200",children:[(0,Pt.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Reason"}),(0,Pt.jsx)("div",{className:"text-sm text-gray-900",children:e.reason})]}),e.approved_by_name&&(0,Pt.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:[(0,Pt.jsx)(qn,{size:14,className:"inline mr-1 text-green-600"}),"Approved by ",e.approved_by_name," on ",x(e.approved_at)]}),(0,Pt.jsxs)("div",{className:"mt-3 flex items-center gap-4 text-xs text-gray-500",children:[(0,Pt.jsxs)("span",{children:["Duration: ",b(e.start_date,e.end_date)]}),(0,Pt.jsx)("span",{children:"\u2022"}),(0,Pt.jsxs)("span",{children:["Starts ",x(e.start_date)]})]})]},e.id))})]}),(0,Pt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,Pt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,Pt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Leave History"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"View all your past leave requests"})]}),0===n.length?(0,Pt.jsxs)("div",{className:"p-8 text-center",children:[(0,Pt.jsx)(Bn,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,Pt.jsx)("p",{className:"text-gray-600",children:"No leave requests yet"}),(0,Pt.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:'Click "Request Leave" to apply for your first leave'})]}):(0,Pt.jsx)("div",{className:"divide-y divide-gray-200",children:n.map(e=>(0,Pt.jsxs)("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:[(0,Pt.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"font-medium text-gray-900",children:y(e.leave_type)}),(0,Pt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:v(e.start_date,e.end_date)})]}),g(e.status)]}),e.reason&&(0,Pt.jsxs)("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[(0,Pt.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Reason"}),(0,Pt.jsx)("div",{className:"text-sm text-gray-900",children:e.reason})]}),"approved"===e.status&&e.approved_by_name&&(0,Pt.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:[(0,Pt.jsx)(qn,{size:14,className:"inline mr-1 text-green-600"}),"Approved by ",e.approved_by_name," on ",x(e.approved_at)]}),"rejected"===e.status&&(0,Pt.jsxs)("div",{className:"mt-3",children:[(0,Pt.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:[(0,Pt.jsx)(oR,{size:14,className:"inline mr-1 text-red-600"}),"Rejected by ",e.rejected_by_name," on ",x(e.rejected_at)]}),e.rejection_reason&&(0,Pt.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,Pt.jsx)("div",{className:"text-xs text-red-600 mb-1",children:"Rejection Reason"}),(0,Pt.jsx)("div",{className:"text-sm text-red-900",children:e.rejection_reason})]})]}),(0,Pt.jsxs)("div",{className:"mt-3 flex items-center gap-4 text-xs text-gray-500",children:[(0,Pt.jsxs)("span",{children:["Duration: ",b(e.start_date,e.end_date)]}),(0,Pt.jsx)("span",{children:"\u2022"}),(0,Pt.jsxs)("span",{children:["Requested on ",x(e.created_at)]})]})]},e.id))})]}),(0,Pt.jsx)(OM,{isOpen:o,onClose:()=>l(!1),userId:t,onSuccess:()=>{f()}})]})},IM=()=>{const{userData:e}=Rt();return e?(0,Pt.jsx)(PM,{userId:e.id}):(0,Pt.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,Pt.jsx)("div",{className:"text-gray-600",children:"Loading user data..."})})},RM=()=>{const{userData:e}=Rt();return e?"admin"!==e.role&&"academic_associate"!==e.role?(0,Pt.jsx)(De,{to:"/unauthorized",replace:!0}):(0,Pt.jsx)(DM,{adminId:e.id,adminName:e.name||e.display_name||"Admin"}):(0,Pt.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,Pt.jsx)("div",{className:"text-gray-600",children:"Loading user data..."})})},MM=()=>(0,Pt.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"401"}),(0,Pt.jsx)("p",{className:"text-xl text-gray-600 mb-4",children:"Unauthorized Access"}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"You don't have permission to access this page."})]})}),LM=()=>(0,Pt.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,Pt.jsxs)("div",{className:"text-center",children:[(0,Pt.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"404"}),(0,Pt.jsx)("p",{className:"text-xl text-gray-600 mb-4",children:"Page Not Found"}),(0,Pt.jsx)("p",{className:"text-gray-500",children:"The page you're looking for doesn't exist."})]})});const FM=function(){return(0,r.useEffect)(()=>{console.log("[App] Initializing review reminder scheduler...");return _n.getInstance().start(),console.log("[App] Initializing attendance scheduler..."),kn.startScheduler(),console.log("[App] Initializing leave scheduler..."),Tn.start(),()=>{console.log("[App] App unmounting, stopping schedulers..."),kn.stopScheduler(),Tn.stop()}},[]),(0,Pt.jsx)(ht,{children:(0,Pt.jsx)(Mt,{children:(0,Pt.jsx)(Ut,{children:(0,Pt.jsx)("div",{className:"App",children:(0,Pt.jsxs)(Pe,{children:[(0,Pt.jsx)(Te,{path:"/login",element:(0,Pt.jsx)(vr,{})}),(0,Pt.jsx)(Te,{path:"/unauthorized",element:(0,Pt.jsx)(MM,{})}),(0,Pt.jsx)(Te,{path:"/",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(De,{to:"/dashboard",replace:!0})})})}),(0,Pt.jsx)(Te,{path:"/dashboard",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(wr,{})})}),(0,Pt.jsx)(Te,{path:"/student/dashboard",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(ga,{})})})}),(0,Pt.jsx)(Te,{path:"/calendar-auth",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(zI,{})})}),(0,Pt.jsx)(Te,{path:"/goals",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(Gl,{})})})}),(0,Pt.jsx)(Te,{path:"/goal-setting",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(Gl,{})})})}),(0,Pt.jsx)(Te,{path:"/reflection",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(Kl,{})})})}),(0,Pt.jsx)(Te,{path:"/student/book-session",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(HI,{})})})}),(0,Pt.jsx)(Te,{path:"/reviews",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(dR,{})})})}),(0,Pt.jsx)(Te,{path:"/mentor/dashboard",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(rR,{})})})}),(0,Pt.jsx)(Te,{path:"/mentor/mentee/:studentId",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(sR,{})})})}),(0,Pt.jsx)(Te,{path:"/mentor/review/:studentId",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(sR,{})})})}),(0,Pt.jsx)(Te,{path:"/mentor/pair-programming",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(cR,{})})})}),(0,Pt.jsx)(Te,{path:"/pair-programming/dashboard",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(wR,{})})})}),(0,Pt.jsx)(Te,{path:"/pair-programming/calendar",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(yR,{})})})}),(0,Pt.jsx)(Te,{path:"/pair-programming/leaderboard",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(bR,{})})})}),(0,Pt.jsx)(Te,{path:"/admin/dashboard",element:(0,Pt.jsx)(Gn,{requireAdmin:!0,children:(0,Pt.jsx)(TM,{})})}),(0,Pt.jsx)(Te,{path:"/leave",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(IM,{})})})}),(0,Pt.jsx)(Te,{path:"/admin/leave-management",element:(0,Pt.jsx)(Gn,{requireAdmin:!0,children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(RM,{})})})}),(0,Pt.jsx)(Te,{path:"/mentees",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Redirecting..."}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-2",children:"Please use /mentor/dashboard"})]})})})}),(0,Pt.jsx)(Te,{path:"/pair-programming",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsxs)("div",{className:"text-center py-12",children:[(0,Pt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Pair Programming"}),(0,Pt.jsx)("p",{className:"text-gray-600 mt-2",children:"Please use /mentor/pair-programming"})]})})})}),(0,Pt.jsx)(Te,{path:"/journey",element:(0,Pt.jsx)(Gn,{children:(0,Pt.jsx)(xr,{children:(0,Pt.jsx)(FI,{})})})}),(0,Pt.jsx)(Te,{path:"*",element:(0,Pt.jsx)(LM,{})})]})})})})})},UM=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,6453)).then(t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:s,getTTFB:i}=t;n(e),r(e),a(e),s(e),i(e)})};s.createRoot(document.getElementById("root")).render((0,Pt.jsx)(r.StrictMode,{children:(0,Pt.jsx)(FM,{})})),UM()})()})();
//# sourceMappingURL=main.0c480be2.js.map